import{$ as Ca,a as _e,b as Ee,c as fn,d as Ma,e as xr}from"./index-ecoaYE1U.js";function jr(t,e){if(t==null)return{};var n,r,i=(function(o,l){if(o==null)return{};var d={};for(var h in o)if({}.hasOwnProperty.call(o,h)){if(l.indexOf(h)!==-1)continue;d[h]=o[h]}return d})(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(r=0;r<a.length;r++)n=a[r],e.indexOf(n)===-1&&{}.propertyIsEnumerable.call(t,n)&&(i[n]=t[n])}return i}function ie(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function U(t){return U=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},U(t)}function Os(t){var e=(function(n,r){if(U(n)!="object"||!n)return n;var i=n[Symbol.toPrimitive];if(i!==void 0){var a=i.call(n,r);if(U(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(n)})(t,"string");return U(e)=="symbol"?e:e+""}function Lr(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Os(r.key),r)}}function se(t,e,n){return e&&Lr(t.prototype,e),n&&Lr(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function sn(t,e){if(e&&(U(e)=="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return(function(n){if(n===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n})(t)}function ge(t){return ge=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},ge(t)}function St(t,e){return St=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},St(t,e)}function an(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&St(t,e)}function be(t,e,n){return(e=Os(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Dr(t,e,n,r,i,a,o){try{var l=t[a](o),d=l.value}catch(h){return void n(h)}l.done?e(d):Promise.resolve(d).then(r,i)}function j(t){return function(){var e=this,n=arguments;return new Promise((function(r,i){var a=t.apply(e,n);function o(d){Dr(a,r,i,o,l,"next",d)}function l(d){Dr(a,r,i,o,l,"throw",d)}o(void 0)}))}}function Rr(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function Y(t,e){return(function(n){if(Array.isArray(n))return n})(t)||(function(n,r){var i=n==null?null:typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(i!=null){var a,o,l,d,h=[],p=!0,v=!1;try{if(l=(i=i.call(n)).next,r===0){if(Object(i)!==i)return;p=!1}else for(;!(p=(a=l.call(i)).done)&&(h.push(a.value),h.length!==r);p=!0);}catch(E){v=!0,o=E}finally{try{if(!p&&i.return!=null&&(d=i.return(),Object(d)!==d))return}finally{if(v)throw o}}return h}})(t,e)||(function(n,r){if(n){if(typeof n=="string")return Rr(n,r);var i={}.toString.call(n).slice(8,-1);return i==="Object"&&n.constructor&&(i=n.constructor.name),i==="Map"||i==="Set"?Array.from(n):i==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?Rr(n,r):void 0}})(t,e)||(function(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)})()}function Ea(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Nr,Ot={exports:{}},Ln=(function(){if(Nr)return Ot.exports;Nr=1;var t,e=typeof Reflect=="object"?Reflect:null,n=e&&typeof e.apply=="function"?e.apply:function(m,_,w){return Function.prototype.apply.call(m,_,w)};t=e&&typeof e.ownKeys=="function"?e.ownKeys:Object.getOwnPropertySymbols?function(m){return Object.getOwnPropertyNames(m).concat(Object.getOwnPropertySymbols(m))}:function(m){return Object.getOwnPropertyNames(m)};var r=Number.isNaN||function(m){return m!=m};function i(){i.init.call(this)}Ot.exports=i,Ot.exports.once=function(m,_){return new Promise((function(w,T){function A(x){m.removeListener(_,I),T(x)}function I(){typeof m.removeListener=="function"&&m.removeListener("error",A),w([].slice.call(arguments))}b(m,_,I,{once:!0}),_!=="error"&&(function(x,R,z){typeof x.on=="function"&&b(x,"error",R,z)})(m,A,{once:!0})}))},i.EventEmitter=i,i.prototype._events=void 0,i.prototype._eventsCount=0,i.prototype._maxListeners=void 0;var a=10;function o(m){if(typeof m!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof m)}function l(m){return m._maxListeners===void 0?i.defaultMaxListeners:m._maxListeners}function d(m,_,w,T){var A,I,x,R;if(o(w),(I=m._events)===void 0?(I=m._events=Object.create(null),m._eventsCount=0):(I.newListener!==void 0&&(m.emit("newListener",_,w.listener?w.listener:w),I=m._events),x=I[_]),x===void 0)x=I[_]=w,++m._eventsCount;else if(typeof x=="function"?x=I[_]=T?[w,x]:[x,w]:T?x.unshift(w):x.push(w),(A=l(m))>0&&x.length>A&&!x.warned){x.warned=!0;var z=new Error("Possible EventEmitter memory leak detected. "+x.length+" "+String(_)+" listeners added. Use emitter.setMaxListeners() to increase limit");z.name="MaxListenersExceededWarning",z.emitter=m,z.type=_,z.count=x.length,R=z,console&&console.warn&&console.warn(R)}return m}function h(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function p(m,_,w){var T={fired:!1,wrapFn:void 0,target:m,type:_,listener:w},A=h.bind(T);return A.listener=w,T.wrapFn=A,A}function v(m,_,w){var T=m._events;if(T===void 0)return[];var A=T[_];return A===void 0?[]:typeof A=="function"?w?[A.listener||A]:[A]:w?(function(I){for(var x=new Array(I.length),R=0;R<x.length;++R)x[R]=I[R].listener||I[R];return x})(A):C(A,A.length)}function E(m){var _=this._events;if(_!==void 0){var w=_[m];if(typeof w=="function")return 1;if(w!==void 0)return w.length}return 0}function C(m,_){for(var w=new Array(_),T=0;T<_;++T)w[T]=m[T];return w}function b(m,_,w,T){if(typeof m.on=="function")T.once?m.once(_,w):m.on(_,w);else{if(typeof m.addEventListener!="function")throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof m);m.addEventListener(_,(function A(I){T.once&&m.removeEventListener(_,A),w(I)}))}}return Object.defineProperty(i,"defaultMaxListeners",{enumerable:!0,get:function(){return a},set:function(m){if(typeof m!="number"||m<0||r(m))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+m+".");a=m}}),i.init=function(){this._events!==void 0&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},i.prototype.setMaxListeners=function(m){if(typeof m!="number"||m<0||r(m))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+m+".");return this._maxListeners=m,this},i.prototype.getMaxListeners=function(){return l(this)},i.prototype.emit=function(m){for(var _=[],w=1;w<arguments.length;w++)_.push(arguments[w]);var T=m==="error",A=this._events;if(A!==void 0)T=T&&A.error===void 0;else if(!T)return!1;if(T){var I;if(_.length>0&&(I=_[0]),I instanceof Error)throw I;var x=new Error("Unhandled error."+(I?" ("+I.message+")":""));throw x.context=I,x}var R=A[m];if(R===void 0)return!1;if(typeof R=="function")n(R,this,_);else{var z=R.length,te=C(R,z);for(w=0;w<z;++w)n(te[w],this,_)}return!0},i.prototype.addListener=function(m,_){return d(this,m,_,!1)},i.prototype.on=i.prototype.addListener,i.prototype.prependListener=function(m,_){return d(this,m,_,!0)},i.prototype.once=function(m,_){return o(_),this.on(m,p(this,m,_)),this},i.prototype.prependOnceListener=function(m,_){return o(_),this.prependListener(m,p(this,m,_)),this},i.prototype.removeListener=function(m,_){var w,T,A,I,x;if(o(_),(T=this._events)===void 0)return this;if((w=T[m])===void 0)return this;if(w===_||w.listener===_)--this._eventsCount==0?this._events=Object.create(null):(delete T[m],T.removeListener&&this.emit("removeListener",m,w.listener||_));else if(typeof w!="function"){for(A=-1,I=w.length-1;I>=0;I--)if(w[I]===_||w[I].listener===_){x=w[I].listener,A=I;break}if(A<0)return this;A===0?w.shift():(function(R,z){for(;z+1<R.length;z++)R[z]=R[z+1];R.pop()})(w,A),w.length===1&&(T[m]=w[0]),T.removeListener!==void 0&&this.emit("removeListener",m,x||_)}return this},i.prototype.off=i.prototype.removeListener,i.prototype.removeAllListeners=function(m){var _,w,T;if((w=this._events)===void 0)return this;if(w.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):w[m]!==void 0&&(--this._eventsCount==0?this._events=Object.create(null):delete w[m]),this;if(arguments.length===0){var A,I=Object.keys(w);for(T=0;T<I.length;++T)(A=I[T])!=="removeListener"&&this.removeAllListeners(A);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(typeof(_=w[m])=="function")this.removeListener(m,_);else if(_!==void 0)for(T=_.length-1;T>=0;T--)this.removeListener(m,_[T]);return this},i.prototype.listeners=function(m){return v(this,m,!0)},i.prototype.rawListeners=function(m){return v(this,m,!1)},i.listenerCount=function(m,_){return typeof m.listenerCount=="function"?m.listenerCount(_):E.call(m,_)},i.prototype.listenerCount=E,i.prototype.eventNames=function(){return this._eventsCount>0?t(this._events):[]},Ot.exports})(),Pt=Ea(Ln),Fr=Object.prototype.hasOwnProperty;function Br(t,e,n){for(n of t.keys())if(Z(n,e))return n}function Z(t,e){var n,r,i;if(t===e)return!0;if(t&&e&&(n=t.constructor)===e.constructor){if(n===Date)return t.getTime()===e.getTime();if(n===RegExp)return t.toString()===e.toString();if(n===Array){if((r=t.length)===e.length)for(;r--&&Z(t[r],e[r]););return r===-1}if(n===Set){if(t.size!==e.size)return!1;for(r of t)if((i=r)&&typeof i=="object"&&!(i=Br(e,i))||!e.has(i))return!1;return!0}if(n===Map){if(t.size!==e.size)return!1;for(r of t)if((i=r[0])&&typeof i=="object"&&!(i=Br(e,i))||!Z(r[1],e.get(i)))return!1;return!0}if(n===ArrayBuffer)t=new Uint8Array(t),e=new Uint8Array(e);else if(n===DataView){if((r=t.byteLength)===e.byteLength)for(;r--&&t.getInt8(r)===e.getInt8(r););return r===-1}if(ArrayBuffer.isView(t)){if((r=t.byteLength)===e.byteLength)for(;r--&&t[r]===e[r];);return r===-1}if(!n||typeof t=="object"){for(n in r=0,t)if(Fr.call(t,n)&&++r&&!Fr.call(e,n)||!(n in e)||!Z(t[n],e[n]))return!1;return Object.keys(e).length===r}}return t!=t&&e!=e}const Ta={"Amazon Silk":"amazon_silk","Android Browser":"android",Bada:"bada",BlackBerry:"blackberry",Chrome:"chrome",Chromium:"chromium",Electron:"electron",Epiphany:"epiphany",Firefox:"firefox",Focus:"focus",Generic:"generic","Google Search":"google_search",Googlebot:"googlebot","Internet Explorer":"ie","K-Meleon":"k_meleon",Maxthon:"maxthon","Microsoft Edge":"edge","MZ Browser":"mz","NAVER Whale Browser":"naver",Opera:"opera","Opera Coast":"opera_coast",PhantomJS:"phantomjs",Puffin:"puffin",QupZilla:"qupzilla",QQ:"qq",QQLite:"qqlite",Safari:"safari",Sailfish:"sailfish","Samsung Internet for Android":"samsung_internet",SeaMonkey:"seamonkey",Sleipnir:"sleipnir",Swing:"swing",Tizen:"tizen","UC Browser":"uc",Vivaldi:"vivaldi","WebOS Browser":"webos",WeChat:"wechat","Yandex Browser":"yandex",Roku:"roku"},Ps={amazon_silk:"Amazon Silk",android:"Android Browser",bada:"Bada",blackberry:"BlackBerry",chrome:"Chrome",chromium:"Chromium",electron:"Electron",epiphany:"Epiphany",firefox:"Firefox",focus:"Focus",generic:"Generic",googlebot:"Googlebot",google_search:"Google Search",ie:"Internet Explorer",k_meleon:"K-Meleon",maxthon:"Maxthon",edge:"Microsoft Edge",mz:"MZ Browser",naver:"NAVER Whale Browser",opera:"Opera",opera_coast:"Opera Coast",phantomjs:"PhantomJS",puffin:"Puffin",qupzilla:"QupZilla",qq:"QQ Browser",qqlite:"QQ Browser Lite",safari:"Safari",sailfish:"Sailfish",samsung_internet:"Samsung Internet for Android",seamonkey:"SeaMonkey",sleipnir:"Sleipnir",swing:"Swing",tizen:"Tizen",uc:"UC Browser",vivaldi:"Vivaldi",webos:"WebOS Browser",wechat:"WeChat",yandex:"Yandex Browser"},W={tablet:"tablet",mobile:"mobile",desktop:"desktop",tv:"tv"},X={WindowsPhone:"Windows Phone",Windows:"Windows",MacOS:"macOS",iOS:"iOS",Android:"Android",WebOS:"WebOS",BlackBerry:"BlackBerry",Bada:"Bada",Tizen:"Tizen",Linux:"Linux",ChromeOS:"Chrome OS",PlayStation4:"PlayStation 4",Roku:"Roku"},Oe={EdgeHTML:"EdgeHTML",Blink:"Blink",Trident:"Trident",Presto:"Presto",Gecko:"Gecko",WebKit:"WebKit"};class k{static getFirstMatch(e,n){const r=n.match(e);return r&&r.length>0&&r[1]||""}static getSecondMatch(e,n){const r=n.match(e);return r&&r.length>1&&r[2]||""}static matchAndReturnConst(e,n,r){if(e.test(n))return r}static getWindowsVersionName(e){switch(e){case"NT":return"NT";case"XP":case"NT 5.1":return"XP";case"NT 5.0":return"2000";case"NT 5.2":return"2003";case"NT 6.0":return"Vista";case"NT 6.1":return"7";case"NT 6.2":return"8";case"NT 6.3":return"8.1";case"NT 10.0":return"10";default:return}}static getMacOSVersionName(e){const n=e.split(".").splice(0,2).map((r=>parseInt(r,10)||0));if(n.push(0),n[0]===10)switch(n[1]){case 5:return"Leopard";case 6:return"Snow Leopard";case 7:return"Lion";case 8:return"Mountain Lion";case 9:return"Mavericks";case 10:return"Yosemite";case 11:return"El Capitan";case 12:return"Sierra";case 13:return"High Sierra";case 14:return"Mojave";case 15:return"Catalina";default:return}}static getAndroidVersionName(e){const n=e.split(".").splice(0,2).map((r=>parseInt(r,10)||0));if(n.push(0),!(n[0]===1&&n[1]<5))return n[0]===1&&n[1]<6?"Cupcake":n[0]===1&&n[1]>=6?"Donut":n[0]===2&&n[1]<2?"Eclair":n[0]===2&&n[1]===2?"Froyo":n[0]===2&&n[1]>2?"Gingerbread":n[0]===3?"Honeycomb":n[0]===4&&n[1]<1?"Ice Cream Sandwich":n[0]===4&&n[1]<4?"Jelly Bean":n[0]===4&&n[1]>=4?"KitKat":n[0]===5?"Lollipop":n[0]===6?"Marshmallow":n[0]===7?"Nougat":n[0]===8?"Oreo":n[0]===9?"Pie":void 0}static getVersionPrecision(e){return e.split(".").length}static compareVersions(e,n,r=!1){const i=k.getVersionPrecision(e),a=k.getVersionPrecision(n);let o=Math.max(i,a),l=0;const d=k.map([e,n],(h=>{const p=o-k.getVersionPrecision(h),v=h+new Array(p+1).join(".0");return k.map(v.split("."),(E=>new Array(20-E.length).join("0")+E)).reverse()}));for(r&&(l=o-Math.min(i,a)),o-=1;o>=l;){if(d[0][o]>d[1][o])return 1;if(d[0][o]===d[1][o]){if(o===l)return 0;o-=1}else if(d[0][o]<d[1][o])return-1}}static map(e,n){const r=[];let i;if(Array.prototype.map)return Array.prototype.map.call(e,n);for(i=0;i<e.length;i+=1)r.push(n(e[i]));return r}static find(e,n){let r,i;if(Array.prototype.find)return Array.prototype.find.call(e,n);for(r=0,i=e.length;r<i;r+=1){const a=e[r];if(n(a,r))return a}}static assign(e,...n){const r=e;let i,a;if(Object.assign)return Object.assign(e,...n);for(i=0,a=n.length;i<a;i+=1){const o=n[i];typeof o=="object"&&o!==null&&Object.keys(o).forEach((l=>{r[l]=o[l]}))}return e}static getBrowserAlias(e){return Ta[e]}static getBrowserTypeByAlias(e){return Ps[e]||""}}const V=/version\/(\d+(\.?_?\d+)+)/i,Aa=[{test:[/googlebot/i],describe(t){const e={name:"Googlebot"},n=k.getFirstMatch(/googlebot\/(\d+(\.\d+))/i,t)||k.getFirstMatch(V,t);return n&&(e.version=n),e}},{test:[/opera/i],describe(t){const e={name:"Opera"},n=k.getFirstMatch(V,t)||k.getFirstMatch(/(?:opera)[\s/](\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/opr\/|opios/i],describe(t){const e={name:"Opera"},n=k.getFirstMatch(/(?:opr|opios)[\s/](\S+)/i,t)||k.getFirstMatch(V,t);return n&&(e.version=n),e}},{test:[/SamsungBrowser/i],describe(t){const e={name:"Samsung Internet for Android"},n=k.getFirstMatch(V,t)||k.getFirstMatch(/(?:SamsungBrowser)[\s/](\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/Whale/i],describe(t){const e={name:"NAVER Whale Browser"},n=k.getFirstMatch(V,t)||k.getFirstMatch(/(?:whale)[\s/](\d+(?:\.\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/MZBrowser/i],describe(t){const e={name:"MZ Browser"},n=k.getFirstMatch(/(?:MZBrowser)[\s/](\d+(?:\.\d+)+)/i,t)||k.getFirstMatch(V,t);return n&&(e.version=n),e}},{test:[/focus/i],describe(t){const e={name:"Focus"},n=k.getFirstMatch(/(?:focus)[\s/](\d+(?:\.\d+)+)/i,t)||k.getFirstMatch(V,t);return n&&(e.version=n),e}},{test:[/swing/i],describe(t){const e={name:"Swing"},n=k.getFirstMatch(/(?:swing)[\s/](\d+(?:\.\d+)+)/i,t)||k.getFirstMatch(V,t);return n&&(e.version=n),e}},{test:[/coast/i],describe(t){const e={name:"Opera Coast"},n=k.getFirstMatch(V,t)||k.getFirstMatch(/(?:coast)[\s/](\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/opt\/\d+(?:.?_?\d+)+/i],describe(t){const e={name:"Opera Touch"},n=k.getFirstMatch(/(?:opt)[\s/](\d+(\.?_?\d+)+)/i,t)||k.getFirstMatch(V,t);return n&&(e.version=n),e}},{test:[/yabrowser/i],describe(t){const e={name:"Yandex Browser"},n=k.getFirstMatch(/(?:yabrowser)[\s/](\d+(\.?_?\d+)+)/i,t)||k.getFirstMatch(V,t);return n&&(e.version=n),e}},{test:[/ucbrowser/i],describe(t){const e={name:"UC Browser"},n=k.getFirstMatch(V,t)||k.getFirstMatch(/(?:ucbrowser)[\s/](\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/Maxthon|mxios/i],describe(t){const e={name:"Maxthon"},n=k.getFirstMatch(V,t)||k.getFirstMatch(/(?:Maxthon|mxios)[\s/](\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/epiphany/i],describe(t){const e={name:"Epiphany"},n=k.getFirstMatch(V,t)||k.getFirstMatch(/(?:epiphany)[\s/](\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/puffin/i],describe(t){const e={name:"Puffin"},n=k.getFirstMatch(V,t)||k.getFirstMatch(/(?:puffin)[\s/](\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/sleipnir/i],describe(t){const e={name:"Sleipnir"},n=k.getFirstMatch(V,t)||k.getFirstMatch(/(?:sleipnir)[\s/](\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/k-meleon/i],describe(t){const e={name:"K-Meleon"},n=k.getFirstMatch(V,t)||k.getFirstMatch(/(?:k-meleon)[\s/](\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/micromessenger/i],describe(t){const e={name:"WeChat"},n=k.getFirstMatch(/(?:micromessenger)[\s/](\d+(\.?_?\d+)+)/i,t)||k.getFirstMatch(V,t);return n&&(e.version=n),e}},{test:[/qqbrowser/i],describe(t){const e={name:/qqbrowserlite/i.test(t)?"QQ Browser Lite":"QQ Browser"},n=k.getFirstMatch(/(?:qqbrowserlite|qqbrowser)[/](\d+(\.?_?\d+)+)/i,t)||k.getFirstMatch(V,t);return n&&(e.version=n),e}},{test:[/msie|trident/i],describe(t){const e={name:"Internet Explorer"},n=k.getFirstMatch(/(?:msie |rv:)(\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/\sedg\//i],describe(t){const e={name:"Microsoft Edge"},n=k.getFirstMatch(/\sedg\/(\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/edg([ea]|ios)/i],describe(t){const e={name:"Microsoft Edge"},n=k.getSecondMatch(/edg([ea]|ios)\/(\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/vivaldi/i],describe(t){const e={name:"Vivaldi"},n=k.getFirstMatch(/vivaldi\/(\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/seamonkey/i],describe(t){const e={name:"SeaMonkey"},n=k.getFirstMatch(/seamonkey\/(\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/sailfish/i],describe(t){const e={name:"Sailfish"},n=k.getFirstMatch(/sailfish\s?browser\/(\d+(\.\d+)?)/i,t);return n&&(e.version=n),e}},{test:[/silk/i],describe(t){const e={name:"Amazon Silk"},n=k.getFirstMatch(/silk\/(\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/phantom/i],describe(t){const e={name:"PhantomJS"},n=k.getFirstMatch(/phantomjs\/(\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/slimerjs/i],describe(t){const e={name:"SlimerJS"},n=k.getFirstMatch(/slimerjs\/(\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/blackberry|\bbb\d+/i,/rim\stablet/i],describe(t){const e={name:"BlackBerry"},n=k.getFirstMatch(V,t)||k.getFirstMatch(/blackberry[\d]+\/(\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/(web|hpw)[o0]s/i],describe(t){const e={name:"WebOS Browser"},n=k.getFirstMatch(V,t)||k.getFirstMatch(/w(?:eb)?[o0]sbrowser\/(\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/bada/i],describe(t){const e={name:"Bada"},n=k.getFirstMatch(/dolfin\/(\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/tizen/i],describe(t){const e={name:"Tizen"},n=k.getFirstMatch(/(?:tizen\s?)?browser\/(\d+(\.?_?\d+)+)/i,t)||k.getFirstMatch(V,t);return n&&(e.version=n),e}},{test:[/qupzilla/i],describe(t){const e={name:"QupZilla"},n=k.getFirstMatch(/(?:qupzilla)[\s/](\d+(\.?_?\d+)+)/i,t)||k.getFirstMatch(V,t);return n&&(e.version=n),e}},{test:[/firefox|iceweasel|fxios/i],describe(t){const e={name:"Firefox"},n=k.getFirstMatch(/(?:firefox|iceweasel|fxios)[\s/](\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/electron/i],describe(t){const e={name:"Electron"},n=k.getFirstMatch(/(?:electron)\/(\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/MiuiBrowser/i],describe(t){const e={name:"Miui"},n=k.getFirstMatch(/(?:MiuiBrowser)[\s/](\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/chromium/i],describe(t){const e={name:"Chromium"},n=k.getFirstMatch(/(?:chromium)[\s/](\d+(\.?_?\d+)+)/i,t)||k.getFirstMatch(V,t);return n&&(e.version=n),e}},{test:[/chrome|crios|crmo/i],describe(t){const e={name:"Chrome"},n=k.getFirstMatch(/(?:chrome|crios|crmo)\/(\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/GSA/i],describe(t){const e={name:"Google Search"},n=k.getFirstMatch(/(?:GSA)\/(\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test(t){const e=!t.test(/like android/i),n=t.test(/android/i);return e&&n},describe(t){const e={name:"Android Browser"},n=k.getFirstMatch(V,t);return n&&(e.version=n),e}},{test:[/playstation 4/i],describe(t){const e={name:"PlayStation 4"},n=k.getFirstMatch(V,t);return n&&(e.version=n),e}},{test:[/safari|applewebkit/i],describe(t){const e={name:"Safari"},n=k.getFirstMatch(V,t);return n&&(e.version=n),e}},{test:[/.*/i],describe(t){const e=t.search("\\(")!==-1?/^(.*)\/(.*)[ \t]\((.*)/:/^(.*)\/(.*) /;return{name:k.getFirstMatch(e,t),version:k.getSecondMatch(e,t)}}}];var Oa=[{test:[/Roku\/DVP/],describe(t){const e=k.getFirstMatch(/Roku\/DVP-(\d+\.\d+)/i,t);return{name:X.Roku,version:e}}},{test:[/windows phone/i],describe(t){const e=k.getFirstMatch(/windows phone (?:os)?\s?(\d+(\.\d+)*)/i,t);return{name:X.WindowsPhone,version:e}}},{test:[/windows /i],describe(t){const e=k.getFirstMatch(/Windows ((NT|XP)( \d\d?.\d)?)/i,t),n=k.getWindowsVersionName(e);return{name:X.Windows,version:e,versionName:n}}},{test:[/Macintosh(.*?) FxiOS(.*?)\//],describe(t){const e={name:X.iOS},n=k.getSecondMatch(/(Version\/)(\d[\d.]+)/,t);return n&&(e.version=n),e}},{test:[/macintosh/i],describe(t){const e=k.getFirstMatch(/mac os x (\d+(\.?_?\d+)+)/i,t).replace(/[_\s]/g,"."),n=k.getMacOSVersionName(e),r={name:X.MacOS,version:e};return n&&(r.versionName=n),r}},{test:[/(ipod|iphone|ipad)/i],describe(t){const e=k.getFirstMatch(/os (\d+([_\s]\d+)*) like mac os x/i,t).replace(/[_\s]/g,".");return{name:X.iOS,version:e}}},{test(t){const e=!t.test(/like android/i),n=t.test(/android/i);return e&&n},describe(t){const e=k.getFirstMatch(/android[\s/-](\d+(\.\d+)*)/i,t),n=k.getAndroidVersionName(e),r={name:X.Android,version:e};return n&&(r.versionName=n),r}},{test:[/(web|hpw)[o0]s/i],describe(t){const e=k.getFirstMatch(/(?:web|hpw)[o0]s\/(\d+(\.\d+)*)/i,t),n={name:X.WebOS};return e&&e.length&&(n.version=e),n}},{test:[/blackberry|\bbb\d+/i,/rim\stablet/i],describe(t){const e=k.getFirstMatch(/rim\stablet\sos\s(\d+(\.\d+)*)/i,t)||k.getFirstMatch(/blackberry\d+\/(\d+([_\s]\d+)*)/i,t)||k.getFirstMatch(/\bbb(\d+)/i,t);return{name:X.BlackBerry,version:e}}},{test:[/bada/i],describe(t){const e=k.getFirstMatch(/bada\/(\d+(\.\d+)*)/i,t);return{name:X.Bada,version:e}}},{test:[/tizen/i],describe(t){const e=k.getFirstMatch(/tizen[/\s](\d+(\.\d+)*)/i,t);return{name:X.Tizen,version:e}}},{test:[/linux/i],describe:()=>({name:X.Linux})},{test:[/CrOS/],describe:()=>({name:X.ChromeOS})},{test:[/PlayStation 4/],describe(t){const e=k.getFirstMatch(/PlayStation 4[/\s](\d+(\.\d+)*)/i,t);return{name:X.PlayStation4,version:e}}}],Pa=[{test:[/googlebot/i],describe:()=>({type:"bot",vendor:"Google"})},{test:[/huawei/i],describe(t){const e=k.getFirstMatch(/(can-l01)/i,t)&&"Nova",n={type:W.mobile,vendor:"Huawei"};return e&&(n.model=e),n}},{test:[/nexus\s*(?:7|8|9|10).*/i],describe:()=>({type:W.tablet,vendor:"Nexus"})},{test:[/ipad/i],describe:()=>({type:W.tablet,vendor:"Apple",model:"iPad"})},{test:[/Macintosh(.*?) FxiOS(.*?)\//],describe:()=>({type:W.tablet,vendor:"Apple",model:"iPad"})},{test:[/kftt build/i],describe:()=>({type:W.tablet,vendor:"Amazon",model:"Kindle Fire HD 7"})},{test:[/silk/i],describe:()=>({type:W.tablet,vendor:"Amazon"})},{test:[/tablet(?! pc)/i],describe:()=>({type:W.tablet})},{test(t){const e=t.test(/ipod|iphone/i),n=t.test(/like (ipod|iphone)/i);return e&&!n},describe(t){const e=k.getFirstMatch(/(ipod|iphone)/i,t);return{type:W.mobile,vendor:"Apple",model:e}}},{test:[/nexus\s*[0-6].*/i,/galaxy nexus/i],describe:()=>({type:W.mobile,vendor:"Nexus"})},{test:[/[^-]mobi/i],describe:()=>({type:W.mobile})},{test:t=>t.getBrowserName(!0)==="blackberry",describe:()=>({type:W.mobile,vendor:"BlackBerry"})},{test:t=>t.getBrowserName(!0)==="bada",describe:()=>({type:W.mobile})},{test:t=>t.getBrowserName()==="windows phone",describe:()=>({type:W.mobile,vendor:"Microsoft"})},{test(t){const e=Number(String(t.getOSVersion()).split(".")[0]);return t.getOSName(!0)==="android"&&e>=3},describe:()=>({type:W.tablet})},{test:t=>t.getOSName(!0)==="android",describe:()=>({type:W.mobile})},{test:t=>t.getOSName(!0)==="macos",describe:()=>({type:W.desktop,vendor:"Apple"})},{test:t=>t.getOSName(!0)==="windows",describe:()=>({type:W.desktop})},{test:t=>t.getOSName(!0)==="linux",describe:()=>({type:W.desktop})},{test:t=>t.getOSName(!0)==="playstation 4",describe:()=>({type:W.tv})},{test:t=>t.getOSName(!0)==="roku",describe:()=>({type:W.tv})}],Ia=[{test:t=>t.getBrowserName(!0)==="microsoft edge",describe(t){if(/\sedg\//i.test(t))return{name:Oe.Blink};const e=k.getFirstMatch(/edge\/(\d+(\.?_?\d+)+)/i,t);return{name:Oe.EdgeHTML,version:e}}},{test:[/trident/i],describe(t){const e={name:Oe.Trident},n=k.getFirstMatch(/trident\/(\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:t=>t.test(/presto/i),describe(t){const e={name:Oe.Presto},n=k.getFirstMatch(/presto\/(\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test(t){const e=t.test(/gecko/i),n=t.test(/like gecko/i);return e&&!n},describe(t){const e={name:Oe.Gecko},n=k.getFirstMatch(/gecko\/(\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/(apple)?webkit\/537\.36/i],describe:()=>({name:Oe.Blink})},{test:[/(apple)?webkit/i],describe(t){const e={name:Oe.WebKit},n=k.getFirstMatch(/webkit\/(\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}}];class Ur{constructor(e,n=!1){if(e==null||e==="")throw new Error("UserAgent parameter can't be empty");this._ua=e,this.parsedResult={},n!==!0&&this.parse()}getUA(){return this._ua}test(e){return e.test(this._ua)}parseBrowser(){this.parsedResult.browser={};const e=k.find(Aa,(n=>{if(typeof n.test=="function")return n.test(this);if(n.test instanceof Array)return n.test.some((r=>this.test(r)));throw new Error("Browser's test function is not valid")}));return e&&(this.parsedResult.browser=e.describe(this.getUA())),this.parsedResult.browser}getBrowser(){return this.parsedResult.browser?this.parsedResult.browser:this.parseBrowser()}getBrowserName(e){return e?String(this.getBrowser().name).toLowerCase()||"":this.getBrowser().name||""}getBrowserVersion(){return this.getBrowser().version}getOS(){return this.parsedResult.os?this.parsedResult.os:this.parseOS()}parseOS(){this.parsedResult.os={};const e=k.find(Oa,(n=>{if(typeof n.test=="function")return n.test(this);if(n.test instanceof Array)return n.test.some((r=>this.test(r)));throw new Error("Browser's test function is not valid")}));return e&&(this.parsedResult.os=e.describe(this.getUA())),this.parsedResult.os}getOSName(e){const{name:n}=this.getOS();return e?String(n).toLowerCase()||"":n||""}getOSVersion(){return this.getOS().version}getPlatform(){return this.parsedResult.platform?this.parsedResult.platform:this.parsePlatform()}getPlatformType(e=!1){const{type:n}=this.getPlatform();return e?String(n).toLowerCase()||"":n||""}parsePlatform(){this.parsedResult.platform={};const e=k.find(Pa,(n=>{if(typeof n.test=="function")return n.test(this);if(n.test instanceof Array)return n.test.some((r=>this.test(r)));throw new Error("Browser's test function is not valid")}));return e&&(this.parsedResult.platform=e.describe(this.getUA())),this.parsedResult.platform}getEngine(){return this.parsedResult.engine?this.parsedResult.engine:this.parseEngine()}getEngineName(e){return e?String(this.getEngine().name).toLowerCase()||"":this.getEngine().name||""}parseEngine(){this.parsedResult.engine={};const e=k.find(Ia,(n=>{if(typeof n.test=="function")return n.test(this);if(n.test instanceof Array)return n.test.some((r=>this.test(r)));throw new Error("Browser's test function is not valid")}));return e&&(this.parsedResult.engine=e.describe(this.getUA())),this.parsedResult.engine}parse(){return this.parseBrowser(),this.parseOS(),this.parsePlatform(),this.parseEngine(),this}getResult(){return k.assign({},this.parsedResult)}satisfies(e){const n={};let r=0;const i={};let a=0;if(Object.keys(e).forEach((o=>{const l=e[o];typeof l=="string"?(i[o]=l,a+=1):typeof l=="object"&&(n[o]=l,r+=1)})),r>0){const o=Object.keys(n),l=k.find(o,(h=>this.isOS(h)));if(l){const h=this.satisfies(n[l]);if(h!==void 0)return h}const d=k.find(o,(h=>this.isPlatform(h)));if(d){const h=this.satisfies(n[d]);if(h!==void 0)return h}}if(a>0){const o=Object.keys(i),l=k.find(o,(d=>this.isBrowser(d,!0)));if(l!==void 0)return this.compareVersion(i[l])}}isBrowser(e,n=!1){const r=this.getBrowserName().toLowerCase();let i=e.toLowerCase();const a=k.getBrowserTypeByAlias(i);return n&&a&&(i=a.toLowerCase()),i===r}compareVersion(e){let n=[0],r=e,i=!1;const a=this.getBrowserVersion();if(typeof a=="string")return e[0]===">"||e[0]==="<"?(r=e.substr(1),e[1]==="="?(i=!0,r=e.substr(2)):n=[],e[0]===">"?n.push(1):n.push(-1)):e[0]==="="?r=e.substr(1):e[0]==="~"&&(i=!0,r=e.substr(1)),n.indexOf(k.compareVersions(a,r,i))>-1}isOS(e){return this.getOSName(!0)===String(e).toLowerCase()}isPlatform(e){return this.getPlatformType(!0)===String(e).toLowerCase()}isEngine(e){return this.getEngineName(!0)===String(e).toLowerCase()}is(e,n=!1){return this.isBrowser(e,n)||this.isOS(e)||this.isPlatform(e)}some(e=[]){return e.some((n=>this.is(n)))}}/*!
 * Bowser - a browser detector
 * https://github.com/lancedikson/bowser
 * MIT License | (c) Dustin Diaz 2012-2015
 * MIT License | (c) Denis Demchenko 2015-2019
 */class xa{static getParser(e,n=!1){if(typeof e!="string")throw new Error("UserAgent should be a string");return new Ur(e,n)}static parse(e){return new Ur(e).getResult()}static get BROWSER_MAP(){return Ps}static get ENGINE_MAP(){return Oe}static get OS_MAP(){return X}static get PLATFORMS_MAP(){return W}}function on(){return Date.now()+Math.random().toString()}function vt(){throw new Error("Method must be implemented in subclass")}function Is(t,e){return e!=null&&e.proxyUrl?e.proxyUrl+(e.proxyUrl.slice(-1)==="/"?"":"/")+t.substring(8):t}function Qt(t){return t!=null&&t.callObjectBundleUrlOverride?t.callObjectBundleUrlOverride:Is("https://c.daily.co/call-machine/versioned/".concat("0.84.0","/static/call-machine-object-bundle.js"),t)}function Gt(t){try{new URL(t)}catch{return!1}return!0}const q=typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__,Je="8.55.0",$=globalThis;function Kt(t,e,n){const r=$,i=r.__SENTRY__=r.__SENTRY__||{},a=i[Je]=i[Je]||{};return a[t]||(a[t]=e())}const Ye=typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__,Dn=["debug","info","warn","error","log","assert","trace"],Yt={};function Mt(t){if(!("console"in $))return t();const e=$.console,n={},r=Object.keys(Yt);r.forEach((i=>{const a=Yt[i];n[i]=e[i],e[i]=a}));try{return t()}finally{r.forEach((i=>{e[i]=n[i]}))}}const L=Kt("logger",(function(){let t=!1;const e={enable:()=>{t=!0},disable:()=>{t=!1},isEnabled:()=>t};return Ye?Dn.forEach((n=>{e[n]=(...r)=>{t&&Mt((()=>{$.console[n](`Sentry Logger [${n}]:`,...r)}))}})):Dn.forEach((n=>{e[n]=()=>{}})),e})),Ve="?",$r=/\(error: (.*)\)/,Vr=/captureMessage|captureException/;function It(t){return t[t.length-1]||{}}const Jr="<anonymous>";function xe(t){try{return t&&typeof t=="function"&&t.name||Jr}catch{return Jr}}function qr(t){const e=t.exception;if(e){const n=[];try{return e.values.forEach((r=>{r.stacktrace.frames&&n.push(...r.stacktrace.frames)})),n}catch{return}}}const qt={},zr={};function qe(t,e){qt[t]=qt[t]||[],qt[t].push(e)}function ze(t,e){if(!zr[t]){zr[t]=!0;try{e()}catch(n){Ye&&L.error(`Error while instrumenting ${t}`,n)}}}function pe(t,e){const n=t&&qt[t];if(n)for(const r of n)try{r(e)}catch(i){Ye&&L.error(`Error while triggering instrumentation handler.
Type: ${t}
Name: ${xe(r)}
Error:`,i)}}let pn=null;function ja(){pn=$.onerror,$.onerror=function(t,e,n,r,i){return pe("error",{column:r,error:i,line:n,msg:t,url:e}),!!pn&&pn.apply(this,arguments)},$.onerror.__SENTRY_INSTRUMENTED__=!0}let gn=null;function La(){gn=$.onunhandledrejection,$.onunhandledrejection=function(t){return pe("unhandledrejection",t),!gn||gn.apply(this,arguments)},$.onunhandledrejection.__SENTRY_INSTRUMENTED__=!0}function cn(){return sr($),$}function sr(t){const e=t.__SENTRY__=t.__SENTRY__||{};return e.version=e.version||Je,e[Je]=e[Je]||{}}const xs=Object.prototype.toString;function ar(t){switch(xs.call(t)){case"[object Error]":case"[object Exception]":case"[object DOMException]":case"[object WebAssembly.Exception]":return!0;default:return He(t,Error)}}function dt(t,e){return xs.call(t)===`[object ${e}]`}function js(t){return dt(t,"ErrorEvent")}function Wr(t){return dt(t,"DOMError")}function Se(t){return dt(t,"String")}function or(t){return typeof t=="object"&&t!==null&&"__sentry_template_string__"in t&&"__sentry_template_values__"in t}function Rn(t){return t===null||or(t)||typeof t!="object"&&typeof t!="function"}function at(t){return dt(t,"Object")}function ln(t){return typeof Event<"u"&&He(t,Event)}function un(t){return!!(t&&t.then&&typeof t.then=="function")}function He(t,e){try{return t instanceof e}catch{return!1}}function Ls(t){return!(typeof t!="object"||t===null||!t.__isVue&&!t._isVue)}const cr=$;function Ds(t,e={}){if(!t)return"<unknown>";try{let n=t;const r=5,i=[];let a=0,o=0;const l=" > ",d=l.length;let h;const p=Array.isArray(e)?e:e.keyAttrs,v=!Array.isArray(e)&&e.maxStringLength||80;for(;n&&a++<r&&(h=Da(n,p),!(h==="html"||a>1&&o+i.length*d+h.length>=v));)i.push(h),o+=h.length,n=n.parentNode;return i.reverse().join(l)}catch{return"<unknown>"}}function Da(t,e){const n=t,r=[];if(!n||!n.tagName)return"";if(cr.HTMLElement&&n instanceof HTMLElement&&n.dataset){if(n.dataset.sentryComponent)return n.dataset.sentryComponent;if(n.dataset.sentryElement)return n.dataset.sentryElement}r.push(n.tagName.toLowerCase());const i=e&&e.length?e.filter((o=>n.getAttribute(o))).map((o=>[o,n.getAttribute(o)])):null;if(i&&i.length)i.forEach((o=>{r.push(`[${o[0]}="${o[1]}"]`)}));else{n.id&&r.push(`#${n.id}`);const o=n.className;if(o&&Se(o)){const l=o.split(/\s+/);for(const d of l)r.push(`.${d}`)}}const a=["aria-label","type","name","title","alt"];for(const o of a){const l=n.getAttribute(o);l&&r.push(`[${o}="${l}"]`)}return r.join("")}function it(t,e=0){return typeof t!="string"||e===0||t.length<=e?t:`${t.slice(0,e)}...`}function Hr(t,e){if(!Array.isArray(t))return"";const n=[];for(let r=0;r<t.length;r++){const i=t[r];try{Ls(i)?n.push("[VueViewModel]"):n.push(String(i))}catch{n.push("[value cannot be serialized]")}}return n.join(e)}function Ra(t,e,n=!1){return!!Se(t)&&(dt(e,"RegExp")?e.test(t):!!Se(e)&&(n?t===e:t.includes(e)))}function xt(t,e=[],n=!1){return e.some((r=>Ra(t,r,n)))}function re(t,e,n){if(!(e in t))return;const r=t[e],i=n(r);typeof i=="function"&&Rs(i,r);try{t[e]=i}catch{Ye&&L.log(`Failed to replace method "${e}" in object`,t)}}function Qe(t,e,n){try{Object.defineProperty(t,e,{value:n,writable:!0,configurable:!0})}catch{Ye&&L.log(`Failed to add non-enumerable property "${e}" to object`,t)}}function Rs(t,e){try{const n=e.prototype||{};t.prototype=e.prototype=n,Qe(t,"__sentry_original__",e)}catch{}}function lr(t){return t.__sentry_original__}function Ns(t){if(ar(t))return{message:t.message,name:t.name,stack:t.stack,...Gr(t)};if(ln(t)){const e={type:t.type,target:Qr(t.target),currentTarget:Qr(t.currentTarget),...Gr(t)};return typeof CustomEvent<"u"&&He(t,CustomEvent)&&(e.detail=t.detail),e}return t}function Qr(t){try{return e=t,typeof Element<"u"&&He(e,Element)?Ds(t):Object.prototype.toString.call(t)}catch{return"<unknown>"}var e}function Gr(t){if(typeof t=="object"&&t!==null){const e={};for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}return{}}function ce(t){return Nn(t,new Map)}function Nn(t,e){if((function(n){if(!at(n))return!1;try{const r=Object.getPrototypeOf(n).constructor.name;return!r||r==="Object"}catch{return!0}})(t)){const n=e.get(t);if(n!==void 0)return n;const r={};e.set(t,r);for(const i of Object.getOwnPropertyNames(t))t[i]!==void 0&&(r[i]=Nn(t[i],e));return r}if(Array.isArray(t)){const n=e.get(t);if(n!==void 0)return n;const r=[];return e.set(t,r),t.forEach((i=>{r.push(Nn(i,e))})),r}return t}function Et(){return Date.now()/1e3}const Me=(function(){const{performance:t}=$;if(!t||!t.now)return Et;const e=Date.now()-t.now(),n=t.timeOrigin==null?e:t.timeOrigin;return()=>(n+t.now())/1e3})();function le(){const t=$,e=t.crypto||t.msCrypto;let n=()=>16*Math.random();try{if(e&&e.randomUUID)return e.randomUUID().replace(/-/g,"");e&&e.getRandomValues&&(n=()=>{const r=new Uint8Array(1);return e.getRandomValues(r),r[0]})}catch{}return("10000000100040008000"+1e11).replace(/[018]/g,(r=>(r^(15&n())>>r/4).toString(16)))}function Fs(t){return t.exception&&t.exception.values?t.exception.values[0]:void 0}function Pe(t){const{message:e,event_id:n}=t;if(e)return e;const r=Fs(t);return r?r.type&&r.value?`${r.type}: ${r.value}`:r.type||r.value||n||"<unknown>":n||"<unknown>"}function Fn(t,e,n){const r=t.exception=t.exception||{},i=r.values=r.values||[],a=i[0]=i[0]||{};a.value||(a.value=e||""),a.type||(a.type="Error")}function ot(t,e){const n=Fs(t);if(!n)return;const r=n.mechanism;if(n.mechanism={type:"generic",handled:!0,...r,...e},e&&"data"in e){const i={...r&&r.data,...e.data};n.mechanism.data=i}}function Kr(t){if((function(e){try{return e.__sentry_captured__}catch{}})(t))return!0;try{Qe(t,"__sentry_captured__",!0)}catch{}return!1}var we;function Ge(t){return new oe((e=>{e(t)}))}function Xt(t){return new oe(((e,n)=>{n(t)}))}(()=>{const{performance:t}=$;!t||!t.now||(t.now(),t.timing&&t.timing.navigationStart)})(),(function(t){t[t.PENDING=0]="PENDING",t[t.RESOLVED=1]="RESOLVED",t[t.REJECTED=2]="REJECTED"})(we||(we={}));class oe{constructor(e){oe.prototype.__init.call(this),oe.prototype.__init2.call(this),oe.prototype.__init3.call(this),oe.prototype.__init4.call(this),this._state=we.PENDING,this._handlers=[];try{e(this._resolve,this._reject)}catch(n){this._reject(n)}}then(e,n){return new oe(((r,i)=>{this._handlers.push([!1,a=>{if(e)try{r(e(a))}catch(o){i(o)}else r(a)},a=>{if(n)try{r(n(a))}catch(o){i(o)}else i(a)}]),this._executeHandlers()}))}catch(e){return this.then((n=>n),e)}finally(e){return new oe(((n,r)=>{let i,a;return this.then((o=>{a=!1,i=o,e&&e()}),(o=>{a=!0,i=o,e&&e()})).then((()=>{a?r(i):n(i)}))}))}__init(){this._resolve=e=>{this._setResult(we.RESOLVED,e)}}__init2(){this._reject=e=>{this._setResult(we.REJECTED,e)}}__init3(){this._setResult=(e,n)=>{this._state===we.PENDING&&(un(n)?n.then(this._resolve,this._reject):(this._state=e,this._value=n,this._executeHandlers()))}}__init4(){this._executeHandlers=()=>{if(this._state===we.PENDING)return;const e=this._handlers.slice();this._handlers=[],e.forEach((n=>{n[0]||(this._state===we.RESOLVED&&n[1](this._value),this._state===we.REJECTED&&n[2](this._value),n[0]=!0)}))}}}function Na(t){const e=Me(),n={sid:le(),init:!0,timestamp:e,started:e,duration:0,status:"ok",errors:0,ignoreDuration:!1,toJSON:()=>(function(r){return ce({sid:`${r.sid}`,init:r.init,started:new Date(1e3*r.started).toISOString(),timestamp:new Date(1e3*r.timestamp).toISOString(),status:r.status,errors:r.errors,did:typeof r.did=="number"||typeof r.did=="string"?`${r.did}`:void 0,duration:r.duration,abnormal_mechanism:r.abnormal_mechanism,attrs:{release:r.release,environment:r.environment,ip_address:r.ipAddress,user_agent:r.userAgent}})})(n)};return t&&ct(n,t),n}function ct(t,e={}){if(e.user&&(!t.ipAddress&&e.user.ip_address&&(t.ipAddress=e.user.ip_address),t.did||e.did||(t.did=e.user.id||e.user.email||e.user.username)),t.timestamp=e.timestamp||Me(),e.abnormal_mechanism&&(t.abnormal_mechanism=e.abnormal_mechanism),e.ignoreDuration&&(t.ignoreDuration=e.ignoreDuration),e.sid&&(t.sid=e.sid.length===32?e.sid:le()),e.init!==void 0&&(t.init=e.init),!t.did&&e.did&&(t.did=`${e.did}`),typeof e.started=="number"&&(t.started=e.started),t.ignoreDuration)t.duration=void 0;else if(typeof e.duration=="number")t.duration=e.duration;else{const n=t.timestamp-t.started;t.duration=n>=0?n:0}e.release&&(t.release=e.release),e.environment&&(t.environment=e.environment),!t.ipAddress&&e.ipAddress&&(t.ipAddress=e.ipAddress),!t.userAgent&&e.userAgent&&(t.userAgent=e.userAgent),typeof e.errors=="number"&&(t.errors=e.errors),e.status&&(t.status=e.status)}function Yr(){return le()}function Bn(){return le().substring(16)}function dn(t,e,n=2){if(!e||typeof e!="object"||n<=0)return e;if(t&&e&&Object.keys(e).length===0)return t;const r={...t};for(const i in e)Object.prototype.hasOwnProperty.call(e,i)&&(r[i]=dn(r[i],e[i],n-1));return r}const Un="_sentrySpan";function Xr(t,e){e?Qe(t,Un,e):delete t[Un]}function Zr(t){return t[Un]}class ur{constructor(){this._notifyingListeners=!1,this._scopeListeners=[],this._eventProcessors=[],this._breadcrumbs=[],this._attachments=[],this._user={},this._tags={},this._extra={},this._contexts={},this._sdkProcessingMetadata={},this._propagationContext={traceId:Yr(),spanId:Bn()}}clone(){const e=new ur;return e._breadcrumbs=[...this._breadcrumbs],e._tags={...this._tags},e._extra={...this._extra},e._contexts={...this._contexts},this._contexts.flags&&(e._contexts.flags={values:[...this._contexts.flags.values]}),e._user=this._user,e._level=this._level,e._session=this._session,e._transactionName=this._transactionName,e._fingerprint=this._fingerprint,e._eventProcessors=[...this._eventProcessors],e._requestSession=this._requestSession,e._attachments=[...this._attachments],e._sdkProcessingMetadata={...this._sdkProcessingMetadata},e._propagationContext={...this._propagationContext},e._client=this._client,e._lastEventId=this._lastEventId,Xr(e,Zr(this)),e}setClient(e){this._client=e}setLastEventId(e){this._lastEventId=e}getClient(){return this._client}lastEventId(){return this._lastEventId}addScopeListener(e){this._scopeListeners.push(e)}addEventProcessor(e){return this._eventProcessors.push(e),this}setUser(e){return this._user=e||{email:void 0,id:void 0,ip_address:void 0,username:void 0},this._session&&ct(this._session,{user:e}),this._notifyScopeListeners(),this}getUser(){return this._user}getRequestSession(){return this._requestSession}setRequestSession(e){return this._requestSession=e,this}setTags(e){return this._tags={...this._tags,...e},this._notifyScopeListeners(),this}setTag(e,n){return this._tags={...this._tags,[e]:n},this._notifyScopeListeners(),this}setExtras(e){return this._extra={...this._extra,...e},this._notifyScopeListeners(),this}setExtra(e,n){return this._extra={...this._extra,[e]:n},this._notifyScopeListeners(),this}setFingerprint(e){return this._fingerprint=e,this._notifyScopeListeners(),this}setLevel(e){return this._level=e,this._notifyScopeListeners(),this}setTransactionName(e){return this._transactionName=e,this._notifyScopeListeners(),this}setContext(e,n){return n===null?delete this._contexts[e]:this._contexts[e]=n,this._notifyScopeListeners(),this}setSession(e){return e?this._session=e:delete this._session,this._notifyScopeListeners(),this}getSession(){return this._session}update(e){if(!e)return this;const n=typeof e=="function"?e(this):e,[r,i]=n instanceof je?[n.getScopeData(),n.getRequestSession()]:at(n)?[e,e.requestSession]:[],{tags:a,extra:o,user:l,contexts:d,level:h,fingerprint:p=[],propagationContext:v}=r||{};return this._tags={...this._tags,...a},this._extra={...this._extra,...o},this._contexts={...this._contexts,...d},l&&Object.keys(l).length&&(this._user=l),h&&(this._level=h),p.length&&(this._fingerprint=p),v&&(this._propagationContext=v),i&&(this._requestSession=i),this}clear(){return this._breadcrumbs=[],this._tags={},this._extra={},this._user={},this._contexts={},this._level=void 0,this._transactionName=void 0,this._fingerprint=void 0,this._requestSession=void 0,this._session=void 0,Xr(this,void 0),this._attachments=[],this.setPropagationContext({traceId:Yr()}),this._notifyScopeListeners(),this}addBreadcrumb(e,n){const r=typeof n=="number"?n:100;if(r<=0)return this;const i={timestamp:Et(),...e};return this._breadcrumbs.push(i),this._breadcrumbs.length>r&&(this._breadcrumbs=this._breadcrumbs.slice(-r),this._client&&this._client.recordDroppedEvent("buffer_overflow","log_item")),this._notifyScopeListeners(),this}getLastBreadcrumb(){return this._breadcrumbs[this._breadcrumbs.length-1]}clearBreadcrumbs(){return this._breadcrumbs=[],this._notifyScopeListeners(),this}addAttachment(e){return this._attachments.push(e),this}clearAttachments(){return this._attachments=[],this}getScopeData(){return{breadcrumbs:this._breadcrumbs,attachments:this._attachments,contexts:this._contexts,tags:this._tags,extra:this._extra,user:this._user,level:this._level,fingerprint:this._fingerprint||[],eventProcessors:this._eventProcessors,propagationContext:this._propagationContext,sdkProcessingMetadata:this._sdkProcessingMetadata,transactionName:this._transactionName,span:Zr(this)}}setSDKProcessingMetadata(e){return this._sdkProcessingMetadata=dn(this._sdkProcessingMetadata,e,2),this}setPropagationContext(e){return this._propagationContext={spanId:Bn(),...e},this}getPropagationContext(){return this._propagationContext}captureException(e,n){const r=n&&n.event_id?n.event_id:le();if(!this._client)return L.warn("No client configured on scope - will not capture exception!"),r;const i=new Error("Sentry syntheticException");return this._client.captureException(e,{originalException:e,syntheticException:i,...n,event_id:r},this),r}captureMessage(e,n,r){const i=r&&r.event_id?r.event_id:le();if(!this._client)return L.warn("No client configured on scope - will not capture message!"),i;const a=new Error(e);return this._client.captureMessage(e,n,{originalException:e,syntheticException:a,...r,event_id:i},this),i}captureEvent(e,n){const r=n&&n.event_id?n.event_id:le();return this._client?(this._client.captureEvent(e,{...n,event_id:r},this),r):(L.warn("No client configured on scope - will not capture event!"),r)}_notifyScopeListeners(){this._notifyingListeners||(this._notifyingListeners=!0,this._scopeListeners.forEach((e=>{e(this)})),this._notifyingListeners=!1)}}const je=ur;class Fa{constructor(e,n){let r,i;r=e||new je,i=n||new je,this._stack=[{scope:r}],this._isolationScope=i}withScope(e){const n=this._pushScope();let r;try{r=e(n)}catch(i){throw this._popScope(),i}return un(r)?r.then((i=>(this._popScope(),i)),(i=>{throw this._popScope(),i})):(this._popScope(),r)}getClient(){return this.getStackTop().client}getScope(){return this.getStackTop().scope}getIsolationScope(){return this._isolationScope}getStackTop(){return this._stack[this._stack.length-1]}_pushScope(){const e=this.getScope().clone();return this._stack.push({client:this.getClient(),scope:e}),e}_popScope(){return!(this._stack.length<=1)&&!!this._stack.pop()}}function lt(){const t=sr(cn());return t.stack=t.stack||new Fa(Kt("defaultCurrentScope",(()=>new je)),Kt("defaultIsolationScope",(()=>new je)))}function Ba(t){return lt().withScope(t)}function Ua(t,e){const n=lt();return n.withScope((()=>(n.getStackTop().scope=t,e(t))))}function ei(t){return lt().withScope((()=>t(lt().getIsolationScope())))}function dr(t){const e=sr(t);return e.acs?e.acs:{withIsolationScope:ei,withScope:Ba,withSetScope:Ua,withSetIsolationScope:(n,r)=>ei(r),getCurrentScope:()=>lt().getScope(),getIsolationScope:()=>lt().getIsolationScope()}}function Xe(){return dr(cn()).getCurrentScope()}function Tt(){return dr(cn()).getIsolationScope()}function K(){return Xe().getClient()}function $a(t){const e=t.getPropagationContext(),{traceId:n,spanId:r,parentSpanId:i}=e;return ce({trace_id:n,span_id:r,parent_span_id:i})}function Va(t){const e=t._sentryMetrics;if(!e)return;const n={};for(const[,[r,i]]of e)(n[r]||(n[r]=[])).push(ce(i));return n}const Ja=/^sentry-/;function qa(t){const e=(function(r){if(!(!r||!Se(r)&&!Array.isArray(r)))return Array.isArray(r)?r.reduce(((i,a)=>{const o=ti(a);return Object.entries(o).forEach((([l,d])=>{i[l]=d})),i}),{}):ti(r)})(t);if(!e)return;const n=Object.entries(e).reduce(((r,[i,a])=>(i.match(Ja)&&(r[i.slice(7)]=a),r)),{});return Object.keys(n).length>0?n:void 0}function ti(t){return t.split(",").map((e=>e.split("=").map((n=>decodeURIComponent(n.trim()))))).reduce(((e,[n,r])=>(n&&r&&(e[n]=r),e)),{})}let ni=!1;function za(t){const{spanId:e,traceId:n,isRemote:r}=t.spanContext();return ce({parent_span_id:r?e:hr(t).parent_span_id,span_id:r?Bn():e,trace_id:n})}function ri(t){return typeof t=="number"?ii(t):Array.isArray(t)?t[0]+t[1]/1e9:t instanceof Date?ii(t.getTime()):Me()}function ii(t){return t>9999999999?t/1e3:t}function hr(t){if((function(e){return typeof e.getSpanJSON=="function"})(t))return t.getSpanJSON();try{const{spanId:e,traceId:n}=t.spanContext();if((function(r){const i=r;return!!(i.attributes&&i.startTime&&i.name&&i.endTime&&i.status)})(t)){const{attributes:r,startTime:i,name:a,endTime:o,parentSpanId:l,status:d}=t;return ce({span_id:e,trace_id:n,data:r,description:a,parent_span_id:l,start_timestamp:ri(i),timestamp:ri(o)||void 0,status:Wa(d),op:r["sentry.op"],origin:r["sentry.origin"],_metrics_summary:Va(t)})}return{span_id:e,trace_id:n}}catch{return{}}}function Wa(t){if(t&&t.code!==0)return t.code===1?"ok":t.message||"unknown_error"}function Bs(t){return t._sentryRootSpan||t}function Ha(){ni||(Mt((()=>{console.warn("[Sentry] Deprecation warning: Returning null from `beforeSendSpan` will be disallowed from SDK version 9.0.0 onwards. The callback will only support mutating spans. To drop certain spans, configure the respective integrations directly.")})),ni=!0)}const fr="production";function Us(t,e){const n=e.getOptions(),{publicKey:r}=e.getDsn()||{},i=ce({environment:n.environment||fr,release:n.release,public_key:r,trace_id:t});return e.emit("createDsc",i),i}function Qa(t){const e=K();if(!e)return{};const n=Bs(t),r=n._frozenDsc;if(r)return r;const i=n.spanContext().traceState,a=i&&i.get("sentry.dsc"),o=a&&qa(a);if(o)return o;const l=Us(t.spanContext().traceId,e),d=hr(n),h=d.data||{},p=h["sentry.sample_rate"];p!=null&&(l.sample_rate=`${p}`);const v=h["sentry.source"],E=d.description;return v!=="url"&&E&&(l.transaction=E),(function(C){if(typeof __SENTRY_TRACING__=="boolean"&&!__SENTRY_TRACING__)return!1;const b=K(),m=b&&b.getOptions();return!!m&&(m.enableTracing||"tracesSampleRate"in m||"tracesSampler"in m)})()&&(l.sampled=String((function(C){const{traceFlags:b}=C.spanContext();return b===1})(n))),e.emit("createDsc",l,n),l}const Ga=/^(?:(\w+):)\/\/(?:(\w+)(?::(\w+)?)?@)([\w.-]+)(?::(\d+))?\/(.+)/;function Zt(t,e=!1){const{host:n,path:r,pass:i,port:a,projectId:o,protocol:l,publicKey:d}=t;return`${l}://${d}${e&&i?`:${i}`:""}@${n}${a?`:${a}`:""}/${r&&`${r}/`}${o}`}function si(t){return{protocol:t.protocol,publicKey:t.publicKey||"",pass:t.pass||"",host:t.host,port:t.port||"",path:t.path||"",projectId:t.projectId}}function Ka(t){const e=typeof t=="string"?(function(n){const r=Ga.exec(n);if(!r)return void Mt((()=>{console.error(`Invalid Sentry Dsn: ${n}`)}));const[i,a,o="",l="",d="",h=""]=r.slice(1);let p="",v=h;const E=v.split("/");if(E.length>1&&(p=E.slice(0,-1).join("/"),v=E.pop()),v){const C=v.match(/^\d+/);C&&(v=C[0])}return si({host:l,pass:o,path:p,projectId:v,port:d,protocol:i,publicKey:a})})(t):si(t);if(e&&(function(n){if(!Ye)return!0;const{port:r,projectId:i,protocol:a}=n;return!(["protocol","publicKey","host","projectId"].find((o=>!n[o]&&(L.error(`Invalid Sentry Dsn: ${o} missing`),!0)))||(i.match(/^\d+$/)?(function(o){return o==="http"||o==="https"})(a)?r&&isNaN(parseInt(r,10))&&(L.error(`Invalid Sentry Dsn: Invalid port ${r}`),1):(L.error(`Invalid Sentry Dsn: Invalid protocol ${a}`),1):(L.error(`Invalid Sentry Dsn: Invalid projectId ${i}`),1)))})(e))return e}function ke(t,e=100,n=1/0){try{return $n("",t,e,n)}catch(r){return{ERROR:`**non-serializable** (${r})`}}}function $s(t,e=3,n=102400){const r=ke(t,e);return i=r,(function(a){return~-encodeURI(a).split(/%..|./).length})(JSON.stringify(i))>n?$s(t,e-1,n):r;var i}function $n(t,e,n=1/0,r=1/0,i=(function(){const a=typeof WeakSet=="function",o=a?new WeakSet:[];return[function(l){if(a)return!!o.has(l)||(o.add(l),!1);for(let d=0;d<o.length;d++)if(o[d]===l)return!0;return o.push(l),!1},function(l){if(a)o.delete(l);else for(let d=0;d<o.length;d++)if(o[d]===l){o.splice(d,1);break}}]})()){const[a,o]=i;if(e==null||["boolean","string"].includes(typeof e)||typeof e=="number"&&Number.isFinite(e))return e;const l=(function(C,b){try{if(C==="domain"&&b&&typeof b=="object"&&b._events)return"[Domain]";if(C==="domainEmitter")return"[DomainEmitter]";if(typeof global<"u"&&b===global)return"[Global]";if(typeof window<"u"&&b===window)return"[Window]";if(typeof document<"u"&&b===document)return"[Document]";if(Ls(b))return"[VueViewModel]";if(at(m=b)&&"nativeEvent"in m&&"preventDefault"in m&&"stopPropagation"in m)return"[SyntheticEvent]";if(typeof b=="number"&&!Number.isFinite(b))return`[${b}]`;if(typeof b=="function")return`[Function: ${xe(b)}]`;if(typeof b=="symbol")return`[${String(b)}]`;if(typeof b=="bigint")return`[BigInt: ${String(b)}]`;const _=(function(w){const T=Object.getPrototypeOf(w);return T?T.constructor.name:"null prototype"})(b);return/^HTML(\w*)Element$/.test(_)?`[HTMLElement: ${_}]`:`[object ${_}]`}catch(_){return`**non-serializable** (${_})`}var m})(t,e);if(!l.startsWith("[object "))return l;if(e.__sentry_skip_normalization__)return e;const d=typeof e.__sentry_override_normalization_depth__=="number"?e.__sentry_override_normalization_depth__:n;if(d===0)return l.replace("object ","");if(a(e))return"[Circular ~]";const h=e;if(h&&typeof h.toJSON=="function")try{return $n("",h.toJSON(),d-1,r,i)}catch{}const p=Array.isArray(e)?[]:{};let v=0;const E=Ns(e);for(const C in E){if(!Object.prototype.hasOwnProperty.call(E,C))continue;if(v>=r){p[C]="[MaxProperties ~]";break}const b=E[C];p[C]=$n(C,b,d-1,r,i),v++}return o(e),p}function Ct(t,e=[]){return[t,e]}function Ya(t,e){const[n,r]=t;return[n,[...r,e]]}function ai(t,e){const n=t[1];for(const r of n)if(e(r,r[0].type))return!0;return!1}function Vn(t){return $.__SENTRY__&&$.__SENTRY__.encodePolyfill?$.__SENTRY__.encodePolyfill(t):new TextEncoder().encode(t)}function Xa(t){const[e,n]=t;let r=JSON.stringify(e);function i(a){typeof r=="string"?r=typeof a=="string"?r+a:[Vn(r),a]:r.push(typeof a=="string"?Vn(a):a)}for(const a of n){const[o,l]=a;if(i(`
${JSON.stringify(o)}
`),typeof l=="string"||l instanceof Uint8Array)i(l);else{let d;try{d=JSON.stringify(l)}catch{d=JSON.stringify(ke(l))}i(d)}}return typeof r=="string"?r:(function(a){const o=a.reduce(((h,p)=>h+p.length),0),l=new Uint8Array(o);let d=0;for(const h of a)l.set(h,d),d+=h.length;return l})(r)}function Za(t){const e=typeof t.data=="string"?Vn(t.data):t.data;return[ce({type:"attachment",length:e.length,filename:t.filename,content_type:t.contentType,attachment_type:t.attachmentType}),e]}const eo={session:"session",sessions:"session",attachment:"attachment",transaction:"transaction",event:"error",client_report:"internal",user_report:"default",profile:"profile",profile_chunk:"profile",replay_event:"replay",replay_recording:"replay",check_in:"monitor",feedback:"feedback",span:"span",statsd:"metric_bucket",raw_security:"security"};function oi(t){return eo[t]}function Vs(t){if(!t||!t.sdk)return;const{name:e,version:n}=t.sdk;return{name:e,version:n}}function to(t,e,n,r){const i=Vs(n),a=t.type&&t.type!=="replay_event"?t.type:"event";(function(l,d){d&&(l.sdk=l.sdk||{},l.sdk.name=l.sdk.name||d.name,l.sdk.version=l.sdk.version||d.version,l.sdk.integrations=[...l.sdk.integrations||[],...d.integrations||[]],l.sdk.packages=[...l.sdk.packages||[],...d.packages||[]])})(t,n&&n.sdk);const o=(function(l,d,h,p){const v=l.sdkProcessingMetadata&&l.sdkProcessingMetadata.dynamicSamplingContext;return{event_id:l.event_id,sent_at:new Date().toISOString(),...d&&{sdk:d},...!!h&&p&&{dsn:Zt(p)},...v&&{trace:ce({...v})}}})(t,i,r,e);return delete t.sdkProcessingMetadata,Ct(o,[[{type:a},t]])}function Jn(t,e,n,r=0){return new oe(((i,a)=>{const o=t[r];if(e===null||typeof o!="function")i(e);else{const l=o({...e},n);q&&o.id&&l===null&&L.log(`Event processor "${o.id}" dropped event`),un(l)?l.then((d=>Jn(t,d,n,r+1).then(i))).then(null,a):Jn(t,l,n,r+1).then(i).then(null,a)}}))}let jt,ci,mn;function no(t,e){const{fingerprint:n,span:r,breadcrumbs:i,sdkProcessingMetadata:a}=e;(function(o,l){const{extra:d,tags:h,user:p,contexts:v,level:E,transactionName:C}=l,b=ce(d);b&&Object.keys(b).length&&(o.extra={...b,...o.extra});const m=ce(h);m&&Object.keys(m).length&&(o.tags={...m,...o.tags});const _=ce(p);_&&Object.keys(_).length&&(o.user={..._,...o.user});const w=ce(v);w&&Object.keys(w).length&&(o.contexts={...w,...o.contexts}),E&&(o.level=E),C&&o.type!=="transaction"&&(o.transaction=C)})(t,e),r&&(function(o,l){o.contexts={trace:za(l),...o.contexts},o.sdkProcessingMetadata={dynamicSamplingContext:Qa(l),...o.sdkProcessingMetadata};const d=Bs(l),h=hr(d).description;h&&!o.transaction&&o.type==="transaction"&&(o.transaction=h)})(t,r),(function(o,l){o.fingerprint=o.fingerprint?Array.isArray(o.fingerprint)?o.fingerprint:[o.fingerprint]:[],l&&(o.fingerprint=o.fingerprint.concat(l)),o.fingerprint&&!o.fingerprint.length&&delete o.fingerprint})(t,n),(function(o,l){const d=[...o.breadcrumbs||[],...l];o.breadcrumbs=d.length?d:void 0})(t,i),(function(o,l){o.sdkProcessingMetadata={...o.sdkProcessingMetadata,...l}})(t,a)}function li(t,e){const{extra:n,tags:r,user:i,contexts:a,level:o,sdkProcessingMetadata:l,breadcrumbs:d,fingerprint:h,eventProcessors:p,attachments:v,propagationContext:E,transactionName:C,span:b}=e;Lt(t,"extra",n),Lt(t,"tags",r),Lt(t,"user",i),Lt(t,"contexts",a),t.sdkProcessingMetadata=dn(t.sdkProcessingMetadata,l,2),o&&(t.level=o),C&&(t.transactionName=C),b&&(t.span=b),d.length&&(t.breadcrumbs=[...t.breadcrumbs,...d]),h.length&&(t.fingerprint=[...t.fingerprint,...h]),p.length&&(t.eventProcessors=[...t.eventProcessors,...p]),v.length&&(t.attachments=[...t.attachments,...v]),t.propagationContext={...t.propagationContext,...E}}function Lt(t,e,n){t[e]=dn(t[e],n,1)}function ro(t,e,n,r,i,a){const{normalizeDepth:o=3,normalizeMaxBreadth:l=1e3}=t,d={...e,event_id:e.event_id||n.event_id||le(),timestamp:e.timestamp||Et()},h=n.integrations||t.integrations.map((b=>b.name));(function(b,m){const{environment:_,release:w,dist:T,maxValueLength:A=250}=m;b.environment=b.environment||_||fr,!b.release&&w&&(b.release=w),!b.dist&&T&&(b.dist=T),b.message&&(b.message=it(b.message,A));const I=b.exception&&b.exception.values&&b.exception.values[0];I&&I.value&&(I.value=it(I.value,A));const x=b.request;x&&x.url&&(x.url=it(x.url,A))})(d,t),(function(b,m){m.length>0&&(b.sdk=b.sdk||{},b.sdk.integrations=[...b.sdk.integrations||[],...m])})(d,h),i&&i.emit("applyFrameMetadata",e),e.type===void 0&&(function(b,m){const _=(function(w){const T=$._sentryDebugIds;if(!T)return{};const A=Object.keys(T);return mn&&A.length===ci||(ci=A.length,mn=A.reduce(((I,x)=>{jt||(jt={});const R=jt[x];if(R)I[R[0]]=R[1];else{const z=w(x);for(let te=z.length-1;te>=0;te--){const Ze=z[te],et=Ze&&Ze.filename,tt=T[x];if(et&&tt){I[et]=tt,jt[x]=[et,tt];break}}}return I}),{})),mn})(m);try{b.exception.values.forEach((w=>{w.stacktrace.frames.forEach((T=>{_&&T.filename&&(T.debug_id=_[T.filename])}))}))}catch{}})(d,t.stackParser);const p=(function(b,m){if(!m)return b;const _=b?b.clone():new je;return _.update(m),_})(r,n.captureContext);n.mechanism&&ot(d,n.mechanism);const v=i?i.getEventProcessors():[],E=Kt("globalScope",(()=>new je)).getScopeData();a&&li(E,a.getScopeData()),p&&li(E,p.getScopeData());const C=[...n.attachments||[],...E.attachments];return C.length&&(n.attachments=C),no(d,E),Jn([...v,...E.eventProcessors],d,n).then((b=>(b&&(function(m){const _={};try{m.exception.values.forEach((T=>{T.stacktrace.frames.forEach((A=>{A.debug_id&&(A.abs_path?_[A.abs_path]=A.debug_id:A.filename&&(_[A.filename]=A.debug_id),delete A.debug_id)}))}))}catch{}if(Object.keys(_).length===0)return;m.debug_meta=m.debug_meta||{},m.debug_meta.images=m.debug_meta.images||[];const w=m.debug_meta.images;Object.entries(_).forEach((([T,A])=>{w.push({type:"sourcemap",code_file:T,debug_id:A})}))})(b),typeof o=="number"&&o>0?(function(m,_,w){if(!m)return null;const T={...m,...m.breadcrumbs&&{breadcrumbs:m.breadcrumbs.map((A=>({...A,...A.data&&{data:ke(A.data,_,w)}})))},...m.user&&{user:ke(m.user,_,w)},...m.contexts&&{contexts:ke(m.contexts,_,w)},...m.extra&&{extra:ke(m.extra,_,w)}};return m.contexts&&m.contexts.trace&&T.contexts&&(T.contexts.trace=m.contexts.trace,m.contexts.trace.data&&(T.contexts.trace.data=ke(m.contexts.trace.data,_,w))),m.spans&&(T.spans=m.spans.map((A=>({...A,...A.data&&{data:ke(A.data,_,w)}})))),m.contexts&&m.contexts.flags&&T.contexts&&(T.contexts.flags=ke(m.contexts.flags,3,w)),T})(b,o,l):b)))}function ui(t,e){return Xe().captureEvent(t,e)}function di(t){const e=K(),n=Tt(),r=Xe(),{release:i,environment:a=fr}=e&&e.getOptions()||{},{userAgent:o}=$.navigator||{},l=Na({release:i,environment:a,user:r.getUser()||n.getUser(),...o&&{userAgent:o},...t}),d=n.getSession();return d&&d.status==="ok"&&ct(d,{status:"exited"}),Js(),n.setSession(l),r.setSession(l),l}function Js(){const t=Tt(),e=Xe(),n=e.getSession()||t.getSession();n&&(function(r,i){let a={};r.status==="ok"&&(a={status:"exited"}),ct(r,a)})(n),qs(),t.setSession(),e.setSession()}function qs(){const t=Tt(),e=Xe(),n=K(),r=e.getSession()||t.getSession();r&&n&&n.captureSession(r)}function hi(t=!1){t?Js():qs()}function io(t,e,n){return e||`${(function(r){return`${(function(i){const a=i.protocol?`${i.protocol}:`:"",o=i.port?`:${i.port}`:"";return`${a}//${i.host}${o}${i.path?`/${i.path}`:""}/api/`})(r)}${r.projectId}/envelope/`})(t)}?${(function(r,i){const a={sentry_version:"7"};return r.publicKey&&(a.sentry_key=r.publicKey),i&&(a.sentry_client=`${i.name}/${i.version}`),new URLSearchParams(a).toString()})(t,n)}`}const fi=[];function pi(t,e){for(const n of e)n&&n.afterAllSetup&&n.afterAllSetup(t)}function gi(t,e,n){if(n[e.name])q&&L.log(`Integration skipped because it was already installed: ${e.name}`);else{if(n[e.name]=e,fi.indexOf(e.name)===-1&&typeof e.setupOnce=="function"&&(e.setupOnce(),fi.push(e.name)),e.setup&&typeof e.setup=="function"&&e.setup(t),typeof e.preprocessEvent=="function"){const r=e.preprocessEvent.bind(e);t.on("preprocessEvent",((i,a)=>r(i,a,t)))}if(typeof e.processEvent=="function"){const r=e.processEvent.bind(e),i=Object.assign(((a,o)=>r(a,o,t)),{id:e.name});t.addEventProcessor(i)}q&&L.log(`Integration installed: ${e.name}`)}}class he extends Error{constructor(e,n="warn"){super(e),this.message=e,this.logLevel=n}}const mi="Not capturing exception because it's already been captured.";class so{constructor(e){if(this._options=e,this._integrations={},this._numProcessing=0,this._outcomes={},this._hooks={},this._eventProcessors=[],e.dsn?this._dsn=Ka(e.dsn):q&&L.warn("No DSN provided, client will not send events."),this._dsn){const r=io(this._dsn,e.tunnel,e._metadata?e._metadata.sdk:void 0);this._transport=e.transport({tunnel:this._options.tunnel,recordDroppedEvent:this.recordDroppedEvent.bind(this),...e.transportOptions,url:r})}const n=["enableTracing","tracesSampleRate","tracesSampler"].find((r=>r in e&&e[r]==null));n&&Mt((()=>{console.warn(`[Sentry] Deprecation warning: \`${n}\` is set to undefined, which leads to tracing being enabled. In v9, a value of \`undefined\` will result in tracing being disabled.`)}))}captureException(e,n,r){const i=le();if(Kr(e))return q&&L.log(mi),i;const a={event_id:i,...n};return this._process(this.eventFromException(e,a).then((o=>this._captureEvent(o,a,r)))),a.event_id}captureMessage(e,n,r,i){const a={event_id:le(),...r},o=or(e)?e:String(e),l=Rn(e)?this.eventFromMessage(o,n,a):this.eventFromException(e,a);return this._process(l.then((d=>this._captureEvent(d,a,i)))),a.event_id}captureEvent(e,n,r){const i=le();if(n&&n.originalException&&Kr(n.originalException))return q&&L.log(mi),i;const a={event_id:i,...n},o=(e.sdkProcessingMetadata||{}).capturedSpanScope;return this._process(this._captureEvent(e,a,o||r)),a.event_id}captureSession(e){typeof e.release!="string"?q&&L.warn("Discarded session because of missing or non-string release"):(this.sendSession(e),ct(e,{init:!1}))}getDsn(){return this._dsn}getOptions(){return this._options}getSdkMetadata(){return this._options._metadata}getTransport(){return this._transport}flush(e){const n=this._transport;return n?(this.emit("flush"),this._isClientDoneProcessing(e).then((r=>n.flush(e).then((i=>r&&i))))):Ge(!0)}close(e){return this.flush(e).then((n=>(this.getOptions().enabled=!1,this.emit("close"),n)))}getEventProcessors(){return this._eventProcessors}addEventProcessor(e){this._eventProcessors.push(e)}init(){(this._isEnabled()||this._options.integrations.some((({name:e})=>e.startsWith("Spotlight"))))&&this._setupIntegrations()}getIntegrationByName(e){return this._integrations[e]}addIntegration(e){const n=this._integrations[e.name];gi(this,e,this._integrations),n||pi(this,[e])}sendEvent(e,n={}){this.emit("beforeSendEvent",e,n);let r=to(e,this._dsn,this._options._metadata,this._options.tunnel);for(const a of n.attachments||[])r=Ya(r,Za(a));const i=this.sendEnvelope(r);i&&i.then((a=>this.emit("afterSendEvent",e,a)),null)}sendSession(e){const n=(function(r,i,a,o){const l=Vs(a);return Ct({sent_at:new Date().toISOString(),...l&&{sdk:l},...!!o&&i&&{dsn:Zt(i)}},["aggregates"in r?[{type:"sessions"},r]:[{type:"session"},r.toJSON()]])})(e,this._dsn,this._options._metadata,this._options.tunnel);this.sendEnvelope(n)}recordDroppedEvent(e,n,r){if(this._options.sendClientReports){const i=typeof r=="number"?r:1,a=`${e}:${n}`;q&&L.log(`Recording outcome: "${a}"${i>1?` (${i} times)`:""}`),this._outcomes[a]=(this._outcomes[a]||0)+i}}on(e,n){const r=this._hooks[e]=this._hooks[e]||[];return r.push(n),()=>{const i=r.indexOf(n);i>-1&&r.splice(i,1)}}emit(e,...n){const r=this._hooks[e];r&&r.forEach((i=>i(...n)))}sendEnvelope(e){return this.emit("beforeEnvelope",e),this._isEnabled()&&this._transport?this._transport.send(e).then(null,(n=>(q&&L.error("Error while sending envelope:",n),n))):(q&&L.error("Transport disabled"),Ge({}))}_setupIntegrations(){const{integrations:e}=this._options;this._integrations=(function(n,r){const i={};return r.forEach((a=>{a&&gi(n,a,i)})),i})(this,e),pi(this,e)}_updateSessionFromEvent(e,n){let r=n.level==="fatal",i=!1;const a=n.exception&&n.exception.values;if(a){i=!0;for(const l of a){const d=l.mechanism;if(d&&d.handled===!1){r=!0;break}}}const o=e.status==="ok";(o&&e.errors===0||o&&r)&&(ct(e,{...r&&{status:"crashed"},errors:e.errors||Number(i||r)}),this.captureSession(e))}_isClientDoneProcessing(e){return new oe((n=>{let r=0;const i=setInterval((()=>{this._numProcessing==0?(clearInterval(i),n(!0)):(r+=1,e&&r>=e&&(clearInterval(i),n(!1)))}),1)}))}_isEnabled(){return this.getOptions().enabled!==!1&&this._transport!==void 0}_prepareEvent(e,n,r=Xe(),i=Tt()){const a=this.getOptions(),o=Object.keys(this._integrations);return!n.integrations&&o.length>0&&(n.integrations=o),this.emit("preprocessEvent",e,n),e.type||i.setLastEventId(e.event_id||n.event_id),ro(a,e,n,r,this,i).then((l=>{if(l===null)return l;l.contexts={trace:$a(r),...l.contexts};const d=(function(h,p){const v=p.getPropagationContext();return v.dsc||Us(v.traceId,h)})(this,r);return l.sdkProcessingMetadata={dynamicSamplingContext:d,...l.sdkProcessingMetadata},l}))}_captureEvent(e,n={},r){return this._processEvent(e,n,r).then((i=>i.event_id),(i=>{q&&(i instanceof he&&i.logLevel==="log"?L.log(i.message):L.warn(i))}))}_processEvent(e,n,r){const i=this.getOptions(),{sampleRate:a}=i,o=yi(e),l=vi(e),d=e.type||"error",h=`before send for type \`${d}\``,p=a===void 0?void 0:(function(C){if(typeof C=="boolean")return Number(C);const b=typeof C=="string"?parseFloat(C):C;if(!(typeof b!="number"||isNaN(b)||b<0||b>1))return b;q&&L.warn(`[Tracing] Given sample rate is invalid. Sample rate must be a boolean or a number between 0 and 1. Got ${JSON.stringify(C)} of type ${JSON.stringify(typeof C)}.`)})(a);if(l&&typeof p=="number"&&Math.random()>p)return this.recordDroppedEvent("sample_rate","error",e),Xt(new he(`Discarding event because it's not included in the random sample (sampling rate = ${a})`,"log"));const v=d==="replay_event"?"replay":d,E=(e.sdkProcessingMetadata||{}).capturedSpanIsolationScope;return this._prepareEvent(e,n,r,E).then((C=>{if(C===null)throw this.recordDroppedEvent("event_processor",v,e),new he("An event processor returned `null`, will not send event.","log");if(n.data&&n.data.__sentry__===!0)return C;const b=(function(m,_,w,T){const{beforeSend:A,beforeSendTransaction:I,beforeSendSpan:x}=_;if(vi(w)&&A)return A(w,T);if(yi(w)){if(w.spans&&x){const R=[];for(const z of w.spans){const te=x(z);te?R.push(te):(Ha(),m.recordDroppedEvent("before_send","span"))}w.spans=R}if(I){if(w.spans){const R=w.spans.length;w.sdkProcessingMetadata={...w.sdkProcessingMetadata,spanCountBeforeProcessing:R}}return I(w,T)}}return w})(this,i,C,n);return(function(m,_){const w=`${_} must return \`null\` or a valid event.`;if(un(m))return m.then((T=>{if(!at(T)&&T!==null)throw new he(w);return T}),(T=>{throw new he(`${_} rejected with ${T}`)}));if(!at(m)&&m!==null)throw new he(w);return m})(b,h)})).then((C=>{if(C===null){if(this.recordDroppedEvent("before_send",v,e),o){const _=1+(e.spans||[]).length;this.recordDroppedEvent("before_send","span",_)}throw new he(`${h} returned \`null\`, will not send event.`,"log")}const b=r&&r.getSession();if(!o&&b&&this._updateSessionFromEvent(b,C),o){const _=(C.sdkProcessingMetadata&&C.sdkProcessingMetadata.spanCountBeforeProcessing||0)-(C.spans?C.spans.length:0);_>0&&this.recordDroppedEvent("before_send","span",_)}const m=C.transaction_info;if(o&&m&&C.transaction!==e.transaction){const _="custom";C.transaction_info={...m,source:_}}return this.sendEvent(C,n),C})).then(null,(C=>{throw C instanceof he?C:(this.captureException(C,{data:{__sentry__:!0},originalException:C}),new he(`Event processing pipeline threw an error, original event will not be sent. Details have been sent as a new event.
Reason: ${C}`))}))}_process(e){this._numProcessing++,e.then((n=>(this._numProcessing--,n)),(n=>(this._numProcessing--,n)))}_clearOutcomes(){const e=this._outcomes;return this._outcomes={},Object.entries(e).map((([n,r])=>{const[i,a]=n.split(":");return{reason:i,category:a,quantity:r}}))}_flushOutcomes(){q&&L.log("Flushing outcomes...");const e=this._clearOutcomes();if(e.length===0)return void(q&&L.log("No outcomes to send"));if(!this._dsn)return void(q&&L.log("No dsn provided, will not send outcomes"));q&&L.log("Sending outcomes:",e);const n=(r=e,Ct((i=this._options.tunnel&&Zt(this._dsn))?{dsn:i}:{},[[{type:"client_report"},{timestamp:a||Et(),discarded_events:r}]]));var r,i,a;this.sendEnvelope(n)}}function vi(t){return t.type===void 0}function yi(t){return t.type==="transaction"}function ao(t){const e=[];function n(r){return e.splice(e.indexOf(r),1)[0]||Promise.resolve(void 0)}return{$:e,add:function(r){if(!(t===void 0||e.length<t))return Xt(new he("Not adding Promise because buffer limit was reached."));const i=r();return e.indexOf(i)===-1&&e.push(i),i.then((()=>n(i))).then(null,(()=>n(i).then(null,(()=>{})))),i},drain:function(r){return new oe(((i,a)=>{let o=e.length;if(!o)return i(!0);const l=setTimeout((()=>{r&&r>0&&i(!1)}),r);e.forEach((d=>{Ge(d).then((()=>{--o||(clearTimeout(l),i(!0))}),a)}))}))}}}function oo(t,{statusCode:e,headers:n},r=Date.now()){const i={...t},a=n&&n["x-sentry-rate-limits"],o=n&&n["retry-after"];if(a)for(const l of a.trim().split(",")){const[d,h,,,p]=l.split(":",5),v=parseInt(d,10),E=1e3*(isNaN(v)?60:v);if(h)for(const C of h.split(";"))C==="metric_bucket"&&p&&!p.split(";").includes("custom")||(i[C]=r+E);else i.all=r+E}else o?i.all=r+(function(l,d=Date.now()){const h=parseInt(`${l}`,10);if(!isNaN(h))return 1e3*h;const p=Date.parse(`${l}`);return isNaN(p)?6e4:p-d})(o,r):e===429&&(i.all=r+6e4);return i}function co(t,e,n=ao(t.bufferSize||64)){let r={};return{send:function(i){const a=[];if(ai(i,((d,h)=>{const p=oi(h);if((function(v,E,C=Date.now()){return(function(b,m){return b[m]||b.all||0})(v,E)>C})(r,p)){const v=bi(d,h);t.recordDroppedEvent("ratelimit_backoff",p,v)}else a.push(d)})),a.length===0)return Ge({});const o=Ct(i[0],a),l=d=>{ai(o,((h,p)=>{const v=bi(h,p);t.recordDroppedEvent(d,oi(p),v)}))};return n.add((()=>e({body:Xa(o)}).then((d=>(d.statusCode!==void 0&&(d.statusCode<200||d.statusCode>=300)&&q&&L.warn(`Sentry responded with status code ${d.statusCode} to sent event.`),r=oo(r,d),d)),(d=>{throw l("network_error"),d})))).then((d=>d),(d=>{if(d instanceof he)return q&&L.error("Skipped sending event because buffer is full."),l("queue_overflow"),Ge({});throw d}))},flush:i=>n.drain(i)}}function bi(t,e){if(e==="event"||e==="transaction")return Array.isArray(t)?t[1]:void 0}const lo=100;function Re(t,e){const n=K(),r=Tt();if(!n)return;const{beforeBreadcrumb:i=null,maxBreadcrumbs:a=lo}=n.getOptions();if(a<=0)return;const o={timestamp:Et(),...t},l=i?Mt((()=>i(o,e))):o;l!==null&&(n.emit&&n.emit("beforeAddBreadcrumb",l,e),r.addBreadcrumb(l,a))}let _i;const wi=new WeakMap,uo=()=>({name:"FunctionToString",setupOnce(){_i=Function.prototype.toString;try{Function.prototype.toString=function(...t){const e=lr(this),n=wi.has(K())&&e!==void 0?e:this;return _i.apply(n,t)}}catch{}},setup(t){wi.set(t,!0)}}),ho=[/^Script error\.?$/,/^Javascript error: Script error\.? on line 0$/,/^ResizeObserver loop completed with undelivered notifications.$/,/^Cannot redefine property: googletag$/,"undefined is not an object (evaluating 'a.L')",`can't redefine non-configurable property "solana"`,"vv().getRestrictions is not a function. (In 'vv().getRestrictions(1,a)', 'vv().getRestrictions' is undefined)","Can't find variable: _AutofillCallbackHandler",/^Non-Error promise rejection captured with value: Object Not Found Matching Id:\d+, MethodName:simulateEvent, ParamCount:\d+$/],fo=(t={})=>({name:"InboundFilters",processEvent(e,n,r){const i=r.getOptions(),a=(function(o={},l={}){return{allowUrls:[...o.allowUrls||[],...l.allowUrls||[]],denyUrls:[...o.denyUrls||[],...l.denyUrls||[]],ignoreErrors:[...o.ignoreErrors||[],...l.ignoreErrors||[],...o.disableErrorDefaults?[]:ho],ignoreTransactions:[...o.ignoreTransactions||[],...l.ignoreTransactions||[]],ignoreInternal:o.ignoreInternal===void 0||o.ignoreInternal}})(t,i);return(function(o,l){return l.ignoreInternal&&(function(d){try{return d.exception.values[0].type==="SentryError"}catch{}return!1})(o)?(q&&L.warn(`Event dropped due to being internal Sentry Error.
Event: ${Pe(o)}`),!0):(function(d,h){return d.type||!h||!h.length?!1:(function(p){const v=[];p.message&&v.push(p.message);let E;try{E=p.exception.values[p.exception.values.length-1]}catch{}return E&&E.value&&(v.push(E.value),E.type&&v.push(`${E.type}: ${E.value}`)),v})(d).some((p=>xt(p,h)))})(o,l.ignoreErrors)?(q&&L.warn(`Event dropped due to being matched by \`ignoreErrors\` option.
Event: ${Pe(o)}`),!0):(function(d){return d.type||!d.exception||!d.exception.values||d.exception.values.length===0?!1:!d.message&&!d.exception.values.some((h=>h.stacktrace||h.type&&h.type!=="Error"||h.value))})(o)?(q&&L.warn(`Event dropped due to not having an error message, error type or stacktrace.
Event: ${Pe(o)}`),!0):(function(d,h){if(d.type!=="transaction"||!h||!h.length)return!1;const p=d.transaction;return!!p&&xt(p,h)})(o,l.ignoreTransactions)?(q&&L.warn(`Event dropped due to being matched by \`ignoreTransactions\` option.
Event: ${Pe(o)}`),!0):(function(d,h){if(!h||!h.length)return!1;const p=Dt(d);return!!p&&xt(p,h)})(o,l.denyUrls)?(q&&L.warn(`Event dropped due to being matched by \`denyUrls\` option.
Event: ${Pe(o)}.
Url: ${Dt(o)}`),!0):(function(d,h){if(!h||!h.length)return!0;const p=Dt(d);return!p||xt(p,h)})(o,l.allowUrls)?!1:(q&&L.warn(`Event dropped due to not being matched by \`allowUrls\` option.
Event: ${Pe(o)}.
Url: ${Dt(o)}`),!0)})(e,a)?null:e}});function Dt(t){try{let e;try{e=t.exception.values[0].stacktrace.frames}catch{}return e?(function(n=[]){for(let r=n.length-1;r>=0;r--){const i=n[r];if(i&&i.filename!=="<anonymous>"&&i.filename!=="[native code]")return i.filename||null}return null})(e):null}catch{return q&&L.error(`Cannot extract url for event ${Pe(t)}`),null}}function po(t,e,n=250,r,i,a,o){if(!(a.exception&&a.exception.values&&o&&He(o.originalException,Error)))return;const l=a.exception.values.length>0?a.exception.values[a.exception.values.length-1]:void 0;var d,h;l&&(a.exception.values=(d=qn(t,e,i,o.originalException,r,a.exception.values,l,0),h=n,d.map((p=>(p.value&&(p.value=it(p.value,h)),p)))))}function qn(t,e,n,r,i,a,o,l){if(a.length>=n+1)return a;let d=[...a];if(He(r[i],Error)){ki(o,l);const h=t(e,r[i]),p=d.length;Si(h,i,p,l),d=qn(t,e,n,r[i],i,[h,...d],h,p)}return Array.isArray(r.errors)&&r.errors.forEach(((h,p)=>{if(He(h,Error)){ki(o,l);const v=t(e,h),E=d.length;Si(v,`errors[${p}]`,E,l),d=qn(t,e,n,h,i,[v,...d],v,E)}})),d}function ki(t,e){t.mechanism=t.mechanism||{type:"generic",handled:!0},t.mechanism={...t.mechanism,...t.type==="AggregateError"&&{is_exception_group:!0},exception_id:e}}function Si(t,e,n,r){t.mechanism=t.mechanism||{type:"generic",handled:!0},t.mechanism={...t.mechanism,type:"chained",source:e,exception_id:n,parent_id:r}}function vn(t){if(!t)return{};const e=t.match(/^(([^:/?#]+):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?$/);if(!e)return{};const n=e[6]||"",r=e[8]||"";return{host:e[4],path:e[5],protocol:e[2],search:n,hash:r,relative:e[5]+n+r}}function go(){"console"in $&&Dn.forEach((function(t){t in $.console&&re($.console,t,(function(e){return Yt[t]=e,function(...n){pe("console",{args:n,level:t});const r=Yt[t];r&&r.apply($.console,n)}}))}))}function mo(t){return t==="warn"?"warning":["fatal","error","warning","log","info","debug"].includes(t)?t:"log"}const vo=()=>{let t;return{name:"Dedupe",processEvent(e){if(e.type)return e;try{if((function(n,r){return r?!!((function(i,a){const o=i.message,l=a.message;return!(!o&&!l||o&&!l||!o&&l||o!==l||!Mi(i,a)||!Ci(i,a))})(n,r)||(function(i,a){const o=Ei(a),l=Ei(i);return!(!o||!l||o.type!==l.type||o.value!==l.value||!Mi(i,a)||!Ci(i,a))})(n,r)):!1})(e,t))return q&&L.warn("Event dropped due to being a duplicate of previously captured event."),null}catch{}return t=e}}};function Ci(t,e){let n=qr(t),r=qr(e);if(!n&&!r)return!0;if(n&&!r||!n&&r||r.length!==n.length)return!1;for(let i=0;i<r.length;i++){const a=r[i],o=n[i];if(a.filename!==o.filename||a.lineno!==o.lineno||a.colno!==o.colno||a.function!==o.function)return!1}return!0}function Mi(t,e){let n=t.fingerprint,r=e.fingerprint;if(!n&&!r)return!0;if(n&&!r||!n&&r)return!1;try{return n.join("")===r.join("")}catch{return!1}}function Ei(t){return t.exception&&t.exception.values&&t.exception.values[0]}function Ti(t){return t===void 0?void 0:t>=400&&t<500?"warning":t>=500?"error":void 0}const yn=$;function zn(t){return t&&/^function\s+\w+\(\)\s+\{\s+\[native code\]\s+\}$/.test(t.toString())}function yo(){if(typeof EdgeRuntime=="string")return!0;if(!(function(){if(!("fetch"in yn))return!1;try{return new Headers,new Request("http://www.example.com"),new Response,!0}catch{return!1}})())return!1;if(zn(yn.fetch))return!0;let t=!1;const e=yn.document;if(e&&typeof e.createElement=="function")try{const n=e.createElement("iframe");n.hidden=!0,e.head.appendChild(n),n.contentWindow&&n.contentWindow.fetch&&(t=zn(n.contentWindow.fetch)),e.head.removeChild(n)}catch(n){Ye&&L.warn("Could not create sandbox iframe for pure fetch check, bailing to window.fetch: ",n)}return t}function bo(t,e){const n="fetch";qe(n,t),ze(n,(()=>(function(r,i=!1){i&&!yo()||re($,"fetch",(function(a){return function(...o){const l=new Error,{method:d,url:h}=(function(v){if(v.length===0)return{method:"GET",url:""};if(v.length===2){const[C,b]=v;return{url:Ai(C),method:Wn(b,"method")?String(b.method).toUpperCase():"GET"}}const E=v[0];return{url:Ai(E),method:Wn(E,"method")?String(E.method).toUpperCase():"GET"}})(o),p={args:o,fetchData:{method:d,url:h},startTimestamp:1e3*Me(),virtualError:l};return r||pe("fetch",{...p}),a.apply($,o).then((async v=>(r?r(v):pe("fetch",{...p,endTimestamp:1e3*Me(),response:v}),v)),(v=>{throw pe("fetch",{...p,endTimestamp:1e3*Me(),error:v}),ar(v)&&v.stack===void 0&&(v.stack=l.stack,Qe(v,"framesToPop",1)),v}))}}))})(void 0,e)))}function Wn(t,e){return!!t&&typeof t=="object"&&!!t[e]}function Ai(t){return typeof t=="string"?t:t?Wn(t,"url")?t.url:t.toString?t.toString():"":""}const Rt=$,Q=$;let Hn=0;function Oi(){return Hn>0}function ut(t,e={}){if(!(function(r){return typeof r=="function"})(t))return t;try{const r=t.__sentry_wrapped__;if(r)return typeof r=="function"?r:t;if(lr(t))return t}catch{return t}const n=function(...r){try{const i=r.map((a=>ut(a,e)));return t.apply(this,i)}catch(i){throw Hn++,setTimeout((()=>{Hn--})),(function(...a){const o=dr(cn());if(a.length===2){const[l,d]=a;return l?o.withSetScope(l,d):o.withScope(d)}o.withScope(a[0])})((a=>{var o;a.addEventProcessor((l=>(e.mechanism&&(Fn(l,void 0),ot(l,e.mechanism)),l.extra={...l.extra,arguments:r},l))),o=i,Xe().captureException(o,void 0)})),i}};try{for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}catch{}Rs(n,t),Qe(t,"__sentry_wrapped__",n);try{Object.getOwnPropertyDescriptor(n,"name").configurable&&Object.defineProperty(n,"name",{get:()=>t.name})}catch{}return n}const hn=typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__;function pr(t,e){const n=gr(t,e),r={type:ko(e),value:So(e)};return n.length&&(r.stacktrace={frames:n}),r.type===void 0&&r.value===""&&(r.value="Unrecoverable error caught"),r}function _o(t,e,n,r){const i=K(),a=i&&i.getOptions().normalizeDepth,o=(function(h){for(const p in h)if(Object.prototype.hasOwnProperty.call(h,p)){const v=h[p];if(v instanceof Error)return v}})(e),l={__serialized__:$s(e,a)};if(o)return{exception:{values:[pr(t,o)]},extra:l};const d={exception:{values:[{type:ln(e)?e.constructor.name:r?"UnhandledRejection":"Error",value:Co(e,{isUnhandledRejection:r})}]},extra:l};if(n){const h=gr(t,n);h.length&&(d.exception.values[0].stacktrace={frames:h})}return d}function bn(t,e){return{exception:{values:[pr(t,e)]}}}function gr(t,e){const n=e.stacktrace||e.stack||"",r=(function(a){return a&&wo.test(a.message)?1:0})(e),i=(function(a){return typeof a.framesToPop=="number"?a.framesToPop:0})(e);try{return t(n,r,i)}catch{}return[]}const wo=/Minified React error #\d+;/i;function zs(t){return typeof WebAssembly<"u"&&WebAssembly.Exception!==void 0&&t instanceof WebAssembly.Exception}function ko(t){const e=t&&t.name;return!e&&zs(t)?t.message&&Array.isArray(t.message)&&t.message.length==2?t.message[0]:"WebAssembly.Exception":e}function So(t){const e=t&&t.message;return e?e.error&&typeof e.error.message=="string"?e.error.message:zs(t)&&Array.isArray(t.message)&&t.message.length==2?t.message[1]:e:"No error message"}function Qn(t,e,n,r,i){let a;if(js(e)&&e.error)return bn(t,e.error);if(Wr(e)||dt(e,"DOMException")){const o=e;if("stack"in e)a=bn(t,e);else{const l=o.name||(Wr(o)?"DOMError":"DOMException"),d=o.message?`${l}: ${o.message}`:l;a=Gn(t,d,n,r),Fn(a,d)}return"code"in o&&(a.tags={...a.tags,"DOMException.code":`${o.code}`}),a}return ar(e)?bn(t,e):at(e)||ln(e)?(a=_o(t,e,n,i),ot(a,{synthetic:!0}),a):(a=Gn(t,e,n,r),Fn(a,`${e}`),ot(a,{synthetic:!0}),a)}function Gn(t,e,n,r){const i={};if(r&&n){const a=gr(t,n);a.length&&(i.exception={values:[{value:e,stacktrace:{frames:a}}]}),ot(i,{synthetic:!0})}if(or(e)){const{__sentry_template_string__:a,__sentry_template_values__:o}=e;return i.logentry={message:a,params:o},i}return i.message=e,i}function Co(t,{isUnhandledRejection:e}){const n=(function(i,a=40){const o=Object.keys(Ns(i));o.sort();const l=o[0];if(!l)return"[object has no keys]";if(l.length>=a)return it(l,a);for(let d=o.length;d>0;d--){const h=o.slice(0,d).join(", ");if(!(h.length>a))return d===o.length?h:it(h,a)}return""})(t),r=e?"promise rejection":"exception";return js(t)?`Event \`ErrorEvent\` captured as ${r} with message \`${t.message}\``:ln(t)?`Event \`${(function(i){try{const a=Object.getPrototypeOf(i);return a?a.constructor.name:void 0}catch{}})(t)}\` (type=${t.type}) captured as ${r}`:`Object captured as ${r} with keys: ${n}`}class Mo extends so{constructor(e){const n={parentSpanIsAlwaysRootSpan:!0,...e};(function(r,i,a=[i],o="npm"){const l=r._metadata||{};l.sdk||(l.sdk={name:`sentry.javascript.${i}`,packages:a.map((d=>({name:`${o}:@sentry/${d}`,version:Je}))),version:Je}),r._metadata=l})(n,"browser",["browser"],Q.SENTRY_SDK_SOURCE||"npm"),super(n),n.sendClientReports&&Q.document&&Q.document.addEventListener("visibilitychange",(()=>{Q.document.visibilityState==="hidden"&&this._flushOutcomes()}))}eventFromException(e,n){return(function(r,i,a,o){const l=Qn(r,i,a&&a.syntheticException||void 0,o);return ot(l),l.level="error",a&&a.event_id&&(l.event_id=a.event_id),Ge(l)})(this._options.stackParser,e,n,this._options.attachStacktrace)}eventFromMessage(e,n="info",r){return(function(i,a,o="info",l,d){const h=Gn(i,a,l&&l.syntheticException||void 0,d);return h.level=o,l&&l.event_id&&(h.event_id=l.event_id),Ge(h)})(this._options.stackParser,e,n,r,this._options.attachStacktrace)}captureUserFeedback(e){if(!this._isEnabled())return void(hn&&L.warn("SDK not enabled, will not capture user feedback."));const n=(function(r,{metadata:i,tunnel:a,dsn:o}){const l={event_id:r.event_id,sent_at:new Date().toISOString(),...i&&i.sdk&&{sdk:{name:i.sdk.name,version:i.sdk.version}},...!!a&&!!o&&{dsn:Zt(o)}};return Ct(l,[(function(h){return[{type:"user_report"},h]})(r)])})(e,{metadata:this.getSdkMetadata(),dsn:this.getDsn(),tunnel:this.getOptions().tunnel});this.sendEnvelope(n)}_prepareEvent(e,n,r){return e.platform=e.platform||"javascript",super._prepareEvent(e,n,r)}}const Eo=typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__,ee=$;let Pi,_n,wn,Nt;function To(){if(!ee.document)return;const t=pe.bind(null,"dom"),e=Ii(t,!0);ee.document.addEventListener("click",e,!1),ee.document.addEventListener("keypress",e,!1),["EventTarget","Node"].forEach((n=>{const r=ee[n],i=r&&r.prototype;i&&i.hasOwnProperty&&i.hasOwnProperty("addEventListener")&&(re(i,"addEventListener",(function(a){return function(o,l,d){if(o==="click"||o=="keypress")try{const h=this.__sentry_instrumentation_handlers__=this.__sentry_instrumentation_handlers__||{},p=h[o]=h[o]||{refCount:0};if(!p.handler){const v=Ii(t);p.handler=v,a.call(this,o,v,d)}p.refCount++}catch{}return a.call(this,o,l,d)}})),re(i,"removeEventListener",(function(a){return function(o,l,d){if(o==="click"||o=="keypress")try{const h=this.__sentry_instrumentation_handlers__||{},p=h[o];p&&(p.refCount--,p.refCount<=0&&(a.call(this,o,p.handler,d),p.handler=void 0,delete h[o]),Object.keys(h).length===0&&delete this.__sentry_instrumentation_handlers__)}catch{}return a.call(this,o,l,d)}})))}))}function Ii(t,e=!1){return n=>{if(!n||n._sentryCaptured)return;const r=(function(a){try{return a.target}catch{return null}})(n);if((function(a,o){return a==="keypress"&&(!o||!o.tagName||o.tagName!=="INPUT"&&o.tagName!=="TEXTAREA"&&!o.isContentEditable)})(n.type,r))return;Qe(n,"_sentryCaptured",!0),r&&!r._sentryId&&Qe(r,"_sentryId",le());const i=n.type==="keypress"?"input":n.type;(function(a){if(a.type!==_n)return!1;try{if(!a.target||a.target._sentryId!==wn)return!1}catch{}return!0})(n)||(t({event:n,name:i,global:e}),_n=n.type,wn=r?r._sentryId:void 0),clearTimeout(Pi),Pi=ee.setTimeout((()=>{wn=void 0,_n=void 0}),1e3)}}function Ws(t){const e="history";qe(e,t),ze(e,Ao)}function Ao(){if(!(function(){const n=Rt.chrome,r=n&&n.app&&n.app.runtime,i="history"in Rt&&!!Rt.history.pushState&&!!Rt.history.replaceState;return!r&&i})())return;const t=ee.onpopstate;function e(n){return function(...r){const i=r.length>2?r[2]:void 0;if(i){const a=Nt,o=String(i);Nt=o,pe("history",{from:a,to:o})}return n.apply(this,r)}}ee.onpopstate=function(...n){const r=ee.location.href,i=Nt;if(Nt=r,pe("history",{from:i,to:r}),t)try{return t.apply(this,n)}catch{}},re(ee.history,"pushState",e),re(ee.history,"replaceState",e)}const zt={};function xi(t){zt[t]=void 0}const bt="__sentry_xhr_v3__";function Oo(){if(!ee.XMLHttpRequest)return;const t=XMLHttpRequest.prototype;t.open=new Proxy(t.open,{apply(e,n,r){const i=new Error,a=1e3*Me(),o=Se(r[0])?r[0].toUpperCase():void 0,l=(function(h){if(Se(h))return h;try{return h.toString()}catch{}})(r[1]);if(!o||!l)return e.apply(n,r);n[bt]={method:o,url:l,request_headers:{}},o==="POST"&&l.match(/sentry_key/)&&(n.__sentry_own_request__=!0);const d=()=>{const h=n[bt];if(h&&n.readyState===4){try{h.status_code=n.status}catch{}pe("xhr",{endTimestamp:1e3*Me(),startTimestamp:a,xhr:n,virtualError:i})}};return"onreadystatechange"in n&&typeof n.onreadystatechange=="function"?n.onreadystatechange=new Proxy(n.onreadystatechange,{apply:(h,p,v)=>(d(),h.apply(p,v))}):n.addEventListener("readystatechange",d),n.setRequestHeader=new Proxy(n.setRequestHeader,{apply(h,p,v){const[E,C]=v,b=p[bt];return b&&Se(E)&&Se(C)&&(b.request_headers[E.toLowerCase()]=C),h.apply(p,v)}}),e.apply(n,r)}}),t.send=new Proxy(t.send,{apply(e,n,r){const i=n[bt];return i?(r[0]!==void 0&&(i.body=r[0]),pe("xhr",{startTimestamp:1e3*Me(),xhr:n}),e.apply(n,r)):e.apply(n,r)}})}function Po(t,e=(function(n){const r=zt[n];if(r)return r;let i=ee[n];if(zn(i))return zt[n]=i.bind(ee);const a=ee.document;if(a&&typeof a.createElement=="function")try{const o=a.createElement("iframe");o.hidden=!0,a.head.appendChild(o);const l=o.contentWindow;l&&l[n]&&(i=l[n]),a.head.removeChild(o)}catch(o){Eo&&L.warn(`Could not create sandbox iframe for ${n} check, bailing to window.${n}: `,o)}return i&&(zt[n]=i.bind(ee))})("fetch")){let n=0,r=0;return co(t,(function(i){const a=i.body.length;n+=a,r++;const o={body:i.body,method:"POST",referrerPolicy:"origin",headers:t.headers,keepalive:n<=6e4&&r<15,...t.fetchOptions};if(!e)return xi("fetch"),Xt("No fetch implementation available");try{return e(t.url,o).then((l=>(n-=a,r--,{statusCode:l.status,headers:{"x-sentry-rate-limits":l.headers.get("X-Sentry-Rate-Limits"),"retry-after":l.headers.get("Retry-After")}})))}catch(l){return xi("fetch"),n-=a,r--,Xt(l)}}))}function kn(t,e,n,r){const i={filename:t,function:e==="<anonymous>"?Ve:e,in_app:!0};return n!==void 0&&(i.lineno=n),r!==void 0&&(i.colno=r),i}const Io=/^\s*at (\S+?)(?::(\d+))(?::(\d+))\s*$/i,xo=/^\s*at (?:(.+?\)(?: \[.+\])?|.*?) ?\((?:address at )?)?(?:async )?((?:<anonymous>|[-a-z]+:|.*bundle|\/)?.*?)(?::(\d+))?(?::(\d+))?\)?\s*$/i,jo=/\((\S*)(?::(\d+))(?::(\d+))\)/,Lo=/^\s*(.*?)(?:\((.*?)\))?(?:^|@)?((?:[-a-z]+)?:\/.*?|\[native code\]|[^@]*(?:bundle|\d+\.js)|\/[\w\-. /=]+)(?::(\d+))?(?::(\d+))?\s*$/i,Do=/(\S+) line (\d+)(?: > eval line \d+)* > eval/i,Ro=(function(...t){const e=t.sort(((n,r)=>n[0]-r[0])).map((n=>n[1]));return(n,r=0,i=0)=>{const a=[],o=n.split(`
`);for(let l=r;l<o.length;l++){const d=o[l];if(d.length>1024)continue;const h=$r.test(d)?d.replace($r,"$1"):d;if(!h.match(/\S*Error: /)){for(const p of e){const v=p(h);if(v){a.push(v);break}}if(a.length>=50+i)break}}return(function(l){if(!l.length)return[];const d=Array.from(l);return/sentryWrapped/.test(It(d).function||"")&&d.pop(),d.reverse(),Vr.test(It(d).function||"")&&(d.pop(),Vr.test(It(d).function||"")&&d.pop()),d.slice(0,50).map((h=>({...h,filename:h.filename||It(d).filename,function:h.function||Ve})))})(a.slice(i))}})([30,t=>{const e=Io.exec(t);if(e){const[,r,i,a]=e;return kn(r,Ve,+i,+a)}const n=xo.exec(t);if(n){if(n[2]&&n[2].indexOf("eval")===0){const a=jo.exec(n[2]);a&&(n[2]=a[1],n[3]=a[2],n[4]=a[3])}const[r,i]=ji(n[1]||Ve,n[2]);return kn(i,r,n[3]?+n[3]:void 0,n[4]?+n[4]:void 0)}}],[50,t=>{const e=Lo.exec(t);if(e){if(e[3]&&e[3].indexOf(" > eval")>-1){const i=Do.exec(e[3]);i&&(e[1]=e[1]||"eval",e[3]=i[1],e[4]=i[2],e[5]="")}let n=e[3],r=e[1]||Ve;return[r,n]=ji(r,n),kn(n,r,e[4]?+e[4]:void 0,e[5]?+e[5]:void 0)}}]),ji=(t,e)=>{const n=t.indexOf("safari-extension")!==-1,r=t.indexOf("safari-web-extension")!==-1;return n||r?[t.indexOf("@")!==-1?t.split("@")[0]:Ve,n?`safari-extension:${e}`:`safari-web-extension:${e}`]:[t,e]},Li=1024,No=(t={})=>{const e={console:!0,dom:!0,fetch:!0,history:!0,sentry:!0,xhr:!0,...t};return{name:"Breadcrumbs",setup(n){var r;e.console&&(function(i){const a="console";qe(a,i),ze(a,go)})((function(i){return function(a){if(K()!==i)return;const o={category:"console",data:{arguments:a.args,logger:"console"},level:mo(a.level),message:Hr(a.args," ")};if(a.level==="assert"){if(a.args[0]!==!1)return;o.message=`Assertion failed: ${Hr(a.args.slice(1)," ")||"console.assert"}`,o.data.arguments=a.args.slice(1)}Re(o,{input:a.args,level:a.level})}})(n)),e.dom&&(r=(function(i,a){return function(o){if(K()!==i)return;let l,d,h=typeof a=="object"?a.serializeAttribute:void 0,p=typeof a=="object"&&typeof a.maxStringLength=="number"?a.maxStringLength:void 0;p&&p>Li&&(hn&&L.warn(`\`dom.maxStringLength\` cannot exceed 1024, but a value of ${p} was configured. Sentry will use 1024 instead.`),p=Li),typeof h=="string"&&(h=[h]);try{const E=o.event,C=(function(b){return!!b&&!!b.target})(E)?E.target:E;l=Ds(C,{keyAttrs:h,maxStringLength:p}),d=(function(b){if(!cr.HTMLElement)return null;let m=b;for(let _=0;_<5;_++){if(!m)return null;if(m instanceof HTMLElement){if(m.dataset.sentryComponent)return m.dataset.sentryComponent;if(m.dataset.sentryElement)return m.dataset.sentryElement}m=m.parentNode}return null})(C)}catch{l="<unknown>"}if(l.length===0)return;const v={category:`ui.${o.name}`,message:l};d&&(v.data={"ui.component_name":d}),Re(v,{event:o.event,name:o.name,global:o.global})}})(n,e.dom),qe("dom",r),ze("dom",To)),e.xhr&&(function(i){qe("xhr",i),ze("xhr",Oo)})((function(i){return function(a){if(K()!==i)return;const{startTimestamp:o,endTimestamp:l}=a,d=a.xhr[bt];if(!o||!l||!d)return;const{method:h,url:p,status_code:v,body:E}=d,C={method:h,url:p,status_code:v},b={xhr:a.xhr,input:E,startTimestamp:o,endTimestamp:l};Re({category:"xhr",data:C,type:"http",level:Ti(v)},b)}})(n)),e.fetch&&bo((function(i){return function(a){if(K()!==i)return;const{startTimestamp:o,endTimestamp:l}=a;if(l&&(!a.fetchData.url.match(/sentry_key/)||a.fetchData.method!=="POST"))if(a.error)Re({category:"fetch",data:a.fetchData,level:"error",type:"http"},{data:a.error,input:a.args,startTimestamp:o,endTimestamp:l});else{const d=a.response,h={...a.fetchData,status_code:d&&d.status},p={input:a.args,response:d,startTimestamp:o,endTimestamp:l};Re({category:"fetch",data:h,type:"http",level:Ti(h.status_code)},p)}}})(n)),e.history&&Ws((function(i){return function(a){if(K()!==i)return;let o=a.from,l=a.to;const d=vn(Q.location.href);let h=o?vn(o):void 0;const p=vn(l);h&&h.path||(h=d),d.protocol===p.protocol&&d.host===p.host&&(l=p.relative),d.protocol===h.protocol&&d.host===h.host&&(o=h.relative),Re({category:"navigation",data:{from:o,to:l}})}})(n)),e.sentry&&n.on("beforeSendEvent",(function(i){return function(a){K()===i&&Re({category:"sentry."+(a.type==="transaction"?"transaction":"event"),event_id:a.event_id,level:a.level,message:Pe(a)},{event:a})}})(n))}}},Fo=["EventTarget","Window","Node","ApplicationCache","AudioTrackList","BroadcastChannel","ChannelMergerNode","CryptoOperation","EventSource","FileReader","HTMLUnknownElement","IDBDatabase","IDBRequest","IDBTransaction","KeyOperation","MediaController","MessagePort","ModalWindow","Notification","SVGElementInstance","Screen","SharedWorker","TextTrack","TextTrackCue","TextTrackList","WebSocket","WebSocketWorker","Worker","XMLHttpRequest","XMLHttpRequestEventTarget","XMLHttpRequestUpload"],Bo=(t={})=>{const e={XMLHttpRequest:!0,eventTarget:!0,requestAnimationFrame:!0,setInterval:!0,setTimeout:!0,...t};return{name:"BrowserApiErrors",setupOnce(){e.setTimeout&&re(Q,"setTimeout",Di),e.setInterval&&re(Q,"setInterval",Di),e.requestAnimationFrame&&re(Q,"requestAnimationFrame",Uo),e.XMLHttpRequest&&"XMLHttpRequest"in Q&&re(XMLHttpRequest.prototype,"send",$o);const n=e.eventTarget;n&&(Array.isArray(n)?n:Fo).forEach(Vo)}}};function Di(t){return function(...e){const n=e[0];return e[0]=ut(n,{mechanism:{data:{function:xe(t)},handled:!1,type:"instrument"}}),t.apply(this,e)}}function Uo(t){return function(e){return t.apply(this,[ut(e,{mechanism:{data:{function:"requestAnimationFrame",handler:xe(t)},handled:!1,type:"instrument"}})])}}function $o(t){return function(...e){const n=this;return["onload","onerror","onprogress","onreadystatechange"].forEach((r=>{r in n&&typeof n[r]=="function"&&re(n,r,(function(i){const a={mechanism:{data:{function:r,handler:xe(i)},handled:!1,type:"instrument"}},o=lr(i);return o&&(a.mechanism.data.handler=xe(o)),ut(i,a)}))})),t.apply(this,e)}}function Vo(t){const e=Q[t],n=e&&e.prototype;n&&n.hasOwnProperty&&n.hasOwnProperty("addEventListener")&&(re(n,"addEventListener",(function(r){return function(i,a,o){try{typeof a.handleEvent=="function"&&(a.handleEvent=ut(a.handleEvent,{mechanism:{data:{function:"handleEvent",handler:xe(a),target:t},handled:!1,type:"instrument"}}))}catch{}return r.apply(this,[i,ut(a,{mechanism:{data:{function:"addEventListener",handler:xe(a),target:t},handled:!1,type:"instrument"}}),o])}})),re(n,"removeEventListener",(function(r){return function(i,a,o){try{const l=a.__sentry_wrapped__;l&&r.call(this,i,l,o)}catch{}return r.call(this,i,a,o)}})))}const Jo=()=>({name:"BrowserSession",setupOnce(){Q.document!==void 0?(di({ignoreDuration:!0}),hi(),Ws((({from:t,to:e})=>{t!==void 0&&t!==e&&(di({ignoreDuration:!0}),hi())}))):hn&&L.warn("Using the `browserSessionIntegration` in non-browser environments is not supported.")}}),qo=(t={})=>{const e={onerror:!0,onunhandledrejection:!0,...t};return{name:"GlobalHandlers",setupOnce(){Error.stackTraceLimit=50},setup(n){e.onerror&&((function(r){(function(i){const a="error";qe(a,i),ze(a,ja)})((i=>{const{stackParser:a,attachStacktrace:o}=Ni();if(K()!==r||Oi())return;const{msg:l,url:d,line:h,column:p,error:v}=i,E=(function(C,b,m,_){const w=C.exception=C.exception||{},T=w.values=w.values||[],A=T[0]=T[0]||{},I=A.stacktrace=A.stacktrace||{},x=I.frames=I.frames||[],R=_,z=m,te=Se(b)&&b.length>0?b:(function(){try{return cr.document.location.href}catch{return""}})();return x.length===0&&x.push({colno:R,filename:te,function:Ve,in_app:!0,lineno:z}),C})(Qn(a,v||l,void 0,o,!1),d,h,p);E.level="error",ui(E,{originalException:v,mechanism:{handled:!1,type:"onerror"}})}))})(n),Ri("onerror")),e.onunhandledrejection&&((function(r){(function(i){const a="unhandledrejection";qe(a,i),ze(a,La)})((i=>{const{stackParser:a,attachStacktrace:o}=Ni();if(K()!==r||Oi())return;const l=(function(h){if(Rn(h))return h;try{if("reason"in h)return h.reason;if("detail"in h&&"reason"in h.detail)return h.detail.reason}catch{}return h})(i),d=Rn(l)?{exception:{values:[{type:"UnhandledRejection",value:`Non-Error promise rejection captured with value: ${String(l)}`}]}}:Qn(a,l,void 0,o,!0);d.level="error",ui(d,{originalException:l,mechanism:{handled:!1,type:"onunhandledrejection"}})}))})(n),Ri("onunhandledrejection"))}}};function Ri(t){hn&&L.log(`Global Handler attached: ${t}`)}function Ni(){const t=K();return t&&t.getOptions()||{stackParser:()=>[],attachStacktrace:!1}}const zo=()=>({name:"HttpContext",preprocessEvent(t){if(!Q.navigator&&!Q.location&&!Q.document)return;const e=t.request&&t.request.url||Q.location&&Q.location.href,{referrer:n}=Q.document||{},{userAgent:r}=Q.navigator||{},i={...t.request&&t.request.headers,...n&&{Referer:n},...r&&{"User-Agent":r}},a={...t.request,...e&&{url:e},headers:i};t.request=a}}),Wo=(t={})=>{const e=t.limit||5,n=t.key||"cause";return{name:"LinkedErrors",preprocessEvent(r,i,a){const o=a.getOptions();po(pr,o.stackParser,o.maxValueLength,n,e,r,i)}}};var Fi="new",Bi="loading",Ui="loaded",Kn="joining-meeting",$e="joined-meeting",Ne="left-meeting",Te="error",Ho="playable",Sn="unknown",Qo="full",Go="base",$i="no-room",Ko="end-of-life",Yo="connection-error",Xo="iframe-ready-for-launch-config",Zo="iframe-launch-config",ec="theme-updated",tc="loading",nc="load-attempt-failed",Vi="loaded",rc="started-camera",ic="camera-error",sc="joining-meeting",ac="joined-meeting",oc="left-meeting",cc="participant-joined",lc="participant-updated",uc="participant-left",dc="participant-counts-updated",hc="access-state-updated",fc="meeting-session-summary-updated",pc="meeting-session-state-updated",gc="waiting-participant-added",mc="waiting-participant-updated",vc="waiting-participant-removed",yc="track-started",bc="track-stopped",_c="transcription-started",wc="transcription-stopped",kc="transcription-error",Ji="recording-started",qi="recording-stopped",Sc="recording-stats",Cc="recording-error",Mc="recording-upload-completed",Ec="recording-data",Tc="app-message",Ac="transcription-message",Oc="remote-media-player-started",Pc="remote-media-player-updated",Ic="remote-media-player-stopped",xc="local-screen-share-started",jc="local-screen-share-stopped",Lc="local-screen-share-canceled",Dc="active-speaker-change",Rc="active-speaker-mode-change",Nc="network-quality-change",Fc="network-connection",Bc="cpu-load-change",Uc="face-counts-updated",Ft="fullscreen",Bt="exited-fullscreen",$c="live-streaming-started",Vc="live-streaming-updated",Jc="live-streaming-stopped",qc="live-streaming-error",zc="lang-updated",Wc="receive-settings-updated",zi="input-settings-updated",Wi="nonfatal-error",Hi="error",Cn=4096,Qi=102400,Mn="iframe-call-message",Gi="local-screen-start",Ki="daily-method-update-live-streaming-endpoints",Ut="transmit-log",Ce="daily-custom-track",Wt={NONE:"none",BGBLUR:"background-blur",BGIMAGE:"background-image",FACE_DETECTION:"face-detection"},Hs={NONE:"none",NOISE_CANCELLATION:"noise-cancellation"},Yn={PLAY:"play",PAUSE:"pause"},En=["jpg","png","jpeg"],Hc="add-endpoints",Qc="remove-endpoints",Yi="sip-call-transfer";function ue(){return!F()&&typeof window<"u"&&window.navigator&&window.navigator.userAgent?window.navigator.userAgent:""}function F(){return typeof navigator<"u"&&navigator.product&&navigator.product==="ReactNative"}function Qs(){return navigator&&navigator.mediaDevices&&navigator.mediaDevices.getUserMedia}function Gc(){return!!(navigator&&navigator.mediaDevices&&navigator.mediaDevices.getDisplayMedia)&&((function(t,e){if(!t||!e)return!0;switch(t){case"Chrome":return e.major>=75;case"Safari":return RTCRtpTransceiver.prototype.hasOwnProperty("currentDirection")&&!(e.major===13&&e.minor===0&&e.point===0);case"Firefox":return e.major>=67}return!0})(Ke(),en())||F())}function Xi(){if(F()||!document)return!1;var t=document.createElement("iframe");return!!t.requestFullscreen||!!t.webkitRequestFullscreen}var Xn="none",Kc="software",Yc="hardware",Xc=(function(){try{var t,e=document.createElement("canvas"),n=!1;(t=e.getContext("webgl2",{failIfMajorPerformanceCaveat:!0}))||(n=!0,t=e.getContext("webgl2"));var r=t!=null;return e.remove(),r?n?Kc:Yc:Xn}catch{return Xn}})();function Gs(){var t=arguments.length>0&&arguments[0]!==void 0&&arguments[0];return!F()&&Xc!==Xn&&(t?(function(){return Zi()?!1:["Chrome","Firefox"].includes(Ke())})():(function(){if(Zi())return!1;var e=Ke();if(e==="Safari"){var n=vr();if(n.major<15||n.major===15&&n.minor<4)return!1}return e==="Chrome"?mr().major>=77:e==="Firefox"?yr().major>=97:["Chrome","Firefox","Safari"].includes(e)})())}function Ks(){if(F()||Ys()||typeof AudioWorkletNode>"u")return!1;switch(Ke()){case"Chrome":case"Firefox":return!0;case"Safari":var t=en();return t.major>17||t.major===17&&t.minor>=4}return!1}function Tn(){return Qs()&&typeof MediaStreamTrack<"u"&&!(function(){var t,e=Ke();if(!ue())return!0;switch(e){case"Chrome":return(t=mr()).major&&t.major>0&&t.major<75;case"Firefox":return(t=yr()).major<91;case"Safari":return(t=vr()).major<13||t.major===13&&t.minor<1;default:return!0}})()}function Ys(){return ue().match(/Linux; Android/)}function Zi(){var t,e=ue(),n=e.match(/Mac/)&&(!F()&&typeof window<"u"&&(t=window)!==null&&t!==void 0&&(t=t.navigator)!==null&&t!==void 0&&t.maxTouchPoints?window.navigator.maxTouchPoints:0)>=5;return!!(e.match(/Mobi/)||e.match(/Android/)||n)||!!ue().match(/DailyAnd\//)||void 0}function Ke(){if(typeof window<"u"){var t=ue();return Xs()?"Safari":t.indexOf("Edge")>-1?"Edge":t.match(/Chrome\//)?"Chrome":t.indexOf("Safari")>-1||Zs()?"Safari":t.indexOf("Firefox")>-1?"Firefox":t.indexOf("MSIE")>-1||t.indexOf(".NET")>-1?"IE":"Unknown Browser"}}function en(){switch(Ke()){case"Chrome":return mr();case"Safari":return vr();case"Firefox":return yr();case"Edge":return(function(){var t=0,e=0;if(typeof window<"u"){var n=ue().match(/Edge\/(\d+).(\d+)/);if(n)try{t=parseInt(n[1]),e=parseInt(n[2])}catch{}}return{major:t,minor:e}})()}}function mr(){var t=0,e=0,n=0,r=0,i=!1;if(typeof window<"u"){var a=ue(),o=a.match(/Chrome\/(\d+).(\d+).(\d+).(\d+)/);if(o)try{t=parseInt(o[1]),e=parseInt(o[2]),n=parseInt(o[3]),r=parseInt(o[4]),i=a.indexOf("OPR/")>-1}catch{}}return{major:t,minor:e,build:n,patch:r,opera:i}}function Xs(){return!!ue().match(/iPad|iPhone|iPod/i)&&Qs()}function Zs(){return ue().indexOf("AppleWebKit/605.1.15")>-1}function vr(){var t=0,e=0,n=0;if(typeof window<"u"){var r=ue().match(/Version\/(\d+).(\d+)(.(\d+))?/);if(r)try{t=parseInt(r[1]),e=parseInt(r[2]),n=parseInt(r[4])}catch{}else(Xs()||Zs())&&(t=14,e=0,n=3)}return{major:t,minor:e,point:n}}function yr(){var t=0,e=0;if(typeof window<"u"){var n=ue().match(/Firefox\/(\d+).(\d+)/);if(n)try{t=parseInt(n[1]),e=parseInt(n[2])}catch{}}return{major:t,minor:e}}var ea=(function(){return se((function t(){ie(this,t)}),[{key:"addListenerForMessagesFromCallMachine",value:function(t,e,n){vt()}},{key:"addListenerForMessagesFromDailyJs",value:function(t,e,n){vt()}},{key:"sendMessageToCallMachine",value:function(t,e,n,r){vt()}},{key:"sendMessageToDailyJs",value:function(t,e){vt()}},{key:"removeListener",value:function(t){vt()}}])})();function es(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable}))),n.push.apply(n,r)}return n}function An(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?es(Object(n),!0).forEach((function(r){be(t,r,n[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):es(Object(n)).forEach((function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))}))}return t}function ta(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch{}return(ta=function(){return!!t})()}var Zc=(function(){function t(){var e,n,r,i;return ie(this,t),n=this,r=ge(r=t),(e=sn(n,ta()?Reflect.construct(r,[],ge(n).constructor):r.apply(n,i)))._wrappedListeners={},e._messageCallbacks={},e}return an(t,ea),se(t,[{key:"addListenerForMessagesFromCallMachine",value:function(e,n,r){var i=this,a=function(o){if(o.data&&o.data.what==="iframe-call-message"&&(!o.data.callClientId||o.data.callClientId===n)&&(!o.data.from||o.data.from!=="module")){var l=An({},o.data);if(delete l.from,l.callbackStamp&&i._messageCallbacks[l.callbackStamp]){var d=l.callbackStamp;i._messageCallbacks[d].call(r,l),delete i._messageCallbacks[d]}delete l.what,delete l.callbackStamp,e.call(r,l)}};this._wrappedListeners[e]=a,window.addEventListener("message",a)}},{key:"addListenerForMessagesFromDailyJs",value:function(e,n,r){var i=function(a){var o;if(!(!a.data||a.data.what!==Mn||!a.data.action||a.data.from&&a.data.from!=="module"||a.data.callClientId&&n&&a.data.callClientId!==n||a!=null&&(o=a.data)!==null&&o!==void 0&&o.callFrameId)){var l=a.data;e.call(r,l)}};this._wrappedListeners[e]=i,window.addEventListener("message",i)}},{key:"sendMessageToCallMachine",value:function(e,n,r,i){if(!r)throw new Error("undefined callClientId. Are you trying to use a DailyCall instance previously destroyed?");var a=An({},e);if(a.what=Mn,a.from="module",a.callClientId=r,n){var o=on();this._messageCallbacks[o]=n,a.callbackStamp=o}var l=i?i.contentWindow:window,d=this._callMachineTargetOrigin(i);d&&l.postMessage(a,d)}},{key:"sendMessageToDailyJs",value:function(e,n){e.what=Mn,e.callClientId=n,e.from="embedded",window.postMessage(e,this._targetOriginFromWindowLocation())}},{key:"removeListener",value:function(e){var n=this._wrappedListeners[e];n&&(window.removeEventListener("message",n),delete this._wrappedListeners[e])}},{key:"forwardPackagedMessageToCallMachine",value:function(e,n,r){var i=An({},e);i.callClientId=r;var a=n?n.contentWindow:window,o=this._callMachineTargetOrigin(n);o&&a.postMessage(i,o)}},{key:"addListenerForPackagedMessagesFromCallMachine",value:function(e,n){var r=function(i){if(i.data&&i.data.what==="iframe-call-message"&&(!i.data.callClientId||i.data.callClientId===n)&&(!i.data.from||i.data.from!=="module")){var a=i.data;e(a)}};return this._wrappedListeners[e]=r,window.addEventListener("message",r),e}},{key:"removeListenerForPackagedMessagesFromCallMachine",value:function(e){var n=this._wrappedListeners[e];n&&(window.removeEventListener("message",n),delete this._wrappedListeners[e])}},{key:"_callMachineTargetOrigin",value:function(e){return e?e.src?new URL(e.src).origin:void 0:this._targetOriginFromWindowLocation()}},{key:"_targetOriginFromWindowLocation",value:function(){return window.location.protocol==="file:"?"*":window.location.origin}}])})();function ts(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable}))),n.push.apply(n,r)}return n}function na(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch{}return(na=function(){return!!t})()}var el=(function(){function t(){var e,n,r,i;return ie(this,t),n=this,r=ge(r=t),e=sn(n,na()?Reflect.construct(r,[],ge(n).constructor):r.apply(n,i)),global.callMachineToDailyJsEmitter=global.callMachineToDailyJsEmitter||new Ln.EventEmitter,global.dailyJsToCallMachineEmitter=global.dailyJsToCallMachineEmitter||new Ln.EventEmitter,e._wrappedListeners={},e._messageCallbacks={},e}return an(t,ea),se(t,[{key:"addListenerForMessagesFromCallMachine",value:function(e,n,r){this._addListener(e,global.callMachineToDailyJsEmitter,n,r,"received call machine message")}},{key:"addListenerForMessagesFromDailyJs",value:function(e,n,r){this._addListener(e,global.dailyJsToCallMachineEmitter,n,r,"received daily-js message")}},{key:"sendMessageToCallMachine",value:function(e,n,r){this._sendMessage(e,global.dailyJsToCallMachineEmitter,r,n,"sending message to call machine")}},{key:"sendMessageToDailyJs",value:function(e,n){this._sendMessage(e,global.callMachineToDailyJsEmitter,n,null,"sending message to daily-js")}},{key:"removeListener",value:function(e){var n=this._wrappedListeners[e];n&&(global.callMachineToDailyJsEmitter.removeListener("message",n),global.dailyJsToCallMachineEmitter.removeListener("message",n),delete this._wrappedListeners[e])}},{key:"_addListener",value:function(e,n,r,i,a){var o=this,l=function(d){if(d.callClientId===r){if(d.callbackStamp&&o._messageCallbacks[d.callbackStamp]){var h=d.callbackStamp;o._messageCallbacks[h].call(i,d),delete o._messageCallbacks[h]}e.call(i,d)}};this._wrappedListeners[e]=l,n.addListener("message",l)}},{key:"_sendMessage",value:function(e,n,r,i,a){var o=(function(d){for(var h=1;h<arguments.length;h++){var p=arguments[h]!=null?arguments[h]:{};h%2?ts(Object(p),!0).forEach((function(v){be(d,v,p[v])})):Object.getOwnPropertyDescriptors?Object.defineProperties(d,Object.getOwnPropertyDescriptors(p)):ts(Object(p)).forEach((function(v){Object.defineProperty(d,v,Object.getOwnPropertyDescriptor(p,v))}))}return d})({},e);if(o.callClientId=r,i){var l=on();this._messageCallbacks[l]=i,o.callbackStamp=l}n.emit("message",o)}}])})(),Zn="replace",er="shallow-merge",ns=[Zn,er],tl=(function(){function t(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=e.data,r=e.mergeStrategy,i=r===void 0?Zn:r;ie(this,t),t._validateMergeStrategy(i),t._validateData(n,i),this.mergeStrategy=i,this.data=n}return se(t,[{key:"isNoOp",value:function(){return t.isNoOpUpdate(this.data,this.mergeStrategy)}}],[{key:"isNoOpUpdate",value:function(e,n){return Object.keys(e).length===0&&n===er}},{key:"_validateMergeStrategy",value:function(e){if(!ns.includes(e))throw Error("Unrecognized mergeStrategy provided. Options are: [".concat(ns,"]"))}},{key:"_validateData",value:function(e,n){if(!(function(l){if(l==null||U(l)!=="object")return!1;var d=Object.getPrototypeOf(l);return d==null||d===Object.prototype})(e))throw Error("Meeting session data must be a plain (map-like) object");var r;try{if(r=JSON.stringify(e),n===Zn){var i=JSON.parse(r);Z(i,e)||console.warn("The meeting session data provided will be modified when serialized.",i,e)}else if(n===er){for(var a in e)if(Object.hasOwnProperty.call(e,a)&&e[a]!==void 0){var o=JSON.parse(JSON.stringify(e[a]));Z(e[a],o)||console.warn("At least one key in the meeting session data provided will be modified when serialized.",o,e[a])}}}catch(l){throw Error("Meeting session data must be serializable to JSON: ".concat(l))}if(r.length>Qi)throw Error("Meeting session data is too large (".concat(r.length," characters). Maximum size suppported is ").concat(Qi,"."))}}])})();function ra(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch{}return(ra=function(){return!!t})()}function tr(t){var e=typeof Map=="function"?new Map:void 0;return tr=function(n){if(n===null||!(function(i){try{return Function.toString.call(i).indexOf("[native code]")!==-1}catch{return typeof i=="function"}})(n))return n;if(typeof n!="function")throw new TypeError("Super expression must either be null or a function");if(e!==void 0){if(e.has(n))return e.get(n);e.set(n,r)}function r(){return(function(i,a,o){if(ra())return Reflect.construct.apply(null,arguments);var l=[null];l.push.apply(l,a);var d=new(i.bind.apply(i,l));return o&&St(d,o.prototype),d})(n,arguments,ge(this).constructor)}return r.prototype=Object.create(n.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),St(r,n)},tr(t)}function ia(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch{}return(ia=function(){return!!t})()}function rs(t){var e,n=(e=window._daily)===null||e===void 0?void 0:e.pendings;if(n){var r=n.indexOf(t);r!==-1&&n.splice(r,1)}}var nl=(function(){return se((function t(e){ie(this,t),this._currentLoad=null,this._callClientId=e}),[{key:"load",value:function(){var t,e=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=arguments.length>1?arguments[1]:void 0,i=arguments.length>2?arguments[2]:void 0;if(this.loaded)return window._daily.instances[this._callClientId].callMachine.reset(),void r(!0);t=this._callClientId,window._daily.pendings.push(t),this._currentLoad&&this._currentLoad.cancel(),this._currentLoad=new rl(n,(function(){r(!1)}),(function(a,o){o||rs(e._callClientId),i(a,o)})),this._currentLoad.start()}},{key:"cancel",value:function(){this._currentLoad&&this._currentLoad.cancel(),rs(this._callClientId)}},{key:"loaded",get:function(){return this._currentLoad&&this._currentLoad.succeeded}}])})(),rl=(function(){return se((function t(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=arguments.length>1?arguments[1]:void 0,r=arguments.length>2?arguments[2]:void 0;ie(this,t),this._attemptsRemaining=3,this._currentAttempt=null,this._dailyConfig=e,this._successCallback=n,this._failureCallback=r}),[{key:"start",value:function(){var t=this;if(!this._currentAttempt){var e=function(n){t._currentAttempt.cancelled||(t._attemptsRemaining--,t._failureCallback(n,t._attemptsRemaining>0),t._attemptsRemaining<=0||setTimeout((function(){t._currentAttempt.cancelled||(t._currentAttempt=new is(t._dailyConfig,t._successCallback,e),t._currentAttempt.start())}),3e3))};this._currentAttempt=new is(this._dailyConfig,this._successCallback,e),this._currentAttempt.start()}}},{key:"cancel",value:function(){this._currentAttempt&&this._currentAttempt.cancel()}},{key:"cancelled",get:function(){return this._currentAttempt&&this._currentAttempt.cancelled}},{key:"succeeded",get:function(){return this._currentAttempt&&this._currentAttempt.succeeded}}])})(),On=(function(){function t(){return ie(this,t),e=this,r=arguments,n=ge(n=t),sn(e,ia()?Reflect.construct(n,r||[],ge(e).constructor):n.apply(e,r));var e,n,r}return an(t,tr(Error)),se(t)})(),tn=2e4,is=(function(){return se((function e(n,r,i){ie(this,e),this._loadAttemptImpl=F()||!n.avoidEval?new il(n,r,i):new sl(n,r,i)}),[{key:"start",value:(t=j((function*(){return this._loadAttemptImpl.start()})),function(){return t.apply(this,arguments)})},{key:"cancel",value:function(){this._loadAttemptImpl.cancel()}},{key:"cancelled",get:function(){return this._loadAttemptImpl.cancelled}},{key:"succeeded",get:function(){return this._loadAttemptImpl.succeeded}}]);var t})(),il=(function(){return se((function i(a,o,l){ie(this,i),this.cancelled=!1,this.succeeded=!1,this._networkTimedOut=!1,this._networkTimeout=null,this._iosCache=typeof iOSCallObjectBundleCache<"u"&&iOSCallObjectBundleCache,this._refetchHeaders=null,this._dailyConfig=a,this._successCallback=o,this._failureCallback=l}),[{key:"start",value:(r=j((function*(){var i=Qt(this._dailyConfig);!(yield this._tryLoadFromIOSCache(i))&&this._loadFromNetwork(i)})),function(){return r.apply(this,arguments)})},{key:"cancel",value:function(){clearTimeout(this._networkTimeout),this.cancelled=!0}},{key:"_tryLoadFromIOSCache",value:(n=j((function*(i){if(!this._iosCache)return!1;try{var a=yield this._iosCache.get(i);return!!this.cancelled||!!a&&(a.code?(Function('"use strict";'+a.code)(),this.succeeded=!0,this._successCallback(),!0):(this._refetchHeaders=a.refetchHeaders,!1))}catch{return!1}})),function(i){return n.apply(this,arguments)})},{key:"_loadFromNetwork",value:(e=j((function*(i){var a=this;this._networkTimeout=setTimeout((function(){a._networkTimedOut=!0,a._failureCallback({msg:"Timed out (>".concat(tn," ms) when loading call object bundle ").concat(i),type:"timeout"})}),tn);try{var o=this._refetchHeaders?{headers:this._refetchHeaders}:{},l=yield fetch(i,o);if(clearTimeout(this._networkTimeout),this.cancelled||this._networkTimedOut)throw new On;var d=yield this._getBundleCodeFromResponse(i,l);if(this.cancelled)throw new On;Function('"use strict";'+d)(),this._iosCache&&this._iosCache.set(i,d,l.headers),this.succeeded=!0,this._successCallback()}catch(h){if(clearTimeout(this._networkTimeout),h instanceof On||this.cancelled||this._networkTimedOut)return;this._failureCallback({msg:"Failed to load call object bundle ".concat(i,": ").concat(h),type:h.message})}})),function(i){return e.apply(this,arguments)})},{key:"_getBundleCodeFromResponse",value:(t=j((function*(i,a){if(a.ok)return yield a.text();if(this._iosCache&&a.status===304)return(yield this._iosCache.renew(i,a.headers)).code;throw new Error("Received ".concat(a.status," response"))})),function(i,a){return t.apply(this,arguments)})}]);var t,e,n,r})(),sl=(function(){return se((function t(e,n,r){ie(this,t),this.cancelled=!1,this.succeeded=!1,this._dailyConfig=e,this._successCallback=n,this._failureCallback=r,this._attemptId=on(),this._networkTimeout=null,this._scriptElement=null}),[{key:"start",value:function(){window._dailyCallMachineLoadWaitlist||(window._dailyCallMachineLoadWaitlist=new Set);var t=Qt(this._dailyConfig);(typeof document>"u"?"undefined":U(document))==="object"?this._startLoading(t):this._failureCallback({msg:"Call object bundle must be loaded in a DOM/web context",type:"missing context"})}},{key:"cancel",value:function(){this._stopLoading(),this.cancelled=!0}},{key:"_startLoading",value:function(t){var e=this;this._signUpForCallMachineLoadWaitlist(),this._networkTimeout=setTimeout((function(){e._stopLoading(),e._failureCallback({msg:"Timed out (>".concat(tn," ms) when loading call object bundle ").concat(t),type:"timeout"})}),tn);var n=document.getElementsByTagName("head")[0],r=document.createElement("script");this._scriptElement=r,r.onload=function(){e._stopLoading(),e.succeeded=!0,e._successCallback()},r.onerror=function(i){e._stopLoading(),e._failureCallback({msg:"Failed to load call object bundle ".concat(i.target.src),type:i.message})},r.src=t,n.appendChild(r)}},{key:"_stopLoading",value:function(){this._withdrawFromCallMachineLoadWaitlist(),clearTimeout(this._networkTimeout),this._scriptElement&&(this._scriptElement.onload=null,this._scriptElement.onerror=null)}},{key:"_signUpForCallMachineLoadWaitlist",value:function(){window._dailyCallMachineLoadWaitlist.add(this._attemptId)}},{key:"_withdrawFromCallMachineLoadWaitlist",value:function(){window._dailyCallMachineLoadWaitlist.delete(this._attemptId)}}])})(),$t=function(t,e,n){return ol(t.local,e,n)===!0},al=function(t,e,n){return t.local.streams&&t.local.streams[e]&&t.local.streams[e].stream&&t.local.streams[e].stream["get".concat(n==="video"?"Video":"Audio","Tracks")]()[0]},rt=function(t,e,n,r){var i=cl(t,e,n,r);return i&&i.pendingTrack},ol=function(t,e,n){if(!t)return!1;var r=function(a){switch(a){case"avatar":return!0;case"staged":return a;default:return!!a}},i=t.public.subscribedTracks;return i&&i[e]?["cam-audio","cam-video","screen-video","screen-audio","rmpAudio","rmpVideo"].indexOf(n)===-1&&i[e].custom?[!0,"staged"].includes(i[e].custom)?r(i[e].custom):r(i[e].custom[n]):r(i[e][n]):!i||r(i.ALL)},cl=function(t,e,n,r){var i=Object.values(t.streams||{}).filter((function(a){return a.participantId===e&&a.type===n&&a.pendingTrack&&a.pendingTrack.kind===r})).sort((function(a,o){return new Date(o.starttime)-new Date(a.starttime)}));return i&&i[0]},ll=function(t,e){var n=t.local.public.customTracks;if(n&&n[e])return n[e].track};function ss(t,e){for(var n=e.getState(),r=0,i=["cam","screen"];r<i.length;r++)for(var a=i[r],o=0,l=["video","audio"];o<l.length;o++){var d=l[o],h=a==="cam"?d:"screen".concat(d.charAt(0).toUpperCase()+d.slice(1)),p=t.tracks[h];if(p){var v=t.local?al(n,a,d):rt(n,t.session_id,a,d);p.state==="playable"&&(p.track=v),p.persistentTrack=v}}}function as(t,e){try{var n=e.getState();for(var r in t.tracks)if(!ul(r)){var i=t.tracks[r].kind;if(i){var a=t.tracks[r];if(a){var o=t.local?ll(n,r):rt(n,t.session_id,r,i);a.state==="playable"&&(t.tracks[r].track=o),a.persistentTrack=o}}else console.error("unknown type for custom track")}}catch(l){console.error(l)}}function ul(t){return["video","audio","screenVideo","screenAudio"].includes(t)}function os(t,e,n){var r=n.getState();if(t.local){if(t.audio)try{t.audioTrack=r.local.streams.cam.stream.getAudioTracks()[0],t.audioTrack||(t.audio=!1)}catch{}if(t.video)try{t.videoTrack=r.local.streams.cam.stream.getVideoTracks()[0],t.videoTrack||(t.video=!1)}catch{}if(t.screen)try{t.screenVideoTrack=r.local.streams.screen.stream.getVideoTracks()[0],t.screenAudioTrack=r.local.streams.screen.stream.getAudioTracks()[0],t.screenVideoTrack||t.screenAudioTrack||(t.screen=!1)}catch{}}else{var i=!0;try{var a=r.participants[t.session_id];a&&a.public&&a.public.rtcType&&a.public.rtcType.impl==="peer-to-peer"&&a.private&&!["connected","completed"].includes(a.private.peeringState)&&(i=!1)}catch(p){console.error(p)}if(!i)return t.audio=!1,t.audioTrack=!1,t.video=!1,t.videoTrack=!1,t.screen=!1,void(t.screenTrack=!1);try{if(r.streams,t.audio&&$t(r,t.session_id,"cam-audio")){var o=rt(r,t.session_id,"cam","audio");o&&(e&&e.audioTrack&&e.audioTrack.id===o.id?t.audioTrack=o:o.muted||(t.audioTrack=o)),t.audioTrack||(t.audio=!1)}if(t.video&&$t(r,t.session_id,"cam-video")){var l=rt(r,t.session_id,"cam","video");l&&(e&&e.videoTrack&&e.videoTrack.id===l.id?t.videoTrack=l:l.muted||(t.videoTrack=l)),t.videoTrack||(t.video=!1)}if(t.screen&&$t(r,t.session_id,"screen-audio")){var d=rt(r,t.session_id,"screen","audio");d&&(e&&e.screenAudioTrack&&e.screenAudioTrack.id===d.id?t.screenAudioTrack=d:d.muted||(t.screenAudioTrack=d))}if(t.screen&&$t(r,t.session_id,"screen-video")){var h=rt(r,t.session_id,"screen","video");h&&(e&&e.screenVideoTrack&&e.screenVideoTrack.id===h.id?t.screenVideoTrack=h:h.muted||(t.screenVideoTrack=h))}t.screenVideoTrack||t.screenAudioTrack||(t.screen=!1)}catch(p){console.error("unexpected error matching up tracks",p)}}}function dl(t,e){var n=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=(function(d,h){if(d){if(typeof d=="string")return cs(d,h);var p={}.toString.call(d).slice(8,-1);return p==="Object"&&d.constructor&&(p=d.constructor.name),p==="Map"||p==="Set"?Array.from(d):p==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(p)?cs(d,h):void 0}})(t))||e){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(d){throw d},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a,o=!0,l=!1;return{s:function(){n=n.call(t)},n:function(){var d=n.next();return o=d.done,d},e:function(d){l=!0,a=d},f:function(){try{o||n.return==null||n.return()}finally{if(l)throw a}}}}function cs(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}var ve=new Map,st=null;function hl(t,e){var n=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=(function(d,h){if(d){if(typeof d=="string")return ls(d,h);var p={}.toString.call(d).slice(8,-1);return p==="Object"&&d.constructor&&(p=d.constructor.name),p==="Map"||p==="Set"?Array.from(d):p==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(p)?ls(d,h):void 0}})(t))||e){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(d){throw d},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a,o=!0,l=!1;return{s:function(){n=n.call(t)},n:function(){var d=n.next();return o=d.done,d},e:function(d){l=!0,a=d},f:function(){try{o||n.return==null||n.return()}finally{if(l)throw a}}}}function ls(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}var ye=new Map,wt=null;function fl(t){sa()?(function(e){ve.has(e)||(ve.set(e,{}),navigator.mediaDevices.enumerateDevices().then((function(n){ve.has(e)&&(ve.get(e).lastDevicesString=JSON.stringify(n),st||(st=(function(){var r=j((function*(){var i,a=yield navigator.mediaDevices.enumerateDevices(),o=dl(ve.keys());try{for(o.s();!(i=o.n()).done;){var l=i.value,d=JSON.stringify(a);d!==ve.get(l).lastDevicesString&&(ve.get(l).lastDevicesString=d,l(a))}}catch(h){o.e(h)}finally{o.f()}}));return function(){return r.apply(this,arguments)}})(),navigator.mediaDevices.addEventListener("devicechange",st)))})).catch((function(){})))})(t):(function(e){ye.has(e)||(ye.set(e,{}),navigator.mediaDevices.enumerateDevices().then((function(n){ye.has(e)&&(ye.get(e).lastDevicesString=JSON.stringify(n),wt||(wt=setInterval(j((function*(){var r,i=yield navigator.mediaDevices.enumerateDevices(),a=hl(ye.keys());try{for(a.s();!(r=a.n()).done;){var o=r.value,l=JSON.stringify(i);l!==ye.get(o).lastDevicesString&&(ye.get(o).lastDevicesString=l,o(i))}}catch(d){a.e(d)}finally{a.f()}})),3e3)))})))})(t)}function pl(t){sa()?(function(e){ve.has(e)&&(ve.delete(e),ve.size===0&&st&&(navigator.mediaDevices.removeEventListener("devicechange",st),st=null))})(t):(function(e){ye.has(e)&&(ye.delete(e),ye.size===0&&wt&&(clearInterval(wt),wt=null))})(t)}function sa(){var t;return F()||((t=navigator.mediaDevices)===null||t===void 0?void 0:t.ondevicechange)!==void 0}var gl=new Set;function ml(t,e){return t&&t.readyState==="live"&&!(function(n,r){return n.muted&&!gl.has(n.id)})(t)}function us(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable}))),n.push.apply(n,r)}return n}function Ae(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?us(Object(n),!0).forEach((function(r){be(t,r,n[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):us(Object(n)).forEach((function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))}))}return t}var _t=Object.freeze({VIDEO:"video",AUDIO:"audio",SCREEN_VIDEO:"screenVideo",SCREEN_AUDIO:"screenAudio",CUSTOM_VIDEO:"customVideo",CUSTOM_AUDIO:"customAudio"}),vl=Object.freeze({PARTICIPANTS:"participants",STREAMING:"streaming",TRANSCRIPTION:"transcription"}),kt=Object.values(_t),ds=["v","a","sv","sa","cv","ca"];Object.freeze(kt.reduce((function(t,e,n){return t[e]=ds[n],t}),{})),Object.freeze(ds.reduce((function(t,e,n){return t[e]=kt[n],t}),{}));var yl=[_t.VIDEO,_t.AUDIO,_t.SCREEN_VIDEO,_t.SCREEN_AUDIO],hs=Object.values(vl),fs=["p","s","t"];Object.freeze(hs.reduce((function(t,e,n){return t[e]=fs[n],t}),{})),Object.freeze(fs.reduce((function(t,e,n){return t[e]=hs[n],t}),{}));var aa=(function(){function t(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=e.base,r=e.byUserId,i=e.byParticipantId;ie(this,t),this.base=n,this.byUserId=r,this.byParticipantId=i}return se(t,[{key:"clone",value:function(){var e=new t;if(this.base instanceof G?e.base=this.base.clone():e.base=this.base,this.byUserId!==void 0)for(var n in e.byUserId={},this.byUserId){var r=this.byUserId[n];e.byUserId[n]=r instanceof G?r.clone():r}if(this.byParticipantId!==void 0)for(var i in e.byParticipantId={},this.byParticipantId){var a=this.byParticipantId[i];e.byParticipantId[i]=a instanceof G?a.clone():a}return e}},{key:"toJSONObject",value:function(){var e={};if(typeof this.base=="boolean"?e.base=this.base:this.base instanceof G&&(e.base=this.base.toJSONObject()),this.byUserId!==void 0)for(var n in e.byUserId={},this.byUserId){var r=this.byUserId[n];e.byUserId[n]=r instanceof G?r.toJSONObject():r}if(this.byParticipantId!==void 0)for(var i in e.byParticipantId={},this.byParticipantId){var a=this.byParticipantId[i];e.byParticipantId[i]=a instanceof G?a.toJSONObject():a}return e}},{key:"toMinifiedJSONObject",value:function(){var e={};if(this.base!==void 0&&(typeof this.base=="boolean"?e.b=this.base:e.b=this.base.toMinifiedJSONObject()),this.byUserId!==void 0)for(var n in e.u={},this.byUserId){var r=this.byUserId[n];e.u[n]=typeof r=="boolean"?r:r.toMinifiedJSONObject()}if(this.byParticipantId!==void 0)for(var i in e.p={},this.byParticipantId){var a=this.byParticipantId[i];e.p[i]=typeof a=="boolean"?a:a.toMinifiedJSONObject()}return e}},{key:"normalize",value:function(){return this.base instanceof G&&(this.base=this.base.normalize()),this.byUserId&&(this.byUserId=Object.fromEntries(Object.entries(this.byUserId).map((function(e){var n=Y(e,2),r=n[0],i=n[1];return[r,i instanceof G?i.normalize():i]})))),this.byParticipantId&&(this.byParticipantId=Object.fromEntries(Object.entries(this.byParticipantId).map((function(e){var n=Y(e,2),r=n[0],i=n[1];return[r,i instanceof G?i.normalize():i]})))),this}}],[{key:"fromJSONObject",value:function(e){var n,r,i;if(e.base!==void 0&&(n=typeof e.base=="boolean"?e.base:G.fromJSONObject(e.base)),e.byUserId!==void 0)for(var a in r={},e.byUserId){var o=e.byUserId[a];r[a]=typeof o=="boolean"?o:G.fromJSONObject(o)}if(e.byParticipantId!==void 0)for(var l in i={},e.byParticipantId){var d=e.byParticipantId[l];i[l]=typeof d=="boolean"?d:G.fromJSONObject(d)}return new t({base:n,byUserId:r,byParticipantId:i})}},{key:"fromMinifiedJSONObject",value:function(e){var n,r,i;if(e.b!==void 0&&(n=typeof e.b=="boolean"?e.b:G.fromMinifiedJSONObject(e.b)),e.u!==void 0)for(var a in r={},e.u){var o=e.u[a];r[a]=typeof o=="boolean"?o:G.fromMinifiedJSONObject(o)}if(e.p!==void 0)for(var l in i={},e.p){var d=e.p[l];i[l]=typeof d=="boolean"?d:G.fromMinifiedJSONObject(d)}return new t({base:n,byUserId:r,byParticipantId:i})}},{key:"validateJSONObject",value:function(e){if(U(e)!=="object")return[!1,"canReceive must be an object"];for(var n=["base","byUserId","byParticipantId"],r=0,i=Object.keys(e);r<i.length;r++){var a=i[r];if(!n.includes(a))return[!1,"canReceive can only contain keys (".concat(n.join(", "),")")];if(a==="base"){var o=Y(G.validateJSONObject(e.base,!0),2),l=o[0],d=o[1];if(!l)return[!1,d]}else{if(U(e[a])!=="object")return[!1,"invalid (non-object) value for field '".concat(a,"' in canReceive")];for(var h=0,p=Object.values(e[a]);h<p.length;h++){var v=p[h],E=Y(G.validateJSONObject(v),2),C=E[0],b=E[1];if(!C)return[!1,b]}}}return[!0]}}])})(),G=(function(){function t(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=e.video,r=e.audio,i=e.screenVideo,a=e.screenAudio,o=e.customVideo,l=e.customAudio;ie(this,t),this.video=n,this.audio=r,this.screenVideo=i,this.screenAudio=a,this.customVideo=o,this.customAudio=l}return se(t,[{key:"clone",value:function(){var e=new t;return this.video!==void 0&&(e.video=this.video),this.audio!==void 0&&(e.audio=this.audio),this.screenVideo!==void 0&&(e.screenVideo=this.screenVideo),this.screenAudio!==void 0&&(e.screenAudio=this.screenAudio),this.customVideo!==void 0&&(e.customVideo=Ae({},this.customVideo)),this.customAudio!==void 0&&(e.customAudio=Ae({},this.customAudio)),e}},{key:"toJSONObject",value:function(){var e={};return this.video!==void 0&&(e.video=this.video),this.audio!==void 0&&(e.audio=this.audio),this.screenVideo!==void 0&&(e.screenVideo=this.screenVideo),this.screenAudio!==void 0&&(e.screenAudio=this.screenAudio),this.customVideo!==void 0&&(e.customVideo=Ae({},this.customVideo)),this.customAudio!==void 0&&(e.customAudio=Ae({},this.customAudio)),e}},{key:"toMinifiedJSONObject",value:function(){var e={};return this.video!==void 0&&(e.v=this.video),this.audio!==void 0&&(e.a=this.audio),this.screenVideo!==void 0&&(e.sv=this.screenVideo),this.screenAudio!==void 0&&(e.sa=this.screenAudio),this.customVideo!==void 0&&(e.cv=Ae({},this.customVideo)),this.customAudio!==void 0&&(e.ca=Ae({},this.customAudio)),e}},{key:"normalize",value:function(){function e(n,r){return n&&Object.keys(n).length===1&&n["*"]===r}return!(this.video!==!0||this.audio!==!0||this.screenVideo!==!0||this.screenAudio!==!0||!e(this.customVideo,!0)||!e(this.customAudio,!0))||(this.video!==!1||this.audio!==!1||this.screenVideo!==!1||this.screenAudio!==!1||!e(this.customVideo,!1)||!e(this.customAudio,!1))&&this}}],[{key:"fromBoolean",value:function(e){return new t({video:e,audio:e,screenVideo:e,screenAudio:e,customVideo:{"*":e},customAudio:{"*":e}})}},{key:"fromJSONObject",value:function(e){return new t({video:e.video,audio:e.audio,screenVideo:e.screenVideo,screenAudio:e.screenAudio,customVideo:e.customVideo!==void 0?Ae({},e.customVideo):void 0,customAudio:e.customAudio!==void 0?Ae({},e.customAudio):void 0})}},{key:"fromMinifiedJSONObject",value:function(e){return new t({video:e.v,audio:e.a,screenVideo:e.sv,screenAudio:e.sa,customVideo:e.cv,customAudio:e.ca})}},{key:"validateJSONObject",value:function(e,n){if(typeof e=="boolean")return[!0];if(U(e)!=="object")return[!1,"invalid (non-object, non-boolean) value in canReceive"];for(var r=Object.keys(e),i=0,a=r;i<a.length;i++){var o=a[i];if(!kt.includes(o))return[!1,"invalid media type '".concat(o,"' in canReceive")];if(yl.includes(o)){if(typeof e[o]!="boolean")return[!1,"invalid (non-boolean) value for media type '".concat(o,"' in canReceive")]}else{if(U(e[o])!=="object")return[!1,"invalid (non-object) value for media type '".concat(o,"' in canReceive")];for(var l=0,d=Object.values(e[o]);l<d.length;l++)if(typeof d[l]!="boolean")return[!1,"invalid (non-boolean) value for entry within '".concat(o,"' in canReceive")];if(n&&e[o]["*"]===void 0)return[!1,`canReceive "base" permission must specify "*" as an entry within '`.concat(o,"'")]}}return n&&r.length!==kt.length?[!1,'canReceive "base" permission must specify all media types: '.concat(kt.join(", ")," (or be set to a boolean shorthand)")]:[!0]}}])})(),bl=["result"],_l=["preserveIframe"];function ps(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable}))),n.push.apply(n,r)}return n}function P(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?ps(Object(n),!0).forEach((function(r){be(t,r,n[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ps(Object(n)).forEach((function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))}))}return t}function oa(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch{}return(oa=function(){return!!t})()}function gs(t,e){var n=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=(function(d,h){if(d){if(typeof d=="string")return ms(d,h);var p={}.toString.call(d).slice(8,-1);return p==="Object"&&d.constructor&&(p=d.constructor.name),p==="Map"||p==="Set"?Array.from(d):p==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(p)?ms(d,h):void 0}})(t))||e){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(d){throw d},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a,o=!0,l=!1;return{s:function(){n=n.call(t)},n:function(){var d=n.next();return o=d.done,d},e:function(d){l=!0,a=d},f:function(){try{o||n.return==null||n.return()}finally{if(l)throw a}}}}function ms(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}var Fe={},vs="video",wl="voice",ys=F()?{data:{}}:{data:{},topology:"none"},bs={present:0,hidden:0},ca={maxBitrate:{min:1e5,max:25e5},maxFramerate:{min:1,max:30},scaleResolutionDownBy:{min:1,max:8}},Pn=Object.keys(ca),_s=["state","volume","simulcastEncodings"],ws={androidInCallNotification:{title:"string",subtitle:"string",iconName:"string",disableForCustomOverride:"boolean"},disableAutoDeviceManagement:{audio:"boolean",video:"boolean"}},nn={id:{iconPath:"string",iconPathDarkMode:"string",label:"string",tooltip:"string",visualState:"'default' | 'sidebar-open' | 'active'"}},nr={id:{allow:"string",controlledBy:"'*' | 'owners' | string[]",csp:"string",iconURL:"string",label:"string",loading:"'eager' | 'lazy'",location:"'main' | 'sidebar'",name:"string",referrerPolicy:"string",sandbox:"string",src:"string",srcdoc:"string",shared:"string[] | 'owners' | boolean"}},Be={customIntegrations:{validate:ma,help:pa()},customTrayButtons:{validate:ga,help:"customTrayButtons should be a dictionary of the type ".concat(JSON.stringify(nn))},url:{validate:function(t){return typeof t=="string"},help:"url should be a string"},baseUrl:{validate:function(t){return typeof t=="string"},help:"baseUrl should be a string"},token:{validate:function(t){return typeof t=="string"},help:"token should be a string",queryString:"t"},dailyConfig:{validate:function(t,e){try{return e.validateDailyConfig(t),!0}catch(n){console.error("Failed to validate dailyConfig",n)}return!1},help:"Unsupported dailyConfig. Check error logs for detailed info."},reactNativeConfig:{validate:function(t){return va(t,ws)},help:"reactNativeConfig should look like ".concat(JSON.stringify(ws),", all fields optional")},lang:{validate:function(t){return["da","de","en-us","en","es","fi","fr","it","jp","ka","nl","no","pl","pt","pt-BR","ru","sv","tr","user"].includes(t)},help:"language not supported. Options are: da, de, en-us, en, es, fi, fr, it, jp, ka, nl, no, pl, pt, pt-BR, ru, sv, tr, user"},userName:!0,userData:{validate:function(t){try{return la(t),!0}catch(e){return console.error(e),!1}},help:"invalid userData type provided"},startVideoOff:!0,startAudioOff:!0,allowLocalVideo:!0,allowLocalAudio:!0,activeSpeakerMode:!0,showLeaveButton:!0,showLocalVideo:!0,showParticipantsBar:!0,showFullscreenButton:!0,showUserNameChangeUI:!0,iframeStyle:!0,customLayout:!0,cssFile:!0,cssText:!0,bodyClass:!0,videoSource:{validate:function(t,e){if(typeof t=="boolean")return e._preloadCache.allowLocalVideo=t,!0;var n;if(t instanceof MediaStreamTrack)e._sharedTracks.videoTrack=t,n={customTrack:Ce};else{if(delete e._sharedTracks.videoTrack,typeof t!="string")return console.error("videoSource must be a MediaStreamTrack, boolean, or a string"),!1;n={deviceId:t}}return e._updatePreloadCacheInputSettings({video:{settings:n}},!1),!0}},audioSource:{validate:function(t,e){if(typeof t=="boolean")return e._preloadCache.allowLocalAudio=t,!0;var n;if(t instanceof MediaStreamTrack)e._sharedTracks.audioTrack=t,n={customTrack:Ce};else{if(delete e._sharedTracks.audioTrack,typeof t!="string")return console.error("audioSource must be a MediaStreamTrack, boolean, or a string"),!1;n={deviceId:t}}return e._updatePreloadCacheInputSettings({audio:{settings:n}},!1),!0}},subscribeToTracksAutomatically:{validate:function(t,e){return e._preloadCache.subscribeToTracksAutomatically=t,!0}},theme:{validate:function(t){var e=["accent","accentText","background","backgroundAccent","baseText","border","mainAreaBg","mainAreaBgAccent","mainAreaText","supportiveText"],n=function(r){for(var i=0,a=Object.keys(r);i<a.length;i++){var o=a[i];if(!e.includes(o))return console.error('unsupported color "'.concat(o,'". Valid colors: ').concat(e.join(", "))),!1;if(!r[o].match(/^#[0-9a-f]{6}|#[0-9a-f]{3}$/i))return console.error("".concat(o,' theme color should be provided in valid hex color format. Received: "').concat(r[o],'"')),!1}return!0};return U(t)==="object"&&("light"in t&&"dark"in t||"colors"in t)?"light"in t&&"dark"in t?"colors"in t.light?"colors"in t.dark?n(t.light.colors)&&n(t.dark.colors):(console.error('Dark theme is missing "colors" property.',t),!1):(console.error('Light theme is missing "colors" property.',t),!1):n(t.colors):(console.error('Theme must contain either both "light" and "dark" properties, or "colors".',t),!1)},help:"unsupported theme configuration. Check error logs for detailed info."},layoutConfig:{validate:function(t){if("grid"in t){var e=t.grid;if("maxTilesPerPage"in e){if(!Number.isInteger(e.maxTilesPerPage))return console.error("grid.maxTilesPerPage should be an integer. You passed ".concat(e.maxTilesPerPage,".")),!1;if(e.maxTilesPerPage>49)return console.error("grid.maxTilesPerPage can't be larger than 49 without sacrificing browser performance. Please contact us at https://www.daily.co/contact to talk about your use case."),!1}if("minTilesPerPage"in e){if(!Number.isInteger(e.minTilesPerPage))return console.error("grid.minTilesPerPage should be an integer. You passed ".concat(e.minTilesPerPage,".")),!1;if(e.minTilesPerPage<1)return console.error("grid.minTilesPerPage can't be lower than 1."),!1;if("maxTilesPerPage"in e&&e.minTilesPerPage>e.maxTilesPerPage)return console.error("grid.minTilesPerPage can't be higher than grid.maxTilesPerPage."),!1}}return!0},help:"unsupported layoutConfig. Check error logs for detailed info."},receiveSettings:{validate:function(t){return ua(t,{allowAllParticipantsKey:!1})},help:fa({allowAllParticipantsKey:!1})},sendSettings:{validate:function(t,e){return!!(function(n,r){try{return r.validateUpdateSendSettings(n),!0}catch(i){return console.error("Failed to validate send settings",i),!1}})(t,e)&&(e._preloadCache.sendSettings=t,!0)},help:"Invalid sendSettings provided. Check error logs for detailed info."},inputSettings:{validate:function(t,e){var n;return!!da(t)&&(e._inputSettings||(e._inputSettings={}),ha(t,(n=e.properties)===null||n===void 0?void 0:n.dailyConfig,e._sharedTracks),e._updatePreloadCacheInputSettings(t,!0),!0)},help:rr()},layout:{validate:function(t){return t==="custom-v1"||t==="browser"||t==="none"},help:'layout may only be set to "custom-v1"',queryString:"layout"},emb:{queryString:"emb"},embHref:{queryString:"embHref"},dailyJsVersion:{queryString:"dailyJsVersion"},proxy:{queryString:"proxy"},strictMode:!0,allowMultipleCallInstances:!0},Vt={styles:{validate:function(t){for(var e in t)if(e!=="cam"&&e!=="screen")return!1;if(t.cam){for(var n in t.cam)if(n!=="div"&&n!=="video")return!1}if(t.screen){for(var r in t.screen)if(r!=="div"&&r!=="video")return!1}return!0},help:"styles format should be a subset of: { cam: {div: {}, video: {}}, screen: {div: {}, video: {}} }"},setSubscribedTracks:{validate:function(t,e){if(e._preloadCache.subscribeToTracksAutomatically)return!1;var n=[!0,!1,"staged"];if(n.includes(t)||!F()&&t==="avatar")return!0;var r=["audio","video","screenAudio","screenVideo","rmpAudio","rmpVideo"],i=function(a){var o=arguments.length>1&&arguments[1]!==void 0&&arguments[1];for(var l in a)if(l==="custom"){if(!n.includes(a[l])&&!i(a[l],!0))return!1}else{var d=!o&&!r.includes(l),h=!n.includes(a[l]);if(d||h)return!1}return!0};return i(t)},help:"setSubscribedTracks cannot be used when setSubscribeToTracksAutomatically is enabled, and should be of the form: "+"true".concat(F()?"":" | 'avatar'"," | false | 'staged' | { [audio: true|false|'staged'], [video: true|false|'staged'], [screenAudio: true|false|'staged'], [screenVideo: true|false|'staged'] }")},setAudio:!0,setVideo:!0,setScreenShare:{validate:function(t){return t===!1},help:"setScreenShare must be false, as it's only meant for stopping remote participants' screen shares"},eject:!0,updatePermissions:{validate:function(t){for(var e=0,n=Object.entries(t);e<n.length;e++){var r=Y(n[e],2),i=r[0],a=r[1];switch(i){case"hasPresence":if(typeof a!="boolean")return!1;break;case"canSend":if(a instanceof Set||a instanceof Array||Array.isArray(a)){var o,l=["video","audio","screenVideo","screenAudio","customVideo","customAudio"],d=gs(a);try{for(d.s();!(o=d.n()).done;){var h=o.value;if(!l.includes(h))return!1}}catch(w){d.e(w)}finally{d.f()}}else if(typeof a!="boolean")return!1;(a instanceof Array||Array.isArray(a))&&(t.canSend=new Set(a));break;case"canReceive":var p=Y(aa.validateJSONObject(a),2),v=p[0],E=p[1];if(!v)return console.error(E),!1;break;case"canAdmin":if(a instanceof Set||a instanceof Array||Array.isArray(a)){var C,b=["participants","streaming","transcription"],m=gs(a);try{for(m.s();!(C=m.n()).done;){var _=C.value;if(!b.includes(_))return!1}}catch(w){m.e(w)}finally{m.f()}}else if(typeof a!="boolean")return!1;(a instanceof Array||Array.isArray(a))&&(t.canAdmin=new Set(a));break;default:return!1}}return!0},help:"updatePermissions can take hasPresence, canSend, canReceive, and canAdmin permissions. hasPresence must be a boolean. canSend can be a boolean or an Array or Set of media types (video, audio, screenVideo, screenAudio, customVideo, customAudio). canReceive must be an object specifying base, byUserId, and/or byParticipantId fields (see documentation for more details). canAdmin can be a boolean or an Array or Set of admin types (participants, streaming, transcription)."}};Promise.any||(Promise.any=(function(){var t=j((function*(e){return new Promise((function(n,r){var i=[];e.forEach((function(a){return Promise.resolve(a).then((function(o){n(o)})).catch((function(o){i.push(o),i.length===e.length&&r(i)}))}))}))}));return function(e){return t.apply(this,arguments)}})());var kl=(function(){function t(s){var u,c,f,g,y,S,M=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(ie(this,t),f=this,g=ge(g=t),be(c=sn(f,oa()?Reflect.construct(g,[],ge(f).constructor):g.apply(f,y)),"startListeningForDeviceChanges",(function(){fl(c.handleDeviceChange)})),be(c,"stopListeningForDeviceChanges",(function(){pl(c.handleDeviceChange)})),be(c,"handleDeviceChange",(function(D){D=D.map((function(B){return JSON.parse(JSON.stringify(B))})),c.emitDailyJSEvent({action:"available-devices-updated",availableDevices:D})})),be(c,"handleNativeAppStateChange",(function(){var D=j((function*(B){if(B==="destroyed")return console.warn("App has been destroyed before leaving the meeting. Cleaning up all the resources!"),void(yield c.destroy());var me=B==="active";c.disableReactNativeAutoDeviceManagement("video")||(me?c.camUnmutedBeforeLosingNativeActiveState&&c.setLocalVideo(!0):(c.camUnmutedBeforeLosingNativeActiveState=c.localVideo(),c.camUnmutedBeforeLosingNativeActiveState&&c.setLocalVideo(!1)))}));return function(B){return D.apply(this,arguments)}})()),be(c,"handleNativeAudioFocusChange",(function(D){c.disableReactNativeAutoDeviceManagement("audio")||(c._hasNativeAudioFocus=D,c.toggleParticipantAudioBasedOnNativeAudioFocus(),c._hasNativeAudioFocus?c.micUnmutedBeforeLosingNativeAudioFocus&&c.setLocalAudio(!0):(c.micUnmutedBeforeLosingNativeAudioFocus=c.localAudio(),c.setLocalAudio(!1)))})),be(c,"handleNativeSystemScreenCaptureStop",(function(){c.stopScreenShare()})),!Tn()&&!F())throw new Error("WebRTC not supported or suppressed");if(c.strictMode=M.strictMode===void 0||M.strictMode,c.allowMultipleCallInstances=(u=M.allowMultipleCallInstances)!==null&&u!==void 0&&u,Object.keys(Fe).length&&(c._logDuplicateInstanceAttempt(),!c.allowMultipleCallInstances)){if(c.strictMode)throw new Error("Duplicate DailyIframe instances are not allowed");console.warn("Using strictMode: false to allow multiple call instances is now deprecated. Set `allowMultipleCallInstances: true`")}if(window._daily||(window._daily={pendings:[],instances:{}}),c.callClientId=on(),Fe[(S=c).callClientId]=S,window._daily.instances[c.callClientId]={},c._sharedTracks={},window._daily.instances[c.callClientId].tracks=c._sharedTracks,M.dailyJsVersion=t.version(),c._iframe=s,c._callObjectMode=M.layout==="none"&&!c._iframe,c._preloadCache={subscribeToTracksAutomatically:!0,outputDeviceId:null,inputSettings:null,sendSettings:null,videoTrackForNetworkConnectivityTest:null,videoTrackForConnectionQualityTest:null},M.showLocalVideo!==void 0?c._callObjectMode?console.error("showLocalVideo is not available in call object mode"):c._showLocalVideo=!!M.showLocalVideo:c._showLocalVideo=!0,M.showParticipantsBar!==void 0?c._callObjectMode?console.error("showParticipantsBar is not available in call object mode"):c._showParticipantsBar=!!M.showParticipantsBar:c._showParticipantsBar=!0,M.customIntegrations!==void 0?c._callObjectMode?console.error("customIntegrations is not available in call object mode"):c._customIntegrations=M.customIntegrations:c._customIntegrations={},M.customTrayButtons!==void 0?c._callObjectMode?console.error("customTrayButtons is not available in call object mode"):c._customTrayButtons=M.customTrayButtons:c._customTrayButtons={},M.activeSpeakerMode!==void 0?c._callObjectMode?console.error("activeSpeakerMode is not available in call object mode"):c._activeSpeakerMode=!!M.activeSpeakerMode:c._activeSpeakerMode=!1,M.receiveSettings?c._callObjectMode?c._receiveSettings=M.receiveSettings:console.error("receiveSettings is only available in call object mode"):c._receiveSettings={},c.validateProperties(M),c.properties=P({},M),c._inputSettings||(c._inputSettings={}),c._callObjectLoader=c._callObjectMode?new nl(c.callClientId):null,c._callState=Fi,c._isPreparingToJoin=!1,c._accessState={access:Sn},c._meetingSessionSummary={},c._finalSummaryOfPrevSession={},c._meetingSessionState=jn(ys,c._callObjectMode),c._nativeInCallAudioMode=vs,c._participants={},c._isScreenSharing=!1,c._participantCounts=bs,c._rmpPlayerState={},c._waitingParticipants={},c._network={threshold:"good",quality:100,networkState:"unknown",stats:{}},c._activeSpeaker={},c._localAudioLevel=0,c._isLocalAudioLevelObserverRunning=!1,c._remoteParticipantsAudioLevel={},c._isRemoteParticipantsAudioLevelObserverRunning=!1,c._maxAppMessageSize=Cn,c._messageChannel=F()?new el:new Zc,c._iframe&&(c._iframe.requestFullscreen?c._iframe.addEventListener("fullscreenchange",(function(){document.fullscreenElement===c._iframe?(c.emitDailyJSEvent({action:Ft}),c.sendMessageToCallMachine({action:Ft})):(c.emitDailyJSEvent({action:Bt}),c.sendMessageToCallMachine({action:Bt}))})):c._iframe.webkitRequestFullscreen&&c._iframe.addEventListener("webkitfullscreenchange",(function(){document.webkitFullscreenElement===c._iframe?(c.emitDailyJSEvent({action:Ft}),c.sendMessageToCallMachine({action:Ft})):(c.emitDailyJSEvent({action:Bt}),c.sendMessageToCallMachine({action:Bt}))}))),F()){var O=c.nativeUtils();O.addAudioFocusChangeListener&&O.removeAudioFocusChangeListener&&O.addAppStateChangeListener&&O.removeAppStateChangeListener&&O.addSystemScreenCaptureStopListener&&O.removeSystemScreenCaptureStopListener||console.warn("expected (add|remove)(AudioFocusChange|AppActiveStateChange|SystemScreenCaptureStop)Listener to be available in React Native"),c._hasNativeAudioFocus=!0,O.addAudioFocusChangeListener(c.handleNativeAudioFocusChange),O.addAppStateChangeListener(c.handleNativeAppStateChange),O.addSystemScreenCaptureStopListener(c.handleNativeSystemScreenCaptureStop)}return c._callObjectMode&&c.startListeningForDeviceChanges(),c._messageChannel.addListenerForMessagesFromCallMachine(c.handleMessageFromCallMachine,c.callClientId,c),c}return an(t,Pt),se(t,[{key:"destroy",value:(Pr=j((function*(){var s;try{yield this.leave()}catch{}var u=this._iframe;if(u){var c=u.parentElement;c&&c.removeChild(u)}if(this._messageChannel.removeListener(this.handleMessageFromCallMachine),F()){var f=this.nativeUtils();f.removeAudioFocusChangeListener(this.handleNativeAudioFocusChange),f.removeAppStateChangeListener(this.handleNativeAppStateChange),f.removeSystemScreenCaptureStopListener(this.handleNativeSystemScreenCaptureStop)}this._callObjectMode&&this.stopListeningForDeviceChanges(),this.resetMeetingDependentVars(),this._destroyed=!0,this.emitDailyJSEvent({action:"call-instance-destroyed"}),delete Fe[this.callClientId],!((s=window)===null||s===void 0||(s=s._daily)===null||s===void 0)&&s.instances&&delete window._daily.instances[this.callClientId],this.strictMode&&(this.callClientId=void 0)})),function(){return Pr.apply(this,arguments)})},{key:"isDestroyed",value:function(){return!!this._destroyed}},{key:"loadCss",value:function(s){var u=s.bodyClass,c=s.cssFile,f=s.cssText;return N(),this.sendMessageToCallMachine({action:"load-css",cssFile:this.absoluteUrl(c),bodyClass:u,cssText:f}),this}},{key:"iframe",value:function(){return N(),this._iframe}},{key:"meetingState",value:function(){return this._callState}},{key:"accessState",value:function(){return de(this._callObjectMode,"accessState()"),this._accessState}},{key:"participants",value:function(){return this._participants}},{key:"participantCounts",value:function(){return this._participantCounts}},{key:"waitingParticipants",value:function(){return de(this._callObjectMode,"waitingParticipants()"),this._waitingParticipants}},{key:"validateParticipantProperties",value:function(s,u){for(var c in u){if(!Vt[c])throw new Error("unrecognized updateParticipant property ".concat(c));if(Vt[c].validate&&!Vt[c].validate(u[c],this,this._participants[s]))throw new Error(Vt[c].help)}}},{key:"updateParticipant",value:function(s,u){return this._participants.local&&this._participants.local.session_id===s&&(s="local"),s&&u&&(this.validateParticipantProperties(s,u),this.sendMessageToCallMachine({action:"update-participant",id:s,properties:u})),this}},{key:"updateParticipants",value:function(s){var u=this._participants.local&&this._participants.local.session_id;for(var c in s)c===u&&(c="local"),c&&s[c]&&this.validateParticipantProperties(c,s[c]);return this.sendMessageToCallMachine({action:"update-participants",participants:s}),this}},{key:"updateWaitingParticipant",value:(Or=j((function*(){var s=this,u=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(de(this._callObjectMode,"updateWaitingParticipant()"),J(this._callState,"updateWaitingParticipant()"),typeof u!="string"||U(c)!=="object")throw new Error("updateWaitingParticipant() must take an id string and a updates object");return new Promise((function(f,g){s.sendMessageToCallMachine({action:"daily-method-update-waiting-participant",id:u,updates:c},(function(y){y.error&&g(y.error),y.id||g(new Error("unknown error in updateWaitingParticipant()")),f({id:y.id})}))}))})),function(){return Or.apply(this,arguments)})},{key:"updateWaitingParticipants",value:(Ar=j((function*(){var s=this,u=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(de(this._callObjectMode,"updateWaitingParticipants()"),J(this._callState,"updateWaitingParticipants()"),U(u)!=="object")throw new Error("updateWaitingParticipants() must take a mapping between ids and update objects");return new Promise((function(c,f){s.sendMessageToCallMachine({action:"daily-method-update-waiting-participants",updatesById:u},(function(g){g.error&&f(g.error),g.ids||f(new Error("unknown error in updateWaitingParticipants()")),c({ids:g.ids})}))}))})),function(){return Ar.apply(this,arguments)})},{key:"requestAccess",value:(Tr=j((function*(){var s=this,u=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},c=u.access,f=c===void 0?{level:Qo}:c,g=u.name,y=g===void 0?"":g;return de(this._callObjectMode,"requestAccess()"),J(this._callState,"requestAccess()"),new Promise((function(S,M){s.sendMessageToCallMachine({action:"daily-method-request-access",access:f,name:y},(function(O){O.error&&M(O.error),O.access||M(new Error("unknown error in requestAccess()")),S({access:O.access,granted:O.granted})}))}))})),function(){return Tr.apply(this,arguments)})},{key:"localAudio",value:function(){return this._participants.local?!["blocked","off"].includes(this._participants.local.tracks.audio.state):null}},{key:"localVideo",value:function(){return this._participants.local?!["blocked","off"].includes(this._participants.local.tracks.video.state):null}},{key:"setLocalAudio",value:function(s){var u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return"forceDiscardTrack"in u&&(F()?(console.warn("forceDiscardTrack option not supported in React Native; ignoring"),u={}):s&&(console.warn("forceDiscardTrack option only supported when calling setLocalAudio(false); ignoring"),u={})),this.sendMessageToCallMachine({action:"local-audio",state:s,options:u}),this}},{key:"localScreenAudio",value:function(){return this._participants.local?!["blocked","off"].includes(this._participants.local.tracks.screenAudio.state):null}},{key:"localScreenVideo",value:function(){return this._participants.local?!["blocked","off"].includes(this._participants.local.tracks.screenVideo.state):null}},{key:"updateScreenShare",value:function(s){if(this._isScreenSharing)return this.sendMessageToCallMachine({action:"local-screen-update",options:s}),this;console.warn("There is no screen share in progress. Try calling startScreenShare first.")}},{key:"setLocalVideo",value:function(s){return this.sendMessageToCallMachine({action:"local-video",state:s}),this}},{key:"_setAllowLocalAudio",value:function(s){if(this._preloadCache.allowLocalAudio=s,this._callMachineInitialized)return this.sendMessageToCallMachine({action:"set-allow-local-audio",state:s}),this}},{key:"_setAllowLocalVideo",value:function(s){if(this._preloadCache.allowLocalVideo=s,this._callMachineInitialized)return this.sendMessageToCallMachine({action:"set-allow-local-video",state:s}),this}},{key:"getReceiveSettings",value:(Er=j((function*(s){var u=this,c=(arguments.length>1&&arguments[1]!==void 0?arguments[1]:{}).showInheritedValues,f=c!==void 0&&c;if(de(this._callObjectMode,"getReceiveSettings()"),!this._callMachineInitialized)return this._receiveSettings;switch(U(s)){case"string":return new Promise((function(g){u.sendMessageToCallMachine({action:"get-single-participant-receive-settings",id:s,showInheritedValues:f},(function(y){g(y.receiveSettings)}))}));case"undefined":return this._receiveSettings;default:throw new Error('first argument to getReceiveSettings() must be a participant id (or "base"), or there should be no arguments')}})),function(s){return Er.apply(this,arguments)})},{key:"updateReceiveSettings",value:(Mr=j((function*(s){var u=this;if(de(this._callObjectMode,"updateReceiveSettings()"),!ua(s,{allowAllParticipantsKey:!0}))throw new Error(fa({allowAllParticipantsKey:!0}));return J(this._callState,"updateReceiveSettings()","To specify receive settings earlier, use the receiveSettings config property."),new Promise((function(c){u.sendMessageToCallMachine({action:"update-receive-settings",receiveSettings:s},(function(f){c({receiveSettings:f.receiveSettings})}))}))})),function(s){return Mr.apply(this,arguments)})},{key:"_prepInputSettingsForSharing",value:function(s,u){if(s){var c={};if(s.audio){var f,g,y;s.audio.settings&&(!Object.keys(s.audio.settings).length&&u||(c.audio={settings:P({},s.audio.settings)})),u&&(f=c.audio)!==null&&f!==void 0&&(f=f.settings)!==null&&f!==void 0&&f.customTrack&&(c.audio.settings={customTrack:this._sharedTracks.audioTrack});var S=((g=s.audio.processor)===null||g===void 0?void 0:g.type)==="none"&&((y=s.audio.processor)===null||y===void 0?void 0:y._isDefaultWhenNone);if(s.audio.processor&&!S){var M=P({},s.audio.processor);delete M._isDefaultWhenNone,c.audio=P(P({},c.audio),{},{processor:M})}}if(s.video){var O,D,B;s.video.settings&&(!Object.keys(s.video.settings).length&&u||(c.video={settings:P({},s.video.settings)})),u&&(O=c.video)!==null&&O!==void 0&&(O=O.settings)!==null&&O!==void 0&&O.customTrack&&(c.video.settings={customTrack:this._sharedTracks.videoTrack});var me=((D=s.video.processor)===null||D===void 0?void 0:D.type)==="none"&&((B=s.video.processor)===null||B===void 0?void 0:B._isDefaultWhenNone);if(s.video.processor&&!me){var Le=P({},s.video.processor);delete Le._isDefaultWhenNone,c.video=P(P({},c.video),{},{processor:Le})}}return c}}},{key:"getInputSettings",value:function(){var s=this;return N(),new Promise((function(u){u(s._getInputSettings())}))}},{key:"_getInputSettings",value:function(){var s,u,c,f,g,y,S={processor:{type:"none",_isDefaultWhenNone:!0}};this._inputSettings?(s=((c=this._inputSettings)===null||c===void 0?void 0:c.video)||S,u=((f=this._inputSettings)===null||f===void 0?void 0:f.audio)||S):(s=((g=this._preloadCache)===null||g===void 0||(g=g.inputSettings)===null||g===void 0?void 0:g.video)||S,u=((y=this._preloadCache)===null||y===void 0||(y=y.inputSettings)===null||y===void 0?void 0:y.audio)||S);var M={audio:u,video:s};return this._prepInputSettingsForSharing(M,!0)}},{key:"_updatePreloadCacheInputSettings",value:function(s,u){var c=this._inputSettings||{},f={};if(s.video){var g,y,S;f.video={},s.video.settings?(f.video.settings={},u||s.video.settings.customTrack||(S=c.video)===null||S===void 0||!S.settings?f.video.settings=s.video.settings:f.video.settings=P(P({},c.video.settings),s.video.settings),Object.keys(f.video.settings).length||delete f.video.settings):(g=c.video)!==null&&g!==void 0&&g.settings&&(f.video.settings=c.video.settings),s.video.processor?f.video.processor=s.video.processor:(y=c.video)!==null&&y!==void 0&&y.processor&&(f.video.processor=c.video.processor)}else c.video&&(f.video=c.video);if(s.audio){var M,O,D;f.audio={},s.audio.settings?(f.audio.settings={},u||s.audio.settings.customTrack||(D=c.audio)===null||D===void 0||!D.settings?f.audio.settings=s.audio.settings:f.audio.settings=P(P({},c.audio.settings),s.audio.settings),Object.keys(f.audio.settings).length||delete f.audio.settings):(M=c.audio)!==null&&M!==void 0&&M.settings&&(f.audio.settings=c.audio.settings),s.audio.processor?f.audio.processor=s.audio.processor:(O=c.audio)!==null&&O!==void 0&&O.processor&&(f.audio.processor=c.audio.processor)}else c.audio&&(f.audio=c.audio);this._maybeUpdateInputSettings(f)}},{key:"_devicesFromInputSettings",value:function(s){var u,c,f=(s==null||(u=s.video)===null||u===void 0||(u=u.settings)===null||u===void 0?void 0:u.deviceId)||null,g=(s==null||(c=s.audio)===null||c===void 0||(c=c.settings)===null||c===void 0?void 0:c.deviceId)||null,y=this._preloadCache.outputDeviceId||null;return{camera:f?{deviceId:f}:{},mic:g?{deviceId:g}:{},speaker:y?{deviceId:y}:{}}}},{key:"updateInputSettings",value:(Cr=j((function*(s){var u=this;return N(),da(s)?s.video||s.audio?(ha(s,this.properties.dailyConfig,this._sharedTracks),this._callObjectMode&&!this._callMachineInitialized?(this._updatePreloadCacheInputSettings(s,!0),this._getInputSettings()):new Promise((function(c,f){u.sendMessageToCallMachine({action:"update-input-settings",inputSettings:s},(function(g){if(g.error)f(g.error);else{if(g.returnPreloadCache)return u._updatePreloadCacheInputSettings(s,!0),void c(u._getInputSettings());u._maybeUpdateInputSettings(g.inputSettings),c(u._prepInputSettingsForSharing(g.inputSettings,!0))}}))}))):this._getInputSettings():(console.error(rr()),Promise.reject(rr()))})),function(s){return Cr.apply(this,arguments)})},{key:"setBandwidth",value:function(s){var u=s.kbs,c=s.trackConstraints;if(N(),this._callMachineInitialized)return this.sendMessageToCallMachine({action:"set-bandwidth",kbs:u,trackConstraints:c}),this}},{key:"getDailyLang",value:function(){var s=this;if(N(),this._callMachineInitialized)return new Promise((function(u){s.sendMessageToCallMachine({action:"get-daily-lang"},(function(c){delete c.action,delete c.callbackStamp,u(c)}))}))}},{key:"setDailyLang",value:function(s){return N(),this.sendMessageToCallMachine({action:"set-daily-lang",lang:s}),this}},{key:"setProxyUrl",value:function(s){return this.sendMessageToCallMachine({action:"set-proxy-url",proxyUrl:s}),this}},{key:"setIceConfig",value:function(s){return this.sendMessageToCallMachine({action:"set-ice-config",iceConfig:s}),this}},{key:"meetingSessionSummary",value:function(){return[Ne,Te].includes(this._callState)?this._finalSummaryOfPrevSession:this._meetingSessionSummary}},{key:"getMeetingSession",value:(Sr=j((function*(){var s=this;return console.warn("getMeetingSession() is deprecated: use meetingSessionSummary(), which will return immediately"),J(this._callState,"getMeetingSession()"),new Promise((function(u){s.sendMessageToCallMachine({action:"get-meeting-session"},(function(c){delete c.action,delete c.callbackStamp,u(c)}))}))})),function(){return Sr.apply(this,arguments)})},{key:"meetingSessionState",value:function(){return J(this._callState,"meetingSessionState"),this._meetingSessionState}},{key:"setMeetingSessionData",value:function(s){var u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"replace";de(this._callObjectMode,"setMeetingSessionData()"),J(this._callState,"setMeetingSessionData");try{(function(c,f){new tl({data:c,mergeStrategy:f})})(s,u)}catch(c){throw console.error(c),c}try{this.sendMessageToCallMachine({action:"set-session-data",data:s,mergeStrategy:u})}catch(c){throw new Error("Error setting meeting session data: ".concat(c))}}},{key:"setUserName",value:function(s,u){var c=this;return this.properties.userName=s,new Promise((function(f){c.sendMessageToCallMachine({action:"set-user-name",name:s??"",thisMeetingOnly:F()||!!u&&!!u.thisMeetingOnly},(function(g){delete g.action,delete g.callbackStamp,f(g)}))}))}},{key:"setUserData",value:(kr=j((function*(s){var u=this;try{la(s)}catch(c){throw console.error(c),c}if(this.properties.userData=s,this._callMachineInitialized)return new Promise((function(c){try{u.sendMessageToCallMachine({action:"set-user-data",userData:s},(function(f){delete f.action,delete f.callbackStamp,c(f)}))}catch(f){throw new Error("Error setting user data: ".concat(f))}}))})),function(s){return kr.apply(this,arguments)})},{key:"validateAudioLevelInterval",value:function(s){if(s&&(s<100||typeof s!="number"))throw new Error("The interval must be a number greater than or equal to 100 milliseconds.")}},{key:"startLocalAudioLevelObserver",value:function(s){var u=this;if(typeof AudioWorkletNode>"u"&&!F())throw new Error("startLocalAudioLevelObserver() is not supported on this browser");if(this.validateAudioLevelInterval(s),this._callMachineInitialized)return this._isLocalAudioLevelObserverRunning=!0,new Promise((function(c,f){u.sendMessageToCallMachine({action:"start-local-audio-level-observer",interval:s},(function(g){u._isLocalAudioLevelObserverRunning=!g.error,g.error?f({error:g.error}):c()}))}));this._preloadCache.localAudioLevelObserver={enabled:!0,interval:s}}},{key:"isLocalAudioLevelObserverRunning",value:function(){return this._isLocalAudioLevelObserverRunning}},{key:"stopLocalAudioLevelObserver",value:function(){this._preloadCache.localAudioLevelObserver=null,this._localAudioLevel=0,this._isLocalAudioLevelObserverRunning=!1,this.sendMessageToCallMachine({action:"stop-local-audio-level-observer"})}},{key:"startRemoteParticipantsAudioLevelObserver",value:function(s){var u=this;if(this.validateAudioLevelInterval(s),this._callMachineInitialized)return this._isRemoteParticipantsAudioLevelObserverRunning=!0,new Promise((function(c,f){u.sendMessageToCallMachine({action:"start-remote-participants-audio-level-observer",interval:s},(function(g){u._isRemoteParticipantsAudioLevelObserverRunning=!g.error,g.error?f({error:g.error}):c()}))}));this._preloadCache.remoteParticipantsAudioLevelObserver={enabled:!0,interval:s}}},{key:"isRemoteParticipantsAudioLevelObserverRunning",value:function(){return this._isRemoteParticipantsAudioLevelObserverRunning}},{key:"stopRemoteParticipantsAudioLevelObserver",value:function(){this._preloadCache.remoteParticipantsAudioLevelObserver=null,this._remoteParticipantsAudioLevel={},this._isRemoteParticipantsAudioLevelObserverRunning=!1,this.sendMessageToCallMachine({action:"stop-remote-participants-audio-level-observer"})}},{key:"startCamera",value:(wr=j((function*(){var s=this,u=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(de(this._callObjectMode,"startCamera()"),In(this._callState,this._isPreparingToJoin,"startCamera()","Did you mean to use setLocalAudio() and/or setLocalVideo() instead?"),this.needsLoad())try{yield this.load(u)}catch(c){return Promise.reject(c)}else{if(this._didPreAuth){if(u.url&&u.url!==this.properties.url)return console.error("url in startCamera() is different than the one used in preAuth()"),Promise.reject();if(u.token&&u.token!==this.properties.token)return console.error("token in startCamera() is different than the one used in preAuth()"),Promise.reject()}this.validateProperties(u),this.properties=P(P({},this.properties),u)}return new Promise((function(c){s._preloadCache.inputSettings=s._prepInputSettingsForSharing(s._inputSettings,!1),s.sendMessageToCallMachine({action:"start-camera",properties:nt(s.properties,s.callClientId),preloadCache:nt(s._preloadCache,s.callClientId)},(function(f){c({camera:f.camera,mic:f.mic,speaker:f.speaker})}))}))})),function(){return wr.apply(this,arguments)})},{key:"validateCustomTrack",value:function(s,u,c){if(c&&c.length>50)throw new Error("Custom track `trackName` must not be more than 50 characters");if(u&&u!=="music"&&u!=="speech"&&!(u instanceof Object))throw new Error("Custom track `mode` must be either `music` | `speech` | `DailyMicAudioModeSettings` or `undefined`");if(c&&["cam-audio","cam-video","screen-video","screen-audio","rmpAudio","rmpVideo","customVideoDefaults"].includes(c))throw new Error("Custom track `trackName` must not match a track name already used by daily: cam-audio, cam-video, customVideoDefaults, screen-video, screen-audio, rmpAudio, rmpVideo");if(!(s instanceof MediaStreamTrack))throw new Error("Custom tracks provided must be instances of MediaStreamTrack")}},{key:"startCustomTrack",value:function(){var s=this,u=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{track,mode,trackName,ignoreAudioLevel};return N(),J(this._callState,"startCustomTrack()"),this.validateCustomTrack(u.track,u.mode,u.trackName),new Promise((function(c,f){s._sharedTracks.customTrack=u.track,u.track=Ce,s.sendMessageToCallMachine({action:"start-custom-track",properties:u},(function(g){g.error?f({error:g.error}):c(g.mediaTag)}))}))}},{key:"stopCustomTrack",value:function(s){var u=this;return N(),J(this._callState,"stopCustomTrack()"),new Promise((function(c){u.sendMessageToCallMachine({action:"stop-custom-track",mediaTag:s},(function(f){c(f.mediaTag)}))}))}},{key:"setCamera",value:function(s){var u=this;return yt(),Jt(this._callMachineInitialized,"setCamera()"),new Promise((function(c){u.sendMessageToCallMachine({action:"set-camera",cameraDeviceId:s},(function(f){c({device:f.device})}))}))}},{key:"setAudioDevice",value:(_r=j((function*(s){return yt(),this.nativeUtils().setAudioDevice(s),{deviceId:yield this.nativeUtils().getAudioDevice()}})),function(s){return _r.apply(this,arguments)})},{key:"cycleCamera",value:function(){var s=this,u=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return new Promise((function(c){s.sendMessageToCallMachine({action:"cycle-camera",properties:u},(function(f){c({device:f.device})}))}))}},{key:"cycleMic",value:function(){var s=this;return N(),new Promise((function(u){s.sendMessageToCallMachine({action:"cycle-mic"},(function(c){u({device:c.device})}))}))}},{key:"getCameraFacingMode",value:function(){var s=this;return yt(),new Promise((function(u){s.sendMessageToCallMachine({action:"get-camera-facing-mode"},(function(c){u(c.facingMode)}))}))}},{key:"setInputDevicesAsync",value:(tt=j((function*(s){var u=this,c=s.audioDeviceId,f=s.videoDeviceId,g=s.audioSource,y=s.videoSource;if(N(),g!==void 0&&(c=g),y!==void 0&&(f=y),typeof c=="boolean"&&(this._setAllowLocalAudio(c),c=void 0),typeof f=="boolean"&&(this._setAllowLocalVideo(f),f=void 0),!c&&!f)return yield this.getInputDevices();var S={};return c&&(c instanceof MediaStreamTrack?(this._sharedTracks.audioTrack=c,c=Ce,S.audio={settings:{customTrack:c}}):(delete this._sharedTracks.audioTrack,S.audio={settings:{deviceId:c}})),f&&(f instanceof MediaStreamTrack?(this._sharedTracks.videoTrack=f,f=Ce,S.video={settings:{customTrack:f}}):(delete this._sharedTracks.videoTrack,S.video={settings:{deviceId:f}})),this._callObjectMode&&this.needsLoad()?(this._updatePreloadCacheInputSettings(S,!1),this._devicesFromInputSettings(this._inputSettings)):new Promise((function(M){u.sendMessageToCallMachine({action:"set-input-devices",audioDeviceId:c,videoDeviceId:f},(function(O){if(delete O.action,delete O.callbackStamp,O.returnPreloadCache)return u._updatePreloadCacheInputSettings(S,!1),void M(u._devicesFromInputSettings(u._inputSettings));M(O)}))}))})),function(s){return tt.apply(this,arguments)})},{key:"setOutputDeviceAsync",value:(et=j((function*(s){var u=this,c=s.outputDeviceId;if(N(),!c||typeof c!="string")throw new Error("outputDeviceId must be provided and must be a valid device id");return this._preloadCache.outputDeviceId=c,this._callObjectMode&&this.needsLoad()?this._devicesFromInputSettings(this._inputSettings):new Promise((function(f,g){u.sendMessageToCallMachine({action:"set-output-device",outputDeviceId:c},(function(y){if(delete y.action,delete y.callbackStamp,y.error){var S=new Error(y.error.message);return S.type=y.error.type,void g(S)}y.returnPreloadCache?f(u._devicesFromInputSettings(u._inputSettings)):f(y)}))}))})),function(s){return et.apply(this,arguments)})},{key:"getInputDevices",value:(Ze=j((function*(){var s=this;return this._callObjectMode&&this.needsLoad()?this._devicesFromInputSettings(this._inputSettings):new Promise((function(u){s.sendMessageToCallMachine({action:"get-input-devices"},(function(c){c.returnPreloadCache?u(s._devicesFromInputSettings(s._inputSettings)):u({camera:c.camera,mic:c.mic,speaker:c.speaker})}))}))})),function(){return Ze.apply(this,arguments)})},{key:"nativeInCallAudioMode",value:function(){return yt(),this._nativeInCallAudioMode}},{key:"setNativeInCallAudioMode",value:function(s){if(yt(),[vs,wl].includes(s)){if(s!==this._nativeInCallAudioMode)return this._nativeInCallAudioMode=s,!this.disableReactNativeAutoDeviceManagement("audio")&&Ht(this._callState,this._isPreparingToJoin)&&this.nativeUtils().setAudioMode(this._nativeInCallAudioMode),this}else console.error("invalid in-call audio mode specified: ",s)}},{key:"preAuth",value:(te=j((function*(){var s=this,u=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(de(this._callObjectMode,"preAuth()"),In(this._callState,this._isPreparingToJoin,"preAuth()"),this.needsLoad()&&(yield this.load(u)),!u.url)throw new Error("preAuth() requires at least a url to be provided");return this.validateProperties(u),this.properties=P(P({},this.properties),u),new Promise((function(c,f){s._preloadCache.inputSettings=s._prepInputSettingsForSharing(s._inputSettings,!1),s.sendMessageToCallMachine({action:"daily-method-preauth",properties:nt(s.properties,s.callClientId),preloadCache:nt(s._preloadCache,s.callClientId)},(function(g){return g.error?f(g.error):g.access?(s._didPreAuth=!0,void c({access:g.access})):f(new Error("unknown error in preAuth()"))}))}))})),function(){return te.apply(this,arguments)})},{key:"load",value:(z=j((function*(s){var u=this;if(this.needsLoad()){if(this._destroyed&&(this._logUseAfterDestroy(),this.strictMode))throw new Error("Use after destroy");if(s&&(this.validateProperties(s),this.properties=P(P({},this.properties),s)),!this._callObjectMode&&!this.properties.url)throw new Error("can't load iframe meeting because url property isn't set");return this._updateCallState(Bi),this.emitDailyJSEvent({action:tc}),this._callObjectMode?new Promise((function(c,f){u._callObjectLoader.cancel();var g=Date.now();u._callObjectLoader.load(u.properties.dailyConfig,(function(y){u._bundleLoadTime=y?"no-op":Date.now()-g,u._updateCallState(Ui),y&&u.emitDailyJSEvent({action:Vi}),c()}),(function(y,S){if(u.emitDailyJSEvent({action:nc}),!S){u._updateCallState(Te),u.resetMeetingDependentVars();var M={action:Hi,errorMsg:y.msg,error:{type:"connection-error",msg:"Failed to load call object bundle.",details:{on:"load",sourceError:y,bundleUrl:Qt(u.properties.dailyConfig)}}};u._maybeSendToSentry(M),u.emitDailyJSEvent(M),f(y.msg)}}))})):(this._iframe.src=Is(this.assembleMeetingUrl(),this.properties.dailyConfig),new Promise((function(c,f){u._loadedCallback=function(g){u._callState!==Te?(u._updateCallState(Ui),(u.properties.cssFile||u.properties.cssText)&&u.loadCss(u.properties),c()):f(g)}})))}})),function(s){return z.apply(this,arguments)})},{key:"join",value:(R=j((function*(){var s=this,u=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._testCallInProgress&&this.stopTestCallQuality();var c=!1;if(this.needsLoad()){this.updateIsPreparingToJoin(!0);try{yield this.load(u)}catch(f){return this.updateIsPreparingToJoin(!1),Promise.reject(f)}}else{if(c=!(!this.properties.cssFile&&!this.properties.cssText),this._didPreAuth){if(u.url&&u.url!==this.properties.url)return console.error("url in join() is different than the one used in preAuth()"),this.updateIsPreparingToJoin(!1),Promise.reject();if(u.token&&u.token!==this.properties.token)return console.error("token in join() is different than the one used in preAuth()"),this.updateIsPreparingToJoin(!1),Promise.reject()}if(u.url&&!this._callObjectMode&&u.url&&u.url!==this.properties.url)return console.error("url in join() is different than the one used in load() (".concat(this.properties.url," -> ").concat(u.url,")")),this.updateIsPreparingToJoin(!1),Promise.reject();this.validateProperties(u),this.properties=P(P({},this.properties),u)}return u.showLocalVideo!==void 0&&(this._callObjectMode?console.error("showLocalVideo is not available in callObject mode"):this._showLocalVideo=!!u.showLocalVideo),u.showParticipantsBar!==void 0&&(this._callObjectMode?console.error("showParticipantsBar is not available in callObject mode"):this._showParticipantsBar=!!u.showParticipantsBar),this._callState===$e||this._callState===Kn?(console.warn("already joined meeting, call leave() before joining again"),void this.updateIsPreparingToJoin(!1)):(this._updateCallState(Kn,!1),this.emitDailyJSEvent({action:sc}),this._preloadCache.inputSettings=this._prepInputSettingsForSharing(this._inputSettings||{},!1),this.sendMessageToCallMachine({action:"join-meeting",properties:nt(this.properties,this.callClientId),preloadCache:nt(this._preloadCache,this.callClientId)}),new Promise((function(f,g){s._joinedCallback=function(y,S){if(s._callState!==Te){if(s._updateCallState($e),y)for(var M in y){if(s._callObjectMode){var O=s._callMachine().store;ss(y[M],O),as(y[M],O),os(y[M],s._participants[M],O)}s._participants[M]=P({},y[M]),s.toggleParticipantAudioBasedOnNativeAudioFocus()}c&&s.loadCss(s.properties),f(y)}else g(S)}})))})),function(){return R.apply(this,arguments)})},{key:"leave",value:(x=j((function*(){var s=this;return this._testCallInProgress&&this.stopTestCallQuality(),new Promise((function(u){s._callState===Ne||s._callState===Te?u():s._callObjectLoader&&!s._callObjectLoader.loaded?(s._callObjectLoader.cancel(),s._updateCallState(Ne),s.resetMeetingDependentVars(),s.emitDailyJSEvent({action:Ne}),u()):(s._resolveLeave=u,s.sendMessageToCallMachine({action:"leave-meeting"}))}))})),function(){return x.apply(this,arguments)})},{key:"startScreenShare",value:(I=j((function*(){var s=this,u=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(Jt(this._callMachineInitialized,"startScreenShare()"),u.screenVideoSendSettings&&this._validateVideoSendSettings("screenVideo",u.screenVideoSendSettings),u.mediaStream&&(this._sharedTracks.screenMediaStream=u.mediaStream,u.mediaStream=Ce),typeof DailyNativeUtils<"u"&&DailyNativeUtils.isIOS!==void 0&&DailyNativeUtils.isIOS){var c=this.nativeUtils();if(yield c.isScreenBeingCaptured())return void this.emitDailyJSEvent({action:Wi,type:"screen-share-error",errorMsg:"Could not start the screen sharing. The screen is already been captured!"});c.setSystemScreenCaptureStartCallback((function(){c.setSystemScreenCaptureStartCallback(null),s.sendMessageToCallMachine({action:Gi,captureOptions:u})})),c.presentSystemScreenCapturePrompt()}else this.sendMessageToCallMachine({action:Gi,captureOptions:u})})),function(){return I.apply(this,arguments)})},{key:"stopScreenShare",value:function(){Jt(this._callMachineInitialized,"stopScreenShare()"),this.sendMessageToCallMachine({action:"local-screen-stop"})}},{key:"startRecording",value:function(){var s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},u=s.type;if(u&&u!=="cloud"&&u!=="raw-tracks"&&u!=="local")throw new Error("invalid type: ".concat(u,", allowed values 'cloud', 'raw-tracks', or 'local'"));this.sendMessageToCallMachine(P({action:"local-recording-start"},s))}},{key:"updateRecording",value:function(s){var u=s.layout,c=u===void 0?{preset:"default"}:u,f=s.instanceId;this.sendMessageToCallMachine({action:"daily-method-update-recording",layout:c,instanceId:f})}},{key:"stopRecording",value:function(){var s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.sendMessageToCallMachine(P({action:"local-recording-stop"},s))}},{key:"startLiveStreaming",value:function(){var s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.sendMessageToCallMachine(P({action:"daily-method-start-live-streaming"},s))}},{key:"updateLiveStreaming",value:function(s){var u=s.layout,c=u===void 0?{preset:"default"}:u,f=s.instanceId;this.sendMessageToCallMachine({action:"daily-method-update-live-streaming",layout:c,instanceId:f})}},{key:"addLiveStreamingEndpoints",value:function(s){var u=s.endpoints,c=s.instanceId;this.sendMessageToCallMachine({action:Ki,endpointsOp:Hc,endpoints:u,instanceId:c})}},{key:"removeLiveStreamingEndpoints",value:function(s){var u=s.endpoints,c=s.instanceId;this.sendMessageToCallMachine({action:Ki,endpointsOp:Qc,endpoints:u,instanceId:c})}},{key:"stopLiveStreaming",value:function(){var s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.sendMessageToCallMachine(P({action:"daily-method-stop-live-streaming"},s))}},{key:"validateDailyConfig",value:function(s){s.camSimulcastEncodings&&(console.warn("camSimulcastEncodings is deprecated. Use sendSettings, found in DailyCallOptions, to provide camera simulcast settings."),this.validateSimulcastEncodings(s.camSimulcastEncodings)),s.screenSimulcastEncodings&&console.warn("screenSimulcastEncodings is deprecated. Use sendSettings, found in DailyCallOptions, to provide screen simulcast settings."),Ys()&&s.noAutoDefaultDeviceChange&&console.warn("noAutoDefaultDeviceChange is not supported on Android, and will be ignored.")}},{key:"validateSimulcastEncodings",value:function(s){var u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,c=arguments.length>2&&arguments[2]!==void 0&&arguments[2];if(s){if(!(s instanceof Array||Array.isArray(s)))throw new Error("encodings must be an Array");if(!Es(s.length,1,3))throw new Error("encodings must be an Array with between 1 to ".concat(3," layers"));for(var f=0;f<s.length;f++){var g=s[f];for(var y in this._validateEncodingLayerHasValidProperties(g),g)if(Pn.includes(y)){if(typeof g[y]!="number")throw new Error("".concat(y," must be a number"));if(u){var S=u[y],M=S.min,O=S.max;if(!Es(g[y],M,O))throw new Error("".concat(y," value not in range. valid range: ").concat(M," to ").concat(O))}}else if(!["active","scalabilityMode"].includes(y))throw new Error("Invalid key ".concat(y,", valid keys are:")+Object.values(Pn));if(c&&!g.hasOwnProperty("maxBitrate"))throw new Error("maxBitrate is not specified")}}}},{key:"startRemoteMediaPlayer",value:(A=j((function*(s){var u=this,c=s.url,f=s.settings,g=f===void 0?{state:Yn.PLAY}:f;try{(function(y){if(typeof y!="string")throw new Error('url parameter must be "string" type')})(c),Ms(g),(function(y){for(var S in y)if(!_s.includes(S))throw new Error("Invalid key ".concat(S,", valid keys are: ").concat(_s));y.simulcastEncodings&&this.validateSimulcastEncodings(y.simulcastEncodings,ca,!0)})(g)}catch(y){throw console.error("invalid argument Error: ".concat(y)),console.error(`startRemoteMediaPlayer arguments must be of the form:
  { url: "playback url",
  settings?:
  {state: "play"|"pause", simulcastEncodings?: [{}] } }`),y}return new Promise((function(y,S){u.sendMessageToCallMachine({action:"daily-method-start-remote-media-player",url:c,settings:g},(function(M){M.error?S({error:M.error,errorMsg:M.errorMsg}):y({session_id:M.session_id,remoteMediaPlayerState:{state:M.state,settings:M.settings}})}))}))})),function(s){return A.apply(this,arguments)})},{key:"stopRemoteMediaPlayer",value:(T=j((function*(s){var u=this;if(typeof s!="string")throw new Error(" remotePlayerID must be of type string");return new Promise((function(c,f){u.sendMessageToCallMachine({action:"daily-method-stop-remote-media-player",session_id:s},(function(g){g.error?f({error:g.error,errorMsg:g.errorMsg}):c()}))}))})),function(s){return T.apply(this,arguments)})},{key:"updateRemoteMediaPlayer",value:(w=j((function*(s){var u=this,c=s.session_id,f=s.settings;try{Ms(f)}catch(g){throw console.error("invalid argument Error: ".concat(g)),console.error(`updateRemoteMediaPlayer arguments must be of the form:
  session_id: "participant session",
  { settings?: {state: "play"|"pause"} }`),g}return new Promise((function(g,y){u.sendMessageToCallMachine({action:"daily-method-update-remote-media-player",session_id:c,settings:f},(function(S){S.error?y({error:S.error,errorMsg:S.errorMsg}):g({session_id:S.session_id,remoteMediaPlayerState:{state:S.state,settings:S.settings}})}))}))})),function(s){return w.apply(this,arguments)})},{key:"startTranscription",value:function(s){J(this._callState,"startTranscription()"),this.sendMessageToCallMachine(P({action:"daily-method-start-transcription"},s))}},{key:"updateTranscription",value:function(s){if(J(this._callState,"updateTranscription()"),!s)throw new Error("updateTranscription Error: options is mandatory");if(U(s)!=="object")throw new Error("updateTranscription Error: options must be object type");if(s.participants&&!Array.isArray(s.participants))throw new Error("updateTranscription Error: participants must be an array");this.sendMessageToCallMachine(P({action:"daily-method-update-transcription"},s))}},{key:"stopTranscription",value:function(s){if(J(this._callState,"stopTranscription()"),s&&U(s)!=="object")throw new Error("stopTranscription Error: options must be object type");if(s&&!s.instanceId)throw new Error('"instanceId" not provided');this.sendMessageToCallMachine(P({action:"daily-method-stop-transcription"},s))}},{key:"startDialOut",value:(_=j((function*(s){var u=this;J(this._callState,"startDialOut()");var c=function(S){if(S){if(!Array.isArray(S))throw new Error("Error starting dial out: audio codec must be an array");if(S.length<=0)throw new Error("Error starting dial out: audio codec array specified but empty");S.forEach((function(M){if(typeof M!="string")throw new Error("Error starting dial out: audio codec must be a string");if(M!=="OPUS"&&M!=="PCMU"&&M!=="PCMA"&&M!=="G722")throw new Error("Error starting dial out: audio codec must be one of OPUS, PCMU, PCMA, G722")}))}};if(!s.sipUri&&!s.phoneNumber)throw new Error("Error starting dial out: either a sip uri or phone number must be provided");if(s.sipUri&&s.phoneNumber)throw new Error("Error starting dial out: only one of sip uri or phone number must be provided");if(s.sipUri){if(typeof s.sipUri!="string")throw new Error("Error starting dial out: sipUri must be a string");if(!s.sipUri.startsWith("sip:"))throw new Error("Error starting dial out: Invalid SIP URI, must start with 'sip:'");if(s.video&&typeof s.video!="boolean")throw new Error("Error starting dial out: video must be a boolean value");(function(S){if(S&&(c(S.audio),S.video)){if(!Array.isArray(S.video))throw new Error("Error starting dial out: video codec must be an array");if(S.video.length<=0)throw new Error("Error starting dial out: video codec array specified but empty");S.video.forEach((function(M){if(typeof M!="string")throw new Error("Error starting dial out: video codec must be a string");if(M!=="H264"&&M!=="VP8")throw new Error("Error starting dial out: video codec must be H264 or VP8")}))}})(s.codecs)}if(s.phoneNumber){if(typeof s.phoneNumber!="string")throw new Error("Error starting dial out: phoneNumber must be a string");if(!/^\+\d{1,}$/.test(s.phoneNumber))throw new Error("Error starting dial out: Invalid phone number, must be valid phone number as per E.164");s.codecs&&c(s.codecs.audio)}if(s.callerId){if(typeof s.callerId!="string")throw new Error("Error starting dial out: callerId must be a string");if(s.sipUri)throw new Error("Error starting dial out: callerId not allowed with sipUri")}if(s.displayName){if(typeof s.displayName!="string")throw new Error("Error starting dial out: displayName must be a string");if(s.displayName.length>=200)throw new Error("Error starting dial out: displayName length must be less than 200")}if(s.userId){if(typeof s.userId!="string")throw new Error("Error starting dial out: userId must be a string");if(s.userId.length>36)throw new Error("Error starting dial out: userId length must be less than or equal to 36")}if(ks(s),s.permissions&&s.permissions.canReceive){var f=Y(aa.validateJSONObject(s.permissions.canReceive),2),g=f[0],y=f[1];if(!g)throw new Error(y)}return new Promise((function(S,M){u.sendMessageToCallMachine(P({action:"dialout-start"},s),(function(O){O.error?M(O.error):S(O)}))}))})),function(s){return _.apply(this,arguments)})},{key:"stopDialOut",value:function(s){var u=this;return J(this._callState,"stopDialOut()"),new Promise((function(c,f){u.sendMessageToCallMachine(P({action:"dialout-stop"},s),(function(g){g.error?f(g.error):c(g)}))}))}},{key:"sipCallTransfer",value:(m=j((function*(s){var u=this;if(J(this._callState,"sipCallTransfer()"),!s)throw new Error("sipCallTransfer() requires a sessionId and toEndPoint");return s.useSipRefer=!1,Cs(s,"sipCallTransfer"),ks(s),new Promise((function(c,f){u.sendMessageToCallMachine(P({action:Yi},s),(function(g){g.error?f(g.error):c(g)}))}))})),function(s){return m.apply(this,arguments)})},{key:"sipRefer",value:(b=j((function*(s){var u=this;if(J(this._callState,"sipRefer()"),!s)throw new Error("sessionId and toEndPoint are mandatory parameter");return s.useSipRefer=!0,Cs(s,"sipRefer"),new Promise((function(c,f){u.sendMessageToCallMachine(P({action:Yi},s),(function(g){g.error?f(g.error):c(g)}))}))})),function(s){return b.apply(this,arguments)})},{key:"sendDTMF",value:(C=j((function*(s){var u=this;return J(this._callState,"sendDTMF()"),(function(c){var f=c.sessionId,g=c.tones;if(!f||!g)throw new Error("sessionId and tones are mandatory parameter");if(typeof f!="string"||typeof g!="string")throw new Error("sessionId and tones should be of string type");if(g.length>20)throw new Error("tones string must be upto 20 characters");var y=/[^0-9A-D*#]/g,S=g.match(y);if(S&&S[0])throw new Error("".concat(S[0]," is not valid DTMF tone"))})(s),new Promise((function(c,f){u.sendMessageToCallMachine(P({action:"send-dtmf"},s),(function(g){g.error?f(g.error):c(g)}))}))})),function(s){return C.apply(this,arguments)})},{key:"getNetworkStats",value:function(){var s=this;return this._callState!==$e?Promise.resolve(P({stats:{latest:{}}},this._network)):new Promise((function(u){s.sendMessageToCallMachine({action:"get-calc-stats"},(function(c){u(P(P({},s._network),{},{stats:c.stats}))}))}))}},{key:"testWebsocketConnectivity",value:(E=j((function*(){var s=this;if(xn(this._testCallInProgress,"testWebsocketConnectivity()"),this.needsLoad())try{yield this.load()}catch(u){return Promise.reject(u)}return new Promise((function(u,c){s.sendMessageToCallMachine({action:"test-websocket-connectivity"},(function(f){f.error?c(f.error):u(f.results)}))}))})),function(){return E.apply(this,arguments)})},{key:"abortTestWebsocketConnectivity",value:function(){this.sendMessageToCallMachine({action:"abort-test-websocket-connectivity"})}},{key:"_validateVideoTrackForNetworkTests",value:function(s){return s?s instanceof MediaStreamTrack?!!ml(s)||(console.error("Video track is not playable. This test needs a live video track."),!1):(console.error("Video track needs to be of type `MediaStreamTrack`."),!1):(console.error("Missing video track. You must provide a video track in order to run this test."),!1)}},{key:"testCallQuality",value:(v=j((function*(){var s=this;N(),de(this._callObjectMode,"testCallQuality()"),Jt(this._callMachineInitialized,"testCallQuality()",null,!0),In(this._callState,this._isPreparingToJoin,"testCallQuality()");var u=this._testCallAlreadyInProgress,c=function(g){u||(s._testCallInProgress=g)};if(c(!0),this.needsLoad())try{var f=this._callState;yield this.load(),this._callState=f}catch(g){return c(!1),Promise.reject(g)}return new Promise((function(g){s.sendMessageToCallMachine({action:"test-call-quality",dailyJsVersion:s.properties.dailyJsVersion},(function(y){var S=y.results,M=S.result,O=jr(S,bl);if(M==="failed"){var D,B=P({},O);(D=O.error)!==null&&D!==void 0&&D.details?(O.error.details=JSON.parse(O.error.details),B.error=P(P({},B.error),{},{details:P({},B.error.details)}),B.error.details.duringTest="testCallQuality"):(B.error=B.error?P({},B.error):{},B.error.details={duringTest:"testCallQuality"}),s._maybeSendToSentry(B)}c(!1),g(P({result:M},O))}))}))})),function(){return v.apply(this,arguments)})},{key:"stopTestCallQuality",value:function(){this.sendMessageToCallMachine({action:"stop-test-call-quality"})}},{key:"testConnectionQuality",value:(p=j((function*(s){var u;F()?(console.warn("testConnectionQuality() is deprecated: use testPeerToPeerCallQuality() instead"),u=yield this.testPeerToPeerCallQuality(s)):(console.warn("testConnectionQuality() is deprecated: use testCallQuality() instead"),u=yield this.testCallQuality());var c={result:u.result,secondsElapsed:u.secondsElapsed};return u.data&&(c.data={maxRTT:u.data.maxRoundTripTime,packetLoss:u.data.avgRecvPacketLoss}),c})),function(s){return p.apply(this,arguments)})},{key:"testPeerToPeerCallQuality",value:(h=j((function*(s){var u=this;if(xn(this._testCallInProgress,"testPeerToPeerCallQuality()"),this.needsLoad())try{yield this.load()}catch(g){return Promise.reject(g)}var c=s.videoTrack,f=s.duration;if(!this._validateVideoTrackForNetworkTests(c))throw new Error("Video track error");return this._sharedTracks.videoTrackForConnectionQualityTest=c,new Promise((function(g,y){u.sendMessageToCallMachine({action:"test-p2p-call-quality",duration:f},(function(S){S.error?y(S.error):g(S.results)}))}))})),function(s){return h.apply(this,arguments)})},{key:"stopTestConnectionQuality",value:function(){F()?(console.warn("stopTestConnectionQuality() is deprecated: use testPeerToPeerCallQuality() and stopTestPeerToPeerCallQuality() instead"),this.stopTestPeerToPeerCallQuality()):(console.warn("stopTestConnectionQuality() is deprecated: use testCallQuality() and stopTestCallQuality() instead"),this.stopTestCallQuality())}},{key:"stopTestPeerToPeerCallQuality",value:function(){this.sendMessageToCallMachine({action:"stop-test-p2p-call-quality"})}},{key:"testNetworkConnectivity",value:(d=j((function*(s){var u=this;if(xn(this._testCallInProgress,"testNetworkConnectivity()"),this.needsLoad())try{yield this.load()}catch(c){return Promise.reject(c)}if(!this._validateVideoTrackForNetworkTests(s))throw new Error("Video track error");return this._sharedTracks.videoTrackForNetworkConnectivityTest=s,new Promise((function(c,f){u.sendMessageToCallMachine({action:"test-network-connectivity"},(function(g){g.error?f(g.error):c(g.results)}))}))})),function(s){return d.apply(this,arguments)})},{key:"abortTestNetworkConnectivity",value:function(){this.sendMessageToCallMachine({action:"abort-test-network-connectivity"})}},{key:"getCpuLoadStats",value:function(){var s=this;return new Promise((function(u){s._callState===$e?s.sendMessageToCallMachine({action:"get-cpu-load-stats"},(function(c){u(c.cpuStats)})):u({cpuLoadState:void 0,cpuLoadStateReason:void 0,stats:{}})}))}},{key:"_validateEncodingLayerHasValidProperties",value:function(s){var u;if(!(((u=Object.keys(s))===null||u===void 0?void 0:u.length)>0))throw new Error("Empty encoding is not allowed. At least one of these valid keys should be specified:"+Object.values(Pn))}},{key:"_validateVideoSendSettings",value:function(s,u){var c=s==="screenVideo"?["default-screen-video","detail-optimized","motion-optimized","motion-and-detail-balanced"]:["default-video","bandwidth-optimized","bandwidth-and-quality-balanced","quality-optimized","adaptive-2-layers","adaptive-3-layers"],f="Video send settings should be either an object or one of the supported presets: ".concat(c.join());if(typeof u=="string"){if(!c.includes(u))throw new Error(f)}else{if(U(u)!=="object")throw new Error(f);if(!u.maxQuality&&!u.encodings&&u.allowAdaptiveLayers===void 0)throw new Error("Video send settings must contain at least maxQuality, allowAdaptiveLayers or encodings attribute");if(u.maxQuality&&["low","medium","high"].indexOf(u.maxQuality)===-1)throw new Error("maxQuality must be either low, medium or high");if(u.encodings){var g=!1;switch(Object.keys(u.encodings).length){case 1:g=!u.encodings.low;break;case 2:g=!u.encodings.low||!u.encodings.medium;break;case 3:g=!u.encodings.low||!u.encodings.medium||!u.encodings.high;break;default:g=!0}if(g)throw new Error("Encodings must be defined as: low, low and medium, or low, medium and high.");u.encodings.low&&this._validateEncodingLayerHasValidProperties(u.encodings.low),u.encodings.medium&&this._validateEncodingLayerHasValidProperties(u.encodings.medium),u.encodings.high&&this._validateEncodingLayerHasValidProperties(u.encodings.high)}}}},{key:"validateUpdateSendSettings",value:function(s){var u=this;if(!s||Object.keys(s).length===0)throw new Error("Send settings must contain at least information for one track!");Object.entries(s).forEach((function(c){var f=Y(c,2),g=f[0],y=f[1];u._validateVideoSendSettings(g,y)}))}},{key:"updateSendSettings",value:function(s){var u=this;return this.validateUpdateSendSettings(s),this.needsLoad()?(this._preloadCache.sendSettings=s,{sendSettings:this._preloadCache.sendSettings}):new Promise((function(c,f){u.sendMessageToCallMachine({action:"update-send-settings",sendSettings:s},(function(g){g.error?f(g.error):c(g.sendSettings)}))}))}},{key:"getSendSettings",value:function(){return this._sendSettings||this._preloadCache.sendSettings}},{key:"getLocalAudioLevel",value:function(){return this._localAudioLevel}},{key:"getRemoteParticipantsAudioLevel",value:function(){return this._remoteParticipantsAudioLevel}},{key:"getActiveSpeaker",value:function(){return N(),this._activeSpeaker}},{key:"setActiveSpeakerMode",value:function(s){return N(),this.sendMessageToCallMachine({action:"set-active-speaker-mode",enabled:s}),this}},{key:"activeSpeakerMode",value:function(){return N(),this._activeSpeakerMode}},{key:"subscribeToTracksAutomatically",value:function(){return this._preloadCache.subscribeToTracksAutomatically}},{key:"setSubscribeToTracksAutomatically",value:function(s){return J(this._callState,"setSubscribeToTracksAutomatically()","Use the subscribeToTracksAutomatically configuration property."),this._preloadCache.subscribeToTracksAutomatically=s,this.sendMessageToCallMachine({action:"daily-method-subscribe-to-tracks-automatically",enabled:s}),this}},{key:"enumerateDevices",value:(l=j((function*(){var s=this;if(this._callObjectMode){var u=yield navigator.mediaDevices.enumerateDevices();return Ke()==="Firefox"&&en().major>115&&en().major<123&&(u=u.filter((function(c){return c.kind!=="audiooutput"}))),{devices:u.map((function(c){var f=JSON.parse(JSON.stringify(c));if(!F()&&c.kind==="videoinput"&&c.getCapabilities){var g,y=c.getCapabilities();f.facing=(y==null||(g=y.facingMode)===null||g===void 0?void 0:g.length)>=1?y.facingMode[0]:void 0}return f}))}}return new Promise((function(c){s.sendMessageToCallMachine({action:"enumerate-devices"},(function(f){c({devices:f.devices})}))}))})),function(){return l.apply(this,arguments)})},{key:"sendAppMessage",value:function(s){var u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"*";if(J(this._callState,"sendAppMessage()"),JSON.stringify(s).length>this._maxAppMessageSize)throw new Error("Message data too large. Max size is "+this._maxAppMessageSize);return this.sendMessageToCallMachine({action:"app-msg",data:s,to:u}),this}},{key:"addFakeParticipant",value:function(s){return N(),J(this._callState,"addFakeParticipant()"),this.sendMessageToCallMachine(P({action:"add-fake-participant"},s)),this}},{key:"setShowNamesMode",value:function(s){return ne(this._callObjectMode,"setShowNamesMode()"),N(),s&&s!=="always"&&s!=="never"?(console.error('setShowNamesMode argument should be "always", "never", or false'),this):(this.sendMessageToCallMachine({action:"set-show-names",mode:s}),this)}},{key:"setShowLocalVideo",value:function(){var s=!(arguments.length>0&&arguments[0]!==void 0)||arguments[0];return ne(this._callObjectMode,"setShowLocalVideo()"),N(),J(this._callState,"setShowLocalVideo()"),typeof s!="boolean"?(console.error("setShowLocalVideo only accepts a boolean value"),this):(this.sendMessageToCallMachine({action:"set-show-local-video",show:s}),this._showLocalVideo=s,this)}},{key:"showLocalVideo",value:function(){return ne(this._callObjectMode,"showLocalVideo()"),N(),this._showLocalVideo}},{key:"setShowParticipantsBar",value:function(){var s=!(arguments.length>0&&arguments[0]!==void 0)||arguments[0];return ne(this._callObjectMode,"setShowParticipantsBar()"),N(),J(this._callState,"setShowParticipantsBar()"),typeof s!="boolean"?(console.error("setShowParticipantsBar only accepts a boolean value"),this):(this.sendMessageToCallMachine({action:"set-show-participants-bar",show:s}),this._showParticipantsBar=s,this)}},{key:"showParticipantsBar",value:function(){return ne(this._callObjectMode,"showParticipantsBar()"),N(),this._showParticipantsBar}},{key:"customIntegrations",value:function(){return N(),ne(this._callObjectMode,"customIntegrations()"),this._customIntegrations}},{key:"setCustomIntegrations",value:function(s){return N(),ne(this._callObjectMode,"setCustomIntegrations()"),J(this._callState,"setCustomIntegrations()"),ma(s)?(this.sendMessageToCallMachine({action:"set-custom-integrations",integrations:s}),this._customIntegrations=s,this):this}},{key:"startCustomIntegrations",value:function(s){var u=this;if(N(),ne(this._callObjectMode,"startCustomIntegrations()"),J(this._callState,"startCustomIntegrations()"),Array.isArray(s)&&s.some((function(g){return typeof g!="string"}))||!Array.isArray(s)&&typeof s!="string")return console.error("startCustomIntegrations() only accepts string | string[]"),this;var c=typeof s=="string"?[s]:s,f=c.filter((function(g){return!(g in u._customIntegrations)}));return f.length?(console.error(`Can't find custom integration(s): "`.concat(f.join(", "),'"')),this):(this.sendMessageToCallMachine({action:"start-custom-integrations",ids:c}),this)}},{key:"stopCustomIntegrations",value:function(s){var u=this;if(N(),ne(this._callObjectMode,"stopCustomIntegrations()"),J(this._callState,"stopCustomIntegrations()"),Array.isArray(s)&&s.some((function(g){return typeof g!="string"}))||!Array.isArray(s)&&typeof s!="string")return console.error("stopCustomIntegrations() only accepts string | string[]"),this;var c=typeof s=="string"?[s]:s,f=c.filter((function(g){return!(g in u._customIntegrations)}));return f.length?(console.error(`Can't find custom integration(s): "`.concat(f.join(", "),'"')),this):(this.sendMessageToCallMachine({action:"stop-custom-integrations",ids:c}),this)}},{key:"customTrayButtons",value:function(){return ne(this._callObjectMode,"customTrayButtons()"),N(),this._customTrayButtons}},{key:"updateCustomTrayButtons",value:function(s){return ne(this._callObjectMode,"updateCustomTrayButtons()"),N(),J(this._callState,"updateCustomTrayButtons()"),ga(s)?(this.sendMessageToCallMachine({action:"update-custom-tray-buttons",btns:s}),this._customTrayButtons=s,this):(console.error("updateCustomTrayButtons only accepts a dictionary of the type ".concat(JSON.stringify(nn))),this)}},{key:"theme",value:function(){return ne(this._callObjectMode,"theme()"),this.properties.theme}},{key:"setTheme",value:function(s){var u=this;return ne(this._callObjectMode,"setTheme()"),new Promise((function(c,f){try{u.validateProperties({theme:s}),u.properties.theme=P({},s),u.sendMessageToCallMachine({action:"set-theme",theme:u.properties.theme});try{u.emitDailyJSEvent({action:ec,theme:u.properties.theme})}catch(g){console.log("could not emit 'theme-updated'",g)}c(u.properties.theme)}catch(g){f(g)}}))}},{key:"requestFullscreen",value:(o=j((function*(){if(N(),this._iframe&&!document.fullscreenElement&&Xi())try{(yield this._iframe.requestFullscreen)?this._iframe.requestFullscreen():this._iframe.webkitRequestFullscreen()}catch(s){console.log("could not make video call fullscreen",s)}})),function(){return o.apply(this,arguments)})},{key:"exitFullscreen",value:function(){N(),document.fullscreenElement?document.exitFullscreen():document.webkitFullscreenElement&&document.webkitExitFullscreen()}},{key:"getSidebarView",value:(a=j((function*(){var s=this;return this._callObjectMode?(console.error("getSidebarView is not available in callObject mode"),Promise.resolve(null)):new Promise((function(u){s.sendMessageToCallMachine({action:"get-sidebar-view"},(function(c){u(c.view)}))}))})),function(){return a.apply(this,arguments)})},{key:"setSidebarView",value:function(s){return this._callObjectMode?(console.error("setSidebarView is not available in callObject mode"),this):(this.sendMessageToCallMachine({action:"set-sidebar-view",view:s}),this)}},{key:"room",value:(i=j((function*(){var s=this,u=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:{}).includeRoomConfigDefaults,c=u===void 0||u;return this._accessState.access===Sn||this.needsLoad()?this.properties.url?{roomUrlPendingJoin:this.properties.url}:null:new Promise((function(f){s.sendMessageToCallMachine({action:"lib-room-info",includeRoomConfigDefaults:c},(function(g){delete g.action,delete g.callbackStamp,f(g)}))}))})),function(){return i.apply(this,arguments)})},{key:"geo",value:(r=j((function*(){try{var s=yield fetch("https://gs.daily.co/_ks_/x-swsl/:");return{current:(yield s.json()).geo}}catch(u){return console.error("geo lookup failed",u),{current:""}}})),function(){return r.apply(this,arguments)})},{key:"setNetworkTopology",value:(n=j((function*(s){var u=this;return N(),J(this._callState,"setNetworkTopology()"),new Promise((function(c,f){u.sendMessageToCallMachine({action:"set-network-topology",opts:s},(function(g){g.error?f({error:g.error}):c({workerId:g.workerId})}))}))})),function(s){return n.apply(this,arguments)})},{key:"getNetworkTopology",value:(e=j((function*(){var s=this;return new Promise((function(u,c){s.needsLoad()&&u({topology:"none"}),s.sendMessageToCallMachine({action:"get-network-topology"},(function(f){f.error?c({error:f.error}):u({topology:f.topology})}))}))})),function(){return e.apply(this,arguments)})},{key:"setPlayNewParticipantSound",value:function(s){if(N(),typeof s!="number"&&s!==!0&&s!==!1)throw new Error("argument to setShouldPlayNewParticipantSound should be true, false, or a number, but is ".concat(s));this.sendMessageToCallMachine({action:"daily-method-set-play-ding",arg:s})}},{key:"on",value:function(s,u){return Pt.prototype.on.call(this,s,u)}},{key:"once",value:function(s,u){return Pt.prototype.once.call(this,s,u)}},{key:"off",value:function(s,u){return Pt.prototype.off.call(this,s,u)}},{key:"validateProperties",value:function(s){var u,c;if(s!=null&&(u=s.dailyConfig)!==null&&u!==void 0&&u.userMediaAudioConstraints){var f,g;F()||console.warn("userMediaAudioConstraints is deprecated. You can override constraints with inputSettings.audio.settings, found in DailyCallOptions.");var y=s.inputSettings||{};y.audio=((f=s.inputSettings)===null||f===void 0?void 0:f.audio)||{},y.audio.settings=((g=s.inputSettings)===null||g===void 0||(g=g.audio)===null||g===void 0?void 0:g.settings)||{},y.audio.settings=P(P({},y.audio.settings),s.dailyConfig.userMediaAudioConstraints),s.inputSettings=y,delete s.dailyConfig.userMediaAudioConstraints}if(s!=null&&(c=s.dailyConfig)!==null&&c!==void 0&&c.userMediaVideoConstraints){var S,M;F()||console.warn("userMediaVideoConstraints is deprecated. You can override constraints with inputSettings.video.settings, found in DailyCallOptions.");var O=s.inputSettings||{};O.video=((S=s.inputSettings)===null||S===void 0?void 0:S.video)||{},O.video.settings=((M=s.inputSettings)===null||M===void 0||(M=M.video)===null||M===void 0?void 0:M.settings)||{},O.video.settings=P(P({},O.video.settings),s.dailyConfig.userMediaVideoConstraints),s.inputSettings=O,delete s.dailyConfig.userMediaVideoConstraints}for(var D in s)if(Be[D]){if(Be[D].validate&&!Be[D].validate(s[D],this))throw new Error("property '".concat(D,"': ").concat(Be[D].help))}else console.warn("Ignoring unrecognized property '".concat(D,"'")),delete s[D]}},{key:"assembleMeetingUrl",value:function(){var s,u,c=P(P({},this.properties),{},{emb:this.callClientId,embHref:encodeURIComponent(window.location.href),proxy:(s=this.properties.dailyConfig)!==null&&s!==void 0&&s.proxyUrl?encodeURIComponent((u=this.properties.dailyConfig)===null||u===void 0?void 0:u.proxyUrl):void 0}),f=c.url.match(/\?/)?"&":"?";return c.url+f+Object.keys(Be).filter((function(g){return Be[g].queryString&&c[g]!==void 0})).map((function(g){return"".concat(Be[g].queryString,"=").concat(c[g])})).join("&")}},{key:"needsLoad",value:function(){return[Fi,Bi,Ne,Te].includes(this._callState)}},{key:"sendMessageToCallMachine",value:function(s,u){if(this._destroyed&&(this._logUseAfterDestroy(),this.strictMode))throw new Error("Use after destroy");this._messageChannel.sendMessageToCallMachine(s,u,this.callClientId,this._iframe)}},{key:"forwardPackagedMessageToCallMachine",value:function(s){this._messageChannel.forwardPackagedMessageToCallMachine(s,this._iframe,this.callClientId)}},{key:"addListenerForPackagedMessagesFromCallMachine",value:function(s){return this._messageChannel.addListenerForPackagedMessagesFromCallMachine(s,this.callClientId)}},{key:"removeListenerForPackagedMessagesFromCallMachine",value:function(s){this._messageChannel.removeListenerForPackagedMessagesFromCallMachine(s)}},{key:"handleMessageFromCallMachine",value:function(s){switch(s.action){case Xo:this.sendMessageToCallMachine(P({action:Zo},this.properties));break;case"call-machine-initialized":this._callMachineInitialized=!0;var u={action:Ut,level:"log",code:1011,stats:{event:"bundle load",time:this._bundleLoadTime==="no-op"?0:this._bundleLoadTime,preLoaded:this._bundleLoadTime==="no-op",url:Qt(this.properties.dailyConfig)}};this.sendMessageToCallMachine(u),this._delayDuplicateInstanceLog&&this._logDuplicateInstanceAttempt();break;case Vi:this._loadedCallback&&(this._loadedCallback(),this._loadedCallback=null),this.emitDailyJSEvent(s);break;case ac:var c,f=P({},s);delete f.internal,this._maxAppMessageSize=((c=s.internal)===null||c===void 0?void 0:c._maxAppMessageSize)||Cn,this._joinedCallback&&(this._joinedCallback(s.participants),this._joinedCallback=null),this.emitDailyJSEvent(f);break;case cc:case lc:if(this._callState===Ne)return;if(s.participant&&s.participant.session_id){var g=s.participant.local?"local":s.participant.session_id;if(this._callObjectMode){var y=this._callMachine().store;ss(s.participant,y),as(s.participant,y),os(s.participant,this._participants[g],y)}try{this.maybeParticipantTracksStopped(this._participants[g],s.participant),this.maybeParticipantTracksStarted(this._participants[g],s.participant),this.maybeEventRecordingStopped(this._participants[g],s.participant),this.maybeEventRecordingStarted(this._participants[g],s.participant)}catch(Sa){console.error("track events error",Sa)}this.compareEqualForParticipantUpdateEvent(s.participant,this._participants[g])||(this._participants[g]=P({},s.participant),this.toggleParticipantAudioBasedOnNativeAudioFocus(),this.emitDailyJSEvent(s))}break;case uc:if(s.participant&&s.participant.session_id){var S=this._participants[s.participant.session_id];S&&this.maybeParticipantTracksStopped(S,null),delete this._participants[s.participant.session_id],this.emitDailyJSEvent(s)}break;case dc:Z(this._participantCounts,s.participantCounts)||(this._participantCounts=s.participantCounts,this.emitDailyJSEvent(s));break;case hc:var M={access:s.access};s.awaitingAccess&&(M.awaitingAccess=s.awaitingAccess),Z(this._accessState,M)||(this._accessState=M,this.emitDailyJSEvent(s));break;case fc:if(s.meetingSession){this._meetingSessionSummary=s.meetingSession,this.emitDailyJSEvent(s);var O=P(P({},s),{},{action:"meeting-session-updated"});this.emitDailyJSEvent(O)}break;case Hi:var D;this._iframe&&!s.preserveIframe&&(this._iframe.src=""),this._updateCallState(Te),this.resetMeetingDependentVars(),this._loadedCallback&&(this._loadedCallback(s.errorMsg),this._loadedCallback=null),s.preserveIframe;var B=jr(s,_l);B!=null&&(D=B.error)!==null&&D!==void 0&&D.details&&(B.error.details=JSON.parse(B.error.details)),this._maybeSendToSentry(s),this._joinedCallback&&(this._joinedCallback(null,B),this._joinedCallback=null),this.emitDailyJSEvent(B);break;case oc:this._callState!==Te&&this._updateCallState(Ne),this.resetMeetingDependentVars(),this._resolveLeave&&(this._resolveLeave(),this._resolveLeave=null),this.emitDailyJSEvent(s);break;case"selected-devices-updated":s.devices&&this.emitDailyJSEvent(s);break;case Nc:var me=s.state,Le=s.threshold,ft=s.quality,H=me.state,ae=me.reasons;H===this._network.networkState&&Z(ae,this._network.networkStateReasons)&&Le===this._network.threshold&&ft===this._network.quality||(this._network.networkState=H,this._network.networkStateReasons=ae,this._network.quality=ft,this._network.threshold=Le,s.networkState=H,ae.length&&(s.networkStateReasons=ae),delete s.state,this.emitDailyJSEvent(s));break;case Bc:s&&s.cpuLoadState&&this.emitDailyJSEvent(s);break;case Uc:s&&s.faceCounts!==void 0&&this.emitDailyJSEvent(s);break;case Dc:var De=s.activeSpeaker;this._activeSpeaker.peerId!==De.peerId&&(this._activeSpeaker.peerId=De.peerId,this.emitDailyJSEvent({action:s.action,activeSpeaker:this._activeSpeaker}));break;case"show-local-video-changed":if(this._callObjectMode)return;var pt=s.show;this._showLocalVideo=pt,this.emitDailyJSEvent({action:s.action,show:pt});break;case Rc:var At=s.enabled;this._activeSpeakerMode!==At&&(this._activeSpeakerMode=At,this.emitDailyJSEvent({action:s.action,enabled:this._activeSpeakerMode}));break;case gc:case mc:case vc:this._waitingParticipants=s.allWaitingParticipants,this.emitDailyJSEvent({action:s.action,participant:s.participant});break;case Wc:Z(this._receiveSettings,s.receiveSettings)||(this._receiveSettings=s.receiveSettings,this.emitDailyJSEvent({action:s.action,receiveSettings:s.receiveSettings}));break;case zi:this._maybeUpdateInputSettings(s.inputSettings);break;case"send-settings-updated":Z(this._sendSettings,s.sendSettings)||(this._sendSettings=s.sendSettings,this._preloadCache.sendSettings=null,this.emitDailyJSEvent({action:s.action,sendSettings:s.sendSettings}));break;case"local-audio-level":this._localAudioLevel=s.audioLevel,this._preloadCache.localAudioLevelObserver=null,this.emitDailyJSEvent(s);break;case"remote-participants-audio-level":this._remoteParticipantsAudioLevel=s.participantsAudioLevel,this._preloadCache.remoteParticipantsAudioLevelObserver=null,this.emitDailyJSEvent(s);break;case Oc:var gt=s.session_id;this._rmpPlayerState[gt]=s.playerState,this.emitDailyJSEvent(s);break;case Ic:delete this._rmpPlayerState[s.session_id],this.emitDailyJSEvent(s);break;case Pc:var mt=s.session_id,Ir=this._rmpPlayerState[mt];Ir&&this.compareEqualForRMPUpdateEvent(Ir,s.remoteMediaPlayerState)||(this._rmpPlayerState[mt]=s.remoteMediaPlayerState,this.emitDailyJSEvent(s));break;case"custom-button-click":case"sidebar-view-changed":case"pip-started":case"pip-stopped":this.emitDailyJSEvent(s);break;case pc:var ka=this._meetingSessionState.topology!==(s.meetingSessionState&&s.meetingSessionState.topology);this._meetingSessionState=jn(s.meetingSessionState,this._callObjectMode),(this._callObjectMode||ka)&&this.emitDailyJSEvent(s);break;case xc:this._isScreenSharing=!0,this.emitDailyJSEvent(s);break;case jc:case Lc:this._isScreenSharing=!1,this.emitDailyJSEvent(s);break;case Ji:case qi:case Sc:case Cc:case Mc:case _c:case wc:case kc:case rc:case ic:case Tc:case Ac:case"test-completed":case Fc:case Ec:case $c:case Vc:case Jc:case qc:case Wi:case zc:case"dialin-ready":case"dialin-connected":case"dialin-error":case"dialin-stopped":case"dialin-warning":case"dialout-connected":case"dialout-answered":case"dialout-error":case"dialout-stopped":case"dialout-warning":this.emitDailyJSEvent(s);break;case"request-fullscreen":this.requestFullscreen();break;case"request-exit-fullscreen":this.exitFullscreen()}}},{key:"maybeEventRecordingStopped",value:function(s,u){var c="record";s&&(u.local||u[c]!==!1||s[c]===u[c]||this.emitDailyJSEvent({action:qi}))}},{key:"maybeEventRecordingStarted",value:function(s,u){var c="record";s&&(u.local||u[c]!==!0||s[c]===u[c]||this.emitDailyJSEvent({action:Ji}))}},{key:"_trackStatePlayable",value:function(s){return!(!s||s.state!==Ho)}},{key:"_trackChanged",value:function(s,u){return s?.id!==u?.id}},{key:"maybeEventTrackStopped",value:function(s,u,c){var f,g,y=(f=u?.tracks[s])!==null&&f!==void 0?f:null,S=(g=c?.tracks[s])!==null&&g!==void 0?g:null,M=y?.track;if(M){var O=this._trackStatePlayable(y),D=this._trackStatePlayable(S),B=this._trackChanged(M,S?.track);O&&(D&&!B||this.emitDailyJSEvent({action:bc,track:M,participant:c??u,type:s}))}}},{key:"maybeEventTrackStarted",value:function(s,u,c){var f,g,y=(f=u?.tracks[s])!==null&&f!==void 0?f:null,S=(g=c?.tracks[s])!==null&&g!==void 0?g:null,M=S?.track;if(M){var O=this._trackStatePlayable(y),D=this._trackStatePlayable(S),B=this._trackChanged(y?.track,M);D&&(O&&!B||this.emitDailyJSEvent({action:yc,track:M,participant:c,type:s}))}}},{key:"maybeParticipantTracksStopped",value:function(s,u){if(s)for(var c in s.tracks)this.maybeEventTrackStopped(c,s,u)}},{key:"maybeParticipantTracksStarted",value:function(s,u){if(u)for(var c in u.tracks)this.maybeEventTrackStarted(c,s,u)}},{key:"compareEqualForRMPUpdateEvent",value:function(s,u){var c,f;return s.state===u.state&&((c=s.settings)===null||c===void 0?void 0:c.volume)===((f=u.settings)===null||f===void 0?void 0:f.volume)}},{key:"emitDailyJSEvent",value:function(s){try{s.callClientId=this.callClientId,this.emit(s.action,s)}catch(u){console.log("could not emit",s,u)}}},{key:"compareEqualForParticipantUpdateEvent",value:function(s,u){return!!Z(s,u)&&(!s.videoTrack||!u.videoTrack||s.videoTrack.id===u.videoTrack.id&&s.videoTrack.muted===u.videoTrack.muted&&s.videoTrack.enabled===u.videoTrack.enabled)&&(!s.audioTrack||!u.audioTrack||s.audioTrack.id===u.audioTrack.id&&s.audioTrack.muted===u.audioTrack.muted&&s.audioTrack.enabled===u.audioTrack.enabled)}},{key:"nativeUtils",value:function(){return F()?typeof DailyNativeUtils>"u"?(console.warn("in React Native, DailyNativeUtils is expected to be available"),null):DailyNativeUtils:null}},{key:"updateIsPreparingToJoin",value:function(s){this._updateCallState(this._callState,s)}},{key:"_updateCallState",value:function(s){var u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this._isPreparingToJoin;if(s!==this._callState||u!==this._isPreparingToJoin){var c=this._callState,f=this._isPreparingToJoin;this._callState=s,this._isPreparingToJoin=u;var g=this._callState===$e;this.updateShowAndroidOngoingMeetingNotification(g);var y=Ht(c,f),S=Ht(this._callState,this._isPreparingToJoin);y!==S&&(this.updateKeepDeviceAwake(S),this.updateDeviceAudioMode(S),this.updateNoOpRecordingEnsuringBackgroundContinuity(S))}}},{key:"resetMeetingDependentVars",value:function(){this._participants={},this._participantCounts=bs,this._waitingParticipants={},this._activeSpeaker={},this._activeSpeakerMode=!1,this._didPreAuth=!1,this._accessState={access:Sn},this._finalSummaryOfPrevSession=this._meetingSessionSummary,this._meetingSessionSummary={},this._meetingSessionState=jn(ys,this._callObjectMode),this._isScreenSharing=!1,this._receiveSettings={},this._inputSettings=void 0,this._sendSettings={},this._localAudioLevel=0,this._isLocalAudioLevelObserverRunning=!1,this._remoteParticipantsAudioLevel={},this._isRemoteParticipantsAudioLevelObserverRunning=!1,this._maxAppMessageSize=Cn,this._callMachineInitialized=!1,this._bundleLoadTime=void 0,this._preloadCache}},{key:"updateKeepDeviceAwake",value:function(s){F()&&this.nativeUtils().setKeepDeviceAwake(s,this.callClientId)}},{key:"updateDeviceAudioMode",value:function(s){if(F()&&!this.disableReactNativeAutoDeviceManagement("audio")){var u=s?this._nativeInCallAudioMode:"idle";this.nativeUtils().setAudioMode(u)}}},{key:"updateShowAndroidOngoingMeetingNotification",value:function(s){if(F()&&this.nativeUtils().setShowOngoingMeetingNotification){var u,c,f,g;if(this.properties.reactNativeConfig&&this.properties.reactNativeConfig.androidInCallNotification){var y=this.properties.reactNativeConfig.androidInCallNotification;u=y.title,c=y.subtitle,f=y.iconName,g=y.disableForCustomOverride}g&&(s=!1),this.nativeUtils().setShowOngoingMeetingNotification(s,u,c,f,this.callClientId)}}},{key:"updateNoOpRecordingEnsuringBackgroundContinuity",value:function(s){F()&&this.nativeUtils().enableNoOpRecordingEnsuringBackgroundContinuity&&this.nativeUtils().enableNoOpRecordingEnsuringBackgroundContinuity(s)}},{key:"toggleParticipantAudioBasedOnNativeAudioFocus",value:function(){var s;if(F()){var u=(s=this._callMachine())===null||s===void 0||(s=s.store)===null||s===void 0?void 0:s.getState();for(var c in u?.streams){var f=u.streams[c];f&&f.pendingTrack&&f.pendingTrack.kind==="audio"&&(f.pendingTrack.enabled=this._hasNativeAudioFocus)}}}},{key:"disableReactNativeAutoDeviceManagement",value:function(s){return this.properties.reactNativeConfig&&this.properties.reactNativeConfig.disableAutoDeviceManagement&&this.properties.reactNativeConfig.disableAutoDeviceManagement[s]}},{key:"absoluteUrl",value:function(s){if(s!==void 0){var u=document.createElement("a");return u.href=s,u.href}}},{key:"sayHello",value:function(){var s="hello, world.";return console.log(s),s}},{key:"_logUseAfterDestroy",value:function(){var s=Object.values(Fe)[0];if(this.needsLoad())if(s&&!s.needsLoad()){var u={action:Ut,level:"error",code:this.strictMode?9995:9997};s.sendMessageToCallMachine(u)}else this.strictMode||console.error("You are are attempting to use a call instance that was previously destroyed, which is unsupported. Please remove `strictMode: false` from your constructor properties to enable strict mode to track down and fix this unsupported usage.");else{var c={action:Ut,level:"error",code:this.strictMode?9995:9997};this._messageChannel.sendMessageToCallMachine(c,null,this.callClientId,this._iframe)}}},{key:"_logDuplicateInstanceAttempt",value:function(){for(var s=0,u=Object.values(Fe);s<u.length;s++){var c=u[s];c._callMachineInitialized?(c.sendMessageToCallMachine({action:Ut,level:"warn",code:this.allowMultipleCallInstances?9993:9992}),c._delayDuplicateInstanceLog=!1):c._delayDuplicateInstanceLog=!0}}},{key:"_maybeSendToSentry",value:function(s){var u,c,f,g;if(!((u=s.error)!==null&&u!==void 0&&u.type&&(![Yo,Ko,$i].includes(s.error.type)||s.error.type===$i&&s.error.msg.includes("deleted")))){var y=(c=this.properties)!==null&&c!==void 0&&c.url?new URL(this.properties.url):void 0,S="production";y&&y.host.includes(".staging.daily")&&(S="staging");var M,O,D,B,me,Le=(function(gt){const mt=[fo(),uo(),Bo(),No(),qo(),Wo(),vo(),zo()];return gt.autoSessionTracking!==!1&&mt.push(Jo()),mt})({}).filter((function(gt){return!["BrowserApiErrors","Breadcrumbs","GlobalHandlers"].includes(gt.name)})),ft=new Mo({dsn:"https://f10f1c81e5d44a4098416c0867a8b740@o77906.ingest.sentry.io/168844",transport:Po,stackParser:Ro,integrations:Le,environment:S}),H=new je;if(H.setClient(ft),ft.init(),this.session_id&&H.setExtra("sessionId",this.session_id),this.properties){var ae=P({},this.properties);ae.userName=ae.userName?"[Filtered]":void 0,ae.userData=ae.userData?"[Filtered]":void 0,ae.token=ae.token?"[Filtered]":void 0,H.setExtra("properties",ae)}if(y){var De=y.searchParams.get("domain");if(!De){var pt=y.host.match(/(.*?)\./);De=pt&&pt[1]||""}De&&H.setTag("domain",De)}s.error&&(H.setTag("fatalErrorType",s.error.type),H.setExtra("errorDetails",s.error.details),!((M=s.error.details)===null||M===void 0)&&M.uri&&H.setTag("serverAddress",s.error.details.uri),!((O=s.error.details)===null||O===void 0)&&O.workerGroup&&H.setTag("workerGroup",s.error.details.workerGroup),!((D=s.error.details)===null||D===void 0)&&D.geoGroup&&H.setTag("geoGroup",s.error.details.geoGroup),!((B=s.error.details)===null||B===void 0)&&B.on&&H.setTag("connectionAttempt",s.error.details.on),(me=s.error.details)!==null&&me!==void 0&&me.bundleUrl&&(H.setTag("bundleUrl",s.error.details.bundleUrl),H.setTag("bundleError",s.error.details.sourceError.type))),H.setTags({callMode:this._callObjectMode?F()?"reactNative":(f=this.properties)!==null&&f!==void 0&&(f=f.dailyConfig)!==null&&f!==void 0&&(f=f.callMode)!==null&&f!==void 0&&f.includes("prebuilt")?this.properties.dailyConfig.callMode:"custom":"prebuilt-frame",version:t.version()});var At=((g=s.error)===null||g===void 0?void 0:g.msg)||s.errorMsg;H.captureException(new Error(At))}}},{key:"_callMachine",value:function(){var s;return(s=window._daily)===null||s===void 0||(s=s.instances)===null||s===void 0||(s=s[this.callClientId])===null||s===void 0?void 0:s.callMachine}},{key:"_maybeUpdateInputSettings",value:function(s){if(!Z(this._inputSettings,s)){var u=this._getInputSettings();this._inputSettings=s;var c=this._getInputSettings();Z(u,c)||this.emitDailyJSEvent({action:zi,inputSettings:c})}}}],[{key:"supportedBrowser",value:function(){if(F())return{supported:!0,mobile:!0,name:"React Native",version:null,supportsScreenShare:!0,supportsSfu:!0,supportsVideoProcessing:!1,supportsAudioProcessing:!1};var s=xa.getParser(ue());return{supported:!!Tn(),mobile:s.getPlatformType()==="mobile",name:s.getBrowserName(),version:s.getBrowserVersion(),supportsFullscreen:!!Xi(),supportsScreenShare:!!Gc(),supportsSfu:!!Tn(),supportsVideoProcessing:Gs(),supportsAudioProcessing:Ks()}}},{key:"version",value:function(){return"0.84.0"}},{key:"createCallObject",value:function(){var s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return s.layout="none",new t(null,s)}},{key:"wrap",value:function(s){var u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(N(),!s||!s.contentWindow||typeof s.src!="string")throw new Error("DailyIframe::Wrap needs an iframe-like first argument");return u.layout||(u.customLayout?u.layout="custom-v1":u.layout="browser"),new t(s,u)}},{key:"createFrame",value:function(s,u){var c,f;N(),s&&u?(c=s,f=u):s&&s.append?(c=s,f={}):(c=document.body,f=s||{});var g=f.iframeStyle;g||(g=c===document.body?{position:"fixed",border:"1px solid black",backgroundColor:"white",width:"375px",height:"450px",right:"1em",bottom:"1em"}:{border:0,width:"100%",height:"100%"});var y=document.createElement("iframe");window.navigator&&window.navigator.userAgent.match(/Chrome\/61\./)?y.allow="microphone, camera":y.allow="microphone; camera; autoplay; display-capture; screen-wake-lock",y.style.visibility="hidden",c.appendChild(y),y.style.visibility=null,Object.keys(g).forEach((function(S){return y.style[S]=g[S]})),f.layout||(f.customLayout?f.layout="custom-v1":f.layout="browser");try{return new t(y,f)}catch(S){throw c.removeChild(y),S}}},{key:"createTransparentFrame",value:function(){var s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};N();var u=document.createElement("iframe");return u.allow="microphone; camera; autoplay",u.style.cssText=`
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      border: 0;
      pointer-events: none;
    `,document.body.appendChild(u),s.layout||(s.layout="custom-v1"),t.wrap(u,s)}},{key:"getCallInstance",value:function(){var s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:void 0;return s?Fe[s]:Object.values(Fe)[0]}}]);var e,n,r,i,a,o,l,d,h,p,v,E,C,b,m,_,w,T,A,I,x,R,z,te,Ze,et,tt,_r,wr,kr,Sr,Cr,Mr,Er,Tr,Ar,Or,Pr})();function ks(t){if(t.extension){if(typeof t.extension!="string")throw new Error("Error starting dial out: extension must be a string");if(t.extension.length>20)throw new Error("Error starting dial out: extension length must be less than or equal to 20")}if(t.waitBeforeExtensionDialSec){if(typeof t.waitBeforeExtensionDialSec!="number")throw new Error("Error starting dial out: waitBeforeExtensionDialSec must be a number");if(t.waitBeforeExtensionDialSec>60)throw new Error("Error starting dial out: waitBeforeExtensionDialSec must be less than or equal to 60");if(!t.extension)throw new Error("Error starting dial out: waitBeforeExtensionDialSec requires a phoneNumber and extension")}}function nt(t,e){var n={};for(var r in t)if(t[r]instanceof MediaStreamTrack)console.warn("MediaStreamTrack found in props or cache.",r),n[r]=Ce;else if(r==="dailyConfig"){if(t[r].modifyLocalSdpHook){var i=window._daily.instances[e].customCallbacks||{};i.modifyLocalSdpHook=t[r].modifyLocalSdpHook,window._daily.instances[e].customCallbacks=i,delete t[r].modifyLocalSdpHook}if(t[r].modifyRemoteSdpHook){var a=window._daily.instances[e].customCallbacks||{};a.modifyRemoteSdpHook=t[r].modifyRemoteSdpHook,window._daily.instances[e].customCallbacks=a,delete t[r].modifyRemoteSdpHook}n[r]=t[r]}else n[r]=t[r];return n}function J(t){var e=arguments.length>2?arguments[2]:void 0;if(t!==$e){var n="".concat(arguments.length>1&&arguments[1]!==void 0?arguments[1]:"This daily-js method"," only supported after join.");throw e&&(n+=" ".concat(e)),console.error(n),new Error(n)}}function Ht(t,e){return[Kn,$e].includes(t)||e}function In(t,e){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"This daily-js method",r=arguments.length>3?arguments[3]:void 0;if(Ht(t,e)){var i="".concat(n," not supported after joining a meeting.");throw r&&(i+=" ".concat(r)),console.error(i),new Error(i)}}function Jt(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"This daily-js method",n=arguments.length>2?arguments[2]:void 0;if(!t){var r="".concat(e,arguments.length>3&&arguments[3]!==void 0&&arguments[3]?" requires preAuth() or startCamera() to initialize call state.":" requires preAuth(), startCamera(), or join() to initialize call state.");throw n&&(r+=" ".concat(n)),console.error(r),new Error(r)}}function xn(t){if(t){var e="A pre-call quality test is in progress. Please try ".concat(arguments.length>1&&arguments[1]!==void 0?arguments[1]:"This daily-js method"," again once testing has completed. Use stopTestCallQuality() to end it early.");throw console.error(e),new Error(e)}}function de(t){if(!t){var e="".concat(arguments.length>1&&arguments[1]!==void 0?arguments[1]:"This daily-js method"," is only supported on custom callObject instances");throw console.error(e),new Error(e)}}function ne(t){if(t){var e="".concat(arguments.length>1&&arguments[1]!==void 0?arguments[1]:"This daily-js method"," is only supported as part of Daily's Prebuilt");throw console.error(e),new Error(e)}}function N(){if(F())throw new Error("This daily-js method is not currently supported in React Native")}function yt(){if(!F())throw new Error("This daily-js method is only supported in React Native")}function la(t){if(t===void 0)return!0;var e;if(typeof t=="string")e=t;else try{e=JSON.stringify(t),Z(JSON.parse(e),t)||console.warn("The userData provided will be modified when serialized.")}catch(n){throw Error("userData must be serializable to JSON: ".concat(n))}if(e.length>4096)throw Error("userData is too large (".concat(e.length," characters). Maximum size suppported is ").concat(4096,"."));return!0}function ua(t,e){for(var n=e.allowAllParticipantsKey,r=function(v){var E=["local"];return n||E.push("*"),v&&!E.includes(v)},i=function(v){return!!(v.layer===void 0||Number.isInteger(v.layer)&&v.layer>=0||v.layer==="inherit")},a=function(v){return!!v&&!(v.video&&!i(v.video))&&!(v.screenVideo&&!i(v.screenVideo))},o=0,l=Object.entries(t);o<l.length;o++){var d=Y(l[o],2),h=d[0],p=d[1];if(!r(h)||!a(p))return!1}return!0}function da(t){if(U(t)!=="object")return!1;for(var e=0,n=Object.entries(t);e<n.length;e++){var r=Y(n[e],2),i=r[0],a=r[1];switch(i){case"video":if(U(a)!=="object")return!1;for(var o=0,l=Object.entries(a);o<l.length;o++){var d=Y(l[o],2),h=d[0],p=d[1];switch(h){case"processor":if(!Cl(p))return!1;break;case"settings":if(!Ss(p))return!1;break;default:return!1}}break;case"audio":if(U(a)!=="object")return!1;for(var v=0,E=Object.entries(a);v<E.length;v++){var C=Y(E[v],2),b=C[0],m=C[1];switch(b){case"processor":if(!Sl(m))return!1;break;case"settings":if(!Ss(m))return!1;break;default:return!1}}break;default:return!1}}return!0}function ha(t,e,n){var r,i=[];t.video&&t.video.processor&&(Gs((r=e?.useLegacyVideoProcessor)!==null&&r!==void 0&&r)||(t.video.settings?delete t.video.processor:delete t.video,i.push("video"))),t.audio&&t.audio.processor&&(Ks()||(t.audio.settings?delete t.audio.processor:delete t.audio,i.push("audio"))),i.length>0&&console.error("Ignoring settings for browser- or platform-unsupported input processor(s): ".concat(i.join(", "))),t.audio&&t.audio.settings&&(t.audio.settings.customTrack?(n.audioTrack=t.audio.settings.customTrack,t.audio.settings={customTrack:Ce}):delete n.audioTrack),t.video&&t.video.settings&&(t.video.settings.customTrack?(n.videoTrack=t.video.settings.customTrack,t.video.settings={customTrack:Ce}):delete n.videoTrack)}function Sl(t){if(F())return console.warn("Video processing is not yet supported in React Native"),!1;var e=["type"];return!!t&&U(t)==="object"&&(Object.keys(t).filter((function(n){return!e.includes(n)})).forEach((function(n){console.warn("invalid key inputSettings -> audio -> processor : ".concat(n)),delete t[n]})),!!(function(n){return typeof n!="string"?!1:Object.values(Hs).includes(n)?!0:(console.error("inputSettings audio processor type invalid"),!1)})(t.type))}function Cl(t){if(F())return console.warn("Video processing is not yet supported in React Native"),!1;var e=["type","config"];return!t||U(t)!=="object"||!(function(n){return typeof n!="string"?!1:Object.values(Wt).includes(n)?!0:(console.error("inputSettings video processor type invalid"),!1)})(t.type)||t.config&&(U(t.config)!=="object"||!(function(n,r){var i=Object.keys(r);if(i.length===0)return!0;var a="invalid object in inputSettings -> video -> processor -> config";switch(n){case Wt.BGBLUR:return i.length>1||i[0]!=="strength"?(console.error(a),!1):!(typeof r.strength!="number"||r.strength<=0||r.strength>1||isNaN(r.strength))||(console.error("".concat(a,"; expected: {0 < strength <= 1}, got: ").concat(r.strength)),!1);case Wt.BGIMAGE:return!(r.source!==void 0&&!(function(o){if(o.source==="default")return o.type="default",!0;if(o.source instanceof ArrayBuffer)return!0;if(Gt(o.source))return o.type="url",!!(function(h){var p=new URL(h),v=p.pathname;if(p.protocol==="data:")try{var E=v.substring(v.indexOf(":")+1,v.indexOf(";")).split("/")[1];return En.includes(E)}catch(b){return console.error("failed to deduce blob content type",b),!1}var C=v.split(".").at(-1).toLowerCase().trim();return En.includes(C)})(o.source)||(console.error("invalid image type; supported types: [".concat(En.join(", "),"]")),!1);return l=o.source,d=Number(l),isNaN(d)||!Number.isInteger(d)||d<=0||d>10?(console.error("invalid image selection; must be an int, > 0, <= ".concat(10)),!1):(o.type="daily-preselect",!0);var l,d})(r));default:return!0}})(t.type,t.config))?!1:(Object.keys(t).filter((function(n){return!e.includes(n)})).forEach((function(n){console.warn("invalid key inputSettings -> video -> processor : ".concat(n)),delete t[n]})),!0)}function Ss(t){return U(t)==="object"&&(!t.customTrack||t.customTrack instanceof MediaStreamTrack)}function rr(){var t=Object.values(Wt).join(" | "),e=Object.values(Hs).join(" | ");return"inputSettings must be of the form: { video?: { processor?: { type: [ ".concat(t," ], config?: {} } }, audio?: { processor: {type: [ ").concat(e," ] } } }")}function fa(t){var e=t.allowAllParticipantsKey;return"receiveSettings must be of the form { [<remote participant id> | ".concat(Go).concat(e?' | "'.concat("*",'"'):"","]: ")+'{ [video: [{ layer: [<non-negative integer> | "inherit"] } | "inherit"]], [screenVideo: [{ layer: [<non-negative integer> | "inherit"] } | "inherit"]] }}}'}function pa(){return"customIntegrations should be an object of type ".concat(JSON.stringify(nr),".")}function ga(t){if(t&&U(t)!=="object"||Array.isArray(t))return console.error("customTrayButtons should be an Object of the type ".concat(JSON.stringify(nn),".")),!1;if(t)for(var e=0,n=Object.entries(t);e<n.length;e++)for(var r=Y(n[e],1)[0],i=0,a=Object.entries(t[r]);i<a.length;i++){var o=Y(a[i],2),l=o[0],d=o[1],h=nn.id[l];if(!h)return console.error("customTrayButton does not support key ".concat(l)),!1;switch(l){case"iconPath":case"iconPathDarkMode":if(!Gt(d))return console.error("customTrayButton ".concat(l," should be a url.")),!1;break;case"visualState":if(!["default","sidebar-open","active"].includes(d))return console.error("customTrayButton ".concat(l," should be ").concat(h,". Got: ").concat(d)),!1;break;default:if(U(d)!==h)return console.error("customTrayButton ".concat(l," should be a ").concat(h,".")),!1}}return!0}function ma(t){if(!t||t&&U(t)!=="object"||Array.isArray(t))return console.error(pa()),!1;for(var e=function(v){return"".concat(v," should be ").concat(nr.id[v])},n=function(v,E){return console.error("customIntegration ".concat(v,": ").concat(E))},r=0,i=Object.entries(t);r<i.length;r++){var a=Y(i[r],1)[0];if(!("label"in t[a]))return n(a,"label is required"),!1;if(!("location"in t[a]))return n(a,"location is required"),!1;if(!("src"in t[a])&&!("srcdoc"in t[a]))return n(a,"src or srcdoc is required"),!1;for(var o=0,l=Object.entries(t[a]);o<l.length;o++){var d=Y(l[o],2),h=d[0],p=d[1];switch(h){case"allow":case"csp":case"name":case"referrerPolicy":case"sandbox":if(typeof p!="string")return n(a,e(h)),!1;break;case"iconURL":if(!Gt(p))return n(a,"".concat(h," should be a url")),!1;break;case"src":if("srcdoc"in t[a])return n(a,"cannot have both src and srcdoc"),!1;if(!Gt(p))return n(a,'src "'.concat(p,'" is not a valid URL')),!1;break;case"srcdoc":if("src"in t[a])return n(a,"cannot have both src and srcdoc"),!1;if(typeof p!="string")return n(a,e(h)),!1;break;case"location":if(!["main","sidebar"].includes(p))return n(a,e(h)),!1;break;case"controlledBy":if(p!=="*"&&p!=="owners"&&(!Array.isArray(p)||p.some((function(v){return typeof v!="string"}))))return n(a,e(h)),!1;break;case"shared":if((!Array.isArray(p)||p.some((function(v){return typeof v!="string"})))&&p!=="owners"&&typeof p!="boolean")return n(a,e(h)),!1;break;default:if(!nr.id[h])return console.error("customIntegration does not support key ".concat(h)),!1}}}return!0}function va(t,e){if(e===void 0)return!1;switch(U(e)){case"string":return U(t)===e;case"object":if(U(t)!=="object")return!1;for(var n in t)if(!va(t[n],e[n]))return!1;return!0;default:return!1}}function Cs(t,e){var n=t.sessionId,r=t.toEndPoint,i=t.callerId,a=t.useSipRefer;if(!n||!r)throw new Error("".concat(e,"() requires a sessionId and toEndPoint"));if(typeof n!="string"||typeof r!="string")throw new Error("Invalid paramater: sessionId and toEndPoint must be of type string");if(a&&!r.startsWith("sip:"))throw new Error('"toEndPoint" must be a "sip" address');if(!r.startsWith("sip:")&&!r.startsWith("+"))throw new Error("toEndPoint: ".concat(r,' must starts with either "sip:" or "+"'));if(i&&typeof i!="string")throw new Error("callerId must be of type string");if(i&&!r.startsWith("+"))throw new Error("callerId is only valid when transferring to a PSTN number")}function Ms(t){if(U(t)!=="object")throw new Error('RemoteMediaPlayerSettings: must be "object" type');if(t.state&&!Object.values(Yn).includes(t.state))throw new Error("Invalid value for RemoteMediaPlayerSettings.state, valid values are: "+JSON.stringify(Yn));if(t.volume){if(typeof t.volume!="number")throw new Error('RemoteMediaPlayerSettings.volume: must be "number" type');if(t.volume<0||t.volume>2)throw new Error("RemoteMediaPlayerSettings.volume: must be between 0.0 - 2.0")}}function Es(t,e,n){return!(typeof t!="number"||t<e||t>n)}function jn(t,e){return t&&!e&&delete t.data,t}function Ml(t){return t&&t.__esModule?t.default:t}function ya(t,e,n,r){Object.defineProperty(t,e,{get:n,set:r,enumerable:!0,configurable:!0})}var ba={};ya(ba,"DailyRTVIMessageType",()=>ir);ya(ba,"DailyTransport",()=>We);class fe{static floatTo16BitPCM(e){const n=new ArrayBuffer(e.length*2),r=new DataView(n);let i=0;for(let a=0;a<e.length;a++,i+=2){let o=Math.max(-1,Math.min(1,e[a]));r.setInt16(i,o<0?o*32768:o*32767,!0)}return n}static mergeBuffers(e,n){const r=new Uint8Array(e.byteLength+n.byteLength);return r.set(new Uint8Array(e),0),r.set(new Uint8Array(n),e.byteLength),r.buffer}_packData(e,n){return[new Uint8Array([n,n>>8]),new Uint8Array([n,n>>8,n>>16,n>>24])][e]}pack(e,n){if(n?.bitsPerSample)if(n?.channels){if(!n?.data)throw new Error('Missing "data"')}else throw new Error('Missing "channels"');else throw new Error('Missing "bitsPerSample"');const{bitsPerSample:r,channels:i,data:a}=n,o=["RIFF",this._packData(1,52),"WAVE","fmt ",this._packData(1,16),this._packData(0,1),this._packData(0,i.length),this._packData(1,e),this._packData(1,e*i.length*r/8),this._packData(0,i.length*r/8),this._packData(0,r),"data",this._packData(1,i[0].length*i.length*r/8),a],l=new Blob(o,{type:"audio/mpeg"}),d=URL.createObjectURL(l);return{blob:l,url:d,channelCount:i.length,sampleRate:e,duration:a.byteLength/(i.length*e*2)}}}globalThis.WavPacker=fe;const Ts=[4186.01,4434.92,4698.63,4978.03,5274.04,5587.65,5919.91,6271.93,6644.88,7040,7458.62,7902.13],El=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"],Ie=[],br=[];for(let t=1;t<=8;t++)for(let e=0;e<Ts.length;e++){const n=Ts[e];Ie.push(n/Math.pow(2,8-t)),br.push(El[e]+t)}const rn=[32,2e3],As=Ie.filter((t,e)=>Ie[e]>rn[0]&&Ie[e]<rn[1]),Tl=br.filter((t,e)=>Ie[e]>rn[0]&&Ie[e]<rn[1]);class ht{static getFrequencies(e,n,r,i="frequency",a=-100,o=-30){r||(r=new Float32Array(e.frequencyBinCount),e.getFloatFrequencyData(r));const l=n/2,d=1/r.length*l;let h,p,v;if(i==="music"||i==="voice"){const b=i==="voice"?As:Ie,m=Array(b.length).fill(a);for(let _=0;_<r.length;_++){const w=_*d,T=r[_];for(let A=b.length-1;A>=0;A--)if(w>b[A]){m[A]=Math.max(m[A],T);break}}h=m,p=i==="voice"?As:Ie,v=i==="voice"?Tl:br}else h=Array.from(r),p=h.map((b,m)=>d*m),v=p.map(b=>`${b.toFixed(2)} Hz`);const E=h.map(b=>Math.max(0,Math.min((b-a)/(o-a),1)));return{values:new Float32Array(E),frequencies:p,labels:v}}constructor(e,n=null){if(this.fftResults=[],n){const{length:r,sampleRate:i}=n,a=new OfflineAudioContext({length:r,sampleRate:i}),o=a.createBufferSource();o.buffer=n;const l=a.createAnalyser();l.fftSize=8192,l.smoothingTimeConstant=.1,o.connect(l);const d=1/60,h=r/i,p=v=>{const E=d*v;E<h&&a.suspend(E).then(()=>{const C=new Float32Array(l.frequencyBinCount);l.getFloatFrequencyData(C),this.fftResults.push(C),p(v+1)}),v===1?a.startRendering():a.resume()};o.start(0),p(1),this.audio=e,this.context=a,this.analyser=l,this.sampleRate=i,this.audioBuffer=n}else{const r=new AudioContext,i=r.createMediaElementSource(e),a=r.createAnalyser();a.fftSize=8192,a.smoothingTimeConstant=.1,i.connect(a),a.connect(r.destination),this.audio=e,this.context=r,this.analyser=a,this.sampleRate=this.context.sampleRate,this.audioBuffer=null}}getFrequencies(e="frequency",n=-100,r=-30){let i=null;if(this.audioBuffer&&this.fftResults.length){const a=this.audio.currentTime/this.audio.duration,o=Math.min(a*this.fftResults.length|0,this.fftResults.length-1);i=this.fftResults[o]}return ht.getFrequencies(this.analyser,this.sampleRate,i,e,n,r)}async resumeIfSuspended(){return this.context.state==="suspended"&&await this.context.resume(),!0}}globalThis.AudioAnalysis=ht;const Al=`
class StreamProcessor extends AudioWorkletProcessor {
  constructor() {
    super();
    this.hasStarted = false;
    this.hasInterrupted = false;
    this.outputBuffers = [];
    this.bufferLength = 128;
    this.write = { buffer: new Float32Array(this.bufferLength), trackId: null };
    this.writeOffset = 0;
    this.trackSampleOffsets = {};
    this.port.onmessage = (event) => {
      if (event.data) {
        const payload = event.data;
        if (payload.event === 'write') {
          const int16Array = payload.buffer;
          const float32Array = new Float32Array(int16Array.length);
          for (let i = 0; i < int16Array.length; i++) {
            float32Array[i] = int16Array[i] / 0x8000; // Convert Int16 to Float32
          }
          this.writeData(float32Array, payload.trackId);
        } else if (
          payload.event === 'offset' ||
          payload.event === 'interrupt'
        ) {
          const requestId = payload.requestId;
          const trackId = this.write.trackId;
          const offset = this.trackSampleOffsets[trackId] || 0;
          this.port.postMessage({
            event: 'offset',
            requestId,
            trackId,
            offset,
          });
          if (payload.event === 'interrupt') {
            this.hasInterrupted = true;
          }
        } else {
          throw new Error(\`Unhandled event "\${payload.event}"\`);
        }
      }
    };
  }

  writeData(float32Array, trackId = null) {
    let { buffer } = this.write;
    let offset = this.writeOffset;
    for (let i = 0; i < float32Array.length; i++) {
      buffer[offset++] = float32Array[i];
      if (offset >= buffer.length) {
        this.outputBuffers.push(this.write);
        this.write = { buffer: new Float32Array(this.bufferLength), trackId };
        buffer = this.write.buffer;
        offset = 0;
      }
    }
    this.writeOffset = offset;
    return true;
  }

  process(inputs, outputs, parameters) {
    const output = outputs[0];
    const outputChannelData = output[0];
    const outputBuffers = this.outputBuffers;
    if (this.hasInterrupted) {
      this.port.postMessage({ event: 'stop' });
      return false;
    } else if (outputBuffers.length) {
      this.hasStarted = true;
      const { buffer, trackId } = outputBuffers.shift();
      for (let i = 0; i < outputChannelData.length; i++) {
        outputChannelData[i] = buffer[i] || 0;
      }
      if (trackId) {
        this.trackSampleOffsets[trackId] =
          this.trackSampleOffsets[trackId] || 0;
        this.trackSampleOffsets[trackId] += buffer.length;
      }
      return true;
    } else if (this.hasStarted) {
      this.port.postMessage({ event: 'stop' });
      return false;
    } else {
      return true;
    }
  }
}

registerProcessor('stream_processor', StreamProcessor);
`,Ol=new Blob([Al],{type:"application/javascript"}),Pl=URL.createObjectURL(Ol),Il=Pl;class xl{constructor({sampleRate:e=44100}={}){this.scriptSrc=Il,this.sampleRate=e,this.context=null,this.stream=null,this.analyser=null,this.trackSampleOffsets={},this.interruptedTrackIds={}}async connect(){this.context=new AudioContext({sampleRate:this.sampleRate}),this._speakerID&&this.context.setSinkId(this._speakerID),this.context.state==="suspended"&&await this.context.resume();try{await this.context.audioWorklet.addModule(this.scriptSrc)}catch(n){throw console.error(n),new Error(`Could not add audioWorklet module: ${this.scriptSrc}`)}const e=this.context.createAnalyser();return e.fftSize=8192,e.smoothingTimeConstant=.1,this.analyser=e,!0}getFrequencies(e="frequency",n=-100,r=-30){if(!this.analyser)throw new Error("Not connected, please call .connect() first");return ht.getFrequencies(this.analyser,this.sampleRate,null,e,n,r)}async updateSpeaker(e){const n=this._speakerID;if(this._speakerID=e,this.context)try{e==="default"?await this.context.setSinkId():await this.context.setSinkId(e)}catch(r){console.error(`Could not set sinkId to ${e}: ${r}`),this._speakerID=n}}_start(){const e=new AudioWorkletNode(this.context,"stream_processor");return e.connect(this.context.destination),e.port.onmessage=n=>{const{event:r}=n.data;if(r==="stop")e.disconnect(),this.stream=null;else if(r==="offset"){const{requestId:i,trackId:a,offset:o}=n.data,l=o/this.sampleRate;this.trackSampleOffsets[i]={trackId:a,offset:o,currentTime:l}}},this.analyser.disconnect(),e.connect(this.analyser),this.stream=e,!0}add16BitPCM(e,n="default"){if(typeof n!="string")throw new Error("trackId must be a string");if(this.interruptedTrackIds[n])return;this.stream||this._start();let r;if(e instanceof Int16Array)r=e;else if(e instanceof ArrayBuffer)r=new Int16Array(e);else throw new Error("argument must be Int16Array or ArrayBuffer");return this.stream.port.postMessage({event:"write",buffer:r,trackId:n}),r}async getTrackSampleOffset(e=!1){if(!this.stream)return null;const n=crypto.randomUUID();this.stream.port.postMessage({event:e?"interrupt":"offset",requestId:n});let r;for(;!r;)r=this.trackSampleOffsets[n],await new Promise(a=>setTimeout(()=>a(),1));const{trackId:i}=r;return e&&i&&(this.interruptedTrackIds[i]=!0),r}async interrupt(){return this.getTrackSampleOffset(!0)}}globalThis.WavStreamPlayer=xl;const jl=`
class AudioProcessor extends AudioWorkletProcessor {

  constructor() {
    super();
    this.port.onmessage = this.receive.bind(this);
    this.initialize();
  }

  initialize() {
    this.foundAudio = false;
    this.recording = false;
    this.chunks = [];
  }

  /**
   * Concatenates sampled chunks into channels
   * Format is chunk[Left[], Right[]]
   */
  readChannelData(chunks, channel = -1, maxChannels = 9) {
    let channelLimit;
    if (channel !== -1) {
      if (chunks[0] && chunks[0].length - 1 < channel) {
        throw new Error(
          \`Channel \${channel} out of range: max \${chunks[0].length}\`
        );
      }
      channelLimit = channel + 1;
    } else {
      channel = 0;
      channelLimit = Math.min(chunks[0] ? chunks[0].length : 1, maxChannels);
    }
    const channels = [];
    for (let n = channel; n < channelLimit; n++) {
      const length = chunks.reduce((sum, chunk) => {
        return sum + chunk[n].length;
      }, 0);
      const buffers = chunks.map((chunk) => chunk[n]);
      const result = new Float32Array(length);
      let offset = 0;
      for (let i = 0; i < buffers.length; i++) {
        result.set(buffers[i], offset);
        offset += buffers[i].length;
      }
      channels[n] = result;
    }
    return channels;
  }

  /**
   * Combines parallel audio data into correct format,
   * channels[Left[], Right[]] to float32Array[LRLRLRLR...]
   */
  formatAudioData(channels) {
    if (channels.length === 1) {
      // Simple case is only one channel
      const float32Array = channels[0].slice();
      const meanValues = channels[0].slice();
      return { float32Array, meanValues };
    } else {
      const float32Array = new Float32Array(
        channels[0].length * channels.length
      );
      const meanValues = new Float32Array(channels[0].length);
      for (let i = 0; i < channels[0].length; i++) {
        const offset = i * channels.length;
        let meanValue = 0;
        for (let n = 0; n < channels.length; n++) {
          float32Array[offset + n] = channels[n][i];
          meanValue += channels[n][i];
        }
        meanValues[i] = meanValue / channels.length;
      }
      return { float32Array, meanValues };
    }
  }

  /**
   * Converts 32-bit float data to 16-bit integers
   */
  floatTo16BitPCM(float32Array) {
    const buffer = new ArrayBuffer(float32Array.length * 2);
    const view = new DataView(buffer);
    let offset = 0;
    for (let i = 0; i < float32Array.length; i++, offset += 2) {
      let s = Math.max(-1, Math.min(1, float32Array[i]));
      view.setInt16(offset, s < 0 ? s * 0x8000 : s * 0x7fff, true);
    }
    return buffer;
  }

  /**
   * Retrieves the most recent amplitude values from the audio stream
   * @param {number} channel
   */
  getValues(channel = -1) {
    const channels = this.readChannelData(this.chunks, channel);
    const { meanValues } = this.formatAudioData(channels);
    return { meanValues, channels };
  }

  /**
   * Exports chunks as an audio/wav file
   */
  export() {
    const channels = this.readChannelData(this.chunks);
    const { float32Array, meanValues } = this.formatAudioData(channels);
    const audioData = this.floatTo16BitPCM(float32Array);
    return {
      meanValues: meanValues,
      audio: {
        bitsPerSample: 16,
        channels: channels,
        data: audioData,
      },
    };
  }

  receive(e) {
    const { event, id } = e.data;
    let receiptData = {};
    switch (event) {
      case 'start':
        this.recording = true;
        break;
      case 'stop':
        this.recording = false;
        break;
      case 'clear':
        this.initialize();
        break;
      case 'export':
        receiptData = this.export();
        break;
      case 'read':
        receiptData = this.getValues();
        break;
      default:
        break;
    }
    // Always send back receipt
    this.port.postMessage({ event: 'receipt', id, data: receiptData });
  }

  sendChunk(chunk) {
    const channels = this.readChannelData([chunk]);
    const { float32Array, meanValues } = this.formatAudioData(channels);
    const rawAudioData = this.floatTo16BitPCM(float32Array);
    const monoAudioData = this.floatTo16BitPCM(meanValues);
    this.port.postMessage({
      event: 'chunk',
      data: {
        mono: monoAudioData,
        raw: rawAudioData,
      },
    });
  }

  process(inputList, outputList, parameters) {
    // Copy input to output (e.g. speakers)
    // Note that this creates choppy sounds with Mac products
    const sourceLimit = Math.min(inputList.length, outputList.length);
    for (let inputNum = 0; inputNum < sourceLimit; inputNum++) {
      const input = inputList[inputNum];
      const output = outputList[inputNum];
      const channelCount = Math.min(input.length, output.length);
      for (let channelNum = 0; channelNum < channelCount; channelNum++) {
        input[channelNum].forEach((sample, i) => {
          output[channelNum][i] = sample;
        });
      }
    }
    const inputs = inputList[0];
    // There's latency at the beginning of a stream before recording starts
    // Make sure we actually receive audio data before we start storing chunks
    let sliceIndex = 0;
    if (!this.foundAudio) {
      for (const channel of inputs) {
        sliceIndex = 0; // reset for each channel
        if (this.foundAudio) {
          break;
        }
        if (channel) {
          for (const value of channel) {
            if (value !== 0) {
              // find only one non-zero entry in any channel
              this.foundAudio = true;
              break;
            } else {
              sliceIndex++;
            }
          }
        }
      }
    }
    if (inputs && inputs[0] && this.foundAudio && this.recording) {
      // We need to copy the TypedArray, because the \`process\`
      // internals will reuse the same buffer to hold each input
      const chunk = inputs.map((input) => input.slice(sliceIndex));
      this.chunks.push(chunk);
      this.sendChunk(chunk);
    }
    return true;
  }
}

registerProcessor('audio_processor', AudioProcessor);
`,Ll=new Blob([jl],{type:"application/javascript"}),Dl=URL.createObjectURL(Ll),_a=Dl;class Rl{constructor({sampleRate:e=44100,outputToSpeakers:n=!1,debug:r=!1}={}){this.scriptSrc=_a,this.sampleRate=e,this.outputToSpeakers=n,this.debug=!!r,this._deviceChangeCallback=null,this._deviceErrorCallback=null,this._devices=[],this.deviceSelection=null,this.stream=null,this.processor=null,this.source=null,this.node=null,this.recording=!1,this._lastEventId=0,this.eventReceipts={},this.eventTimeout=5e3,this._chunkProcessor=()=>{},this._chunkProcessorSize=void 0,this._chunkProcessorBuffer={raw:new ArrayBuffer(0),mono:new ArrayBuffer(0)}}static async decode(e,n=44100,r=-1){const i=new AudioContext({sampleRate:n});let a,o;if(e instanceof Blob){if(r!==-1)throw new Error('Can not specify "fromSampleRate" when reading from Blob');o=e,a=await o.arrayBuffer()}else if(e instanceof ArrayBuffer){if(r!==-1)throw new Error('Can not specify "fromSampleRate" when reading from ArrayBuffer');a=e,o=new Blob([a],{type:"audio/wav"})}else{let p,v;if(e instanceof Int16Array){v=e,p=new Float32Array(e.length);for(let m=0;m<e.length;m++)p[m]=e[m]/32768}else if(e instanceof Float32Array)p=e;else if(e instanceof Array)p=new Float32Array(e);else throw new Error('"audioData" must be one of: Blob, Float32Arrray, Int16Array, ArrayBuffer, Array<number>');if(r===-1)throw new Error('Must specify "fromSampleRate" when reading from Float32Array, In16Array or Array');if(r<3e3)throw new Error('Minimum "fromSampleRate" is 3000 (3kHz)');v||(v=fe.floatTo16BitPCM(p));const E={bitsPerSample:16,channels:[p],data:v};o=new fe().pack(r,E).blob,a=await o.arrayBuffer()}const l=await i.decodeAudioData(a),d=l.getChannelData(0),h=URL.createObjectURL(o);return{blob:o,url:h,values:d,audioBuffer:l}}log(){return this.debug&&this.log(...arguments),!0}getSampleRate(){return this.sampleRate}getStatus(){return this.processor?this.recording?"recording":"paused":"ended"}async _event(e,n={},r=null){if(r=r||this.processor,!r)throw new Error("Can not send events without recording first");const i={event:e,id:this._lastEventId++,data:n};r.port.postMessage(i);const a=new Date().valueOf();for(;!this.eventReceipts[i.id];){if(new Date().valueOf()-a>this.eventTimeout)throw new Error(`Timeout waiting for "${e}" event`);await new Promise(l=>setTimeout(()=>l(!0),1))}const o=this.eventReceipts[i.id];return delete this.eventReceipts[i.id],o}listenForDeviceChange(e){if(e===null&&this._deviceChangeCallback)navigator.mediaDevices.removeEventListener("devicechange",this._deviceChangeCallback),this._deviceChangeCallback=null;else if(e!==null){let n=0,r=[];const i=o=>o.map(l=>l.deviceId).sort().join(","),a=async()=>{let o=++n;const l=await this.listDevices();o===n&&i(r)!==i(l)&&(r=l,e(l.slice()))};navigator.mediaDevices.addEventListener("devicechange",a),a(),this._deviceChangeCallback=a}return!0}listenForDeviceErrors(e){this._deviceErrorCallback=e}async requestPermission(){const e=await navigator.permissions.query({name:"microphone"});if(e.state==="denied")this._deviceErrorCallback&&this._deviceErrorCallback({devices:["mic"],type:"unknown",error:new Error("Microphone access denied")});else if(e.state==="prompt")try{(await navigator.mediaDevices.getUserMedia({audio:!0})).getTracks().forEach(i=>i.stop())}catch(n){console.error("Error accessing microphone."),this._deviceErrorCallback&&this._deviceErrorCallback({devices:["mic"],type:"unknown",error:n})}return!0}async listDevices(){if(!navigator.mediaDevices||!("enumerateDevices"in navigator.mediaDevices))throw new Error("Could not request user devices");return await this.requestPermission(),(await navigator.mediaDevices.enumerateDevices()).filter(r=>r.kind==="audioinput")}async begin(e){if(this.processor)throw new Error("Already connected: please call .end() to start a new session");if(!navigator.mediaDevices||!("getUserMedia"in navigator.mediaDevices))throw this._deviceErrorCallback&&this._deviceErrorCallback({devices:["mic","cam"],type:"undefined-mediadevices"}),new Error("Could not request user media");e=e??this.deviceSelection?.deviceId;try{const l={audio:!0};e&&(l.audio={deviceId:{exact:e}}),this.stream=await navigator.mediaDevices.getUserMedia(l)}catch(l){throw this._deviceErrorCallback&&this._deviceErrorCallback({devices:["mic"],type:"unknown",error:l}),new Error("Could not start media stream")}this.listDevices().then(l=>{e=this.stream.getAudioTracks()[0].getSettings().deviceId,console.log("find current device",l,e,this.stream.getAudioTracks()[0].getSettings()),this.deviceSelection=l.find(d=>d.deviceId===e),console.log("current device",this.deviceSelection)});const n=new AudioContext({sampleRate:this.sampleRate}),r=n.createMediaStreamSource(this.stream);try{await n.audioWorklet.addModule(this.scriptSrc)}catch(l){throw console.error(l),new Error(`Could not add audioWorklet module: ${this.scriptSrc}`)}const i=new AudioWorkletNode(n,"audio_processor");i.port.onmessage=l=>{const{event:d,id:h,data:p}=l.data;if(d==="receipt")this.eventReceipts[h]=p;else if(d==="chunk")if(this._chunkProcessorSize){const v=this._chunkProcessorBuffer;this._chunkProcessorBuffer={raw:fe.mergeBuffers(v.raw,p.raw),mono:fe.mergeBuffers(v.mono,p.mono)},this._chunkProcessorBuffer.mono.byteLength>=this._chunkProcessorSize&&(this._chunkProcessor(this._chunkProcessorBuffer),this._chunkProcessorBuffer={raw:new ArrayBuffer(0),mono:new ArrayBuffer(0)})}else this._chunkProcessor(p)};const a=r.connect(i),o=n.createAnalyser();return o.fftSize=8192,o.smoothingTimeConstant=.1,a.connect(o),this.outputToSpeakers&&(console.warn(`Warning: Output to speakers may affect sound quality,
especially due to system audio feedback preventative measures.
use only for debugging`),o.connect(n.destination)),this.source=r,this.node=a,this.analyser=o,this.processor=i,console.log("begin completed"),!0}getFrequencies(e="frequency",n=-100,r=-30){if(!this.processor)throw new Error("Session ended: please call .begin() first");return ht.getFrequencies(this.analyser,this.sampleRate,null,e,n,r)}async pause(){if(this.processor){if(!this.recording)throw new Error("Already paused: please call .record() first")}else throw new Error("Session ended: please call .begin() first");return this._chunkProcessorBuffer.raw.byteLength&&this._chunkProcessor(this._chunkProcessorBuffer),this.log("Pausing ..."),await this._event("stop"),this.recording=!1,!0}async record(e=()=>{},n=8192){if(this.processor){if(this.recording)throw new Error("Already recording: please call .pause() first");if(typeof e!="function")throw new Error("chunkProcessor must be a function")}else throw new Error("Session ended: please call .begin() first");return this._chunkProcessor=e,this._chunkProcessorSize=n,this._chunkProcessorBuffer={raw:new ArrayBuffer(0),mono:new ArrayBuffer(0)},this.log("Recording ..."),await this._event("start"),this.recording=!0,!0}async clear(){if(!this.processor)throw new Error("Session ended: please call .begin() first");return await this._event("clear"),!0}async read(){if(!this.processor)throw new Error("Session ended: please call .begin() first");return this.log("Reading ..."),await this._event("read")}async save(e=!1){if(!this.processor)throw new Error("Session ended: please call .begin() first");if(!e&&this.recording)throw new Error("Currently recording: please call .pause() first, or call .save(true) to force");this.log("Exporting ...");const n=await this._event("export");return new fe().pack(this.sampleRate,n.audio)}async end(){if(!this.processor)throw new Error("Session ended: please call .begin() first");const e=this.processor;this.log("Stopping ..."),await this._event("stop"),this.recording=!1,this.stream.getTracks().forEach(o=>o.stop()),this.log("Exporting ...");const r=await this._event("export",{},e);return this.processor.disconnect(),this.source.disconnect(),this.node.disconnect(),this.analyser.disconnect(),this.stream=null,this.processor=null,this.source=null,this.node=null,new fe().pack(this.sampleRate,r.audio)}async quit(){return this.listenForDeviceChange(null),this.deviceSelection=null,this.processor&&await this.end(),!0}}globalThis.WavRecorder=Rl;class Nl{constructor({sampleRate:e=44100,outputToSpeakers:n=!1,debug:r=!1}={}){this.scriptSrc=_a,this.sampleRate=e,this.outputToSpeakers=n,this.debug=!!r,this.stream=null,this.processor=null,this.source=null,this.node=null,this.recording=!1,this._lastEventId=0,this.eventReceipts={},this.eventTimeout=5e3,this._chunkProcessor=()=>{},this._chunkProcessorSize=void 0,this._chunkProcessorBuffer={raw:new ArrayBuffer(0),mono:new ArrayBuffer(0)}}log(){return this.debug&&this.log(...arguments),!0}getSampleRate(){return this.sampleRate}getStatus(){return this.processor?this.recording?"recording":"paused":"ended"}async _event(e,n={},r=null){if(r=r||this.processor,!r)throw new Error("Can not send events without recording first");const i={event:e,id:this._lastEventId++,data:n};r.port.postMessage(i);const a=new Date().valueOf();for(;!this.eventReceipts[i.id];){if(new Date().valueOf()-a>this.eventTimeout)throw new Error(`Timeout waiting for "${e}" event`);await new Promise(l=>setTimeout(()=>l(!0),1))}const o=this.eventReceipts[i.id];return delete this.eventReceipts[i.id],o}async begin(e){if(this.processor)throw new Error("Already connected: please call .end() to start a new session");if(!e||e.kind!=="audio")throw new Error("No audio track provided");this.stream=new MediaStream([e]);const n=new AudioContext({sampleRate:this.sampleRate}),r=n.createMediaStreamSource(this.stream);try{await n.audioWorklet.addModule(this.scriptSrc)}catch(l){throw console.error(l),new Error(`Could not add audioWorklet module: ${this.scriptSrc}`)}const i=new AudioWorkletNode(n,"audio_processor");i.port.onmessage=l=>{const{event:d,id:h,data:p}=l.data;if(d==="receipt")this.eventReceipts[h]=p;else if(d==="chunk")if(this._chunkProcessorSize){const v=this._chunkProcessorBuffer;this._chunkProcessorBuffer={raw:fe.mergeBuffers(v.raw,p.raw),mono:fe.mergeBuffers(v.mono,p.mono)},this._chunkProcessorBuffer.mono.byteLength>=this._chunkProcessorSize&&(this._chunkProcessor(this._chunkProcessorBuffer),this._chunkProcessorBuffer={raw:new ArrayBuffer(0),mono:new ArrayBuffer(0)})}else this._chunkProcessor(p)};const a=r.connect(i),o=n.createAnalyser();return o.fftSize=8192,o.smoothingTimeConstant=.1,a.connect(o),this.outputToSpeakers&&(console.warn(`Warning: Output to speakers may affect sound quality,
especially due to system audio feedback preventative measures.
use only for debugging`),o.connect(n.destination)),this.source=r,this.node=a,this.analyser=o,this.processor=i,!0}getFrequencies(e="frequency",n=-100,r=-30){if(!this.processor)throw new Error("Session ended: please call .begin() first");return ht.getFrequencies(this.analyser,this.sampleRate,null,e,n,r)}async pause(){if(this.processor){if(!this.recording)throw new Error("Already paused: please call .record() first")}else throw new Error("Session ended: please call .begin() first");return this._chunkProcessorBuffer.raw.byteLength&&this._chunkProcessor(this._chunkProcessorBuffer),this.log("Pausing ..."),await this._event("stop"),this.recording=!1,!0}async record(e=()=>{},n=8192){if(this.processor){if(this.recording)throw new Error("Already recording: HELLO please call .pause() first");if(typeof e!="function")throw new Error("chunkProcessor must be a function")}else throw new Error("Session ended: please call .begin() first");return this._chunkProcessor=e,this._chunkProcessorSize=n,this._chunkProcessorBuffer={raw:new ArrayBuffer(0),mono:new ArrayBuffer(0)},this.log("Recording ..."),await this._event("start"),this.recording=!0,!0}async clear(){if(!this.processor)throw new Error("Session ended: please call .begin() first");return await this._event("clear"),!0}async read(){if(!this.processor)throw new Error("Session ended: please call .begin() first");return this.log("Reading ..."),await this._event("read")}async save(e=!1){if(!this.processor)throw new Error("Session ended: please call .begin() first");if(!e&&this.recording)throw new Error("Currently recording: please call .pause() first, or call .save(true) to force");this.log("Exporting ...");const n=await this._event("export");return new fe().pack(this.sampleRate,n.audio)}async end(){if(!this.processor)throw new Error("Session ended: please call .begin() first");const e=this.processor;this.log("Stopping ..."),await this._event("stop"),this.recording=!1,this.log("Exporting ...");const n=await this._event("export",{},e);return this.processor.disconnect(),this.source.disconnect(),this.node.disconnect(),this.analyser.disconnect(),this.stream=null,this.processor=null,this.source=null,this.node=null,new fe().pack(this.sampleRate,n.audio)}async quit(){return this.listenForDeviceChange(null),this.processor&&await this.end(),!0}}globalThis.WavRecorder=WavRecorder;var wa={};wa=JSON.parse('{"name":"@pipecat-ai/daily-transport","version":"1.4.0","license":"BSD-2-Clause","main":"dist/index.js","module":"dist/index.module.js","types":"dist/index.d.ts","source":"src/index.ts","repository":{"type":"git","url":"git+https://github.com/pipecat-ai/pipecat-client-web-transports.git"},"files":["dist","package.json","README.md"],"scripts":{"build":"parcel build --no-cache","dev":"parcel watch","lint":"eslint . --ext ts --report-unused-disable-directives --max-warnings 0"},"devDependencies":{"@pipecat-ai/client-js":"^1.4.0","eslint":"9.11.1","eslint-config-prettier":"^9.1.0","eslint-plugin-simple-import-sort":"^12.1.1"},"peerDependencies":{"@pipecat-ai/client-js":"~1.4.0"},"dependencies":{"@daily-co/daily-js":"^0.83.1"},"description":"Pipecat Daily Transport Package","author":"Daily.co","bugs":{"url":"https://github.com/pipecat-ai/pipecat-client-web-transports/issues"},"homepage":"https://github.com/pipecat-ai/pipecat-client-web-transports/blob/main/transports/daily-webrtc/README.md"}');var ir;(function(t){t.AUDIO_BUFFERING_STARTED="audio-buffering-started",t.AUDIO_BUFFERING_STOPPED="audio-buffering-stopped"})(ir||(ir={}));class Fl{constructor(e){this._daily=e,this._proxy=new Proxy(this._daily,{get:(n,r,i)=>{if(typeof n[r]=="function"){let a;switch(String(r)){case"preAuth":a="Calls to preAuth() are disabled. Please use Transport.preAuth()";break;case"startCamera":a="Calls to startCamera() are disabled. Please use PipecatClient.initDevices()";break;case"join":a="Calls to join() are disabled. Please use PipecatClient.connect()";break;case"leave":a="Calls to leave() are disabled. Please use PipecatClient.disconnect()";break;case"destroy":a="Calls to destroy() are disabled.";break}return a?()=>{throw new Error(a)}:(...o)=>n[r](...o)}return Reflect.get(n,r,i)}})}get proxy(){return this._proxy}}class We extends Ca{constructor(e={}){super(),this._botId="",this._selectedCam={},this._selectedMic={},this._selectedSpeaker={},this._currentAudioTrack=null,this._audioQueue=[],this._callbacks={};const{bufferLocalAudioUntilBotReady:n,...r}=e;this._dailyFactoryOptions=r,typeof this._dailyFactoryOptions.dailyConfig?.useDevicePreferenceCookies>"u"&&(this._dailyFactoryOptions.dailyConfig==null&&(this._dailyFactoryOptions.dailyConfig={}),this._dailyFactoryOptions.dailyConfig.useDevicePreferenceCookies=!0),this._bufferLocalAudioUntilBotReady=n||!1,this._daily=kl.createCallObject({...this._dailyFactoryOptions,allowMultipleCallInstances:!0}),this._dailyWrapper=new Fl(this._daily)}setupRecorder(){this._mediaStreamRecorder=new Nl({sampleRate:We.RECORDER_SAMPLE_RATE})}handleUserAudioStream(e){this._audioQueue.push(e)}flushAudioQueue(){if(this._audioQueue.length!==0)for(_e.debug(`Will flush audio queue: ${this._audioQueue.length}`);this._audioQueue.length>0;){const n=[];for(;n.length<10&&this._audioQueue.length>0;){const r=this._audioQueue.shift();r&&n.push(r)}n.length>0&&this._sendAudioBatch(n)}}_sendAudioBatch(e){const r={id:"raw-audio-batch",label:"rtvi-ai",type:"raw-audio-batch",data:{base64AudioBatch:e.map(i=>{const a=new Uint8Array(i);return btoa(String.fromCharCode(...a))}),sampleRate:We.RECORDER_SAMPLE_RATE,numChannels:1}};this.sendMessage(r)}initialize(e,n){this._bufferLocalAudioUntilBotReady&&this.setupRecorder(),this._callbacks=e.callbacks??{},this._onMessage=n,(this._dailyFactoryOptions.startVideoOff==null||e.enableCam!=null)&&(this._dailyFactoryOptions.startVideoOff=!(e.enableCam??!1)),(this._dailyFactoryOptions.startAudioOff==null||e.enableMic!=null)&&(this._dailyFactoryOptions.startAudioOff=!(e.enableMic??!0)),this.attachEventListeners(),this.state="disconnected",_e.debug("[Daily Transport] Initialized",Ml(wa).version)}get dailyCallClient(){return this._dailyWrapper.proxy}get state(){return this._state}set state(e){this._state!==e&&(this._state=e,this._callbacks.onTransportStateChanged?.(e))}getSessionInfo(){return this._daily.meetingSessionSummary()}async getAllCams(){const{devices:e}=await this._daily.enumerateDevices();return e.filter(n=>n.kind==="videoinput")}updateCam(e){this._daily.setInputDevicesAsync({videoDeviceId:e}).then(n=>{this._selectedCam=n.camera})}get selectedCam(){return this._selectedCam}async getAllMics(){const{devices:e}=await this._daily.enumerateDevices();return e.filter(n=>n.kind==="audioinput")}updateMic(e){this._daily.setInputDevicesAsync({audioDeviceId:e}).then(n=>{this._selectedMic=n.mic})}get selectedMic(){return this._selectedMic}async getAllSpeakers(){const{devices:e}=await this._daily.enumerateDevices();return e.filter(n=>n.kind==="audiooutput")}updateSpeaker(e){this._daily.setOutputDeviceAsync({outputDeviceId:e}).then(n=>{this._selectedSpeaker=n.speaker}).catch(n=>{this._callbacks.onDeviceError?.(new Ee(["speaker"],n.type??"unknown",n.message))})}get selectedSpeaker(){return this._selectedSpeaker}enableMic(e){this._daily.setLocalAudio(e)}get isMicEnabled(){return this._daily.localAudio()}enableCam(e){this._daily.setLocalVideo(e)}get isCamEnabled(){return this._daily.localVideo()}enableScreenShare(e){e?this._daily.startScreenShare():this._daily.stopScreenShare()}get isSharingScreen(){return this._daily.localScreenAudio()||this._daily.localScreenVideo()}tracks(){const e=this._daily.participants()??{},n=e?.[this._botId],r={local:{audio:e?.local?.tracks?.audio?.persistentTrack,screenAudio:e?.local?.tracks?.screenAudio?.persistentTrack,screenVideo:e?.local?.tracks?.screenVideo?.persistentTrack,video:e?.local?.tracks?.video?.persistentTrack}};return n&&(r.bot={audio:n?.tracks?.audio?.persistentTrack,video:n?.tracks?.video?.persistentTrack}),r}async startRecording(){try{_e.info("[Daily Transport] Initializing recording"),await this._mediaStreamRecorder.record(e=>{this.handleUserAudioStream(e.mono)},We.RECORDER_CHUNK_SIZE),this._callbacks.onAudioBufferingStarted?.(),_e.info("[Daily Transport] Recording Initialized")}catch(e){e.message.includes("Already recording")||_e.error("Error starting recording",e)}}async preAuth(e){this._dailyFactoryOptions=e,await this._daily.preAuth(e)}async initDevices(){if(!this._daily)throw new fn("Transport instance not initialized");this.state="initializing";const e=await this._daily.startCamera(this._dailyFactoryOptions),{devices:n}=await this._daily.enumerateDevices(),r=n.filter(o=>o.kind==="videoinput"),i=n.filter(o=>o.kind==="audioinput"),a=n.filter(o=>o.kind==="audiooutput");this._selectedCam=e.camera,this._selectedMic=e.mic,this._selectedSpeaker=e.speaker,this._callbacks.onAvailableCamsUpdated?.(r),this._callbacks.onAvailableMicsUpdated?.(i),this._callbacks.onAvailableSpeakersUpdated?.(a),this._callbacks.onCamUpdated?.(e.camera),this._callbacks.onMicUpdated?.(e.mic),this._callbacks.onSpeakerUpdated?.(e.speaker),this._daily.isLocalAudioLevelObserverRunning()||await this._daily.startLocalAudioLevelObserver(100),this._daily.isRemoteParticipantsAudioLevelObserverRunning()||await this._daily.startRemoteParticipantsAudioLevelObserver(100),this.state="initialized"}_validateConnectionParams(e){if(e==null)return;if(typeof e!="object")throw new fn("Invalid connection parameters");const n=e;return n.room_url?(n.url=n.room_url,delete n.room_url):n.dailyRoom&&(n.url=n.dailyRoom,delete n.dailyRoom),n.dailyToken&&(n.token=n.dailyToken,delete n.dailyToken),n.token||delete n.token,n}async _connect(e){if(!this._daily)throw new fn("Transport instance not initialized");e&&(this._dailyFactoryOptions={...this._dailyFactoryOptions,...e}),this.state="connecting";try{await this._daily.join(this._dailyFactoryOptions)}catch(n){throw _e.error("Failed to join room",n),this.state="error",new Ma}this._abortController?.signal.aborted||(this.state="connected",this._callbacks.onConnected?.())}async sendReadyMessage(){return new Promise(e=>{const n=()=>{const a=navigator.userAgent;return/iPad|iPhone|iPod/.test(a)||/Macintosh/.test(a)&&"ontouchend"in document},r=()=>{this.state="ready",this.flushAudioQueue(),this.sendMessage(xr.clientReady()),this.stopRecording(),e()};for(const a in this._daily.participants()){const o=this._daily.participants()[a];if(!o.local&&o.tracks?.audio?.persistentTrack){r(),e();return}}const i=a=>{a.participant?.local||(this._daily.off("track-started",i),n()?(_e.debug("[Daily Transport] iOS device detected, adding 0.5 second delay before sending ready message"),setTimeout(r,500)):r())};this._daily.on("track-started",i)})}stopRecording(){this._mediaStreamRecorder&&this._mediaStreamRecorder.getStatus()!=="ended"&&(this._mediaStreamRecorder.end(),this._callbacks.onAudioBufferingStopped?.())}attachEventListeners(){this._daily.on("available-devices-updated",this.handleAvailableDevicesUpdated.bind(this)),this._daily.on("selected-devices-updated",this.handleSelectedDevicesUpdated.bind(this)),this._daily.on("camera-error",this.handleDeviceError.bind(this)),this._daily.on("track-started",this.handleTrackStarted.bind(this)),this._daily.on("track-stopped",this.handleTrackStopped.bind(this)),this._daily.on("participant-joined",this.handleParticipantJoined.bind(this)),this._daily.on("participant-left",this.handleParticipantLeft.bind(this)),this._daily.on("local-audio-level",this.handleLocalAudioLevel.bind(this)),this._daily.on("remote-participants-audio-level",this.handleRemoteAudioLevel.bind(this)),this._daily.on("app-message",this.handleAppMessage.bind(this)),this._daily.on("left-meeting",this.handleLeftMeeting.bind(this)),this._daily.on("error",this.handleFatalError.bind(this)),this._daily.on("nonfatal-error",this.handleNonFatalError.bind(this))}async _disconnect(){this.state="disconnecting",this._daily.stopLocalAudioLevelObserver(),this._daily.stopRemoteParticipantsAudioLevelObserver(),this._audioQueue=[],this._currentAudioTrack=null,this.stopRecording(),await this._daily.leave()}sendMessage(e){this._daily.sendAppMessage(e,"*")}handleAppMessage(e){e.data.label==="rtvi-ai"&&this._onMessage({id:e.data.id,type:e.data.type,data:e.data.data})}handleAvailableDevicesUpdated(e){this._callbacks.onAvailableCamsUpdated?.(e.availableDevices.filter(n=>n.kind==="videoinput")),this._callbacks.onAvailableMicsUpdated?.(e.availableDevices.filter(n=>n.kind==="audioinput")),this._callbacks.onAvailableSpeakersUpdated?.(e.availableDevices.filter(n=>n.kind==="audiooutput"))}handleSelectedDevicesUpdated(e){this._selectedCam?.deviceId!==e.devices.camera&&(this._selectedCam=e.devices.camera,this._callbacks.onCamUpdated?.(e.devices.camera)),this._selectedMic?.deviceId!==e.devices.mic&&(this._selectedMic=e.devices.mic,this._callbacks.onMicUpdated?.(e.devices.mic)),this._selectedSpeaker?.deviceId!==e.devices.speaker&&(this._selectedSpeaker=e.devices.speaker,this._callbacks.onSpeakerUpdated?.(e.devices.speaker))}handleDeviceError(e){const n=r=>{const i=[];switch(r.type){case"permissions":return r.blockedMedia.forEach(a=>{i.push(a==="video"?"cam":"mic")}),new Ee(i,r.type,r.msg,{blockedBy:r.blockedBy});case"not-found":return r.missingMedia.forEach(a=>{i.push(a==="video"?"cam":"mic")}),new Ee(i,r.type,r.msg);case"constraints":return r.failedMedia.forEach(a=>{i.push(a==="video"?"cam":"mic")}),new Ee(i,r.type,r.msg,{reason:r.reason});case"cam-in-use":return i.push("cam"),new Ee(i,"in-use",r.msg);case"mic-in-use":return i.push("mic"),new Ee(i,"in-use",r.msg);case"cam-mic-in-use":return i.push("cam"),i.push("mic"),new Ee(i,"in-use",r.msg);case"undefined-mediadevices":case"unknown":default:return i.push("cam"),i.push("mic"),new Ee(i,r.type,r.msg)}};this._callbacks.onDeviceError?.(n(e.error))}async handleLocalAudioTrack(e){if(this.state=="ready"||!this._bufferLocalAudioUntilBotReady)return;switch(this._mediaStreamRecorder.getStatus()){case"ended":try{await this._mediaStreamRecorder.begin(e),await this.startRecording()}catch{}break;case"paused":await this.startRecording();break;case"recording":default:if(this._currentAudioTrack!==e)try{await this._mediaStreamRecorder.end(),await this._mediaStreamRecorder.begin(e),await this.startRecording()}catch{}else _e.warn("track-started event received for current track and already recording");break}this._currentAudioTrack=e}handleTrackStarted(e){e.type==="screenAudio"||e.type==="screenVideo"?this._callbacks.onScreenTrackStarted?.(e.track,e.participant?Ue(e.participant):void 0):(e.participant?.local&&e.track.kind==="audio"&&this.handleLocalAudioTrack(e.track),this._callbacks.onTrackStarted?.(e.track,e.participant?Ue(e.participant):void 0))}handleTrackStopped(e){e.type==="screenAudio"||e.type==="screenVideo"?this._callbacks.onScreenTrackStopped?.(e.track,e.participant?Ue(e.participant):void 0):this._callbacks.onTrackStopped?.(e.track,e.participant?Ue(e.participant):void 0)}handleParticipantJoined(e){const n=Ue(e.participant);this._callbacks.onParticipantJoined?.(n),!n.local&&(this._botId=e.participant.session_id,this._callbacks.onBotConnected?.(n))}handleParticipantLeft(e){const n=Ue(e.participant);this._callbacks.onParticipantLeft?.(n),!n.local&&(this._botId="",this._callbacks.onBotDisconnected?.(n))}handleLocalAudioLevel(e){this._callbacks.onLocalAudioLevel?.(e.audioLevel)}handleRemoteAudioLevel(e){const n=this._daily.participants(),r=Object.keys(e.participantsAudioLevel);for(let i=0;i<r.length;i++){const a=r[i],o=e.participantsAudioLevel[a];this._callbacks.onRemoteAudioLevel?.(o,Ue(n[a]))}}handleLeftMeeting(){this.state="disconnected",this._botId="",this._callbacks.onDisconnected?.()}handleFatalError(e){_e.error("Daily fatal error",e.errorMsg),this.state="error",this._botId="",this._callbacks.onError?.(xr.error(e.errorMsg,!0))}handleNonFatalError(e){switch(e.type){case"screen-share-error":this._callbacks.onScreenShareError?.(e.errorMsg);break}}}We.RECORDER_SAMPLE_RATE=16e3;We.RECORDER_CHUNK_SIZE=512;const Ue=t=>({id:t.user_id,local:t.local,name:t.user_name});export{ir as DailyRTVIMessageType,We as DailyTransport};
