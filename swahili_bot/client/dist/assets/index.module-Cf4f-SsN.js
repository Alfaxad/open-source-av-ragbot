import{f as tr,g as Md,$ as Td,a as R,h as Ed,c as Ad,d as fs,e as Od,i as Pd,j as Id,b as Ve}from"./index-CHqzpsZm.js";function ps(r,e){if(r==null)return{};var t,n,i=(function(s,c){if(s==null)return{};var u={};for(var l in s)if({}.hasOwnProperty.call(s,l)){if(c.indexOf(l)!==-1)continue;u[l]=s[l]}return u})(r,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(r);for(n=0;n<a.length;n++)t=a[n],e.indexOf(t)===-1&&{}.propertyIsEnumerable.call(r,t)&&(i[t]=r[t])}return i}function he(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}function z(r){return z=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},z(r)}function pl(r){var e=(function(t,n){if(z(t)!="object"||!t)return t;var i=t[Symbol.toPrimitive];if(i!==void 0){var a=i.call(t,n);if(z(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)})(r,"string");return z(e)=="symbol"?e:e+""}function vs(r,e){for(var t=0;t<e.length;t++){var n=e[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,pl(n.key),n)}}function fe(r,e,t){return e&&vs(r.prototype,e),t&&vs(r,t),Object.defineProperty(r,"prototype",{writable:!1}),r}function Ir(r,e){if(e&&(z(e)=="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return(function(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t})(r)}function Ee(r){return Ee=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Ee(r)}function Bt(r,e){return Bt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,n){return t.__proto__=n,t},Bt(r,e)}function jr(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(e&&e.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),Object.defineProperty(r,"prototype",{writable:!1}),e&&Bt(r,e)}function Ie(r,e,t){return(e=pl(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function gs(r,e,t,n,i,a,s){try{var c=r[a](s),u=c.value}catch(l){return void t(l)}c.done?e(u):Promise.resolve(u).then(n,i)}function D(r){return function(){var e=this,t=arguments;return new Promise((function(n,i){var a=r.apply(e,t);function s(u){gs(a,n,i,s,c,"next",u)}function c(u){gs(a,n,i,s,c,"throw",u)}s(void 0)}))}}function ms(r,e){(e==null||e>r.length)&&(e=r.length);for(var t=0,n=Array(e);t<e;t++)n[t]=r[t];return n}function ie(r,e){return(function(t){if(Array.isArray(t))return t})(r)||(function(t,n){var i=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(i!=null){var a,s,c,u,l=[],f=!0,v=!1;try{if(c=(i=i.call(t)).next,n===0){if(Object(i)!==i)return;f=!1}else for(;!(f=(a=c.call(i)).done)&&(l.push(a.value),l.length!==n);f=!0);}catch(b){v=!0,s=b}finally{try{if(!f&&i.return!=null&&(u=i.return(),Object(u)!==u))return}finally{if(v)throw s}}return l}})(r,e)||(function(t,n){if(t){if(typeof t=="string")return ms(t,n);var i={}.toString.call(t).slice(8,-1);return i==="Object"&&t.constructor&&(i=t.constructor.name),i==="Map"||i==="Set"?Array.from(t):i==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?ms(t,n):void 0}})(r,e)||(function(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)})()}function jd(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var ys,rr={exports:{}},ha=(function(){if(ys)return rr.exports;ys=1;var r,e=typeof Reflect=="object"?Reflect:null,t=e&&typeof e.apply=="function"?e.apply:function(m,_,S){return Function.prototype.apply.call(m,_,S)};r=e&&typeof e.ownKeys=="function"?e.ownKeys:Object.getOwnPropertySymbols?function(m){return Object.getOwnPropertyNames(m).concat(Object.getOwnPropertySymbols(m))}:function(m){return Object.getOwnPropertyNames(m)};var n=Number.isNaN||function(m){return m!=m};function i(){i.init.call(this)}rr.exports=i,rr.exports.once=function(m,_){return new Promise((function(S,C){function A(P){m.removeListener(_,O),C(P)}function O(){typeof m.removeListener=="function"&&m.removeListener("error",A),S([].slice.call(arguments))}y(m,_,O,{once:!0}),_!=="error"&&(function(P,x,U){typeof P.on=="function"&&y(P,"error",x,U)})(m,A,{once:!0})}))},i.EventEmitter=i,i.prototype._events=void 0,i.prototype._eventsCount=0,i.prototype._maxListeners=void 0;var a=10;function s(m){if(typeof m!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof m)}function c(m){return m._maxListeners===void 0?i.defaultMaxListeners:m._maxListeners}function u(m,_,S,C){var A,O,P,x;if(s(S),(O=m._events)===void 0?(O=m._events=Object.create(null),m._eventsCount=0):(O.newListener!==void 0&&(m.emit("newListener",_,S.listener?S.listener:S),O=m._events),P=O[_]),P===void 0)P=O[_]=S,++m._eventsCount;else if(typeof P=="function"?P=O[_]=C?[S,P]:[P,S]:C?P.unshift(S):P.push(S),(A=c(m))>0&&P.length>A&&!P.warned){P.warned=!0;var U=new Error("Possible EventEmitter memory leak detected. "+P.length+" "+String(_)+" listeners added. Use emitter.setMaxListeners() to increase limit");U.name="MaxListenersExceededWarning",U.emitter=m,U.type=_,U.count=P.length,x=U,console&&console.warn&&console.warn(x)}return m}function l(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function f(m,_,S){var C={fired:!1,wrapFn:void 0,target:m,type:_,listener:S},A=l.bind(C);return A.listener=S,C.wrapFn=A,A}function v(m,_,S){var C=m._events;if(C===void 0)return[];var A=C[_];return A===void 0?[]:typeof A=="function"?S?[A.listener||A]:[A]:S?(function(O){for(var P=new Array(O.length),x=0;x<P.length;++x)P[x]=O[x].listener||O[x];return P})(A):k(A,A.length)}function b(m){var _=this._events;if(_!==void 0){var S=_[m];if(typeof S=="function")return 1;if(S!==void 0)return S.length}return 0}function k(m,_){for(var S=new Array(_),C=0;C<_;++C)S[C]=m[C];return S}function y(m,_,S,C){if(typeof m.on=="function")C.once?m.once(_,S):m.on(_,S);else{if(typeof m.addEventListener!="function")throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof m);m.addEventListener(_,(function A(O){C.once&&m.removeEventListener(_,A),S(O)}))}}return Object.defineProperty(i,"defaultMaxListeners",{enumerable:!0,get:function(){return a},set:function(m){if(typeof m!="number"||m<0||n(m))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+m+".");a=m}}),i.init=function(){this._events!==void 0&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},i.prototype.setMaxListeners=function(m){if(typeof m!="number"||m<0||n(m))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+m+".");return this._maxListeners=m,this},i.prototype.getMaxListeners=function(){return c(this)},i.prototype.emit=function(m){for(var _=[],S=1;S<arguments.length;S++)_.push(arguments[S]);var C=m==="error",A=this._events;if(A!==void 0)C=C&&A.error===void 0;else if(!C)return!1;if(C){var O;if(_.length>0&&(O=_[0]),O instanceof Error)throw O;var P=new Error("Unhandled error."+(O?" ("+O.message+")":""));throw P.context=O,P}var x=A[m];if(x===void 0)return!1;if(typeof x=="function")t(x,this,_);else{var U=x.length,Y=k(x,U);for(S=0;S<U;++S)t(Y[S],this,_)}return!0},i.prototype.addListener=function(m,_){return u(this,m,_,!1)},i.prototype.on=i.prototype.addListener,i.prototype.prependListener=function(m,_){return u(this,m,_,!0)},i.prototype.once=function(m,_){return s(_),this.on(m,f(this,m,_)),this},i.prototype.prependOnceListener=function(m,_){return s(_),this.prependListener(m,f(this,m,_)),this},i.prototype.removeListener=function(m,_){var S,C,A,O,P;if(s(_),(C=this._events)===void 0)return this;if((S=C[m])===void 0)return this;if(S===_||S.listener===_)--this._eventsCount==0?this._events=Object.create(null):(delete C[m],C.removeListener&&this.emit("removeListener",m,S.listener||_));else if(typeof S!="function"){for(A=-1,O=S.length-1;O>=0;O--)if(S[O]===_||S[O].listener===_){P=S[O].listener,A=O;break}if(A<0)return this;A===0?S.shift():(function(x,U){for(;U+1<x.length;U++)x[U]=x[U+1];x.pop()})(S,A),S.length===1&&(C[m]=S[0]),C.removeListener!==void 0&&this.emit("removeListener",m,P||_)}return this},i.prototype.off=i.prototype.removeListener,i.prototype.removeAllListeners=function(m){var _,S,C;if((S=this._events)===void 0)return this;if(S.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):S[m]!==void 0&&(--this._eventsCount==0?this._events=Object.create(null):delete S[m]),this;if(arguments.length===0){var A,O=Object.keys(S);for(C=0;C<O.length;++C)(A=O[C])!=="removeListener"&&this.removeAllListeners(A);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(typeof(_=S[m])=="function")this.removeListener(m,_);else if(_!==void 0)for(C=_.length-1;C>=0;C--)this.removeListener(m,_[C]);return this},i.prototype.listeners=function(m){return v(this,m,!0)},i.prototype.rawListeners=function(m){return v(this,m,!1)},i.listenerCount=function(m,_){return typeof m.listenerCount=="function"?m.listenerCount(_):b.call(m,_)},i.prototype.listenerCount=b,i.prototype.eventNames=function(){return this._eventsCount>0?r(this._events):[]},rr.exports})(),nr=jd(ha),bs=Object.prototype.hasOwnProperty;function _s(r,e,t){for(t of r.keys())if(se(t,e))return t}function se(r,e){var t,n,i;if(r===e)return!0;if(r&&e&&(t=r.constructor)===e.constructor){if(t===Date)return r.getTime()===e.getTime();if(t===RegExp)return r.toString()===e.toString();if(t===Array){if((n=r.length)===e.length)for(;n--&&se(r[n],e[n]););return n===-1}if(t===Set){if(r.size!==e.size)return!1;for(n of r)if((i=n)&&typeof i=="object"&&!(i=_s(e,i))||!e.has(i))return!1;return!0}if(t===Map){if(r.size!==e.size)return!1;for(n of r)if((i=n[0])&&typeof i=="object"&&!(i=_s(e,i))||!se(n[1],e.get(i)))return!1;return!0}if(t===ArrayBuffer)r=new Uint8Array(r),e=new Uint8Array(e);else if(t===DataView){if((n=r.byteLength)===e.byteLength)for(;n--&&r.getInt8(n)===e.getInt8(n););return n===-1}if(ArrayBuffer.isView(r)){if((n=r.byteLength)===e.byteLength)for(;n--&&r[n]===e[n];);return n===-1}if(!t||typeof r=="object"){for(t in n=0,r)if(bs.call(r,t)&&++n&&!bs.call(e,t)||!(t in e)||!se(r[t],e[t]))return!1;return Object.keys(e).length===n}}return r!=r&&e!=e}const Rd={"Amazon Silk":"amazon_silk","Android Browser":"android",Bada:"bada",BlackBerry:"blackberry",Chrome:"chrome",Chromium:"chromium",Electron:"electron",Epiphany:"epiphany",Firefox:"firefox",Focus:"focus",Generic:"generic","Google Search":"google_search",Googlebot:"googlebot","Internet Explorer":"ie","K-Meleon":"k_meleon",Maxthon:"maxthon","Microsoft Edge":"edge","MZ Browser":"mz","NAVER Whale Browser":"naver",Opera:"opera","Opera Coast":"opera_coast",PhantomJS:"phantomjs",Puffin:"puffin",QupZilla:"qupzilla",QQ:"qq",QQLite:"qqlite",Safari:"safari",Sailfish:"sailfish","Samsung Internet for Android":"samsung_internet",SeaMonkey:"seamonkey",Sleipnir:"sleipnir",Swing:"swing",Tizen:"tizen","UC Browser":"uc",Vivaldi:"vivaldi","WebOS Browser":"webos",WeChat:"wechat","Yandex Browser":"yandex",Roku:"roku"},vl={amazon_silk:"Amazon Silk",android:"Android Browser",bada:"Bada",blackberry:"BlackBerry",chrome:"Chrome",chromium:"Chromium",electron:"Electron",epiphany:"Epiphany",firefox:"Firefox",focus:"Focus",generic:"Generic",googlebot:"Googlebot",google_search:"Google Search",ie:"Internet Explorer",k_meleon:"K-Meleon",maxthon:"Maxthon",edge:"Microsoft Edge",mz:"MZ Browser",naver:"NAVER Whale Browser",opera:"Opera",opera_coast:"Opera Coast",phantomjs:"PhantomJS",puffin:"Puffin",qupzilla:"QupZilla",qq:"QQ Browser",qqlite:"QQ Browser Lite",safari:"Safari",sailfish:"Sailfish",samsung_internet:"Samsung Internet for Android",seamonkey:"SeaMonkey",sleipnir:"Sleipnir",swing:"Swing",tizen:"Tizen",uc:"UC Browser",vivaldi:"Vivaldi",webos:"WebOS Browser",wechat:"WeChat",yandex:"Yandex Browser"},X={tablet:"tablet",mobile:"mobile",desktop:"desktop",tv:"tv"},ae={WindowsPhone:"Windows Phone",Windows:"Windows",MacOS:"macOS",iOS:"iOS",Android:"Android",WebOS:"WebOS",BlackBerry:"BlackBerry",Bada:"Bada",Tizen:"Tizen",Linux:"Linux",ChromeOS:"Chrome OS",PlayStation4:"PlayStation 4",Roku:"Roku"},Je={EdgeHTML:"EdgeHTML",Blink:"Blink",Trident:"Trident",Presto:"Presto",Gecko:"Gecko",WebKit:"WebKit"};class M{static getFirstMatch(e,t){const n=t.match(e);return n&&n.length>0&&n[1]||""}static getSecondMatch(e,t){const n=t.match(e);return n&&n.length>1&&n[2]||""}static matchAndReturnConst(e,t,n){if(e.test(t))return n}static getWindowsVersionName(e){switch(e){case"NT":return"NT";case"XP":case"NT 5.1":return"XP";case"NT 5.0":return"2000";case"NT 5.2":return"2003";case"NT 6.0":return"Vista";case"NT 6.1":return"7";case"NT 6.2":return"8";case"NT 6.3":return"8.1";case"NT 10.0":return"10";default:return}}static getMacOSVersionName(e){const t=e.split(".").splice(0,2).map((n=>parseInt(n,10)||0));if(t.push(0),t[0]===10)switch(t[1]){case 5:return"Leopard";case 6:return"Snow Leopard";case 7:return"Lion";case 8:return"Mountain Lion";case 9:return"Mavericks";case 10:return"Yosemite";case 11:return"El Capitan";case 12:return"Sierra";case 13:return"High Sierra";case 14:return"Mojave";case 15:return"Catalina";default:return}}static getAndroidVersionName(e){const t=e.split(".").splice(0,2).map((n=>parseInt(n,10)||0));if(t.push(0),!(t[0]===1&&t[1]<5))return t[0]===1&&t[1]<6?"Cupcake":t[0]===1&&t[1]>=6?"Donut":t[0]===2&&t[1]<2?"Eclair":t[0]===2&&t[1]===2?"Froyo":t[0]===2&&t[1]>2?"Gingerbread":t[0]===3?"Honeycomb":t[0]===4&&t[1]<1?"Ice Cream Sandwich":t[0]===4&&t[1]<4?"Jelly Bean":t[0]===4&&t[1]>=4?"KitKat":t[0]===5?"Lollipop":t[0]===6?"Marshmallow":t[0]===7?"Nougat":t[0]===8?"Oreo":t[0]===9?"Pie":void 0}static getVersionPrecision(e){return e.split(".").length}static compareVersions(e,t,n=!1){const i=M.getVersionPrecision(e),a=M.getVersionPrecision(t);let s=Math.max(i,a),c=0;const u=M.map([e,t],(l=>{const f=s-M.getVersionPrecision(l),v=l+new Array(f+1).join(".0");return M.map(v.split("."),(b=>new Array(20-b.length).join("0")+b)).reverse()}));for(n&&(c=s-Math.min(i,a)),s-=1;s>=c;){if(u[0][s]>u[1][s])return 1;if(u[0][s]===u[1][s]){if(s===c)return 0;s-=1}else if(u[0][s]<u[1][s])return-1}}static map(e,t){const n=[];let i;if(Array.prototype.map)return Array.prototype.map.call(e,t);for(i=0;i<e.length;i+=1)n.push(t(e[i]));return n}static find(e,t){let n,i;if(Array.prototype.find)return Array.prototype.find.call(e,t);for(n=0,i=e.length;n<i;n+=1){const a=e[n];if(t(a,n))return a}}static assign(e,...t){const n=e;let i,a;if(Object.assign)return Object.assign(e,...t);for(i=0,a=t.length;i<a;i+=1){const s=t[i];typeof s=="object"&&s!==null&&Object.keys(s).forEach((c=>{n[c]=s[c]}))}return e}static getBrowserAlias(e){return Rd[e]}static getBrowserTypeByAlias(e){return vl[e]||""}}const G=/version\/(\d+(\.?_?\d+)+)/i,xd=[{test:[/googlebot/i],describe(r){const e={name:"Googlebot"},t=M.getFirstMatch(/googlebot\/(\d+(\.\d+))/i,r)||M.getFirstMatch(G,r);return t&&(e.version=t),e}},{test:[/opera/i],describe(r){const e={name:"Opera"},t=M.getFirstMatch(G,r)||M.getFirstMatch(/(?:opera)[\s/](\d+(\.?_?\d+)+)/i,r);return t&&(e.version=t),e}},{test:[/opr\/|opios/i],describe(r){const e={name:"Opera"},t=M.getFirstMatch(/(?:opr|opios)[\s/](\S+)/i,r)||M.getFirstMatch(G,r);return t&&(e.version=t),e}},{test:[/SamsungBrowser/i],describe(r){const e={name:"Samsung Internet for Android"},t=M.getFirstMatch(G,r)||M.getFirstMatch(/(?:SamsungBrowser)[\s/](\d+(\.?_?\d+)+)/i,r);return t&&(e.version=t),e}},{test:[/Whale/i],describe(r){const e={name:"NAVER Whale Browser"},t=M.getFirstMatch(G,r)||M.getFirstMatch(/(?:whale)[\s/](\d+(?:\.\d+)+)/i,r);return t&&(e.version=t),e}},{test:[/MZBrowser/i],describe(r){const e={name:"MZ Browser"},t=M.getFirstMatch(/(?:MZBrowser)[\s/](\d+(?:\.\d+)+)/i,r)||M.getFirstMatch(G,r);return t&&(e.version=t),e}},{test:[/focus/i],describe(r){const e={name:"Focus"},t=M.getFirstMatch(/(?:focus)[\s/](\d+(?:\.\d+)+)/i,r)||M.getFirstMatch(G,r);return t&&(e.version=t),e}},{test:[/swing/i],describe(r){const e={name:"Swing"},t=M.getFirstMatch(/(?:swing)[\s/](\d+(?:\.\d+)+)/i,r)||M.getFirstMatch(G,r);return t&&(e.version=t),e}},{test:[/coast/i],describe(r){const e={name:"Opera Coast"},t=M.getFirstMatch(G,r)||M.getFirstMatch(/(?:coast)[\s/](\d+(\.?_?\d+)+)/i,r);return t&&(e.version=t),e}},{test:[/opt\/\d+(?:.?_?\d+)+/i],describe(r){const e={name:"Opera Touch"},t=M.getFirstMatch(/(?:opt)[\s/](\d+(\.?_?\d+)+)/i,r)||M.getFirstMatch(G,r);return t&&(e.version=t),e}},{test:[/yabrowser/i],describe(r){const e={name:"Yandex Browser"},t=M.getFirstMatch(/(?:yabrowser)[\s/](\d+(\.?_?\d+)+)/i,r)||M.getFirstMatch(G,r);return t&&(e.version=t),e}},{test:[/ucbrowser/i],describe(r){const e={name:"UC Browser"},t=M.getFirstMatch(G,r)||M.getFirstMatch(/(?:ucbrowser)[\s/](\d+(\.?_?\d+)+)/i,r);return t&&(e.version=t),e}},{test:[/Maxthon|mxios/i],describe(r){const e={name:"Maxthon"},t=M.getFirstMatch(G,r)||M.getFirstMatch(/(?:Maxthon|mxios)[\s/](\d+(\.?_?\d+)+)/i,r);return t&&(e.version=t),e}},{test:[/epiphany/i],describe(r){const e={name:"Epiphany"},t=M.getFirstMatch(G,r)||M.getFirstMatch(/(?:epiphany)[\s/](\d+(\.?_?\d+)+)/i,r);return t&&(e.version=t),e}},{test:[/puffin/i],describe(r){const e={name:"Puffin"},t=M.getFirstMatch(G,r)||M.getFirstMatch(/(?:puffin)[\s/](\d+(\.?_?\d+)+)/i,r);return t&&(e.version=t),e}},{test:[/sleipnir/i],describe(r){const e={name:"Sleipnir"},t=M.getFirstMatch(G,r)||M.getFirstMatch(/(?:sleipnir)[\s/](\d+(\.?_?\d+)+)/i,r);return t&&(e.version=t),e}},{test:[/k-meleon/i],describe(r){const e={name:"K-Meleon"},t=M.getFirstMatch(G,r)||M.getFirstMatch(/(?:k-meleon)[\s/](\d+(\.?_?\d+)+)/i,r);return t&&(e.version=t),e}},{test:[/micromessenger/i],describe(r){const e={name:"WeChat"},t=M.getFirstMatch(/(?:micromessenger)[\s/](\d+(\.?_?\d+)+)/i,r)||M.getFirstMatch(G,r);return t&&(e.version=t),e}},{test:[/qqbrowser/i],describe(r){const e={name:/qqbrowserlite/i.test(r)?"QQ Browser Lite":"QQ Browser"},t=M.getFirstMatch(/(?:qqbrowserlite|qqbrowser)[/](\d+(\.?_?\d+)+)/i,r)||M.getFirstMatch(G,r);return t&&(e.version=t),e}},{test:[/msie|trident/i],describe(r){const e={name:"Internet Explorer"},t=M.getFirstMatch(/(?:msie |rv:)(\d+(\.?_?\d+)+)/i,r);return t&&(e.version=t),e}},{test:[/\sedg\//i],describe(r){const e={name:"Microsoft Edge"},t=M.getFirstMatch(/\sedg\/(\d+(\.?_?\d+)+)/i,r);return t&&(e.version=t),e}},{test:[/edg([ea]|ios)/i],describe(r){const e={name:"Microsoft Edge"},t=M.getSecondMatch(/edg([ea]|ios)\/(\d+(\.?_?\d+)+)/i,r);return t&&(e.version=t),e}},{test:[/vivaldi/i],describe(r){const e={name:"Vivaldi"},t=M.getFirstMatch(/vivaldi\/(\d+(\.?_?\d+)+)/i,r);return t&&(e.version=t),e}},{test:[/seamonkey/i],describe(r){const e={name:"SeaMonkey"},t=M.getFirstMatch(/seamonkey\/(\d+(\.?_?\d+)+)/i,r);return t&&(e.version=t),e}},{test:[/sailfish/i],describe(r){const e={name:"Sailfish"},t=M.getFirstMatch(/sailfish\s?browser\/(\d+(\.\d+)?)/i,r);return t&&(e.version=t),e}},{test:[/silk/i],describe(r){const e={name:"Amazon Silk"},t=M.getFirstMatch(/silk\/(\d+(\.?_?\d+)+)/i,r);return t&&(e.version=t),e}},{test:[/phantom/i],describe(r){const e={name:"PhantomJS"},t=M.getFirstMatch(/phantomjs\/(\d+(\.?_?\d+)+)/i,r);return t&&(e.version=t),e}},{test:[/slimerjs/i],describe(r){const e={name:"SlimerJS"},t=M.getFirstMatch(/slimerjs\/(\d+(\.?_?\d+)+)/i,r);return t&&(e.version=t),e}},{test:[/blackberry|\bbb\d+/i,/rim\stablet/i],describe(r){const e={name:"BlackBerry"},t=M.getFirstMatch(G,r)||M.getFirstMatch(/blackberry[\d]+\/(\d+(\.?_?\d+)+)/i,r);return t&&(e.version=t),e}},{test:[/(web|hpw)[o0]s/i],describe(r){const e={name:"WebOS Browser"},t=M.getFirstMatch(G,r)||M.getFirstMatch(/w(?:eb)?[o0]sbrowser\/(\d+(\.?_?\d+)+)/i,r);return t&&(e.version=t),e}},{test:[/bada/i],describe(r){const e={name:"Bada"},t=M.getFirstMatch(/dolfin\/(\d+(\.?_?\d+)+)/i,r);return t&&(e.version=t),e}},{test:[/tizen/i],describe(r){const e={name:"Tizen"},t=M.getFirstMatch(/(?:tizen\s?)?browser\/(\d+(\.?_?\d+)+)/i,r)||M.getFirstMatch(G,r);return t&&(e.version=t),e}},{test:[/qupzilla/i],describe(r){const e={name:"QupZilla"},t=M.getFirstMatch(/(?:qupzilla)[\s/](\d+(\.?_?\d+)+)/i,r)||M.getFirstMatch(G,r);return t&&(e.version=t),e}},{test:[/firefox|iceweasel|fxios/i],describe(r){const e={name:"Firefox"},t=M.getFirstMatch(/(?:firefox|iceweasel|fxios)[\s/](\d+(\.?_?\d+)+)/i,r);return t&&(e.version=t),e}},{test:[/electron/i],describe(r){const e={name:"Electron"},t=M.getFirstMatch(/(?:electron)\/(\d+(\.?_?\d+)+)/i,r);return t&&(e.version=t),e}},{test:[/MiuiBrowser/i],describe(r){const e={name:"Miui"},t=M.getFirstMatch(/(?:MiuiBrowser)[\s/](\d+(\.?_?\d+)+)/i,r);return t&&(e.version=t),e}},{test:[/chromium/i],describe(r){const e={name:"Chromium"},t=M.getFirstMatch(/(?:chromium)[\s/](\d+(\.?_?\d+)+)/i,r)||M.getFirstMatch(G,r);return t&&(e.version=t),e}},{test:[/chrome|crios|crmo/i],describe(r){const e={name:"Chrome"},t=M.getFirstMatch(/(?:chrome|crios|crmo)\/(\d+(\.?_?\d+)+)/i,r);return t&&(e.version=t),e}},{test:[/GSA/i],describe(r){const e={name:"Google Search"},t=M.getFirstMatch(/(?:GSA)\/(\d+(\.?_?\d+)+)/i,r);return t&&(e.version=t),e}},{test(r){const e=!r.test(/like android/i),t=r.test(/android/i);return e&&t},describe(r){const e={name:"Android Browser"},t=M.getFirstMatch(G,r);return t&&(e.version=t),e}},{test:[/playstation 4/i],describe(r){const e={name:"PlayStation 4"},t=M.getFirstMatch(G,r);return t&&(e.version=t),e}},{test:[/safari|applewebkit/i],describe(r){const e={name:"Safari"},t=M.getFirstMatch(G,r);return t&&(e.version=t),e}},{test:[/.*/i],describe(r){const e=r.search("\\(")!==-1?/^(.*)\/(.*)[ \t]\((.*)/:/^(.*)\/(.*) /;return{name:M.getFirstMatch(e,r),version:M.getSecondMatch(e,r)}}}];var Ld=[{test:[/Roku\/DVP/],describe(r){const e=M.getFirstMatch(/Roku\/DVP-(\d+\.\d+)/i,r);return{name:ae.Roku,version:e}}},{test:[/windows phone/i],describe(r){const e=M.getFirstMatch(/windows phone (?:os)?\s?(\d+(\.\d+)*)/i,r);return{name:ae.WindowsPhone,version:e}}},{test:[/windows /i],describe(r){const e=M.getFirstMatch(/Windows ((NT|XP)( \d\d?.\d)?)/i,r),t=M.getWindowsVersionName(e);return{name:ae.Windows,version:e,versionName:t}}},{test:[/Macintosh(.*?) FxiOS(.*?)\//],describe(r){const e={name:ae.iOS},t=M.getSecondMatch(/(Version\/)(\d[\d.]+)/,r);return t&&(e.version=t),e}},{test:[/macintosh/i],describe(r){const e=M.getFirstMatch(/mac os x (\d+(\.?_?\d+)+)/i,r).replace(/[_\s]/g,"."),t=M.getMacOSVersionName(e),n={name:ae.MacOS,version:e};return t&&(n.versionName=t),n}},{test:[/(ipod|iphone|ipad)/i],describe(r){const e=M.getFirstMatch(/os (\d+([_\s]\d+)*) like mac os x/i,r).replace(/[_\s]/g,".");return{name:ae.iOS,version:e}}},{test(r){const e=!r.test(/like android/i),t=r.test(/android/i);return e&&t},describe(r){const e=M.getFirstMatch(/android[\s/-](\d+(\.\d+)*)/i,r),t=M.getAndroidVersionName(e),n={name:ae.Android,version:e};return t&&(n.versionName=t),n}},{test:[/(web|hpw)[o0]s/i],describe(r){const e=M.getFirstMatch(/(?:web|hpw)[o0]s\/(\d+(\.\d+)*)/i,r),t={name:ae.WebOS};return e&&e.length&&(t.version=e),t}},{test:[/blackberry|\bbb\d+/i,/rim\stablet/i],describe(r){const e=M.getFirstMatch(/rim\stablet\sos\s(\d+(\.\d+)*)/i,r)||M.getFirstMatch(/blackberry\d+\/(\d+([_\s]\d+)*)/i,r)||M.getFirstMatch(/\bbb(\d+)/i,r);return{name:ae.BlackBerry,version:e}}},{test:[/bada/i],describe(r){const e=M.getFirstMatch(/bada\/(\d+(\.\d+)*)/i,r);return{name:ae.Bada,version:e}}},{test:[/tizen/i],describe(r){const e=M.getFirstMatch(/tizen[/\s](\d+(\.\d+)*)/i,r);return{name:ae.Tizen,version:e}}},{test:[/linux/i],describe:()=>({name:ae.Linux})},{test:[/CrOS/],describe:()=>({name:ae.ChromeOS})},{test:[/PlayStation 4/],describe(r){const e=M.getFirstMatch(/PlayStation 4[/\s](\d+(\.\d+)*)/i,r);return{name:ae.PlayStation4,version:e}}}],Dd=[{test:[/googlebot/i],describe:()=>({type:"bot",vendor:"Google"})},{test:[/huawei/i],describe(r){const e=M.getFirstMatch(/(can-l01)/i,r)&&"Nova",t={type:X.mobile,vendor:"Huawei"};return e&&(t.model=e),t}},{test:[/nexus\s*(?:7|8|9|10).*/i],describe:()=>({type:X.tablet,vendor:"Nexus"})},{test:[/ipad/i],describe:()=>({type:X.tablet,vendor:"Apple",model:"iPad"})},{test:[/Macintosh(.*?) FxiOS(.*?)\//],describe:()=>({type:X.tablet,vendor:"Apple",model:"iPad"})},{test:[/kftt build/i],describe:()=>({type:X.tablet,vendor:"Amazon",model:"Kindle Fire HD 7"})},{test:[/silk/i],describe:()=>({type:X.tablet,vendor:"Amazon"})},{test:[/tablet(?! pc)/i],describe:()=>({type:X.tablet})},{test(r){const e=r.test(/ipod|iphone/i),t=r.test(/like (ipod|iphone)/i);return e&&!t},describe(r){const e=M.getFirstMatch(/(ipod|iphone)/i,r);return{type:X.mobile,vendor:"Apple",model:e}}},{test:[/nexus\s*[0-6].*/i,/galaxy nexus/i],describe:()=>({type:X.mobile,vendor:"Nexus"})},{test:[/[^-]mobi/i],describe:()=>({type:X.mobile})},{test:r=>r.getBrowserName(!0)==="blackberry",describe:()=>({type:X.mobile,vendor:"BlackBerry"})},{test:r=>r.getBrowserName(!0)==="bada",describe:()=>({type:X.mobile})},{test:r=>r.getBrowserName()==="windows phone",describe:()=>({type:X.mobile,vendor:"Microsoft"})},{test(r){const e=Number(String(r.getOSVersion()).split(".")[0]);return r.getOSName(!0)==="android"&&e>=3},describe:()=>({type:X.tablet})},{test:r=>r.getOSName(!0)==="android",describe:()=>({type:X.mobile})},{test:r=>r.getOSName(!0)==="macos",describe:()=>({type:X.desktop,vendor:"Apple"})},{test:r=>r.getOSName(!0)==="windows",describe:()=>({type:X.desktop})},{test:r=>r.getOSName(!0)==="linux",describe:()=>({type:X.desktop})},{test:r=>r.getOSName(!0)==="playstation 4",describe:()=>({type:X.tv})},{test:r=>r.getOSName(!0)==="roku",describe:()=>({type:X.tv})}],Nd=[{test:r=>r.getBrowserName(!0)==="microsoft edge",describe(r){if(/\sedg\//i.test(r))return{name:Je.Blink};const e=M.getFirstMatch(/edge\/(\d+(\.?_?\d+)+)/i,r);return{name:Je.EdgeHTML,version:e}}},{test:[/trident/i],describe(r){const e={name:Je.Trident},t=M.getFirstMatch(/trident\/(\d+(\.?_?\d+)+)/i,r);return t&&(e.version=t),e}},{test:r=>r.test(/presto/i),describe(r){const e={name:Je.Presto},t=M.getFirstMatch(/presto\/(\d+(\.?_?\d+)+)/i,r);return t&&(e.version=t),e}},{test(r){const e=r.test(/gecko/i),t=r.test(/like gecko/i);return e&&!t},describe(r){const e={name:Je.Gecko},t=M.getFirstMatch(/gecko\/(\d+(\.?_?\d+)+)/i,r);return t&&(e.version=t),e}},{test:[/(apple)?webkit\/537\.36/i],describe:()=>({name:Je.Blink})},{test:[/(apple)?webkit/i],describe(r){const e={name:Je.WebKit},t=M.getFirstMatch(/webkit\/(\d+(\.?_?\d+)+)/i,r);return t&&(e.version=t),e}}];class ws{constructor(e,t=!1){if(e==null||e==="")throw new Error("UserAgent parameter can't be empty");this._ua=e,this.parsedResult={},t!==!0&&this.parse()}getUA(){return this._ua}test(e){return e.test(this._ua)}parseBrowser(){this.parsedResult.browser={};const e=M.find(xd,(t=>{if(typeof t.test=="function")return t.test(this);if(t.test instanceof Array)return t.test.some((n=>this.test(n)));throw new Error("Browser's test function is not valid")}));return e&&(this.parsedResult.browser=e.describe(this.getUA())),this.parsedResult.browser}getBrowser(){return this.parsedResult.browser?this.parsedResult.browser:this.parseBrowser()}getBrowserName(e){return e?String(this.getBrowser().name).toLowerCase()||"":this.getBrowser().name||""}getBrowserVersion(){return this.getBrowser().version}getOS(){return this.parsedResult.os?this.parsedResult.os:this.parseOS()}parseOS(){this.parsedResult.os={};const e=M.find(Ld,(t=>{if(typeof t.test=="function")return t.test(this);if(t.test instanceof Array)return t.test.some((n=>this.test(n)));throw new Error("Browser's test function is not valid")}));return e&&(this.parsedResult.os=e.describe(this.getUA())),this.parsedResult.os}getOSName(e){const{name:t}=this.getOS();return e?String(t).toLowerCase()||"":t||""}getOSVersion(){return this.getOS().version}getPlatform(){return this.parsedResult.platform?this.parsedResult.platform:this.parsePlatform()}getPlatformType(e=!1){const{type:t}=this.getPlatform();return e?String(t).toLowerCase()||"":t||""}parsePlatform(){this.parsedResult.platform={};const e=M.find(Dd,(t=>{if(typeof t.test=="function")return t.test(this);if(t.test instanceof Array)return t.test.some((n=>this.test(n)));throw new Error("Browser's test function is not valid")}));return e&&(this.parsedResult.platform=e.describe(this.getUA())),this.parsedResult.platform}getEngine(){return this.parsedResult.engine?this.parsedResult.engine:this.parseEngine()}getEngineName(e){return e?String(this.getEngine().name).toLowerCase()||"":this.getEngine().name||""}parseEngine(){this.parsedResult.engine={};const e=M.find(Nd,(t=>{if(typeof t.test=="function")return t.test(this);if(t.test instanceof Array)return t.test.some((n=>this.test(n)));throw new Error("Browser's test function is not valid")}));return e&&(this.parsedResult.engine=e.describe(this.getUA())),this.parsedResult.engine}parse(){return this.parseBrowser(),this.parseOS(),this.parsePlatform(),this.parseEngine(),this}getResult(){return M.assign({},this.parsedResult)}satisfies(e){const t={};let n=0;const i={};let a=0;if(Object.keys(e).forEach((s=>{const c=e[s];typeof c=="string"?(i[s]=c,a+=1):typeof c=="object"&&(t[s]=c,n+=1)})),n>0){const s=Object.keys(t),c=M.find(s,(l=>this.isOS(l)));if(c){const l=this.satisfies(t[c]);if(l!==void 0)return l}const u=M.find(s,(l=>this.isPlatform(l)));if(u){const l=this.satisfies(t[u]);if(l!==void 0)return l}}if(a>0){const s=Object.keys(i),c=M.find(s,(u=>this.isBrowser(u,!0)));if(c!==void 0)return this.compareVersion(i[c])}}isBrowser(e,t=!1){const n=this.getBrowserName().toLowerCase();let i=e.toLowerCase();const a=M.getBrowserTypeByAlias(i);return t&&a&&(i=a.toLowerCase()),i===n}compareVersion(e){let t=[0],n=e,i=!1;const a=this.getBrowserVersion();if(typeof a=="string")return e[0]===">"||e[0]==="<"?(n=e.substr(1),e[1]==="="?(i=!0,n=e.substr(2)):t=[],e[0]===">"?t.push(1):t.push(-1)):e[0]==="="?n=e.substr(1):e[0]==="~"&&(i=!0,n=e.substr(1)),t.indexOf(M.compareVersions(a,n,i))>-1}isOS(e){return this.getOSName(!0)===String(e).toLowerCase()}isPlatform(e){return this.getPlatformType(!0)===String(e).toLowerCase()}isEngine(e){return this.getEngineName(!0)===String(e).toLowerCase()}is(e,t=!1){return this.isBrowser(e,t)||this.isOS(e)||this.isPlatform(e)}some(e=[]){return e.some((t=>this.is(t)))}}/*!
 * Bowser - a browser detector
 * https://github.com/lancedikson/bowser
 * MIT License | (c) Dustin Diaz 2012-2015
 * MIT License | (c) Denis Demchenko 2015-2019
 */class qd{static getParser(e,t=!1){if(typeof e!="string")throw new Error("UserAgent should be a string");return new ws(e,t)}static parse(e){return new ws(e).getResult()}static get BROWSER_MAP(){return vl}static get ENGINE_MAP(){return Je}static get OS_MAP(){return ae}static get PLATFORMS_MAP(){return X}}function Rr(){return Date.now()+Math.random().toString()}function jt(){throw new Error("Method must be implemented in subclass")}function gl(r,e){return e!=null&&e.proxyUrl?e.proxyUrl+(e.proxyUrl.slice(-1)==="/"?"":"/")+r.substring(8):r}function wr(r){return r!=null&&r.callObjectBundleUrlOverride?r.callObjectBundleUrlOverride:gl("https://c.daily.co/call-machine/versioned/".concat("0.83.1","/static/call-machine-object-bundle.js"),r)}function Sr(r){try{new URL(r)}catch{return!1}return!0}const K=typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__,st="8.55.0",W=globalThis;function kr(r,e,t){const n=W,i=n.__SENTRY__=n.__SENTRY__||{},a=i[st]=i[st]||{};return a[r]||(a[r]=e())}const ft=typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__,fa=["debug","info","warn","error","log","assert","trace"],Cr={};function Vt(r){if(!("console"in W))return r();const e=W.console,t={},n=Object.keys(Cr);n.forEach((i=>{const a=Cr[i];t[i]=e[i],e[i]=a}));try{return r()}finally{n.forEach((i=>{e[i]=t[i]}))}}const N=kr("logger",(function(){let r=!1;const e={enable:()=>{r=!0},disable:()=>{r=!1},isEnabled:()=>r};return ft?fa.forEach((t=>{e[t]=(...n)=>{r&&Vt((()=>{W.console[t](`Sentry Logger [${t}]:`,...n)}))}})):fa.forEach((t=>{e[t]=()=>{}})),e})),at="?",Ss=/\(error: (.*)\)/,ks=/captureMessage|captureException/;function ir(r){return r[r.length-1]||{}}const Cs="<anonymous>";function Ge(r){try{return r&&typeof r=="function"&&r.name||Cs}catch{return Cs}}function Ms(r){const e=r.exception;if(e){const t=[];try{return e.values.forEach((n=>{n.stacktrace.frames&&t.push(...n.stacktrace.frames)})),t}catch{return}}}const mr={},Ts={};function ot(r,e){mr[r]=mr[r]||[],mr[r].push(e)}function ct(r,e){if(!Ts[r]){Ts[r]=!0;try{e()}catch(t){ft&&N.error(`Error while instrumenting ${r}`,t)}}}function Te(r,e){const t=r&&mr[r];if(t)for(const n of t)try{n(e)}catch(i){ft&&N.error(`Error while triggering instrumentation handler.
Type: ${r}
Name: ${Ge(n)}
Error:`,i)}}let Wr=null;function Fd(){Wr=W.onerror,W.onerror=function(r,e,t,n,i){return Te("error",{column:n,error:i,line:t,msg:r,url:e}),!!Wr&&Wr.apply(this,arguments)},W.onerror.__SENTRY_INSTRUMENTED__=!0}let Gr=null;function $d(){Gr=W.onunhandledrejection,W.onunhandledrejection=function(r){return Te("unhandledrejection",r),!Gr||Gr.apply(this,arguments)},W.onunhandledrejection.__SENTRY_INSTRUMENTED__=!0}function xr(){return Da(W),W}function Da(r){const e=r.__SENTRY__=r.__SENTRY__||{};return e.version=e.version||st,e[st]=e[st]||{}}const ml=Object.prototype.toString;function Na(r){switch(ml.call(r)){case"[object Error]":case"[object Exception]":case"[object DOMException]":case"[object WebAssembly.Exception]":return!0;default:return ut(r,Error)}}function At(r,e){return ml.call(r)===`[object ${e}]`}function yl(r){return At(r,"ErrorEvent")}function Es(r){return At(r,"DOMError")}function De(r){return At(r,"String")}function qa(r){return typeof r=="object"&&r!==null&&"__sentry_template_string__"in r&&"__sentry_template_values__"in r}function pa(r){return r===null||qa(r)||typeof r!="object"&&typeof r!="function"}function kt(r){return At(r,"Object")}function Lr(r){return typeof Event<"u"&&ut(r,Event)}function Dr(r){return!!(r&&r.then&&typeof r.then=="function")}function ut(r,e){try{return r instanceof e}catch{return!1}}function bl(r){return!(typeof r!="object"||r===null||!r.__isVue&&!r._isVue)}const Fa=W;function _l(r,e={}){if(!r)return"<unknown>";try{let t=r;const n=5,i=[];let a=0,s=0;const c=" > ",u=c.length;let l;const f=Array.isArray(e)?e:e.keyAttrs,v=!Array.isArray(e)&&e.maxStringLength||80;for(;t&&a++<n&&(l=Bd(t,f),!(l==="html"||a>1&&s+i.length*u+l.length>=v));)i.push(l),s+=l.length,t=t.parentNode;return i.reverse().join(c)}catch{return"<unknown>"}}function Bd(r,e){const t=r,n=[];if(!t||!t.tagName)return"";if(Fa.HTMLElement&&t instanceof HTMLElement&&t.dataset){if(t.dataset.sentryComponent)return t.dataset.sentryComponent;if(t.dataset.sentryElement)return t.dataset.sentryElement}n.push(t.tagName.toLowerCase());const i=e&&e.length?e.filter((s=>t.getAttribute(s))).map((s=>[s,t.getAttribute(s)])):null;if(i&&i.length)i.forEach((s=>{n.push(`[${s[0]}="${s[1]}"]`)}));else{t.id&&n.push(`#${t.id}`);const s=t.className;if(s&&De(s)){const c=s.split(/\s+/);for(const u of c)n.push(`.${u}`)}}const a=["aria-label","type","name","title","alt"];for(const s of a){const c=t.getAttribute(s);c&&n.push(`[${s}="${c}"]`)}return n.join("")}function wt(r,e=0){return typeof r!="string"||e===0||r.length<=e?r:`${r.slice(0,e)}...`}function As(r,e){if(!Array.isArray(r))return"";const t=[];for(let n=0;n<r.length;n++){const i=r[n];try{bl(i)?t.push("[VueViewModel]"):t.push(String(i))}catch{t.push("[value cannot be serialized]")}}return t.join(e)}function Ud(r,e,t=!1){return!!De(r)&&(At(e,"RegExp")?e.test(r):!!De(e)&&(t?r===e:r.includes(e)))}function ar(r,e=[],t=!1){return e.some((n=>Ud(r,n,t)))}function de(r,e,t){if(!(e in r))return;const n=r[e],i=t(n);typeof i=="function"&&wl(i,n);try{r[e]=i}catch{ft&&N.log(`Failed to replace method "${e}" in object`,r)}}function lt(r,e,t){try{Object.defineProperty(r,e,{value:t,writable:!0,configurable:!0})}catch{ft&&N.log(`Failed to add non-enumerable property "${e}" to object`,r)}}function wl(r,e){try{const t=e.prototype||{};r.prototype=e.prototype=t,lt(r,"__sentry_original__",e)}catch{}}function $a(r){return r.__sentry_original__}function Sl(r){if(Na(r))return{message:r.message,name:r.name,stack:r.stack,...Ps(r)};if(Lr(r)){const e={type:r.type,target:Os(r.target),currentTarget:Os(r.currentTarget),...Ps(r)};return typeof CustomEvent<"u"&&ut(r,CustomEvent)&&(e.detail=r.detail),e}return r}function Os(r){try{return e=r,typeof Element<"u"&&ut(e,Element)?_l(r):Object.prototype.toString.call(r)}catch{return"<unknown>"}var e}function Ps(r){if(typeof r=="object"&&r!==null){const e={};for(const t in r)Object.prototype.hasOwnProperty.call(r,t)&&(e[t]=r[t]);return e}return{}}function me(r){return va(r,new Map)}function va(r,e){if((function(t){if(!kt(t))return!1;try{const n=Object.getPrototypeOf(t).constructor.name;return!n||n==="Object"}catch{return!0}})(r)){const t=e.get(r);if(t!==void 0)return t;const n={};e.set(r,n);for(const i of Object.getOwnPropertyNames(r))r[i]!==void 0&&(n[i]=va(r[i],e));return n}if(Array.isArray(r)){const t=e.get(r);if(t!==void 0)return t;const n=[];return e.set(r,n),r.forEach((i=>{n.push(va(i,e))})),n}return r}function Jt(){return Date.now()/1e3}const qe=(function(){const{performance:r}=W;if(!r||!r.now)return Jt;const e=Date.now()-r.now(),t=r.timeOrigin==null?e:r.timeOrigin;return()=>(t+r.now())/1e3})();function ye(){const r=W,e=r.crypto||r.msCrypto;let t=()=>16*Math.random();try{if(e&&e.randomUUID)return e.randomUUID().replace(/-/g,"");e&&e.getRandomValues&&(t=()=>{const n=new Uint8Array(1);return e.getRandomValues(n),n[0]})}catch{}return("10000000100040008000"+1e11).replace(/[018]/g,(n=>(n^(15&t())>>n/4).toString(16)))}function kl(r){return r.exception&&r.exception.values?r.exception.values[0]:void 0}function ze(r){const{message:e,event_id:t}=r;if(e)return e;const n=kl(r);return n?n.type&&n.value?`${n.type}: ${n.value}`:n.type||n.value||t||"<unknown>":t||"<unknown>"}function ga(r,e,t){const n=r.exception=r.exception||{},i=n.values=n.values||[],a=i[0]=i[0]||{};a.value||(a.value=e||""),a.type||(a.type="Error")}function Ct(r,e){const t=kl(r);if(!t)return;const n=t.mechanism;if(t.mechanism={type:"generic",handled:!0,...n,...e},e&&"data"in e){const i={...n&&n.data,...e.data};t.mechanism.data=i}}function Is(r){if((function(e){try{return e.__sentry_captured__}catch{}})(r))return!0;try{lt(r,"__sentry_captured__",!0)}catch{}return!1}var xe;function dt(r){return new ge((e=>{e(r)}))}function Mr(r){return new ge(((e,t)=>{t(r)}))}(()=>{const{performance:r}=W;!r||!r.now||(r.now(),r.timing&&r.timing.navigationStart)})(),(function(r){r[r.PENDING=0]="PENDING",r[r.RESOLVED=1]="RESOLVED",r[r.REJECTED=2]="REJECTED"})(xe||(xe={}));class ge{constructor(e){ge.prototype.__init.call(this),ge.prototype.__init2.call(this),ge.prototype.__init3.call(this),ge.prototype.__init4.call(this),this._state=xe.PENDING,this._handlers=[];try{e(this._resolve,this._reject)}catch(t){this._reject(t)}}then(e,t){return new ge(((n,i)=>{this._handlers.push([!1,a=>{if(e)try{n(e(a))}catch(s){i(s)}else n(a)},a=>{if(t)try{n(t(a))}catch(s){i(s)}else i(a)}]),this._executeHandlers()}))}catch(e){return this.then((t=>t),e)}finally(e){return new ge(((t,n)=>{let i,a;return this.then((s=>{a=!1,i=s,e&&e()}),(s=>{a=!0,i=s,e&&e()})).then((()=>{a?n(i):t(i)}))}))}__init(){this._resolve=e=>{this._setResult(xe.RESOLVED,e)}}__init2(){this._reject=e=>{this._setResult(xe.REJECTED,e)}}__init3(){this._setResult=(e,t)=>{this._state===xe.PENDING&&(Dr(t)?t.then(this._resolve,this._reject):(this._state=e,this._value=t,this._executeHandlers()))}}__init4(){this._executeHandlers=()=>{if(this._state===xe.PENDING)return;const e=this._handlers.slice();this._handlers=[],e.forEach((t=>{t[0]||(this._state===xe.RESOLVED&&t[1](this._value),this._state===xe.REJECTED&&t[2](this._value),t[0]=!0)}))}}}function Vd(r){const e=qe(),t={sid:ye(),init:!0,timestamp:e,started:e,duration:0,status:"ok",errors:0,ignoreDuration:!1,toJSON:()=>(function(n){return me({sid:`${n.sid}`,init:n.init,started:new Date(1e3*n.started).toISOString(),timestamp:new Date(1e3*n.timestamp).toISOString(),status:n.status,errors:n.errors,did:typeof n.did=="number"||typeof n.did=="string"?`${n.did}`:void 0,duration:n.duration,abnormal_mechanism:n.abnormal_mechanism,attrs:{release:n.release,environment:n.environment,ip_address:n.ipAddress,user_agent:n.userAgent}})})(t)};return r&&Mt(t,r),t}function Mt(r,e={}){if(e.user&&(!r.ipAddress&&e.user.ip_address&&(r.ipAddress=e.user.ip_address),r.did||e.did||(r.did=e.user.id||e.user.email||e.user.username)),r.timestamp=e.timestamp||qe(),e.abnormal_mechanism&&(r.abnormal_mechanism=e.abnormal_mechanism),e.ignoreDuration&&(r.ignoreDuration=e.ignoreDuration),e.sid&&(r.sid=e.sid.length===32?e.sid:ye()),e.init!==void 0&&(r.init=e.init),!r.did&&e.did&&(r.did=`${e.did}`),typeof e.started=="number"&&(r.started=e.started),r.ignoreDuration)r.duration=void 0;else if(typeof e.duration=="number")r.duration=e.duration;else{const t=r.timestamp-r.started;r.duration=t>=0?t:0}e.release&&(r.release=e.release),e.environment&&(r.environment=e.environment),!r.ipAddress&&e.ipAddress&&(r.ipAddress=e.ipAddress),!r.userAgent&&e.userAgent&&(r.userAgent=e.userAgent),typeof e.errors=="number"&&(r.errors=e.errors),e.status&&(r.status=e.status)}function js(){return ye()}function ma(){return ye().substring(16)}function Nr(r,e,t=2){if(!e||typeof e!="object"||t<=0)return e;if(r&&e&&Object.keys(e).length===0)return r;const n={...r};for(const i in e)Object.prototype.hasOwnProperty.call(e,i)&&(n[i]=Nr(n[i],e[i],t-1));return n}const ya="_sentrySpan";function Rs(r,e){e?lt(r,ya,e):delete r[ya]}function xs(r){return r[ya]}class Ba{constructor(){this._notifyingListeners=!1,this._scopeListeners=[],this._eventProcessors=[],this._breadcrumbs=[],this._attachments=[],this._user={},this._tags={},this._extra={},this._contexts={},this._sdkProcessingMetadata={},this._propagationContext={traceId:js(),spanId:ma()}}clone(){const e=new Ba;return e._breadcrumbs=[...this._breadcrumbs],e._tags={...this._tags},e._extra={...this._extra},e._contexts={...this._contexts},this._contexts.flags&&(e._contexts.flags={values:[...this._contexts.flags.values]}),e._user=this._user,e._level=this._level,e._session=this._session,e._transactionName=this._transactionName,e._fingerprint=this._fingerprint,e._eventProcessors=[...this._eventProcessors],e._requestSession=this._requestSession,e._attachments=[...this._attachments],e._sdkProcessingMetadata={...this._sdkProcessingMetadata},e._propagationContext={...this._propagationContext},e._client=this._client,e._lastEventId=this._lastEventId,Rs(e,xs(this)),e}setClient(e){this._client=e}setLastEventId(e){this._lastEventId=e}getClient(){return this._client}lastEventId(){return this._lastEventId}addScopeListener(e){this._scopeListeners.push(e)}addEventProcessor(e){return this._eventProcessors.push(e),this}setUser(e){return this._user=e||{email:void 0,id:void 0,ip_address:void 0,username:void 0},this._session&&Mt(this._session,{user:e}),this._notifyScopeListeners(),this}getUser(){return this._user}getRequestSession(){return this._requestSession}setRequestSession(e){return this._requestSession=e,this}setTags(e){return this._tags={...this._tags,...e},this._notifyScopeListeners(),this}setTag(e,t){return this._tags={...this._tags,[e]:t},this._notifyScopeListeners(),this}setExtras(e){return this._extra={...this._extra,...e},this._notifyScopeListeners(),this}setExtra(e,t){return this._extra={...this._extra,[e]:t},this._notifyScopeListeners(),this}setFingerprint(e){return this._fingerprint=e,this._notifyScopeListeners(),this}setLevel(e){return this._level=e,this._notifyScopeListeners(),this}setTransactionName(e){return this._transactionName=e,this._notifyScopeListeners(),this}setContext(e,t){return t===null?delete this._contexts[e]:this._contexts[e]=t,this._notifyScopeListeners(),this}setSession(e){return e?this._session=e:delete this._session,this._notifyScopeListeners(),this}getSession(){return this._session}update(e){if(!e)return this;const t=typeof e=="function"?e(this):e,[n,i]=t instanceof He?[t.getScopeData(),t.getRequestSession()]:kt(t)?[e,e.requestSession]:[],{tags:a,extra:s,user:c,contexts:u,level:l,fingerprint:f=[],propagationContext:v}=n||{};return this._tags={...this._tags,...a},this._extra={...this._extra,...s},this._contexts={...this._contexts,...u},c&&Object.keys(c).length&&(this._user=c),l&&(this._level=l),f.length&&(this._fingerprint=f),v&&(this._propagationContext=v),i&&(this._requestSession=i),this}clear(){return this._breadcrumbs=[],this._tags={},this._extra={},this._user={},this._contexts={},this._level=void 0,this._transactionName=void 0,this._fingerprint=void 0,this._requestSession=void 0,this._session=void 0,Rs(this,void 0),this._attachments=[],this.setPropagationContext({traceId:js()}),this._notifyScopeListeners(),this}addBreadcrumb(e,t){const n=typeof t=="number"?t:100;if(n<=0)return this;const i={timestamp:Jt(),...e};return this._breadcrumbs.push(i),this._breadcrumbs.length>n&&(this._breadcrumbs=this._breadcrumbs.slice(-n),this._client&&this._client.recordDroppedEvent("buffer_overflow","log_item")),this._notifyScopeListeners(),this}getLastBreadcrumb(){return this._breadcrumbs[this._breadcrumbs.length-1]}clearBreadcrumbs(){return this._breadcrumbs=[],this._notifyScopeListeners(),this}addAttachment(e){return this._attachments.push(e),this}clearAttachments(){return this._attachments=[],this}getScopeData(){return{breadcrumbs:this._breadcrumbs,attachments:this._attachments,contexts:this._contexts,tags:this._tags,extra:this._extra,user:this._user,level:this._level,fingerprint:this._fingerprint||[],eventProcessors:this._eventProcessors,propagationContext:this._propagationContext,sdkProcessingMetadata:this._sdkProcessingMetadata,transactionName:this._transactionName,span:xs(this)}}setSDKProcessingMetadata(e){return this._sdkProcessingMetadata=Nr(this._sdkProcessingMetadata,e,2),this}setPropagationContext(e){return this._propagationContext={spanId:ma(),...e},this}getPropagationContext(){return this._propagationContext}captureException(e,t){const n=t&&t.event_id?t.event_id:ye();if(!this._client)return N.warn("No client configured on scope - will not capture exception!"),n;const i=new Error("Sentry syntheticException");return this._client.captureException(e,{originalException:e,syntheticException:i,...t,event_id:n},this),n}captureMessage(e,t,n){const i=n&&n.event_id?n.event_id:ye();if(!this._client)return N.warn("No client configured on scope - will not capture message!"),i;const a=new Error(e);return this._client.captureMessage(e,t,{originalException:e,syntheticException:a,...n,event_id:i},this),i}captureEvent(e,t){const n=t&&t.event_id?t.event_id:ye();return this._client?(this._client.captureEvent(e,{...t,event_id:n},this),n):(N.warn("No client configured on scope - will not capture event!"),n)}_notifyScopeListeners(){this._notifyingListeners||(this._notifyingListeners=!0,this._scopeListeners.forEach((e=>{e(this)})),this._notifyingListeners=!1)}}const He=Ba;class Jd{constructor(e,t){let n,i;n=e||new He,i=t||new He,this._stack=[{scope:n}],this._isolationScope=i}withScope(e){const t=this._pushScope();let n;try{n=e(t)}catch(i){throw this._popScope(),i}return Dr(n)?n.then((i=>(this._popScope(),i)),(i=>{throw this._popScope(),i})):(this._popScope(),n)}getClient(){return this.getStackTop().client}getScope(){return this.getStackTop().scope}getIsolationScope(){return this._isolationScope}getStackTop(){return this._stack[this._stack.length-1]}_pushScope(){const e=this.getScope().clone();return this._stack.push({client:this.getClient(),scope:e}),e}_popScope(){return!(this._stack.length<=1)&&!!this._stack.pop()}}function Tt(){const r=Da(xr());return r.stack=r.stack||new Jd(kr("defaultCurrentScope",(()=>new He)),kr("defaultIsolationScope",(()=>new He)))}function zd(r){return Tt().withScope(r)}function Wd(r,e){const t=Tt();return t.withScope((()=>(t.getStackTop().scope=r,e(r))))}function Ls(r){return Tt().withScope((()=>r(Tt().getIsolationScope())))}function Ua(r){const e=Da(r);return e.acs?e.acs:{withIsolationScope:Ls,withScope:zd,withSetScope:Wd,withSetIsolationScope:(t,n)=>Ls(n),getCurrentScope:()=>Tt().getScope(),getIsolationScope:()=>Tt().getIsolationScope()}}function pt(){return Ua(xr()).getCurrentScope()}function zt(){return Ua(xr()).getIsolationScope()}function ne(){return pt().getClient()}function Gd(r){const e=r.getPropagationContext(),{traceId:t,spanId:n,parentSpanId:i}=e;return me({trace_id:t,span_id:n,parent_span_id:i})}function Hd(r){const e=r._sentryMetrics;if(!e)return;const t={};for(const[,[n,i]]of e)(t[n]||(t[n]=[])).push(me(i));return t}const Kd=/^sentry-/;function Qd(r){const e=(function(n){if(!(!n||!De(n)&&!Array.isArray(n)))return Array.isArray(n)?n.reduce(((i,a)=>{const s=Ds(a);return Object.entries(s).forEach((([c,u])=>{i[c]=u})),i}),{}):Ds(n)})(r);if(!e)return;const t=Object.entries(e).reduce(((n,[i,a])=>(i.match(Kd)&&(n[i.slice(7)]=a),n)),{});return Object.keys(t).length>0?t:void 0}function Ds(r){return r.split(",").map((e=>e.split("=").map((t=>decodeURIComponent(t.trim()))))).reduce(((e,[t,n])=>(t&&n&&(e[t]=n),e)),{})}let Ns=!1;function Yd(r){const{spanId:e,traceId:t,isRemote:n}=r.spanContext();return me({parent_span_id:n?e:Va(r).parent_span_id,span_id:n?ma():e,trace_id:t})}function qs(r){return typeof r=="number"?Fs(r):Array.isArray(r)?r[0]+r[1]/1e9:r instanceof Date?Fs(r.getTime()):qe()}function Fs(r){return r>9999999999?r/1e3:r}function Va(r){if((function(e){return typeof e.getSpanJSON=="function"})(r))return r.getSpanJSON();try{const{spanId:e,traceId:t}=r.spanContext();if((function(n){const i=n;return!!(i.attributes&&i.startTime&&i.name&&i.endTime&&i.status)})(r)){const{attributes:n,startTime:i,name:a,endTime:s,parentSpanId:c,status:u}=r;return me({span_id:e,trace_id:t,data:n,description:a,parent_span_id:c,start_timestamp:qs(i),timestamp:qs(s)||void 0,status:Xd(u),op:n["sentry.op"],origin:n["sentry.origin"],_metrics_summary:Hd(r)})}return{span_id:e,trace_id:t}}catch{return{}}}function Xd(r){if(r&&r.code!==0)return r.code===1?"ok":r.message||"unknown_error"}function Cl(r){return r._sentryRootSpan||r}function Zd(){Ns||(Vt((()=>{console.warn("[Sentry] Deprecation warning: Returning null from `beforeSendSpan` will be disallowed from SDK version 9.0.0 onwards. The callback will only support mutating spans. To drop certain spans, configure the respective integrations directly.")})),Ns=!0)}const Ja="production";function Ml(r,e){const t=e.getOptions(),{publicKey:n}=e.getDsn()||{},i=me({environment:t.environment||Ja,release:t.release,public_key:n,trace_id:r});return e.emit("createDsc",i),i}function eh(r){const e=ne();if(!e)return{};const t=Cl(r),n=t._frozenDsc;if(n)return n;const i=t.spanContext().traceState,a=i&&i.get("sentry.dsc"),s=a&&Qd(a);if(s)return s;const c=Ml(r.spanContext().traceId,e),u=Va(t),l=u.data||{},f=l["sentry.sample_rate"];f!=null&&(c.sample_rate=`${f}`);const v=l["sentry.source"],b=u.description;return v!=="url"&&b&&(c.transaction=b),(function(k){if(typeof __SENTRY_TRACING__=="boolean"&&!__SENTRY_TRACING__)return!1;const y=ne(),m=y&&y.getOptions();return!!m&&(m.enableTracing||"tracesSampleRate"in m||"tracesSampler"in m)})()&&(c.sampled=String((function(k){const{traceFlags:y}=k.spanContext();return y===1})(t))),e.emit("createDsc",c,t),c}const th=/^(?:(\w+):)\/\/(?:(\w+)(?::(\w+)?)?@)([\w.-]+)(?::(\d+))?\/(.+)/;function Tr(r,e=!1){const{host:t,path:n,pass:i,port:a,projectId:s,protocol:c,publicKey:u}=r;return`${c}://${u}${e&&i?`:${i}`:""}@${t}${a?`:${a}`:""}/${n&&`${n}/`}${s}`}function $s(r){return{protocol:r.protocol,publicKey:r.publicKey||"",pass:r.pass||"",host:r.host,port:r.port||"",path:r.path||"",projectId:r.projectId}}function rh(r){const e=typeof r=="string"?(function(t){const n=th.exec(t);if(!n)return void Vt((()=>{console.error(`Invalid Sentry Dsn: ${t}`)}));const[i,a,s="",c="",u="",l=""]=n.slice(1);let f="",v=l;const b=v.split("/");if(b.length>1&&(f=b.slice(0,-1).join("/"),v=b.pop()),v){const k=v.match(/^\d+/);k&&(v=k[0])}return $s({host:c,pass:s,path:f,projectId:v,port:u,protocol:i,publicKey:a})})(r):$s(r);if(e&&(function(t){if(!ft)return!0;const{port:n,projectId:i,protocol:a}=t;return!(["protocol","publicKey","host","projectId"].find((s=>!t[s]&&(N.error(`Invalid Sentry Dsn: ${s} missing`),!0)))||(i.match(/^\d+$/)?(function(s){return s==="http"||s==="https"})(a)?n&&isNaN(parseInt(n,10))&&(N.error(`Invalid Sentry Dsn: Invalid port ${n}`),1):(N.error(`Invalid Sentry Dsn: Invalid protocol ${a}`),1):(N.error(`Invalid Sentry Dsn: Invalid projectId ${i}`),1)))})(e))return e}function Le(r,e=100,t=1/0){try{return ba("",r,e,t)}catch(n){return{ERROR:`**non-serializable** (${n})`}}}function Tl(r,e=3,t=102400){const n=Le(r,e);return i=n,(function(a){return~-encodeURI(a).split(/%..|./).length})(JSON.stringify(i))>t?Tl(r,e-1,t):n;var i}function ba(r,e,t=1/0,n=1/0,i=(function(){const a=typeof WeakSet=="function",s=a?new WeakSet:[];return[function(c){if(a)return!!s.has(c)||(s.add(c),!1);for(let u=0;u<s.length;u++)if(s[u]===c)return!0;return s.push(c),!1},function(c){if(a)s.delete(c);else for(let u=0;u<s.length;u++)if(s[u]===c){s.splice(u,1);break}}]})()){const[a,s]=i;if(e==null||["boolean","string"].includes(typeof e)||typeof e=="number"&&Number.isFinite(e))return e;const c=(function(k,y){try{if(k==="domain"&&y&&typeof y=="object"&&y._events)return"[Domain]";if(k==="domainEmitter")return"[DomainEmitter]";if(typeof global<"u"&&y===global)return"[Global]";if(typeof window<"u"&&y===window)return"[Window]";if(typeof document<"u"&&y===document)return"[Document]";if(bl(y))return"[VueViewModel]";if(kt(m=y)&&"nativeEvent"in m&&"preventDefault"in m&&"stopPropagation"in m)return"[SyntheticEvent]";if(typeof y=="number"&&!Number.isFinite(y))return`[${y}]`;if(typeof y=="function")return`[Function: ${Ge(y)}]`;if(typeof y=="symbol")return`[${String(y)}]`;if(typeof y=="bigint")return`[BigInt: ${String(y)}]`;const _=(function(S){const C=Object.getPrototypeOf(S);return C?C.constructor.name:"null prototype"})(y);return/^HTML(\w*)Element$/.test(_)?`[HTMLElement: ${_}]`:`[object ${_}]`}catch(_){return`**non-serializable** (${_})`}var m})(r,e);if(!c.startsWith("[object "))return c;if(e.__sentry_skip_normalization__)return e;const u=typeof e.__sentry_override_normalization_depth__=="number"?e.__sentry_override_normalization_depth__:t;if(u===0)return c.replace("object ","");if(a(e))return"[Circular ~]";const l=e;if(l&&typeof l.toJSON=="function")try{return ba("",l.toJSON(),u-1,n,i)}catch{}const f=Array.isArray(e)?[]:{};let v=0;const b=Sl(e);for(const k in b){if(!Object.prototype.hasOwnProperty.call(b,k))continue;if(v>=n){f[k]="[MaxProperties ~]";break}const y=b[k];f[k]=ba(k,y,u-1,n,i),v++}return s(e),f}function Ut(r,e=[]){return[r,e]}function nh(r,e){const[t,n]=r;return[t,[...n,e]]}function Bs(r,e){const t=r[1];for(const n of t)if(e(n,n[0].type))return!0;return!1}function _a(r){return W.__SENTRY__&&W.__SENTRY__.encodePolyfill?W.__SENTRY__.encodePolyfill(r):new TextEncoder().encode(r)}function ih(r){const[e,t]=r;let n=JSON.stringify(e);function i(a){typeof n=="string"?n=typeof a=="string"?n+a:[_a(n),a]:n.push(typeof a=="string"?_a(a):a)}for(const a of t){const[s,c]=a;if(i(`
${JSON.stringify(s)}
`),typeof c=="string"||c instanceof Uint8Array)i(c);else{let u;try{u=JSON.stringify(c)}catch{u=JSON.stringify(Le(c))}i(u)}}return typeof n=="string"?n:(function(a){const s=a.reduce(((l,f)=>l+f.length),0),c=new Uint8Array(s);let u=0;for(const l of a)c.set(l,u),u+=l.length;return c})(n)}function ah(r){const e=typeof r.data=="string"?_a(r.data):r.data;return[me({type:"attachment",length:e.length,filename:r.filename,content_type:r.contentType,attachment_type:r.attachmentType}),e]}const sh={session:"session",sessions:"session",attachment:"attachment",transaction:"transaction",event:"error",client_report:"internal",user_report:"default",profile:"profile",profile_chunk:"profile",replay_event:"replay",replay_recording:"replay",check_in:"monitor",feedback:"feedback",span:"span",statsd:"metric_bucket",raw_security:"security"};function Us(r){return sh[r]}function El(r){if(!r||!r.sdk)return;const{name:e,version:t}=r.sdk;return{name:e,version:t}}function oh(r,e,t,n){const i=El(t),a=r.type&&r.type!=="replay_event"?r.type:"event";(function(c,u){u&&(c.sdk=c.sdk||{},c.sdk.name=c.sdk.name||u.name,c.sdk.version=c.sdk.version||u.version,c.sdk.integrations=[...c.sdk.integrations||[],...u.integrations||[]],c.sdk.packages=[...c.sdk.packages||[],...u.packages||[]])})(r,t&&t.sdk);const s=(function(c,u,l,f){const v=c.sdkProcessingMetadata&&c.sdkProcessingMetadata.dynamicSamplingContext;return{event_id:c.event_id,sent_at:new Date().toISOString(),...u&&{sdk:u},...!!l&&f&&{dsn:Tr(f)},...v&&{trace:me({...v})}}})(r,i,n,e);return delete r.sdkProcessingMetadata,Ut(s,[[{type:a},r]])}function wa(r,e,t,n=0){return new ge(((i,a)=>{const s=r[n];if(e===null||typeof s!="function")i(e);else{const c=s({...e},t);K&&s.id&&c===null&&N.log(`Event processor "${s.id}" dropped event`),Dr(c)?c.then((u=>wa(r,u,t,n+1).then(i))).then(null,a):wa(r,c,t,n+1).then(i).then(null,a)}}))}let sr,Vs,Hr;function ch(r,e){const{fingerprint:t,span:n,breadcrumbs:i,sdkProcessingMetadata:a}=e;(function(s,c){const{extra:u,tags:l,user:f,contexts:v,level:b,transactionName:k}=c,y=me(u);y&&Object.keys(y).length&&(s.extra={...y,...s.extra});const m=me(l);m&&Object.keys(m).length&&(s.tags={...m,...s.tags});const _=me(f);_&&Object.keys(_).length&&(s.user={..._,...s.user});const S=me(v);S&&Object.keys(S).length&&(s.contexts={...S,...s.contexts}),b&&(s.level=b),k&&s.type!=="transaction"&&(s.transaction=k)})(r,e),n&&(function(s,c){s.contexts={trace:Yd(c),...s.contexts},s.sdkProcessingMetadata={dynamicSamplingContext:eh(c),...s.sdkProcessingMetadata};const u=Cl(c),l=Va(u).description;l&&!s.transaction&&s.type==="transaction"&&(s.transaction=l)})(r,n),(function(s,c){s.fingerprint=s.fingerprint?Array.isArray(s.fingerprint)?s.fingerprint:[s.fingerprint]:[],c&&(s.fingerprint=s.fingerprint.concat(c)),s.fingerprint&&!s.fingerprint.length&&delete s.fingerprint})(r,t),(function(s,c){const u=[...s.breadcrumbs||[],...c];s.breadcrumbs=u.length?u:void 0})(r,i),(function(s,c){s.sdkProcessingMetadata={...s.sdkProcessingMetadata,...c}})(r,a)}function Js(r,e){const{extra:t,tags:n,user:i,contexts:a,level:s,sdkProcessingMetadata:c,breadcrumbs:u,fingerprint:l,eventProcessors:f,attachments:v,propagationContext:b,transactionName:k,span:y}=e;or(r,"extra",t),or(r,"tags",n),or(r,"user",i),or(r,"contexts",a),r.sdkProcessingMetadata=Nr(r.sdkProcessingMetadata,c,2),s&&(r.level=s),k&&(r.transactionName=k),y&&(r.span=y),u.length&&(r.breadcrumbs=[...r.breadcrumbs,...u]),l.length&&(r.fingerprint=[...r.fingerprint,...l]),f.length&&(r.eventProcessors=[...r.eventProcessors,...f]),v.length&&(r.attachments=[...r.attachments,...v]),r.propagationContext={...r.propagationContext,...b}}function or(r,e,t){r[e]=Nr(r[e],t,1)}function uh(r,e,t,n,i,a){const{normalizeDepth:s=3,normalizeMaxBreadth:c=1e3}=r,u={...e,event_id:e.event_id||t.event_id||ye(),timestamp:e.timestamp||Jt()},l=t.integrations||r.integrations.map((y=>y.name));(function(y,m){const{environment:_,release:S,dist:C,maxValueLength:A=250}=m;y.environment=y.environment||_||Ja,!y.release&&S&&(y.release=S),!y.dist&&C&&(y.dist=C),y.message&&(y.message=wt(y.message,A));const O=y.exception&&y.exception.values&&y.exception.values[0];O&&O.value&&(O.value=wt(O.value,A));const P=y.request;P&&P.url&&(P.url=wt(P.url,A))})(u,r),(function(y,m){m.length>0&&(y.sdk=y.sdk||{},y.sdk.integrations=[...y.sdk.integrations||[],...m])})(u,l),i&&i.emit("applyFrameMetadata",e),e.type===void 0&&(function(y,m){const _=(function(S){const C=W._sentryDebugIds;if(!C)return{};const A=Object.keys(C);return Hr&&A.length===Vs||(Vs=A.length,Hr=A.reduce(((O,P)=>{sr||(sr={});const x=sr[P];if(x)O[x[0]]=x[1];else{const U=S(P);for(let Y=U.length-1;Y>=0;Y--){const Q=U[Y],pe=Q&&Q.filename,F=C[P];if(pe&&F){O[pe]=F,sr[P]=[pe,F];break}}}return O}),{})),Hr})(m);try{y.exception.values.forEach((S=>{S.stacktrace.frames.forEach((C=>{_&&C.filename&&(C.debug_id=_[C.filename])}))}))}catch{}})(u,r.stackParser);const f=(function(y,m){if(!m)return y;const _=y?y.clone():new He;return _.update(m),_})(n,t.captureContext);t.mechanism&&Ct(u,t.mechanism);const v=i?i.getEventProcessors():[],b=kr("globalScope",(()=>new He)).getScopeData();a&&Js(b,a.getScopeData()),f&&Js(b,f.getScopeData());const k=[...t.attachments||[],...b.attachments];return k.length&&(t.attachments=k),ch(u,b),wa([...v,...b.eventProcessors],u,t).then((y=>(y&&(function(m){const _={};try{m.exception.values.forEach((C=>{C.stacktrace.frames.forEach((A=>{A.debug_id&&(A.abs_path?_[A.abs_path]=A.debug_id:A.filename&&(_[A.filename]=A.debug_id),delete A.debug_id)}))}))}catch{}if(Object.keys(_).length===0)return;m.debug_meta=m.debug_meta||{},m.debug_meta.images=m.debug_meta.images||[];const S=m.debug_meta.images;Object.entries(_).forEach((([C,A])=>{S.push({type:"sourcemap",code_file:C,debug_id:A})}))})(y),typeof s=="number"&&s>0?(function(m,_,S){if(!m)return null;const C={...m,...m.breadcrumbs&&{breadcrumbs:m.breadcrumbs.map((A=>({...A,...A.data&&{data:Le(A.data,_,S)}})))},...m.user&&{user:Le(m.user,_,S)},...m.contexts&&{contexts:Le(m.contexts,_,S)},...m.extra&&{extra:Le(m.extra,_,S)}};return m.contexts&&m.contexts.trace&&C.contexts&&(C.contexts.trace=m.contexts.trace,m.contexts.trace.data&&(C.contexts.trace.data=Le(m.contexts.trace.data,_,S))),m.spans&&(C.spans=m.spans.map((A=>({...A,...A.data&&{data:Le(A.data,_,S)}})))),m.contexts&&m.contexts.flags&&C.contexts&&(C.contexts.flags=Le(m.contexts.flags,3,S)),C})(y,s,c):y)))}function zs(r,e){return pt().captureEvent(r,e)}function Ws(r){const e=ne(),t=zt(),n=pt(),{release:i,environment:a=Ja}=e&&e.getOptions()||{},{userAgent:s}=W.navigator||{},c=Vd({release:i,environment:a,user:n.getUser()||t.getUser(),...s&&{userAgent:s},...r}),u=t.getSession();return u&&u.status==="ok"&&Mt(u,{status:"exited"}),Al(),t.setSession(c),n.setSession(c),c}function Al(){const r=zt(),e=pt(),t=e.getSession()||r.getSession();t&&(function(n,i){let a={};n.status==="ok"&&(a={status:"exited"}),Mt(n,a)})(t),Ol(),r.setSession(),e.setSession()}function Ol(){const r=zt(),e=pt(),t=ne(),n=e.getSession()||r.getSession();n&&t&&t.captureSession(n)}function Gs(r=!1){r?Al():Ol()}function lh(r,e,t){return e||`${(function(n){return`${(function(i){const a=i.protocol?`${i.protocol}:`:"",s=i.port?`:${i.port}`:"";return`${a}//${i.host}${s}${i.path?`/${i.path}`:""}/api/`})(n)}${n.projectId}/envelope/`})(r)}?${(function(n,i){const a={sentry_version:"7"};return n.publicKey&&(a.sentry_key=n.publicKey),i&&(a.sentry_client=`${i.name}/${i.version}`),new URLSearchParams(a).toString()})(r,t)}`}const Hs=[];function Ks(r,e){for(const t of e)t&&t.afterAllSetup&&t.afterAllSetup(r)}function Qs(r,e,t){if(t[e.name])K&&N.log(`Integration skipped because it was already installed: ${e.name}`);else{if(t[e.name]=e,Hs.indexOf(e.name)===-1&&typeof e.setupOnce=="function"&&(e.setupOnce(),Hs.push(e.name)),e.setup&&typeof e.setup=="function"&&e.setup(r),typeof e.preprocessEvent=="function"){const n=e.preprocessEvent.bind(e);r.on("preprocessEvent",((i,a)=>n(i,a,r)))}if(typeof e.processEvent=="function"){const n=e.processEvent.bind(e),i=Object.assign(((a,s)=>n(a,s,r)),{id:e.name});r.addEventProcessor(i)}K&&N.log(`Integration installed: ${e.name}`)}}class Ce extends Error{constructor(e,t="warn"){super(e),this.message=e,this.logLevel=t}}const Ys="Not capturing exception because it's already been captured.";class dh{constructor(e){if(this._options=e,this._integrations={},this._numProcessing=0,this._outcomes={},this._hooks={},this._eventProcessors=[],e.dsn?this._dsn=rh(e.dsn):K&&N.warn("No DSN provided, client will not send events."),this._dsn){const n=lh(this._dsn,e.tunnel,e._metadata?e._metadata.sdk:void 0);this._transport=e.transport({tunnel:this._options.tunnel,recordDroppedEvent:this.recordDroppedEvent.bind(this),...e.transportOptions,url:n})}const t=["enableTracing","tracesSampleRate","tracesSampler"].find((n=>n in e&&e[n]==null));t&&Vt((()=>{console.warn(`[Sentry] Deprecation warning: \`${t}\` is set to undefined, which leads to tracing being enabled. In v9, a value of \`undefined\` will result in tracing being disabled.`)}))}captureException(e,t,n){const i=ye();if(Is(e))return K&&N.log(Ys),i;const a={event_id:i,...t};return this._process(this.eventFromException(e,a).then((s=>this._captureEvent(s,a,n)))),a.event_id}captureMessage(e,t,n,i){const a={event_id:ye(),...n},s=qa(e)?e:String(e),c=pa(e)?this.eventFromMessage(s,t,a):this.eventFromException(e,a);return this._process(c.then((u=>this._captureEvent(u,a,i)))),a.event_id}captureEvent(e,t,n){const i=ye();if(t&&t.originalException&&Is(t.originalException))return K&&N.log(Ys),i;const a={event_id:i,...t},s=(e.sdkProcessingMetadata||{}).capturedSpanScope;return this._process(this._captureEvent(e,a,s||n)),a.event_id}captureSession(e){typeof e.release!="string"?K&&N.warn("Discarded session because of missing or non-string release"):(this.sendSession(e),Mt(e,{init:!1}))}getDsn(){return this._dsn}getOptions(){return this._options}getSdkMetadata(){return this._options._metadata}getTransport(){return this._transport}flush(e){const t=this._transport;return t?(this.emit("flush"),this._isClientDoneProcessing(e).then((n=>t.flush(e).then((i=>n&&i))))):dt(!0)}close(e){return this.flush(e).then((t=>(this.getOptions().enabled=!1,this.emit("close"),t)))}getEventProcessors(){return this._eventProcessors}addEventProcessor(e){this._eventProcessors.push(e)}init(){(this._isEnabled()||this._options.integrations.some((({name:e})=>e.startsWith("Spotlight"))))&&this._setupIntegrations()}getIntegrationByName(e){return this._integrations[e]}addIntegration(e){const t=this._integrations[e.name];Qs(this,e,this._integrations),t||Ks(this,[e])}sendEvent(e,t={}){this.emit("beforeSendEvent",e,t);let n=oh(e,this._dsn,this._options._metadata,this._options.tunnel);for(const a of t.attachments||[])n=nh(n,ah(a));const i=this.sendEnvelope(n);i&&i.then((a=>this.emit("afterSendEvent",e,a)),null)}sendSession(e){const t=(function(n,i,a,s){const c=El(a);return Ut({sent_at:new Date().toISOString(),...c&&{sdk:c},...!!s&&i&&{dsn:Tr(i)}},["aggregates"in n?[{type:"sessions"},n]:[{type:"session"},n.toJSON()]])})(e,this._dsn,this._options._metadata,this._options.tunnel);this.sendEnvelope(t)}recordDroppedEvent(e,t,n){if(this._options.sendClientReports){const i=typeof n=="number"?n:1,a=`${e}:${t}`;K&&N.log(`Recording outcome: "${a}"${i>1?` (${i} times)`:""}`),this._outcomes[a]=(this._outcomes[a]||0)+i}}on(e,t){const n=this._hooks[e]=this._hooks[e]||[];return n.push(t),()=>{const i=n.indexOf(t);i>-1&&n.splice(i,1)}}emit(e,...t){const n=this._hooks[e];n&&n.forEach((i=>i(...t)))}sendEnvelope(e){return this.emit("beforeEnvelope",e),this._isEnabled()&&this._transport?this._transport.send(e).then(null,(t=>(K&&N.error("Error while sending envelope:",t),t))):(K&&N.error("Transport disabled"),dt({}))}_setupIntegrations(){const{integrations:e}=this._options;this._integrations=(function(t,n){const i={};return n.forEach((a=>{a&&Qs(t,a,i)})),i})(this,e),Ks(this,e)}_updateSessionFromEvent(e,t){let n=t.level==="fatal",i=!1;const a=t.exception&&t.exception.values;if(a){i=!0;for(const c of a){const u=c.mechanism;if(u&&u.handled===!1){n=!0;break}}}const s=e.status==="ok";(s&&e.errors===0||s&&n)&&(Mt(e,{...n&&{status:"crashed"},errors:e.errors||Number(i||n)}),this.captureSession(e))}_isClientDoneProcessing(e){return new ge((t=>{let n=0;const i=setInterval((()=>{this._numProcessing==0?(clearInterval(i),t(!0)):(n+=1,e&&n>=e&&(clearInterval(i),t(!1)))}),1)}))}_isEnabled(){return this.getOptions().enabled!==!1&&this._transport!==void 0}_prepareEvent(e,t,n=pt(),i=zt()){const a=this.getOptions(),s=Object.keys(this._integrations);return!t.integrations&&s.length>0&&(t.integrations=s),this.emit("preprocessEvent",e,t),e.type||i.setLastEventId(e.event_id||t.event_id),uh(a,e,t,n,this,i).then((c=>{if(c===null)return c;c.contexts={trace:Gd(n),...c.contexts};const u=(function(l,f){const v=f.getPropagationContext();return v.dsc||Ml(v.traceId,l)})(this,n);return c.sdkProcessingMetadata={dynamicSamplingContext:u,...c.sdkProcessingMetadata},c}))}_captureEvent(e,t={},n){return this._processEvent(e,t,n).then((i=>i.event_id),(i=>{K&&(i instanceof Ce&&i.logLevel==="log"?N.log(i.message):N.warn(i))}))}_processEvent(e,t,n){const i=this.getOptions(),{sampleRate:a}=i,s=Zs(e),c=Xs(e),u=e.type||"error",l=`before send for type \`${u}\``,f=a===void 0?void 0:(function(k){if(typeof k=="boolean")return Number(k);const y=typeof k=="string"?parseFloat(k):k;if(!(typeof y!="number"||isNaN(y)||y<0||y>1))return y;K&&N.warn(`[Tracing] Given sample rate is invalid. Sample rate must be a boolean or a number between 0 and 1. Got ${JSON.stringify(k)} of type ${JSON.stringify(typeof k)}.`)})(a);if(c&&typeof f=="number"&&Math.random()>f)return this.recordDroppedEvent("sample_rate","error",e),Mr(new Ce(`Discarding event because it's not included in the random sample (sampling rate = ${a})`,"log"));const v=u==="replay_event"?"replay":u,b=(e.sdkProcessingMetadata||{}).capturedSpanIsolationScope;return this._prepareEvent(e,t,n,b).then((k=>{if(k===null)throw this.recordDroppedEvent("event_processor",v,e),new Ce("An event processor returned `null`, will not send event.","log");if(t.data&&t.data.__sentry__===!0)return k;const y=(function(m,_,S,C){const{beforeSend:A,beforeSendTransaction:O,beforeSendSpan:P}=_;if(Xs(S)&&A)return A(S,C);if(Zs(S)){if(S.spans&&P){const x=[];for(const U of S.spans){const Y=P(U);Y?x.push(Y):(Zd(),m.recordDroppedEvent("before_send","span"))}S.spans=x}if(O){if(S.spans){const x=S.spans.length;S.sdkProcessingMetadata={...S.sdkProcessingMetadata,spanCountBeforeProcessing:x}}return O(S,C)}}return S})(this,i,k,t);return(function(m,_){const S=`${_} must return \`null\` or a valid event.`;if(Dr(m))return m.then((C=>{if(!kt(C)&&C!==null)throw new Ce(S);return C}),(C=>{throw new Ce(`${_} rejected with ${C}`)}));if(!kt(m)&&m!==null)throw new Ce(S);return m})(y,l)})).then((k=>{if(k===null){if(this.recordDroppedEvent("before_send",v,e),s){const _=1+(e.spans||[]).length;this.recordDroppedEvent("before_send","span",_)}throw new Ce(`${l} returned \`null\`, will not send event.`,"log")}const y=n&&n.getSession();if(!s&&y&&this._updateSessionFromEvent(y,k),s){const _=(k.sdkProcessingMetadata&&k.sdkProcessingMetadata.spanCountBeforeProcessing||0)-(k.spans?k.spans.length:0);_>0&&this.recordDroppedEvent("before_send","span",_)}const m=k.transaction_info;if(s&&m&&k.transaction!==e.transaction){const _="custom";k.transaction_info={...m,source:_}}return this.sendEvent(k,t),k})).then(null,(k=>{throw k instanceof Ce?k:(this.captureException(k,{data:{__sentry__:!0},originalException:k}),new Ce(`Event processing pipeline threw an error, original event will not be sent. Details have been sent as a new event.
Reason: ${k}`))}))}_process(e){this._numProcessing++,e.then((t=>(this._numProcessing--,t)),(t=>(this._numProcessing--,t)))}_clearOutcomes(){const e=this._outcomes;return this._outcomes={},Object.entries(e).map((([t,n])=>{const[i,a]=t.split(":");return{reason:i,category:a,quantity:n}}))}_flushOutcomes(){K&&N.log("Flushing outcomes...");const e=this._clearOutcomes();if(e.length===0)return void(K&&N.log("No outcomes to send"));if(!this._dsn)return void(K&&N.log("No dsn provided, will not send outcomes"));K&&N.log("Sending outcomes:",e);const t=(n=e,Ut((i=this._options.tunnel&&Tr(this._dsn))?{dsn:i}:{},[[{type:"client_report"},{timestamp:a||Jt(),discarded_events:n}]]));var n,i,a;this.sendEnvelope(t)}}function Xs(r){return r.type===void 0}function Zs(r){return r.type==="transaction"}function hh(r){const e=[];function t(n){return e.splice(e.indexOf(n),1)[0]||Promise.resolve(void 0)}return{$:e,add:function(n){if(!(r===void 0||e.length<r))return Mr(new Ce("Not adding Promise because buffer limit was reached."));const i=n();return e.indexOf(i)===-1&&e.push(i),i.then((()=>t(i))).then(null,(()=>t(i).then(null,(()=>{})))),i},drain:function(n){return new ge(((i,a)=>{let s=e.length;if(!s)return i(!0);const c=setTimeout((()=>{n&&n>0&&i(!1)}),n);e.forEach((u=>{dt(u).then((()=>{--s||(clearTimeout(c),i(!0))}),a)}))}))}}}function fh(r,{statusCode:e,headers:t},n=Date.now()){const i={...r},a=t&&t["x-sentry-rate-limits"],s=t&&t["retry-after"];if(a)for(const c of a.trim().split(",")){const[u,l,,,f]=c.split(":",5),v=parseInt(u,10),b=1e3*(isNaN(v)?60:v);if(l)for(const k of l.split(";"))k==="metric_bucket"&&f&&!f.split(";").includes("custom")||(i[k]=n+b);else i.all=n+b}else s?i.all=n+(function(c,u=Date.now()){const l=parseInt(`${c}`,10);if(!isNaN(l))return 1e3*l;const f=Date.parse(`${c}`);return isNaN(f)?6e4:f-u})(s,n):e===429&&(i.all=n+6e4);return i}function ph(r,e,t=hh(r.bufferSize||64)){let n={};return{send:function(i){const a=[];if(Bs(i,((u,l)=>{const f=Us(l);if((function(v,b,k=Date.now()){return(function(y,m){return y[m]||y.all||0})(v,b)>k})(n,f)){const v=eo(u,l);r.recordDroppedEvent("ratelimit_backoff",f,v)}else a.push(u)})),a.length===0)return dt({});const s=Ut(i[0],a),c=u=>{Bs(s,((l,f)=>{const v=eo(l,f);r.recordDroppedEvent(u,Us(f),v)}))};return t.add((()=>e({body:ih(s)}).then((u=>(u.statusCode!==void 0&&(u.statusCode<200||u.statusCode>=300)&&K&&N.warn(`Sentry responded with status code ${u.statusCode} to sent event.`),n=fh(n,u),u)),(u=>{throw c("network_error"),u})))).then((u=>u),(u=>{if(u instanceof Ce)return K&&N.error("Skipped sending event because buffer is full."),c("queue_overflow"),dt({});throw u}))},flush:i=>t.drain(i)}}function eo(r,e){if(e==="event"||e==="transaction")return Array.isArray(r)?r[1]:void 0}const vh=100;function Xe(r,e){const t=ne(),n=zt();if(!t)return;const{beforeBreadcrumb:i=null,maxBreadcrumbs:a=vh}=t.getOptions();if(a<=0)return;const s={timestamp:Jt(),...r},c=i?Vt((()=>i(s,e))):s;c!==null&&(t.emit&&t.emit("beforeAddBreadcrumb",c,e),n.addBreadcrumb(c,a))}let to;const ro=new WeakMap,gh=()=>({name:"FunctionToString",setupOnce(){to=Function.prototype.toString;try{Function.prototype.toString=function(...r){const e=$a(this),t=ro.has(ne())&&e!==void 0?e:this;return to.apply(t,r)}}catch{}},setup(r){ro.set(r,!0)}}),mh=[/^Script error\.?$/,/^Javascript error: Script error\.? on line 0$/,/^ResizeObserver loop completed with undelivered notifications.$/,/^Cannot redefine property: googletag$/,"undefined is not an object (evaluating 'a.L')",`can't redefine non-configurable property "solana"`,"vv().getRestrictions is not a function. (In 'vv().getRestrictions(1,a)', 'vv().getRestrictions' is undefined)","Can't find variable: _AutofillCallbackHandler",/^Non-Error promise rejection captured with value: Object Not Found Matching Id:\d+, MethodName:simulateEvent, ParamCount:\d+$/],yh=(r={})=>({name:"InboundFilters",processEvent(e,t,n){const i=n.getOptions(),a=(function(s={},c={}){return{allowUrls:[...s.allowUrls||[],...c.allowUrls||[]],denyUrls:[...s.denyUrls||[],...c.denyUrls||[]],ignoreErrors:[...s.ignoreErrors||[],...c.ignoreErrors||[],...s.disableErrorDefaults?[]:mh],ignoreTransactions:[...s.ignoreTransactions||[],...c.ignoreTransactions||[]],ignoreInternal:s.ignoreInternal===void 0||s.ignoreInternal}})(r,i);return(function(s,c){return c.ignoreInternal&&(function(u){try{return u.exception.values[0].type==="SentryError"}catch{}return!1})(s)?(K&&N.warn(`Event dropped due to being internal Sentry Error.
Event: ${ze(s)}`),!0):(function(u,l){return u.type||!l||!l.length?!1:(function(f){const v=[];f.message&&v.push(f.message);let b;try{b=f.exception.values[f.exception.values.length-1]}catch{}return b&&b.value&&(v.push(b.value),b.type&&v.push(`${b.type}: ${b.value}`)),v})(u).some((f=>ar(f,l)))})(s,c.ignoreErrors)?(K&&N.warn(`Event dropped due to being matched by \`ignoreErrors\` option.
Event: ${ze(s)}`),!0):(function(u){return u.type||!u.exception||!u.exception.values||u.exception.values.length===0?!1:!u.message&&!u.exception.values.some((l=>l.stacktrace||l.type&&l.type!=="Error"||l.value))})(s)?(K&&N.warn(`Event dropped due to not having an error message, error type or stacktrace.
Event: ${ze(s)}`),!0):(function(u,l){if(u.type!=="transaction"||!l||!l.length)return!1;const f=u.transaction;return!!f&&ar(f,l)})(s,c.ignoreTransactions)?(K&&N.warn(`Event dropped due to being matched by \`ignoreTransactions\` option.
Event: ${ze(s)}`),!0):(function(u,l){if(!l||!l.length)return!1;const f=cr(u);return!!f&&ar(f,l)})(s,c.denyUrls)?(K&&N.warn(`Event dropped due to being matched by \`denyUrls\` option.
Event: ${ze(s)}.
Url: ${cr(s)}`),!0):(function(u,l){if(!l||!l.length)return!0;const f=cr(u);return!f||ar(f,l)})(s,c.allowUrls)?!1:(K&&N.warn(`Event dropped due to not being matched by \`allowUrls\` option.
Event: ${ze(s)}.
Url: ${cr(s)}`),!0)})(e,a)?null:e}});function cr(r){try{let e;try{e=r.exception.values[0].stacktrace.frames}catch{}return e?(function(t=[]){for(let n=t.length-1;n>=0;n--){const i=t[n];if(i&&i.filename!=="<anonymous>"&&i.filename!=="[native code]")return i.filename||null}return null})(e):null}catch{return K&&N.error(`Cannot extract url for event ${ze(r)}`),null}}function bh(r,e,t=250,n,i,a,s){if(!(a.exception&&a.exception.values&&s&&ut(s.originalException,Error)))return;const c=a.exception.values.length>0?a.exception.values[a.exception.values.length-1]:void 0;var u,l;c&&(a.exception.values=(u=Sa(r,e,i,s.originalException,n,a.exception.values,c,0),l=t,u.map((f=>(f.value&&(f.value=wt(f.value,l)),f)))))}function Sa(r,e,t,n,i,a,s,c){if(a.length>=t+1)return a;let u=[...a];if(ut(n[i],Error)){no(s,c);const l=r(e,n[i]),f=u.length;io(l,i,f,c),u=Sa(r,e,t,n[i],i,[l,...u],l,f)}return Array.isArray(n.errors)&&n.errors.forEach(((l,f)=>{if(ut(l,Error)){no(s,c);const v=r(e,l),b=u.length;io(v,`errors[${f}]`,b,c),u=Sa(r,e,t,l,i,[v,...u],v,b)}})),u}function no(r,e){r.mechanism=r.mechanism||{type:"generic",handled:!0},r.mechanism={...r.mechanism,...r.type==="AggregateError"&&{is_exception_group:!0},exception_id:e}}function io(r,e,t,n){r.mechanism=r.mechanism||{type:"generic",handled:!0},r.mechanism={...r.mechanism,type:"chained",source:e,exception_id:t,parent_id:n}}function Kr(r){if(!r)return{};const e=r.match(/^(([^:/?#]+):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?$/);if(!e)return{};const t=e[6]||"",n=e[8]||"";return{host:e[4],path:e[5],protocol:e[2],search:t,hash:n,relative:e[5]+t+n}}function _h(){"console"in W&&fa.forEach((function(r){r in W.console&&de(W.console,r,(function(e){return Cr[r]=e,function(...t){Te("console",{args:t,level:r});const n=Cr[r];n&&n.apply(W.console,t)}}))}))}function wh(r){return r==="warn"?"warning":["fatal","error","warning","log","info","debug"].includes(r)?r:"log"}const Sh=()=>{let r;return{name:"Dedupe",processEvent(e){if(e.type)return e;try{if((function(t,n){return n?!!((function(i,a){const s=i.message,c=a.message;return!(!s&&!c||s&&!c||!s&&c||s!==c||!so(i,a)||!ao(i,a))})(t,n)||(function(i,a){const s=oo(a),c=oo(i);return!(!s||!c||s.type!==c.type||s.value!==c.value||!so(i,a)||!ao(i,a))})(t,n)):!1})(e,r))return K&&N.warn("Event dropped due to being a duplicate of previously captured event."),null}catch{}return r=e}}};function ao(r,e){let t=Ms(r),n=Ms(e);if(!t&&!n)return!0;if(t&&!n||!t&&n||n.length!==t.length)return!1;for(let i=0;i<n.length;i++){const a=n[i],s=t[i];if(a.filename!==s.filename||a.lineno!==s.lineno||a.colno!==s.colno||a.function!==s.function)return!1}return!0}function so(r,e){let t=r.fingerprint,n=e.fingerprint;if(!t&&!n)return!0;if(t&&!n||!t&&n)return!1;try{return t.join("")===n.join("")}catch{return!1}}function oo(r){return r.exception&&r.exception.values&&r.exception.values[0]}function co(r){return r===void 0?void 0:r>=400&&r<500?"warning":r>=500?"error":void 0}const Qr=W;function ka(r){return r&&/^function\s+\w+\(\)\s+\{\s+\[native code\]\s+\}$/.test(r.toString())}function kh(){if(typeof EdgeRuntime=="string")return!0;if(!(function(){if(!("fetch"in Qr))return!1;try{return new Headers,new Request("http://www.example.com"),new Response,!0}catch{return!1}})())return!1;if(ka(Qr.fetch))return!0;let r=!1;const e=Qr.document;if(e&&typeof e.createElement=="function")try{const t=e.createElement("iframe");t.hidden=!0,e.head.appendChild(t),t.contentWindow&&t.contentWindow.fetch&&(r=ka(t.contentWindow.fetch)),e.head.removeChild(t)}catch(t){ft&&N.warn("Could not create sandbox iframe for pure fetch check, bailing to window.fetch: ",t)}return r}function Ch(r,e){const t="fetch";ot(t,r),ct(t,(()=>(function(n,i=!1){i&&!kh()||de(W,"fetch",(function(a){return function(...s){const c=new Error,{method:u,url:l}=(function(v){if(v.length===0)return{method:"GET",url:""};if(v.length===2){const[k,y]=v;return{url:uo(k),method:Ca(y,"method")?String(y.method).toUpperCase():"GET"}}const b=v[0];return{url:uo(b),method:Ca(b,"method")?String(b.method).toUpperCase():"GET"}})(s),f={args:s,fetchData:{method:u,url:l},startTimestamp:1e3*qe(),virtualError:c};return n||Te("fetch",{...f}),a.apply(W,s).then((async v=>(n?n(v):Te("fetch",{...f,endTimestamp:1e3*qe(),response:v}),v)),(v=>{throw Te("fetch",{...f,endTimestamp:1e3*qe(),error:v}),Na(v)&&v.stack===void 0&&(v.stack=c.stack,lt(v,"framesToPop",1)),v}))}}))})(void 0,e)))}function Ca(r,e){return!!r&&typeof r=="object"&&!!r[e]}function uo(r){return typeof r=="string"?r:r?Ca(r,"url")?r.url:r.toString?r.toString():"":""}const ur=W,te=W;let Ma=0;function lo(){return Ma>0}function Et(r,e={}){if(!(function(n){return typeof n=="function"})(r))return r;try{const n=r.__sentry_wrapped__;if(n)return typeof n=="function"?n:r;if($a(r))return r}catch{return r}const t=function(...n){try{const i=n.map((a=>Et(a,e)));return r.apply(this,i)}catch(i){throw Ma++,setTimeout((()=>{Ma--})),(function(...a){const s=Ua(xr());if(a.length===2){const[c,u]=a;return c?s.withSetScope(c,u):s.withScope(u)}s.withScope(a[0])})((a=>{var s;a.addEventProcessor((c=>(e.mechanism&&(ga(c,void 0),Ct(c,e.mechanism)),c.extra={...c.extra,arguments:n},c))),s=i,pt().captureException(s,void 0)})),i}};try{for(const n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}catch{}wl(t,r),lt(r,"__sentry_wrapped__",t);try{Object.getOwnPropertyDescriptor(t,"name").configurable&&Object.defineProperty(t,"name",{get:()=>r.name})}catch{}return t}const qr=typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__;function za(r,e){const t=Wa(r,e),n={type:Eh(e),value:Ah(e)};return t.length&&(n.stacktrace={frames:t}),n.type===void 0&&n.value===""&&(n.value="Unrecoverable error caught"),n}function Mh(r,e,t,n){const i=ne(),a=i&&i.getOptions().normalizeDepth,s=(function(l){for(const f in l)if(Object.prototype.hasOwnProperty.call(l,f)){const v=l[f];if(v instanceof Error)return v}})(e),c={__serialized__:Tl(e,a)};if(s)return{exception:{values:[za(r,s)]},extra:c};const u={exception:{values:[{type:Lr(e)?e.constructor.name:n?"UnhandledRejection":"Error",value:Oh(e,{isUnhandledRejection:n})}]},extra:c};if(t){const l=Wa(r,t);l.length&&(u.exception.values[0].stacktrace={frames:l})}return u}function Yr(r,e){return{exception:{values:[za(r,e)]}}}function Wa(r,e){const t=e.stacktrace||e.stack||"",n=(function(a){return a&&Th.test(a.message)?1:0})(e),i=(function(a){return typeof a.framesToPop=="number"?a.framesToPop:0})(e);try{return r(t,n,i)}catch{}return[]}const Th=/Minified React error #\d+;/i;function Pl(r){return typeof WebAssembly<"u"&&WebAssembly.Exception!==void 0&&r instanceof WebAssembly.Exception}function Eh(r){const e=r&&r.name;return!e&&Pl(r)?r.message&&Array.isArray(r.message)&&r.message.length==2?r.message[0]:"WebAssembly.Exception":e}function Ah(r){const e=r&&r.message;return e?e.error&&typeof e.error.message=="string"?e.error.message:Pl(r)&&Array.isArray(r.message)&&r.message.length==2?r.message[1]:e:"No error message"}function Ta(r,e,t,n,i){let a;if(yl(e)&&e.error)return Yr(r,e.error);if(Es(e)||At(e,"DOMException")){const s=e;if("stack"in e)a=Yr(r,e);else{const c=s.name||(Es(s)?"DOMError":"DOMException"),u=s.message?`${c}: ${s.message}`:c;a=Ea(r,u,t,n),ga(a,u)}return"code"in s&&(a.tags={...a.tags,"DOMException.code":`${s.code}`}),a}return Na(e)?Yr(r,e):kt(e)||Lr(e)?(a=Mh(r,e,t,i),Ct(a,{synthetic:!0}),a):(a=Ea(r,e,t,n),ga(a,`${e}`),Ct(a,{synthetic:!0}),a)}function Ea(r,e,t,n){const i={};if(n&&t){const a=Wa(r,t);a.length&&(i.exception={values:[{value:e,stacktrace:{frames:a}}]}),Ct(i,{synthetic:!0})}if(qa(e)){const{__sentry_template_string__:a,__sentry_template_values__:s}=e;return i.logentry={message:a,params:s},i}return i.message=e,i}function Oh(r,{isUnhandledRejection:e}){const t=(function(i,a=40){const s=Object.keys(Sl(i));s.sort();const c=s[0];if(!c)return"[object has no keys]";if(c.length>=a)return wt(c,a);for(let u=s.length;u>0;u--){const l=s.slice(0,u).join(", ");if(!(l.length>a))return u===s.length?l:wt(l,a)}return""})(r),n=e?"promise rejection":"exception";return yl(r)?`Event \`ErrorEvent\` captured as ${n} with message \`${r.message}\``:Lr(r)?`Event \`${(function(i){try{const a=Object.getPrototypeOf(i);return a?a.constructor.name:void 0}catch{}})(r)}\` (type=${r.type}) captured as ${n}`:`Object captured as ${n} with keys: ${t}`}class Ph extends dh{constructor(e){const t={parentSpanIsAlwaysRootSpan:!0,...e};(function(n,i,a=[i],s="npm"){const c=n._metadata||{};c.sdk||(c.sdk={name:`sentry.javascript.${i}`,packages:a.map((u=>({name:`${s}:@sentry/${u}`,version:st}))),version:st}),n._metadata=c})(t,"browser",["browser"],te.SENTRY_SDK_SOURCE||"npm"),super(t),t.sendClientReports&&te.document&&te.document.addEventListener("visibilitychange",(()=>{te.document.visibilityState==="hidden"&&this._flushOutcomes()}))}eventFromException(e,t){return(function(n,i,a,s){const c=Ta(n,i,a&&a.syntheticException||void 0,s);return Ct(c),c.level="error",a&&a.event_id&&(c.event_id=a.event_id),dt(c)})(this._options.stackParser,e,t,this._options.attachStacktrace)}eventFromMessage(e,t="info",n){return(function(i,a,s="info",c,u){const l=Ea(i,a,c&&c.syntheticException||void 0,u);return l.level=s,c&&c.event_id&&(l.event_id=c.event_id),dt(l)})(this._options.stackParser,e,t,n,this._options.attachStacktrace)}captureUserFeedback(e){if(!this._isEnabled())return void(qr&&N.warn("SDK not enabled, will not capture user feedback."));const t=(function(n,{metadata:i,tunnel:a,dsn:s}){const c={event_id:n.event_id,sent_at:new Date().toISOString(),...i&&i.sdk&&{sdk:{name:i.sdk.name,version:i.sdk.version}},...!!a&&!!s&&{dsn:Tr(s)}};return Ut(c,[(function(l){return[{type:"user_report"},l]})(n)])})(e,{metadata:this.getSdkMetadata(),dsn:this.getDsn(),tunnel:this.getOptions().tunnel});this.sendEnvelope(t)}_prepareEvent(e,t,n){return e.platform=e.platform||"javascript",super._prepareEvent(e,t,n)}}const Ih=typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__,oe=W;let ho,Xr,Zr,lr;function jh(){if(!oe.document)return;const r=Te.bind(null,"dom"),e=fo(r,!0);oe.document.addEventListener("click",e,!1),oe.document.addEventListener("keypress",e,!1),["EventTarget","Node"].forEach((t=>{const n=oe[t],i=n&&n.prototype;i&&i.hasOwnProperty&&i.hasOwnProperty("addEventListener")&&(de(i,"addEventListener",(function(a){return function(s,c,u){if(s==="click"||s=="keypress")try{const l=this.__sentry_instrumentation_handlers__=this.__sentry_instrumentation_handlers__||{},f=l[s]=l[s]||{refCount:0};if(!f.handler){const v=fo(r);f.handler=v,a.call(this,s,v,u)}f.refCount++}catch{}return a.call(this,s,c,u)}})),de(i,"removeEventListener",(function(a){return function(s,c,u){if(s==="click"||s=="keypress")try{const l=this.__sentry_instrumentation_handlers__||{},f=l[s];f&&(f.refCount--,f.refCount<=0&&(a.call(this,s,f.handler,u),f.handler=void 0,delete l[s]),Object.keys(l).length===0&&delete this.__sentry_instrumentation_handlers__)}catch{}return a.call(this,s,c,u)}})))}))}function fo(r,e=!1){return t=>{if(!t||t._sentryCaptured)return;const n=(function(a){try{return a.target}catch{return null}})(t);if((function(a,s){return a==="keypress"&&(!s||!s.tagName||s.tagName!=="INPUT"&&s.tagName!=="TEXTAREA"&&!s.isContentEditable)})(t.type,n))return;lt(t,"_sentryCaptured",!0),n&&!n._sentryId&&lt(n,"_sentryId",ye());const i=t.type==="keypress"?"input":t.type;(function(a){if(a.type!==Xr)return!1;try{if(!a.target||a.target._sentryId!==Zr)return!1}catch{}return!0})(t)||(r({event:t,name:i,global:e}),Xr=t.type,Zr=n?n._sentryId:void 0),clearTimeout(ho),ho=oe.setTimeout((()=>{Zr=void 0,Xr=void 0}),1e3)}}function Il(r){const e="history";ot(e,r),ct(e,Rh)}function Rh(){if(!(function(){const t=ur.chrome,n=t&&t.app&&t.app.runtime,i="history"in ur&&!!ur.history.pushState&&!!ur.history.replaceState;return!n&&i})())return;const r=oe.onpopstate;function e(t){return function(...n){const i=n.length>2?n[2]:void 0;if(i){const a=lr,s=String(i);lr=s,Te("history",{from:a,to:s})}return t.apply(this,n)}}oe.onpopstate=function(...t){const n=oe.location.href,i=lr;if(lr=n,Te("history",{from:i,to:n}),r)try{return r.apply(this,t)}catch{}},de(oe.history,"pushState",e),de(oe.history,"replaceState",e)}const yr={};function po(r){yr[r]=void 0}const xt="__sentry_xhr_v3__";function xh(){if(!oe.XMLHttpRequest)return;const r=XMLHttpRequest.prototype;r.open=new Proxy(r.open,{apply(e,t,n){const i=new Error,a=1e3*qe(),s=De(n[0])?n[0].toUpperCase():void 0,c=(function(l){if(De(l))return l;try{return l.toString()}catch{}})(n[1]);if(!s||!c)return e.apply(t,n);t[xt]={method:s,url:c,request_headers:{}},s==="POST"&&c.match(/sentry_key/)&&(t.__sentry_own_request__=!0);const u=()=>{const l=t[xt];if(l&&t.readyState===4){try{l.status_code=t.status}catch{}Te("xhr",{endTimestamp:1e3*qe(),startTimestamp:a,xhr:t,virtualError:i})}};return"onreadystatechange"in t&&typeof t.onreadystatechange=="function"?t.onreadystatechange=new Proxy(t.onreadystatechange,{apply:(l,f,v)=>(u(),l.apply(f,v))}):t.addEventListener("readystatechange",u),t.setRequestHeader=new Proxy(t.setRequestHeader,{apply(l,f,v){const[b,k]=v,y=f[xt];return y&&De(b)&&De(k)&&(y.request_headers[b.toLowerCase()]=k),l.apply(f,v)}}),e.apply(t,n)}}),r.send=new Proxy(r.send,{apply(e,t,n){const i=t[xt];return i?(n[0]!==void 0&&(i.body=n[0]),Te("xhr",{startTimestamp:1e3*qe(),xhr:t}),e.apply(t,n)):e.apply(t,n)}})}function Lh(r,e=(function(t){const n=yr[t];if(n)return n;let i=oe[t];if(ka(i))return yr[t]=i.bind(oe);const a=oe.document;if(a&&typeof a.createElement=="function")try{const s=a.createElement("iframe");s.hidden=!0,a.head.appendChild(s);const c=s.contentWindow;c&&c[t]&&(i=c[t]),a.head.removeChild(s)}catch(s){Ih&&N.warn(`Could not create sandbox iframe for ${t} check, bailing to window.${t}: `,s)}return i&&(yr[t]=i.bind(oe))})("fetch")){let t=0,n=0;return ph(r,(function(i){const a=i.body.length;t+=a,n++;const s={body:i.body,method:"POST",referrerPolicy:"origin",headers:r.headers,keepalive:t<=6e4&&n<15,...r.fetchOptions};if(!e)return po("fetch"),Mr("No fetch implementation available");try{return e(r.url,s).then((c=>(t-=a,n--,{statusCode:c.status,headers:{"x-sentry-rate-limits":c.headers.get("X-Sentry-Rate-Limits"),"retry-after":c.headers.get("Retry-After")}})))}catch(c){return po("fetch"),t-=a,n--,Mr(c)}}))}function en(r,e,t,n){const i={filename:r,function:e==="<anonymous>"?at:e,in_app:!0};return t!==void 0&&(i.lineno=t),n!==void 0&&(i.colno=n),i}const Dh=/^\s*at (\S+?)(?::(\d+))(?::(\d+))\s*$/i,Nh=/^\s*at (?:(.+?\)(?: \[.+\])?|.*?) ?\((?:address at )?)?(?:async )?((?:<anonymous>|[-a-z]+:|.*bundle|\/)?.*?)(?::(\d+))?(?::(\d+))?\)?\s*$/i,qh=/\((\S*)(?::(\d+))(?::(\d+))\)/,Fh=/^\s*(.*?)(?:\((.*?)\))?(?:^|@)?((?:[-a-z]+)?:\/.*?|\[native code\]|[^@]*(?:bundle|\d+\.js)|\/[\w\-. /=]+)(?::(\d+))?(?::(\d+))?\s*$/i,$h=/(\S+) line (\d+)(?: > eval line \d+)* > eval/i,Bh=(function(...r){const e=r.sort(((t,n)=>t[0]-n[0])).map((t=>t[1]));return(t,n=0,i=0)=>{const a=[],s=t.split(`
`);for(let c=n;c<s.length;c++){const u=s[c];if(u.length>1024)continue;const l=Ss.test(u)?u.replace(Ss,"$1"):u;if(!l.match(/\S*Error: /)){for(const f of e){const v=f(l);if(v){a.push(v);break}}if(a.length>=50+i)break}}return(function(c){if(!c.length)return[];const u=Array.from(c);return/sentryWrapped/.test(ir(u).function||"")&&u.pop(),u.reverse(),ks.test(ir(u).function||"")&&(u.pop(),ks.test(ir(u).function||"")&&u.pop()),u.slice(0,50).map((l=>({...l,filename:l.filename||ir(u).filename,function:l.function||at})))})(a.slice(i))}})([30,r=>{const e=Dh.exec(r);if(e){const[,n,i,a]=e;return en(n,at,+i,+a)}const t=Nh.exec(r);if(t){if(t[2]&&t[2].indexOf("eval")===0){const a=qh.exec(t[2]);a&&(t[2]=a[1],t[3]=a[2],t[4]=a[3])}const[n,i]=vo(t[1]||at,t[2]);return en(i,n,t[3]?+t[3]:void 0,t[4]?+t[4]:void 0)}}],[50,r=>{const e=Fh.exec(r);if(e){if(e[3]&&e[3].indexOf(" > eval")>-1){const i=$h.exec(e[3]);i&&(e[1]=e[1]||"eval",e[3]=i[1],e[4]=i[2],e[5]="")}let t=e[3],n=e[1]||at;return[n,t]=vo(n,t),en(t,n,e[4]?+e[4]:void 0,e[5]?+e[5]:void 0)}}]),vo=(r,e)=>{const t=r.indexOf("safari-extension")!==-1,n=r.indexOf("safari-web-extension")!==-1;return t||n?[r.indexOf("@")!==-1?r.split("@")[0]:at,t?`safari-extension:${e}`:`safari-web-extension:${e}`]:[r,e]},go=1024,Uh=(r={})=>{const e={console:!0,dom:!0,fetch:!0,history:!0,sentry:!0,xhr:!0,...r};return{name:"Breadcrumbs",setup(t){var n;e.console&&(function(i){const a="console";ot(a,i),ct(a,_h)})((function(i){return function(a){if(ne()!==i)return;const s={category:"console",data:{arguments:a.args,logger:"console"},level:wh(a.level),message:As(a.args," ")};if(a.level==="assert"){if(a.args[0]!==!1)return;s.message=`Assertion failed: ${As(a.args.slice(1)," ")||"console.assert"}`,s.data.arguments=a.args.slice(1)}Xe(s,{input:a.args,level:a.level})}})(t)),e.dom&&(n=(function(i,a){return function(s){if(ne()!==i)return;let c,u,l=typeof a=="object"?a.serializeAttribute:void 0,f=typeof a=="object"&&typeof a.maxStringLength=="number"?a.maxStringLength:void 0;f&&f>go&&(qr&&N.warn(`\`dom.maxStringLength\` cannot exceed 1024, but a value of ${f} was configured. Sentry will use 1024 instead.`),f=go),typeof l=="string"&&(l=[l]);try{const b=s.event,k=(function(y){return!!y&&!!y.target})(b)?b.target:b;c=_l(k,{keyAttrs:l,maxStringLength:f}),u=(function(y){if(!Fa.HTMLElement)return null;let m=y;for(let _=0;_<5;_++){if(!m)return null;if(m instanceof HTMLElement){if(m.dataset.sentryComponent)return m.dataset.sentryComponent;if(m.dataset.sentryElement)return m.dataset.sentryElement}m=m.parentNode}return null})(k)}catch{c="<unknown>"}if(c.length===0)return;const v={category:`ui.${s.name}`,message:c};u&&(v.data={"ui.component_name":u}),Xe(v,{event:s.event,name:s.name,global:s.global})}})(t,e.dom),ot("dom",n),ct("dom",jh)),e.xhr&&(function(i){ot("xhr",i),ct("xhr",xh)})((function(i){return function(a){if(ne()!==i)return;const{startTimestamp:s,endTimestamp:c}=a,u=a.xhr[xt];if(!s||!c||!u)return;const{method:l,url:f,status_code:v,body:b}=u,k={method:l,url:f,status_code:v},y={xhr:a.xhr,input:b,startTimestamp:s,endTimestamp:c};Xe({category:"xhr",data:k,type:"http",level:co(v)},y)}})(t)),e.fetch&&Ch((function(i){return function(a){if(ne()!==i)return;const{startTimestamp:s,endTimestamp:c}=a;if(c&&(!a.fetchData.url.match(/sentry_key/)||a.fetchData.method!=="POST"))if(a.error)Xe({category:"fetch",data:a.fetchData,level:"error",type:"http"},{data:a.error,input:a.args,startTimestamp:s,endTimestamp:c});else{const u=a.response,l={...a.fetchData,status_code:u&&u.status},f={input:a.args,response:u,startTimestamp:s,endTimestamp:c};Xe({category:"fetch",data:l,type:"http",level:co(l.status_code)},f)}}})(t)),e.history&&Il((function(i){return function(a){if(ne()!==i)return;let s=a.from,c=a.to;const u=Kr(te.location.href);let l=s?Kr(s):void 0;const f=Kr(c);l&&l.path||(l=u),u.protocol===f.protocol&&u.host===f.host&&(c=f.relative),u.protocol===l.protocol&&u.host===l.host&&(s=l.relative),Xe({category:"navigation",data:{from:s,to:c}})}})(t)),e.sentry&&t.on("beforeSendEvent",(function(i){return function(a){ne()===i&&Xe({category:"sentry."+(a.type==="transaction"?"transaction":"event"),event_id:a.event_id,level:a.level,message:ze(a)},{event:a})}})(t))}}},Vh=["EventTarget","Window","Node","ApplicationCache","AudioTrackList","BroadcastChannel","ChannelMergerNode","CryptoOperation","EventSource","FileReader","HTMLUnknownElement","IDBDatabase","IDBRequest","IDBTransaction","KeyOperation","MediaController","MessagePort","ModalWindow","Notification","SVGElementInstance","Screen","SharedWorker","TextTrack","TextTrackCue","TextTrackList","WebSocket","WebSocketWorker","Worker","XMLHttpRequest","XMLHttpRequestEventTarget","XMLHttpRequestUpload"],Jh=(r={})=>{const e={XMLHttpRequest:!0,eventTarget:!0,requestAnimationFrame:!0,setInterval:!0,setTimeout:!0,...r};return{name:"BrowserApiErrors",setupOnce(){e.setTimeout&&de(te,"setTimeout",mo),e.setInterval&&de(te,"setInterval",mo),e.requestAnimationFrame&&de(te,"requestAnimationFrame",zh),e.XMLHttpRequest&&"XMLHttpRequest"in te&&de(XMLHttpRequest.prototype,"send",Wh);const t=e.eventTarget;t&&(Array.isArray(t)?t:Vh).forEach(Gh)}}};function mo(r){return function(...e){const t=e[0];return e[0]=Et(t,{mechanism:{data:{function:Ge(r)},handled:!1,type:"instrument"}}),r.apply(this,e)}}function zh(r){return function(e){return r.apply(this,[Et(e,{mechanism:{data:{function:"requestAnimationFrame",handler:Ge(r)},handled:!1,type:"instrument"}})])}}function Wh(r){return function(...e){const t=this;return["onload","onerror","onprogress","onreadystatechange"].forEach((n=>{n in t&&typeof t[n]=="function"&&de(t,n,(function(i){const a={mechanism:{data:{function:n,handler:Ge(i)},handled:!1,type:"instrument"}},s=$a(i);return s&&(a.mechanism.data.handler=Ge(s)),Et(i,a)}))})),r.apply(this,e)}}function Gh(r){const e=te[r],t=e&&e.prototype;t&&t.hasOwnProperty&&t.hasOwnProperty("addEventListener")&&(de(t,"addEventListener",(function(n){return function(i,a,s){try{typeof a.handleEvent=="function"&&(a.handleEvent=Et(a.handleEvent,{mechanism:{data:{function:"handleEvent",handler:Ge(a),target:r},handled:!1,type:"instrument"}}))}catch{}return n.apply(this,[i,Et(a,{mechanism:{data:{function:"addEventListener",handler:Ge(a),target:r},handled:!1,type:"instrument"}}),s])}})),de(t,"removeEventListener",(function(n){return function(i,a,s){try{const c=a.__sentry_wrapped__;c&&n.call(this,i,c,s)}catch{}return n.call(this,i,a,s)}})))}const Hh=()=>({name:"BrowserSession",setupOnce(){te.document!==void 0?(Ws({ignoreDuration:!0}),Gs(),Il((({from:r,to:e})=>{r!==void 0&&r!==e&&(Ws({ignoreDuration:!0}),Gs())}))):qr&&N.warn("Using the `browserSessionIntegration` in non-browser environments is not supported.")}}),Kh=(r={})=>{const e={onerror:!0,onunhandledrejection:!0,...r};return{name:"GlobalHandlers",setupOnce(){Error.stackTraceLimit=50},setup(t){e.onerror&&((function(n){(function(i){const a="error";ot(a,i),ct(a,Fd)})((i=>{const{stackParser:a,attachStacktrace:s}=bo();if(ne()!==n||lo())return;const{msg:c,url:u,line:l,column:f,error:v}=i,b=(function(k,y,m,_){const S=k.exception=k.exception||{},C=S.values=S.values||[],A=C[0]=C[0]||{},O=A.stacktrace=A.stacktrace||{},P=O.frames=O.frames||[],x=_,U=m,Y=De(y)&&y.length>0?y:(function(){try{return Fa.document.location.href}catch{return""}})();return P.length===0&&P.push({colno:x,filename:Y,function:at,in_app:!0,lineno:U}),k})(Ta(a,v||c,void 0,s,!1),u,l,f);b.level="error",zs(b,{originalException:v,mechanism:{handled:!1,type:"onerror"}})}))})(t),yo("onerror")),e.onunhandledrejection&&((function(n){(function(i){const a="unhandledrejection";ot(a,i),ct(a,$d)})((i=>{const{stackParser:a,attachStacktrace:s}=bo();if(ne()!==n||lo())return;const c=(function(l){if(pa(l))return l;try{if("reason"in l)return l.reason;if("detail"in l&&"reason"in l.detail)return l.detail.reason}catch{}return l})(i),u=pa(c)?{exception:{values:[{type:"UnhandledRejection",value:`Non-Error promise rejection captured with value: ${String(c)}`}]}}:Ta(a,c,void 0,s,!0);u.level="error",zs(u,{originalException:c,mechanism:{handled:!1,type:"onunhandledrejection"}})}))})(t),yo("onunhandledrejection"))}}};function yo(r){qr&&N.log(`Global Handler attached: ${r}`)}function bo(){const r=ne();return r&&r.getOptions()||{stackParser:()=>[],attachStacktrace:!1}}const Qh=()=>({name:"HttpContext",preprocessEvent(r){if(!te.navigator&&!te.location&&!te.document)return;const e=r.request&&r.request.url||te.location&&te.location.href,{referrer:t}=te.document||{},{userAgent:n}=te.navigator||{},i={...r.request&&r.request.headers,...t&&{Referer:t},...n&&{"User-Agent":n}},a={...r.request,...e&&{url:e},headers:i};r.request=a}}),Yh=(r={})=>{const e=r.limit||5,t=r.key||"cause";return{name:"LinkedErrors",preprocessEvent(n,i,a){const s=a.getOptions();bh(za,s.stackParser,s.maxValueLength,t,e,n,i)}}};var _o="new",wo="loading",So="loaded",Aa="joining-meeting",it="joined-meeting",Ze="left-meeting",Be="error",Xh="playable",tn="unknown",Zh="full",ef="base",ko="no-room",tf="end-of-life",rf="connection-error",nf="iframe-ready-for-launch-config",af="iframe-launch-config",sf="theme-updated",of="loading",cf="load-attempt-failed",Co="loaded",uf="started-camera",lf="camera-error",df="joining-meeting",hf="joined-meeting",ff="left-meeting",pf="participant-joined",vf="participant-updated",gf="participant-left",mf="participant-counts-updated",yf="access-state-updated",bf="meeting-session-summary-updated",_f="meeting-session-state-updated",wf="waiting-participant-added",Sf="waiting-participant-updated",kf="waiting-participant-removed",Cf="track-started",Mf="track-stopped",Tf="transcription-started",Ef="transcription-stopped",Af="transcription-error",Mo="recording-started",To="recording-stopped",Of="recording-stats",Pf="recording-error",If="recording-upload-completed",jf="recording-data",Rf="app-message",xf="transcription-message",Lf="remote-media-player-started",Df="remote-media-player-updated",Nf="remote-media-player-stopped",qf="local-screen-share-started",Ff="local-screen-share-stopped",$f="local-screen-share-canceled",Bf="active-speaker-change",Uf="active-speaker-mode-change",Vf="network-quality-change",Jf="network-connection",zf="cpu-load-change",Wf="face-counts-updated",dr="fullscreen",hr="exited-fullscreen",Gf="live-streaming-started",Hf="live-streaming-updated",Kf="live-streaming-stopped",Qf="live-streaming-error",Yf="lang-updated",Xf="receive-settings-updated",Eo="input-settings-updated",Ao="nonfatal-error",Oo="error",rn=4096,Po=102400,nn="iframe-call-message",Io="local-screen-start",jo="daily-method-update-live-streaming-endpoints",fr="transmit-log",Ne="daily-custom-track",br={NONE:"none",BGBLUR:"background-blur",BGIMAGE:"background-image",FACE_DETECTION:"face-detection"},jl={NONE:"none",NOISE_CANCELLATION:"noise-cancellation"},Oa={PLAY:"play",PAUSE:"pause"},an=["jpg","png","jpeg"],Zf="add-endpoints",ep="remove-endpoints",Ro="sip-call-transfer";function be(){return!J()&&typeof window<"u"&&window.navigator&&window.navigator.userAgent?window.navigator.userAgent:""}function J(){return typeof navigator<"u"&&navigator.product&&navigator.product==="ReactNative"}function Rl(){return navigator&&navigator.mediaDevices&&navigator.mediaDevices.getUserMedia}function tp(){return!!(navigator&&navigator.mediaDevices&&navigator.mediaDevices.getDisplayMedia)&&((function(r,e){if(!r||!e)return!0;switch(r){case"Chrome":return e.major>=75;case"Safari":return RTCRtpTransceiver.prototype.hasOwnProperty("currentDirection")&&!(e.major===13&&e.minor===0&&e.point===0);case"Firefox":return e.major>=67}return!0})(ht(),Er())||J())}function xo(){if(J()||!document)return!1;var r=document.createElement("iframe");return!!r.requestFullscreen||!!r.webkitRequestFullscreen}var Pa="none",rp="software",np="hardware",ip=(function(){try{var r,e=document.createElement("canvas"),t=!1;(r=e.getContext("webgl2",{failIfMajorPerformanceCaveat:!0}))||(t=!0,r=e.getContext("webgl2"));var n=r!=null;return e.remove(),n?t?rp:np:Pa}catch{return Pa}})();function xl(){var r=arguments.length>0&&arguments[0]!==void 0&&arguments[0];return!J()&&ip!==Pa&&(r?(function(){return Do()?!1:["Chrome","Firefox"].includes(ht())})():(function(){if(Do())return!1;var e=ht();if(e==="Safari"){var t=Ha();if(t.major<15||t.major===15&&t.minor<4)return!1}return e==="Chrome"?Ga().major>=77:e==="Firefox"?Ka().major>=97:["Chrome","Firefox","Safari"].includes(e)})())}function Ll(){if(J()||Dl()||typeof AudioWorkletNode>"u")return!1;switch(ht()){case"Chrome":case"Firefox":return!0;case"Safari":var r=Er();return r.major>17||r.major===17&&r.minor>=4}return!1}function Lo(){return Rl()&&!(function(){var r,e=ht();if(!be())return!0;switch(e){case"Chrome":return(r=Ga()).major&&r.major>0&&r.major<75;case"Firefox":return(r=Ka()).major<91;case"Safari":return(r=Ha()).major<13||r.major===13&&r.minor<1;default:return!0}})()}function Dl(){return be().match(/Linux; Android/)}function Do(){var r,e=be(),t=e.match(/Mac/)&&(!J()&&typeof window<"u"&&(r=window)!==null&&r!==void 0&&(r=r.navigator)!==null&&r!==void 0&&r.maxTouchPoints?window.navigator.maxTouchPoints:0)>=5;return!!(e.match(/Mobi/)||e.match(/Android/)||t)||!!be().match(/DailyAnd\//)||void 0}function ht(){if(typeof window<"u"){var r=be();return Nl()?"Safari":r.indexOf("Edge")>-1?"Edge":r.match(/Chrome\//)?"Chrome":r.indexOf("Safari")>-1||ql()?"Safari":r.indexOf("Firefox")>-1?"Firefox":r.indexOf("MSIE")>-1||r.indexOf(".NET")>-1?"IE":"Unknown Browser"}}function Er(){switch(ht()){case"Chrome":return Ga();case"Safari":return Ha();case"Firefox":return Ka();case"Edge":return(function(){var r=0,e=0;if(typeof window<"u"){var t=be().match(/Edge\/(\d+).(\d+)/);if(t)try{r=parseInt(t[1]),e=parseInt(t[2])}catch{}}return{major:r,minor:e}})()}}function Ga(){var r=0,e=0,t=0,n=0,i=!1;if(typeof window<"u"){var a=be(),s=a.match(/Chrome\/(\d+).(\d+).(\d+).(\d+)/);if(s)try{r=parseInt(s[1]),e=parseInt(s[2]),t=parseInt(s[3]),n=parseInt(s[4]),i=a.indexOf("OPR/")>-1}catch{}}return{major:r,minor:e,build:t,patch:n,opera:i}}function Nl(){return!!be().match(/iPad|iPhone|iPod/i)&&Rl()}function ql(){return be().indexOf("AppleWebKit/605.1.15")>-1}function Ha(){var r=0,e=0,t=0;if(typeof window<"u"){var n=be().match(/Version\/(\d+).(\d+)(.(\d+))?/);if(n)try{r=parseInt(n[1]),e=parseInt(n[2]),t=parseInt(n[4])}catch{}else(Nl()||ql())&&(r=14,e=0,t=3)}return{major:r,minor:e,point:t}}function Ka(){var r=0,e=0;if(typeof window<"u"){var t=be().match(/Firefox\/(\d+).(\d+)/);if(t)try{r=parseInt(t[1]),e=parseInt(t[2])}catch{}}return{major:r,minor:e}}var Fl=(function(){return fe((function r(){he(this,r)}),[{key:"addListenerForMessagesFromCallMachine",value:function(r,e,t){jt()}},{key:"addListenerForMessagesFromDailyJs",value:function(r,e,t){jt()}},{key:"sendMessageToCallMachine",value:function(r,e,t,n){jt()}},{key:"sendMessageToDailyJs",value:function(r,e){jt()}},{key:"removeListener",value:function(r){jt()}}])})();function No(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);e&&(n=n.filter((function(i){return Object.getOwnPropertyDescriptor(r,i).enumerable}))),t.push.apply(t,n)}return t}function sn(r){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?No(Object(t),!0).forEach((function(n){Ie(r,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):No(Object(t)).forEach((function(n){Object.defineProperty(r,n,Object.getOwnPropertyDescriptor(t,n))}))}return r}function $l(){try{var r=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch{}return($l=function(){return!!r})()}var ap=(function(){function r(){var e,t,n,i;return he(this,r),t=this,n=Ee(n=r),(e=Ir(t,$l()?Reflect.construct(n,[],Ee(t).constructor):n.apply(t,i)))._wrappedListeners={},e._messageCallbacks={},e}return jr(r,Fl),fe(r,[{key:"addListenerForMessagesFromCallMachine",value:function(e,t,n){var i=this,a=function(s){if(s.data&&s.data.what==="iframe-call-message"&&(!s.data.callClientId||s.data.callClientId===t)&&(!s.data.from||s.data.from!=="module")){var c=sn({},s.data);if(delete c.from,c.callbackStamp&&i._messageCallbacks[c.callbackStamp]){var u=c.callbackStamp;i._messageCallbacks[u].call(n,c),delete i._messageCallbacks[u]}delete c.what,delete c.callbackStamp,e.call(n,c)}};this._wrappedListeners[e]=a,window.addEventListener("message",a)}},{key:"addListenerForMessagesFromDailyJs",value:function(e,t,n){var i=function(a){var s;if(!(!a.data||a.data.what!==nn||!a.data.action||a.data.from&&a.data.from!=="module"||a.data.callClientId&&t&&a.data.callClientId!==t||a!=null&&(s=a.data)!==null&&s!==void 0&&s.callFrameId)){var c=a.data;e.call(n,c)}};this._wrappedListeners[e]=i,window.addEventListener("message",i)}},{key:"sendMessageToCallMachine",value:function(e,t,n,i){if(!n)throw new Error("undefined callClientId. Are you trying to use a DailyCall instance previously destroyed?");var a=sn({},e);if(a.what=nn,a.from="module",a.callClientId=n,t){var s=Rr();this._messageCallbacks[s]=t,a.callbackStamp=s}var c=i?i.contentWindow:window,u=this._callMachineTargetOrigin(i);u&&c.postMessage(a,u)}},{key:"sendMessageToDailyJs",value:function(e,t){e.what=nn,e.callClientId=t,e.from="embedded",window.postMessage(e,this._targetOriginFromWindowLocation())}},{key:"removeListener",value:function(e){var t=this._wrappedListeners[e];t&&(window.removeEventListener("message",t),delete this._wrappedListeners[e])}},{key:"forwardPackagedMessageToCallMachine",value:function(e,t,n){var i=sn({},e);i.callClientId=n;var a=t?t.contentWindow:window,s=this._callMachineTargetOrigin(t);s&&a.postMessage(i,s)}},{key:"addListenerForPackagedMessagesFromCallMachine",value:function(e,t){var n=function(i){if(i.data&&i.data.what==="iframe-call-message"&&(!i.data.callClientId||i.data.callClientId===t)&&(!i.data.from||i.data.from!=="module")){var a=i.data;e(a)}};return this._wrappedListeners[e]=n,window.addEventListener("message",n),e}},{key:"removeListenerForPackagedMessagesFromCallMachine",value:function(e){var t=this._wrappedListeners[e];t&&(window.removeEventListener("message",t),delete this._wrappedListeners[e])}},{key:"_callMachineTargetOrigin",value:function(e){return e?e.src?new URL(e.src).origin:void 0:this._targetOriginFromWindowLocation()}},{key:"_targetOriginFromWindowLocation",value:function(){return window.location.protocol==="file:"?"*":window.location.origin}}])})();function qo(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);e&&(n=n.filter((function(i){return Object.getOwnPropertyDescriptor(r,i).enumerable}))),t.push.apply(t,n)}return t}function Bl(){try{var r=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch{}return(Bl=function(){return!!r})()}var sp=(function(){function r(){var e,t,n,i;return he(this,r),t=this,n=Ee(n=r),e=Ir(t,Bl()?Reflect.construct(n,[],Ee(t).constructor):n.apply(t,i)),global.callMachineToDailyJsEmitter=global.callMachineToDailyJsEmitter||new ha.EventEmitter,global.dailyJsToCallMachineEmitter=global.dailyJsToCallMachineEmitter||new ha.EventEmitter,e._wrappedListeners={},e._messageCallbacks={},e}return jr(r,Fl),fe(r,[{key:"addListenerForMessagesFromCallMachine",value:function(e,t,n){this._addListener(e,global.callMachineToDailyJsEmitter,t,n,"received call machine message")}},{key:"addListenerForMessagesFromDailyJs",value:function(e,t,n){this._addListener(e,global.dailyJsToCallMachineEmitter,t,n,"received daily-js message")}},{key:"sendMessageToCallMachine",value:function(e,t,n){this._sendMessage(e,global.dailyJsToCallMachineEmitter,n,t,"sending message to call machine")}},{key:"sendMessageToDailyJs",value:function(e,t){this._sendMessage(e,global.callMachineToDailyJsEmitter,t,null,"sending message to daily-js")}},{key:"removeListener",value:function(e){var t=this._wrappedListeners[e];t&&(global.callMachineToDailyJsEmitter.removeListener("message",t),global.dailyJsToCallMachineEmitter.removeListener("message",t),delete this._wrappedListeners[e])}},{key:"_addListener",value:function(e,t,n,i,a){var s=this,c=function(u){if(u.callClientId===n){if(u.callbackStamp&&s._messageCallbacks[u.callbackStamp]){var l=u.callbackStamp;s._messageCallbacks[l].call(i,u),delete s._messageCallbacks[l]}e.call(i,u)}};this._wrappedListeners[e]=c,t.addListener("message",c)}},{key:"_sendMessage",value:function(e,t,n,i,a){var s=(function(u){for(var l=1;l<arguments.length;l++){var f=arguments[l]!=null?arguments[l]:{};l%2?qo(Object(f),!0).forEach((function(v){Ie(u,v,f[v])})):Object.getOwnPropertyDescriptors?Object.defineProperties(u,Object.getOwnPropertyDescriptors(f)):qo(Object(f)).forEach((function(v){Object.defineProperty(u,v,Object.getOwnPropertyDescriptor(f,v))}))}return u})({},e);if(s.callClientId=n,i){var c=Rr();this._messageCallbacks[c]=i,s.callbackStamp=c}t.emit("message",s)}}])})(),Ia="replace",ja="shallow-merge",Fo=[Ia,ja],op=(function(){function r(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.data,n=e.mergeStrategy,i=n===void 0?Ia:n;he(this,r),r._validateMergeStrategy(i),r._validateData(t,i),this.mergeStrategy=i,this.data=t}return fe(r,[{key:"isNoOp",value:function(){return r.isNoOpUpdate(this.data,this.mergeStrategy)}}],[{key:"isNoOpUpdate",value:function(e,t){return Object.keys(e).length===0&&t===ja}},{key:"_validateMergeStrategy",value:function(e){if(!Fo.includes(e))throw Error("Unrecognized mergeStrategy provided. Options are: [".concat(Fo,"]"))}},{key:"_validateData",value:function(e,t){if(!(function(c){if(c==null||z(c)!=="object")return!1;var u=Object.getPrototypeOf(c);return u==null||u===Object.prototype})(e))throw Error("Meeting session data must be a plain (map-like) object");var n;try{if(n=JSON.stringify(e),t===Ia){var i=JSON.parse(n);se(i,e)||console.warn("The meeting session data provided will be modified when serialized.",i,e)}else if(t===ja){for(var a in e)if(Object.hasOwnProperty.call(e,a)&&e[a]!==void 0){var s=JSON.parse(JSON.stringify(e[a]));se(e[a],s)||console.warn("At least one key in the meeting session data provided will be modified when serialized.",s,e[a])}}}catch(c){throw Error("Meeting session data must be serializable to JSON: ".concat(c))}if(n.length>Po)throw Error("Meeting session data is too large (".concat(n.length," characters). Maximum size suppported is ").concat(Po,"."))}}])})();function Ul(){try{var r=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch{}return(Ul=function(){return!!r})()}function Ra(r){var e=typeof Map=="function"?new Map:void 0;return Ra=function(t){if(t===null||!(function(i){try{return Function.toString.call(i).indexOf("[native code]")!==-1}catch{return typeof i=="function"}})(t))return t;if(typeof t!="function")throw new TypeError("Super expression must either be null or a function");if(e!==void 0){if(e.has(t))return e.get(t);e.set(t,n)}function n(){return(function(i,a,s){if(Ul())return Reflect.construct.apply(null,arguments);var c=[null];c.push.apply(c,a);var u=new(i.bind.apply(i,c));return s&&Bt(u,s.prototype),u})(t,arguments,Ee(this).constructor)}return n.prototype=Object.create(t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),Bt(n,t)},Ra(r)}function Vl(){try{var r=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch{}return(Vl=function(){return!!r})()}function $o(r){var e,t=(e=window._daily)===null||e===void 0?void 0:e.pendings;if(t){var n=t.indexOf(r);n!==-1&&t.splice(n,1)}}var cp=(function(){return fe((function r(e){he(this,r),this._currentLoad=null,this._callClientId=e}),[{key:"load",value:function(){var r,e=this,t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=arguments.length>1?arguments[1]:void 0,i=arguments.length>2?arguments[2]:void 0;if(this.loaded)return window._daily.instances[this._callClientId].callMachine.reset(),void n(!0);r=this._callClientId,window._daily.pendings.push(r),this._currentLoad&&this._currentLoad.cancel(),this._currentLoad=new up(t,(function(){n(!1)}),(function(a,s){s||$o(e._callClientId),i(a,s)})),this._currentLoad.start()}},{key:"cancel",value:function(){this._currentLoad&&this._currentLoad.cancel(),$o(this._callClientId)}},{key:"loaded",get:function(){return this._currentLoad&&this._currentLoad.succeeded}}])})(),up=(function(){return fe((function r(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0;he(this,r),this._attemptsRemaining=3,this._currentAttempt=null,this._dailyConfig=e,this._successCallback=t,this._failureCallback=n}),[{key:"start",value:function(){var r=this;if(!this._currentAttempt){var e=function(t){r._currentAttempt.cancelled||(r._attemptsRemaining--,r._failureCallback(t,r._attemptsRemaining>0),r._attemptsRemaining<=0||setTimeout((function(){r._currentAttempt.cancelled||(r._currentAttempt=new Bo(r._dailyConfig,r._successCallback,e),r._currentAttempt.start())}),3e3))};this._currentAttempt=new Bo(this._dailyConfig,this._successCallback,e),this._currentAttempt.start()}}},{key:"cancel",value:function(){this._currentAttempt&&this._currentAttempt.cancel()}},{key:"cancelled",get:function(){return this._currentAttempt&&this._currentAttempt.cancelled}},{key:"succeeded",get:function(){return this._currentAttempt&&this._currentAttempt.succeeded}}])})(),on=(function(){function r(){return he(this,r),e=this,n=arguments,t=Ee(t=r),Ir(e,Vl()?Reflect.construct(t,n||[],Ee(e).constructor):t.apply(e,n));var e,t,n}return jr(r,Ra(Error)),fe(r)})(),Ar=2e4,Bo=(function(){return fe((function e(t,n,i){he(this,e),this._loadAttemptImpl=J()||!t.avoidEval?new lp(t,n,i):new dp(t,n,i)}),[{key:"start",value:(r=D((function*(){return this._loadAttemptImpl.start()})),function(){return r.apply(this,arguments)})},{key:"cancel",value:function(){this._loadAttemptImpl.cancel()}},{key:"cancelled",get:function(){return this._loadAttemptImpl.cancelled}},{key:"succeeded",get:function(){return this._loadAttemptImpl.succeeded}}]);var r})(),lp=(function(){return fe((function i(a,s,c){he(this,i),this.cancelled=!1,this.succeeded=!1,this._networkTimedOut=!1,this._networkTimeout=null,this._iosCache=typeof iOSCallObjectBundleCache<"u"&&iOSCallObjectBundleCache,this._refetchHeaders=null,this._dailyConfig=a,this._successCallback=s,this._failureCallback=c}),[{key:"start",value:(n=D((function*(){var i=wr(this._dailyConfig);!(yield this._tryLoadFromIOSCache(i))&&this._loadFromNetwork(i)})),function(){return n.apply(this,arguments)})},{key:"cancel",value:function(){clearTimeout(this._networkTimeout),this.cancelled=!0}},{key:"_tryLoadFromIOSCache",value:(t=D((function*(i){if(!this._iosCache)return!1;try{var a=yield this._iosCache.get(i);return!!this.cancelled||!!a&&(a.code?(Function('"use strict";'+a.code)(),this.succeeded=!0,this._successCallback(),!0):(this._refetchHeaders=a.refetchHeaders,!1))}catch{return!1}})),function(i){return t.apply(this,arguments)})},{key:"_loadFromNetwork",value:(e=D((function*(i){var a=this;this._networkTimeout=setTimeout((function(){a._networkTimedOut=!0,a._failureCallback({msg:"Timed out (>".concat(Ar," ms) when loading call object bundle ").concat(i),type:"timeout"})}),Ar);try{var s=this._refetchHeaders?{headers:this._refetchHeaders}:{},c=yield fetch(i,s);if(clearTimeout(this._networkTimeout),this.cancelled||this._networkTimedOut)throw new on;var u=yield this._getBundleCodeFromResponse(i,c);if(this.cancelled)throw new on;Function('"use strict";'+u)(),this._iosCache&&this._iosCache.set(i,u,c.headers),this.succeeded=!0,this._successCallback()}catch(l){if(clearTimeout(this._networkTimeout),l instanceof on||this.cancelled||this._networkTimedOut)return;this._failureCallback({msg:"Failed to load call object bundle ".concat(i,": ").concat(l),type:l.message})}})),function(i){return e.apply(this,arguments)})},{key:"_getBundleCodeFromResponse",value:(r=D((function*(i,a){if(a.ok)return yield a.text();if(this._iosCache&&a.status===304)return(yield this._iosCache.renew(i,a.headers)).code;throw new Error("Received ".concat(a.status," response"))})),function(i,a){return r.apply(this,arguments)})}]);var r,e,t,n})(),dp=(function(){return fe((function r(e,t,n){he(this,r),this.cancelled=!1,this.succeeded=!1,this._dailyConfig=e,this._successCallback=t,this._failureCallback=n,this._attemptId=Rr(),this._networkTimeout=null,this._scriptElement=null}),[{key:"start",value:function(){window._dailyCallMachineLoadWaitlist||(window._dailyCallMachineLoadWaitlist=new Set);var r=wr(this._dailyConfig);(typeof document>"u"?"undefined":z(document))==="object"?this._startLoading(r):this._failureCallback({msg:"Call object bundle must be loaded in a DOM/web context",type:"missing context"})}},{key:"cancel",value:function(){this._stopLoading(),this.cancelled=!0}},{key:"_startLoading",value:function(r){var e=this;this._signUpForCallMachineLoadWaitlist(),this._networkTimeout=setTimeout((function(){e._stopLoading(),e._failureCallback({msg:"Timed out (>".concat(Ar," ms) when loading call object bundle ").concat(r),type:"timeout"})}),Ar);var t=document.getElementsByTagName("head")[0],n=document.createElement("script");this._scriptElement=n,n.onload=function(){e._stopLoading(),e.succeeded=!0,e._successCallback()},n.onerror=function(i){e._stopLoading(),e._failureCallback({msg:"Failed to load call object bundle ".concat(i.target.src),type:i.message})},n.src=r,t.appendChild(n)}},{key:"_stopLoading",value:function(){this._withdrawFromCallMachineLoadWaitlist(),clearTimeout(this._networkTimeout),this._scriptElement&&(this._scriptElement.onload=null,this._scriptElement.onerror=null)}},{key:"_signUpForCallMachineLoadWaitlist",value:function(){window._dailyCallMachineLoadWaitlist.add(this._attemptId)}},{key:"_withdrawFromCallMachineLoadWaitlist",value:function(){window._dailyCallMachineLoadWaitlist.delete(this._attemptId)}}])})(),pr=function(r,e,t){return fp(r.local,e,t)===!0},hp=function(r,e,t){return r.local.streams&&r.local.streams[e]&&r.local.streams[e].stream&&r.local.streams[e].stream["get".concat(t==="video"?"Video":"Audio","Tracks")]()[0]},_t=function(r,e,t,n){var i=pp(r,e,t,n);return i&&i.pendingTrack},fp=function(r,e,t){if(!r)return!1;var n=function(a){switch(a){case"avatar":return!0;case"staged":return a;default:return!!a}},i=r.public.subscribedTracks;return i&&i[e]?["cam-audio","cam-video","screen-video","screen-audio","rmpAudio","rmpVideo"].indexOf(t)===-1&&i[e].custom?[!0,"staged"].includes(i[e].custom)?n(i[e].custom):n(i[e].custom[t]):n(i[e][t]):!i||n(i.ALL)},pp=function(r,e,t,n){var i=Object.values(r.streams||{}).filter((function(a){return a.participantId===e&&a.type===t&&a.pendingTrack&&a.pendingTrack.kind===n})).sort((function(a,s){return new Date(s.starttime)-new Date(a.starttime)}));return i&&i[0]},vp=function(r,e){var t=r.local.public.customTracks;if(t&&t[e])return t[e].track};function Uo(r,e){for(var t=e.getState(),n=0,i=["cam","screen"];n<i.length;n++)for(var a=i[n],s=0,c=["video","audio"];s<c.length;s++){var u=c[s],l=a==="cam"?u:"screen".concat(u.charAt(0).toUpperCase()+u.slice(1)),f=r.tracks[l];if(f){var v=r.local?hp(t,a,u):_t(t,r.session_id,a,u);f.state==="playable"&&(f.track=v),f.persistentTrack=v}}}function Vo(r,e){try{var t=e.getState();for(var n in r.tracks)if(!gp(n)){var i=r.tracks[n].kind;if(i){var a=r.tracks[n];if(a){var s=r.local?vp(t,n):_t(t,r.session_id,n,i);a.state==="playable"&&(r.tracks[n].track=s),a.persistentTrack=s}}else console.error("unknown type for custom track")}}catch(c){console.error(c)}}function gp(r){return["video","audio","screenVideo","screenAudio"].includes(r)}function Jo(r,e,t){var n=t.getState();if(r.local){if(r.audio)try{r.audioTrack=n.local.streams.cam.stream.getAudioTracks()[0],r.audioTrack||(r.audio=!1)}catch{}if(r.video)try{r.videoTrack=n.local.streams.cam.stream.getVideoTracks()[0],r.videoTrack||(r.video=!1)}catch{}if(r.screen)try{r.screenVideoTrack=n.local.streams.screen.stream.getVideoTracks()[0],r.screenAudioTrack=n.local.streams.screen.stream.getAudioTracks()[0],r.screenVideoTrack||r.screenAudioTrack||(r.screen=!1)}catch{}}else{var i=!0;try{var a=n.participants[r.session_id];a&&a.public&&a.public.rtcType&&a.public.rtcType.impl==="peer-to-peer"&&a.private&&!["connected","completed"].includes(a.private.peeringState)&&(i=!1)}catch(f){console.error(f)}if(!i)return r.audio=!1,r.audioTrack=!1,r.video=!1,r.videoTrack=!1,r.screen=!1,void(r.screenTrack=!1);try{if(n.streams,r.audio&&pr(n,r.session_id,"cam-audio")){var s=_t(n,r.session_id,"cam","audio");s&&(e&&e.audioTrack&&e.audioTrack.id===s.id?r.audioTrack=s:s.muted||(r.audioTrack=s)),r.audioTrack||(r.audio=!1)}if(r.video&&pr(n,r.session_id,"cam-video")){var c=_t(n,r.session_id,"cam","video");c&&(e&&e.videoTrack&&e.videoTrack.id===c.id?r.videoTrack=c:c.muted||(r.videoTrack=c)),r.videoTrack||(r.video=!1)}if(r.screen&&pr(n,r.session_id,"screen-audio")){var u=_t(n,r.session_id,"screen","audio");u&&(e&&e.screenAudioTrack&&e.screenAudioTrack.id===u.id?r.screenAudioTrack=u:u.muted||(r.screenAudioTrack=u))}if(r.screen&&pr(n,r.session_id,"screen-video")){var l=_t(n,r.session_id,"screen","video");l&&(e&&e.screenVideoTrack&&e.screenVideoTrack.id===l.id?r.screenVideoTrack=l:l.muted||(r.screenVideoTrack=l))}r.screenVideoTrack||r.screenAudioTrack||(r.screen=!1)}catch(f){console.error("unexpected error matching up tracks",f)}}}function mp(r,e){var t=typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(!t){if(Array.isArray(r)||(t=(function(u,l){if(u){if(typeof u=="string")return zo(u,l);var f={}.toString.call(u).slice(8,-1);return f==="Object"&&u.constructor&&(f=u.constructor.name),f==="Map"||f==="Set"?Array.from(u):f==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(f)?zo(u,l):void 0}})(r))||e){t&&(r=t);var n=0,i=function(){};return{s:i,n:function(){return n>=r.length?{done:!0}:{done:!1,value:r[n++]}},e:function(u){throw u},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a,s=!0,c=!1;return{s:function(){t=t.call(r)},n:function(){var u=t.next();return s=u.done,u},e:function(u){c=!0,a=u},f:function(){try{s||t.return==null||t.return()}finally{if(c)throw a}}}}function zo(r,e){(e==null||e>r.length)&&(e=r.length);for(var t=0,n=Array(e);t<e;t++)n[t]=r[t];return n}var Oe=new Map,St=null;function yp(r,e){var t=typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(!t){if(Array.isArray(r)||(t=(function(u,l){if(u){if(typeof u=="string")return Wo(u,l);var f={}.toString.call(u).slice(8,-1);return f==="Object"&&u.constructor&&(f=u.constructor.name),f==="Map"||f==="Set"?Array.from(u):f==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(f)?Wo(u,l):void 0}})(r))||e){t&&(r=t);var n=0,i=function(){};return{s:i,n:function(){return n>=r.length?{done:!0}:{done:!1,value:r[n++]}},e:function(u){throw u},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a,s=!0,c=!1;return{s:function(){t=t.call(r)},n:function(){var u=t.next();return s=u.done,u},e:function(u){c=!0,a=u},f:function(){try{s||t.return==null||t.return()}finally{if(c)throw a}}}}function Wo(r,e){(e==null||e>r.length)&&(e=r.length);for(var t=0,n=Array(e);t<e;t++)n[t]=r[t];return n}var Pe=new Map,Ft=null;function bp(r){Jl()?(function(e){Oe.has(e)||(Oe.set(e,{}),navigator.mediaDevices.enumerateDevices().then((function(t){Oe.has(e)&&(Oe.get(e).lastDevicesString=JSON.stringify(t),St||(St=(function(){var n=D((function*(){var i,a=yield navigator.mediaDevices.enumerateDevices(),s=mp(Oe.keys());try{for(s.s();!(i=s.n()).done;){var c=i.value,u=JSON.stringify(a);u!==Oe.get(c).lastDevicesString&&(Oe.get(c).lastDevicesString=u,c(a))}}catch(l){s.e(l)}finally{s.f()}}));return function(){return n.apply(this,arguments)}})(),navigator.mediaDevices.addEventListener("devicechange",St)))})).catch((function(){})))})(r):(function(e){Pe.has(e)||(Pe.set(e,{}),navigator.mediaDevices.enumerateDevices().then((function(t){Pe.has(e)&&(Pe.get(e).lastDevicesString=JSON.stringify(t),Ft||(Ft=setInterval(D((function*(){var n,i=yield navigator.mediaDevices.enumerateDevices(),a=yp(Pe.keys());try{for(a.s();!(n=a.n()).done;){var s=n.value,c=JSON.stringify(i);c!==Pe.get(s).lastDevicesString&&(Pe.get(s).lastDevicesString=c,s(i))}}catch(u){a.e(u)}finally{a.f()}})),3e3)))})))})(r)}function _p(r){Jl()?(function(e){Oe.has(e)&&(Oe.delete(e),Oe.size===0&&St&&(navigator.mediaDevices.removeEventListener("devicechange",St),St=null))})(r):(function(e){Pe.has(e)&&(Pe.delete(e),Pe.size===0&&Ft&&(clearInterval(Ft),Ft=null))})(r)}function Jl(){var r;return J()||((r=navigator.mediaDevices)===null||r===void 0?void 0:r.ondevicechange)!==void 0}var wp=new Set;function Sp(r,e){return r&&r.readyState==="live"&&!(function(t,n){return t.muted&&!wp.has(t.id)})(r)}function Go(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);e&&(n=n.filter((function(i){return Object.getOwnPropertyDescriptor(r,i).enumerable}))),t.push.apply(t,n)}return t}function Ue(r){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Go(Object(t),!0).forEach((function(n){Ie(r,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):Go(Object(t)).forEach((function(n){Object.defineProperty(r,n,Object.getOwnPropertyDescriptor(t,n))}))}return r}var Lt=Object.freeze({VIDEO:"video",AUDIO:"audio",SCREEN_VIDEO:"screenVideo",SCREEN_AUDIO:"screenAudio",CUSTOM_VIDEO:"customVideo",CUSTOM_AUDIO:"customAudio"}),kp=Object.freeze({PARTICIPANTS:"participants",STREAMING:"streaming",TRANSCRIPTION:"transcription"}),$t=Object.values(Lt),Ho=["v","a","sv","sa","cv","ca"];Object.freeze($t.reduce((function(r,e,t){return r[e]=Ho[t],r}),{})),Object.freeze(Ho.reduce((function(r,e,t){return r[e]=$t[t],r}),{}));var Cp=[Lt.VIDEO,Lt.AUDIO,Lt.SCREEN_VIDEO,Lt.SCREEN_AUDIO],Ko=Object.values(kp),Qo=["p","s","t"];Object.freeze(Ko.reduce((function(r,e,t){return r[e]=Qo[t],r}),{})),Object.freeze(Qo.reduce((function(r,e,t){return r[e]=Ko[t],r}),{}));var zl=(function(){function r(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.base,n=e.byUserId,i=e.byParticipantId;he(this,r),this.base=t,this.byUserId=n,this.byParticipantId=i}return fe(r,[{key:"clone",value:function(){var e=new r;if(this.base instanceof re?e.base=this.base.clone():e.base=this.base,this.byUserId!==void 0)for(var t in e.byUserId={},this.byUserId){var n=this.byUserId[t];e.byUserId[t]=n instanceof re?n.clone():n}if(this.byParticipantId!==void 0)for(var i in e.byParticipantId={},this.byParticipantId){var a=this.byParticipantId[i];e.byParticipantId[i]=a instanceof re?a.clone():a}return e}},{key:"toJSONObject",value:function(){var e={};if(typeof this.base=="boolean"?e.base=this.base:this.base instanceof re&&(e.base=this.base.toJSONObject()),this.byUserId!==void 0)for(var t in e.byUserId={},this.byUserId){var n=this.byUserId[t];e.byUserId[t]=n instanceof re?n.toJSONObject():n}if(this.byParticipantId!==void 0)for(var i in e.byParticipantId={},this.byParticipantId){var a=this.byParticipantId[i];e.byParticipantId[i]=a instanceof re?a.toJSONObject():a}return e}},{key:"toMinifiedJSONObject",value:function(){var e={};if(this.base!==void 0&&(typeof this.base=="boolean"?e.b=this.base:e.b=this.base.toMinifiedJSONObject()),this.byUserId!==void 0)for(var t in e.u={},this.byUserId){var n=this.byUserId[t];e.u[t]=typeof n=="boolean"?n:n.toMinifiedJSONObject()}if(this.byParticipantId!==void 0)for(var i in e.p={},this.byParticipantId){var a=this.byParticipantId[i];e.p[i]=typeof a=="boolean"?a:a.toMinifiedJSONObject()}return e}},{key:"normalize",value:function(){return this.base instanceof re&&(this.base=this.base.normalize()),this.byUserId&&(this.byUserId=Object.fromEntries(Object.entries(this.byUserId).map((function(e){var t=ie(e,2),n=t[0],i=t[1];return[n,i instanceof re?i.normalize():i]})))),this.byParticipantId&&(this.byParticipantId=Object.fromEntries(Object.entries(this.byParticipantId).map((function(e){var t=ie(e,2),n=t[0],i=t[1];return[n,i instanceof re?i.normalize():i]})))),this}}],[{key:"fromJSONObject",value:function(e){var t,n,i;if(e.base!==void 0&&(t=typeof e.base=="boolean"?e.base:re.fromJSONObject(e.base)),e.byUserId!==void 0)for(var a in n={},e.byUserId){var s=e.byUserId[a];n[a]=typeof s=="boolean"?s:re.fromJSONObject(s)}if(e.byParticipantId!==void 0)for(var c in i={},e.byParticipantId){var u=e.byParticipantId[c];i[c]=typeof u=="boolean"?u:re.fromJSONObject(u)}return new r({base:t,byUserId:n,byParticipantId:i})}},{key:"fromMinifiedJSONObject",value:function(e){var t,n,i;if(e.b!==void 0&&(t=typeof e.b=="boolean"?e.b:re.fromMinifiedJSONObject(e.b)),e.u!==void 0)for(var a in n={},e.u){var s=e.u[a];n[a]=typeof s=="boolean"?s:re.fromMinifiedJSONObject(s)}if(e.p!==void 0)for(var c in i={},e.p){var u=e.p[c];i[c]=typeof u=="boolean"?u:re.fromMinifiedJSONObject(u)}return new r({base:t,byUserId:n,byParticipantId:i})}},{key:"validateJSONObject",value:function(e){if(z(e)!=="object")return[!1,"canReceive must be an object"];for(var t=["base","byUserId","byParticipantId"],n=0,i=Object.keys(e);n<i.length;n++){var a=i[n];if(!t.includes(a))return[!1,"canReceive can only contain keys (".concat(t.join(", "),")")];if(a==="base"){var s=ie(re.validateJSONObject(e.base,!0),2),c=s[0],u=s[1];if(!c)return[!1,u]}else{if(z(e[a])!=="object")return[!1,"invalid (non-object) value for field '".concat(a,"' in canReceive")];for(var l=0,f=Object.values(e[a]);l<f.length;l++){var v=f[l],b=ie(re.validateJSONObject(v),2),k=b[0],y=b[1];if(!k)return[!1,y]}}}return[!0]}}])})(),re=(function(){function r(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.video,n=e.audio,i=e.screenVideo,a=e.screenAudio,s=e.customVideo,c=e.customAudio;he(this,r),this.video=t,this.audio=n,this.screenVideo=i,this.screenAudio=a,this.customVideo=s,this.customAudio=c}return fe(r,[{key:"clone",value:function(){var e=new r;return this.video!==void 0&&(e.video=this.video),this.audio!==void 0&&(e.audio=this.audio),this.screenVideo!==void 0&&(e.screenVideo=this.screenVideo),this.screenAudio!==void 0&&(e.screenAudio=this.screenAudio),this.customVideo!==void 0&&(e.customVideo=Ue({},this.customVideo)),this.customAudio!==void 0&&(e.customAudio=Ue({},this.customAudio)),e}},{key:"toJSONObject",value:function(){var e={};return this.video!==void 0&&(e.video=this.video),this.audio!==void 0&&(e.audio=this.audio),this.screenVideo!==void 0&&(e.screenVideo=this.screenVideo),this.screenAudio!==void 0&&(e.screenAudio=this.screenAudio),this.customVideo!==void 0&&(e.customVideo=Ue({},this.customVideo)),this.customAudio!==void 0&&(e.customAudio=Ue({},this.customAudio)),e}},{key:"toMinifiedJSONObject",value:function(){var e={};return this.video!==void 0&&(e.v=this.video),this.audio!==void 0&&(e.a=this.audio),this.screenVideo!==void 0&&(e.sv=this.screenVideo),this.screenAudio!==void 0&&(e.sa=this.screenAudio),this.customVideo!==void 0&&(e.cv=Ue({},this.customVideo)),this.customAudio!==void 0&&(e.ca=Ue({},this.customAudio)),e}},{key:"normalize",value:function(){function e(t,n){return t&&Object.keys(t).length===1&&t["*"]===n}return!(this.video!==!0||this.audio!==!0||this.screenVideo!==!0||this.screenAudio!==!0||!e(this.customVideo,!0)||!e(this.customAudio,!0))||(this.video!==!1||this.audio!==!1||this.screenVideo!==!1||this.screenAudio!==!1||!e(this.customVideo,!1)||!e(this.customAudio,!1))&&this}}],[{key:"fromBoolean",value:function(e){return new r({video:e,audio:e,screenVideo:e,screenAudio:e,customVideo:{"*":e},customAudio:{"*":e}})}},{key:"fromJSONObject",value:function(e){return new r({video:e.video,audio:e.audio,screenVideo:e.screenVideo,screenAudio:e.screenAudio,customVideo:e.customVideo!==void 0?Ue({},e.customVideo):void 0,customAudio:e.customAudio!==void 0?Ue({},e.customAudio):void 0})}},{key:"fromMinifiedJSONObject",value:function(e){return new r({video:e.v,audio:e.a,screenVideo:e.sv,screenAudio:e.sa,customVideo:e.cv,customAudio:e.ca})}},{key:"validateJSONObject",value:function(e,t){if(typeof e=="boolean")return[!0];if(z(e)!=="object")return[!1,"invalid (non-object, non-boolean) value in canReceive"];for(var n=Object.keys(e),i=0,a=n;i<a.length;i++){var s=a[i];if(!$t.includes(s))return[!1,"invalid media type '".concat(s,"' in canReceive")];if(Cp.includes(s)){if(typeof e[s]!="boolean")return[!1,"invalid (non-boolean) value for media type '".concat(s,"' in canReceive")]}else{if(z(e[s])!=="object")return[!1,"invalid (non-object) value for media type '".concat(s,"' in canReceive")];for(var c=0,u=Object.values(e[s]);c<u.length;c++)if(typeof u[c]!="boolean")return[!1,"invalid (non-boolean) value for entry within '".concat(s,"' in canReceive")];if(t&&e[s]["*"]===void 0)return[!1,`canReceive "base" permission must specify "*" as an entry within '`.concat(s,"'")]}}return t&&n.length!==$t.length?[!1,'canReceive "base" permission must specify all media types: '.concat($t.join(", ")," (or be set to a boolean shorthand)")]:[!0]}}])})(),Mp=["result"],Tp=["preserveIframe"];function Yo(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);e&&(n=n.filter((function(i){return Object.getOwnPropertyDescriptor(r,i).enumerable}))),t.push.apply(t,n)}return t}function j(r){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Yo(Object(t),!0).forEach((function(n){Ie(r,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):Yo(Object(t)).forEach((function(n){Object.defineProperty(r,n,Object.getOwnPropertyDescriptor(t,n))}))}return r}function Wl(){try{var r=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch{}return(Wl=function(){return!!r})()}function Xo(r,e){var t=typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(!t){if(Array.isArray(r)||(t=(function(u,l){if(u){if(typeof u=="string")return Zo(u,l);var f={}.toString.call(u).slice(8,-1);return f==="Object"&&u.constructor&&(f=u.constructor.name),f==="Map"||f==="Set"?Array.from(u):f==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(f)?Zo(u,l):void 0}})(r))||e){t&&(r=t);var n=0,i=function(){};return{s:i,n:function(){return n>=r.length?{done:!0}:{done:!1,value:r[n++]}},e:function(u){throw u},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a,s=!0,c=!1;return{s:function(){t=t.call(r)},n:function(){var u=t.next();return s=u.done,u},e:function(u){c=!0,a=u},f:function(){try{s||t.return==null||t.return()}finally{if(c)throw a}}}}function Zo(r,e){(e==null||e>r.length)&&(e=r.length);for(var t=0,n=Array(e);t<e;t++)n[t]=r[t];return n}var et={},ec="video",Ep="voice",tc=J()?{data:{}}:{data:{},topology:"none"},rc={present:0,hidden:0},Gl={maxBitrate:{min:1e5,max:25e5},maxFramerate:{min:1,max:30},scaleResolutionDownBy:{min:1,max:8}},cn=Object.keys(Gl),nc=["state","volume","simulcastEncodings"],ic={androidInCallNotification:{title:"string",subtitle:"string",iconName:"string",disableForCustomOverride:"boolean"},disableAutoDeviceManagement:{audio:"boolean",video:"boolean"}},Or={id:{iconPath:"string",iconPathDarkMode:"string",label:"string",tooltip:"string",visualState:"'default' | 'sidebar-open' | 'active'"}},xa={id:{allow:"string",controlledBy:"'*' | 'owners' | string[]",csp:"string",iconURL:"string",label:"string",loading:"'eager' | 'lazy'",location:"'main' | 'sidebar'",name:"string",referrerPolicy:"string",sandbox:"string",src:"string",srcdoc:"string",shared:"string[] | 'owners' | boolean"}},tt={customIntegrations:{validate:td,help:Zl()},customTrayButtons:{validate:ed,help:"customTrayButtons should be a dictionary of the type ".concat(JSON.stringify(Or))},url:{validate:function(r){return typeof r=="string"},help:"url should be a string"},baseUrl:{validate:function(r){return typeof r=="string"},help:"baseUrl should be a string"},token:{validate:function(r){return typeof r=="string"},help:"token should be a string",queryString:"t"},dailyConfig:{validate:function(r,e){try{return e.validateDailyConfig(r),!0}catch(t){console.error("Failed to validate dailyConfig",t)}return!1},help:"Unsupported dailyConfig. Check error logs for detailed info."},reactNativeConfig:{validate:function(r){return rd(r,ic)},help:"reactNativeConfig should look like ".concat(JSON.stringify(ic),", all fields optional")},lang:{validate:function(r){return["da","de","en-us","en","es","fi","fr","it","jp","ka","nl","no","pl","pt","pt-BR","ru","sv","tr","user"].includes(r)},help:"language not supported. Options are: da, de, en-us, en, es, fi, fr, it, jp, ka, nl, no, pl, pt, pt-BR, ru, sv, tr, user"},userName:!0,userData:{validate:function(r){try{return Hl(r),!0}catch(e){return console.error(e),!1}},help:"invalid userData type provided"},startVideoOff:!0,startAudioOff:!0,allowLocalVideo:!0,allowLocalAudio:!0,activeSpeakerMode:!0,showLeaveButton:!0,showLocalVideo:!0,showParticipantsBar:!0,showFullscreenButton:!0,showUserNameChangeUI:!0,iframeStyle:!0,customLayout:!0,cssFile:!0,cssText:!0,bodyClass:!0,videoSource:{validate:function(r,e){if(typeof r=="boolean")return e._preloadCache.allowLocalVideo=r,!0;var t;if(r instanceof MediaStreamTrack)e._sharedTracks.videoTrack=r,t={customTrack:Ne};else{if(delete e._sharedTracks.videoTrack,typeof r!="string")return console.error("videoSource must be a MediaStreamTrack, boolean, or a string"),!1;t={deviceId:r}}return e._updatePreloadCacheInputSettings({video:{settings:t}},!1),!0}},audioSource:{validate:function(r,e){if(typeof r=="boolean")return e._preloadCache.allowLocalAudio=r,!0;var t;if(r instanceof MediaStreamTrack)e._sharedTracks.audioTrack=r,t={customTrack:Ne};else{if(delete e._sharedTracks.audioTrack,typeof r!="string")return console.error("audioSource must be a MediaStreamTrack, boolean, or a string"),!1;t={deviceId:r}}return e._updatePreloadCacheInputSettings({audio:{settings:t}},!1),!0}},subscribeToTracksAutomatically:{validate:function(r,e){return e._preloadCache.subscribeToTracksAutomatically=r,!0}},theme:{validate:function(r){var e=["accent","accentText","background","backgroundAccent","baseText","border","mainAreaBg","mainAreaBgAccent","mainAreaText","supportiveText"],t=function(n){for(var i=0,a=Object.keys(n);i<a.length;i++){var s=a[i];if(!e.includes(s))return console.error('unsupported color "'.concat(s,'". Valid colors: ').concat(e.join(", "))),!1;if(!n[s].match(/^#[0-9a-f]{6}|#[0-9a-f]{3}$/i))return console.error("".concat(s,' theme color should be provided in valid hex color format. Received: "').concat(n[s],'"')),!1}return!0};return z(r)==="object"&&("light"in r&&"dark"in r||"colors"in r)?"light"in r&&"dark"in r?"colors"in r.light?"colors"in r.dark?t(r.light.colors)&&t(r.dark.colors):(console.error('Dark theme is missing "colors" property.',r),!1):(console.error('Light theme is missing "colors" property.',r),!1):t(r.colors):(console.error('Theme must contain either both "light" and "dark" properties, or "colors".',r),!1)},help:"unsupported theme configuration. Check error logs for detailed info."},layoutConfig:{validate:function(r){if("grid"in r){var e=r.grid;if("maxTilesPerPage"in e){if(!Number.isInteger(e.maxTilesPerPage))return console.error("grid.maxTilesPerPage should be an integer. You passed ".concat(e.maxTilesPerPage,".")),!1;if(e.maxTilesPerPage>49)return console.error("grid.maxTilesPerPage can't be larger than 49 without sacrificing browser performance. Please contact us at https://www.daily.co/contact to talk about your use case."),!1}if("minTilesPerPage"in e){if(!Number.isInteger(e.minTilesPerPage))return console.error("grid.minTilesPerPage should be an integer. You passed ".concat(e.minTilesPerPage,".")),!1;if(e.minTilesPerPage<1)return console.error("grid.minTilesPerPage can't be lower than 1."),!1;if("maxTilesPerPage"in e&&e.minTilesPerPage>e.maxTilesPerPage)return console.error("grid.minTilesPerPage can't be higher than grid.maxTilesPerPage."),!1}}return!0},help:"unsupported layoutConfig. Check error logs for detailed info."},receiveSettings:{validate:function(r){return Kl(r,{allowAllParticipantsKey:!1})},help:Xl({allowAllParticipantsKey:!1})},sendSettings:{validate:function(r,e){return!!(function(t,n){try{return n.validateUpdateSendSettings(t),!0}catch(i){return console.error("Failed to validate send settings",i),!1}})(r,e)&&(e._preloadCache.sendSettings=r,!0)},help:"Invalid sendSettings provided. Check error logs for detailed info."},inputSettings:{validate:function(r,e){var t;return!!Ql(r)&&(e._inputSettings||(e._inputSettings={}),Yl(r,(t=e.properties)===null||t===void 0?void 0:t.dailyConfig,e._sharedTracks),e._updatePreloadCacheInputSettings(r,!0),!0)},help:La()},layout:{validate:function(r){return r==="custom-v1"||r==="browser"||r==="none"},help:'layout may only be set to "custom-v1"',queryString:"layout"},emb:{queryString:"emb"},embHref:{queryString:"embHref"},dailyJsVersion:{queryString:"dailyJsVersion"},proxy:{queryString:"proxy"},strictMode:!0,allowMultipleCallInstances:!0},vr={styles:{validate:function(r){for(var e in r)if(e!=="cam"&&e!=="screen")return!1;if(r.cam){for(var t in r.cam)if(t!=="div"&&t!=="video")return!1}if(r.screen){for(var n in r.screen)if(n!=="div"&&n!=="video")return!1}return!0},help:"styles format should be a subset of: { cam: {div: {}, video: {}}, screen: {div: {}, video: {}} }"},setSubscribedTracks:{validate:function(r,e){if(e._preloadCache.subscribeToTracksAutomatically)return!1;var t=[!0,!1,"staged"];if(t.includes(r)||!J()&&r==="avatar")return!0;var n=["audio","video","screenAudio","screenVideo","rmpAudio","rmpVideo"],i=function(a){var s=arguments.length>1&&arguments[1]!==void 0&&arguments[1];for(var c in a)if(c==="custom"){if(!t.includes(a[c])&&!i(a[c],!0))return!1}else{var u=!s&&!n.includes(c),l=!t.includes(a[c]);if(u||l)return!1}return!0};return i(r)},help:"setSubscribedTracks cannot be used when setSubscribeToTracksAutomatically is enabled, and should be of the form: "+"true".concat(J()?"":" | 'avatar'"," | false | 'staged' | { [audio: true|false|'staged'], [video: true|false|'staged'], [screenAudio: true|false|'staged'], [screenVideo: true|false|'staged'] }")},setAudio:!0,setVideo:!0,setScreenShare:{validate:function(r){return r===!1},help:"setScreenShare must be false, as it's only meant for stopping remote participants' screen shares"},eject:!0,updatePermissions:{validate:function(r){for(var e=0,t=Object.entries(r);e<t.length;e++){var n=ie(t[e],2),i=n[0],a=n[1];switch(i){case"hasPresence":if(typeof a!="boolean")return!1;break;case"canSend":if(a instanceof Set||a instanceof Array||Array.isArray(a)){var s,c=["video","audio","screenVideo","screenAudio","customVideo","customAudio"],u=Xo(a);try{for(u.s();!(s=u.n()).done;){var l=s.value;if(!c.includes(l))return!1}}catch(S){u.e(S)}finally{u.f()}}else if(typeof a!="boolean")return!1;(a instanceof Array||Array.isArray(a))&&(r.canSend=new Set(a));break;case"canReceive":var f=ie(zl.validateJSONObject(a),2),v=f[0],b=f[1];if(!v)return console.error(b),!1;break;case"canAdmin":if(a instanceof Set||a instanceof Array||Array.isArray(a)){var k,y=["participants","streaming","transcription"],m=Xo(a);try{for(m.s();!(k=m.n()).done;){var _=k.value;if(!y.includes(_))return!1}}catch(S){m.e(S)}finally{m.f()}}else if(typeof a!="boolean")return!1;(a instanceof Array||Array.isArray(a))&&(r.canAdmin=new Set(a));break;default:return!1}}return!0},help:"updatePermissions can take hasPresence, canSend, canReceive, and canAdmin permissions. hasPresence must be a boolean. canSend can be a boolean or an Array or Set of media types (video, audio, screenVideo, screenAudio, customVideo, customAudio). canReceive must be an object specifying base, byUserId, and/or byParticipantId fields (see documentation for more details). canAdmin can be a boolean or an Array or Set of admin types (participants, streaming, transcription)."}};Promise.any||(Promise.any=(function(){var r=D((function*(e){return new Promise((function(t,n){var i=[];e.forEach((function(a){return Promise.resolve(a).then((function(s){t(s)})).catch((function(s){i.push(s),i.length===e.length&&n(i)}))}))}))}));return function(e){return r.apply(this,arguments)}})());var ac=(function(){function r(o){var h,d,p,g,w,T,E=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(he(this,r),p=this,g=Ee(g=r),Ie(d=Ir(p,Wl()?Reflect.construct(g,[],Ee(p).constructor):g.apply(p,w)),"startListeningForDeviceChanges",(function(){bp(d.handleDeviceChange)})),Ie(d,"stopListeningForDeviceChanges",(function(){_p(d.handleDeviceChange)})),Ie(d,"handleDeviceChange",(function(q){q=q.map((function($){return JSON.parse(JSON.stringify($))})),d.emitDailyJSEvent({action:"available-devices-updated",availableDevices:q})})),Ie(d,"handleNativeAppStateChange",(function(){var q=D((function*($){if($==="destroyed")return console.warn("App has been destroyed before leaving the meeting. Cleaning up all the resources!"),void(yield d.destroy());var ve=$==="active";d.disableReactNativeAutoDeviceManagement("video")||(ve?d.camUnmutedBeforeLosingNativeActiveState&&d.setLocalVideo(!0):(d.camUnmutedBeforeLosingNativeActiveState=d.localVideo(),d.camUnmutedBeforeLosingNativeActiveState&&d.setLocalVideo(!1)))}));return function($){return q.apply(this,arguments)}})()),Ie(d,"handleNativeAudioFocusChange",(function(q){d.disableReactNativeAutoDeviceManagement("audio")||(d._hasNativeAudioFocus=q,d.toggleParticipantAudioBasedOnNativeAudioFocus(),d._hasNativeAudioFocus?d.micUnmutedBeforeLosingNativeAudioFocus&&d.setLocalAudio(!0):(d.micUnmutedBeforeLosingNativeAudioFocus=d.localAudio(),d.setLocalAudio(!1)))})),Ie(d,"handleNativeSystemScreenCaptureStop",(function(){d.stopScreenShare()})),d.strictMode=E.strictMode===void 0||E.strictMode,d.allowMultipleCallInstances=(h=E.allowMultipleCallInstances)!==null&&h!==void 0&&h,Object.keys(et).length&&(d._logDuplicateInstanceAttempt(),!d.allowMultipleCallInstances)){if(d.strictMode)throw new Error("Duplicate DailyIframe instances are not allowed");console.warn("Using strictMode: false to allow multiple call instances is now deprecated. Set `allowMultipleCallInstances: true`")}if(window._daily||(window._daily={pendings:[],instances:{}}),d.callClientId=Rr(),et[(T=d).callClientId]=T,window._daily.instances[d.callClientId]={},d._sharedTracks={},window._daily.instances[d.callClientId].tracks=d._sharedTracks,E.dailyJsVersion=r.version(),d._iframe=o,d._callObjectMode=E.layout==="none"&&!d._iframe,d._preloadCache={subscribeToTracksAutomatically:!0,outputDeviceId:null,inputSettings:null,sendSettings:null,videoTrackForNetworkConnectivityTest:null,videoTrackForConnectionQualityTest:null},E.showLocalVideo!==void 0?d._callObjectMode?console.error("showLocalVideo is not available in call object mode"):d._showLocalVideo=!!E.showLocalVideo:d._showLocalVideo=!0,E.showParticipantsBar!==void 0?d._callObjectMode?console.error("showParticipantsBar is not available in call object mode"):d._showParticipantsBar=!!E.showParticipantsBar:d._showParticipantsBar=!0,E.customIntegrations!==void 0?d._callObjectMode?console.error("customIntegrations is not available in call object mode"):d._customIntegrations=E.customIntegrations:d._customIntegrations={},E.customTrayButtons!==void 0?d._callObjectMode?console.error("customTrayButtons is not available in call object mode"):d._customTrayButtons=E.customTrayButtons:d._customTrayButtons={},E.activeSpeakerMode!==void 0?d._callObjectMode?console.error("activeSpeakerMode is not available in call object mode"):d._activeSpeakerMode=!!E.activeSpeakerMode:d._activeSpeakerMode=!1,E.receiveSettings?d._callObjectMode?d._receiveSettings=E.receiveSettings:console.error("receiveSettings is only available in call object mode"):d._receiveSettings={},d.validateProperties(E),d.properties=j({},E),d._inputSettings||(d._inputSettings={}),d._callObjectLoader=d._callObjectMode?new cp(d.callClientId):null,d._callState=_o,d._isPreparingToJoin=!1,d._accessState={access:tn},d._meetingSessionSummary={},d._finalSummaryOfPrevSession={},d._meetingSessionState=dn(tc,d._callObjectMode),d._nativeInCallAudioMode=ec,d._participants={},d._isScreenSharing=!1,d._participantCounts=rc,d._rmpPlayerState={},d._waitingParticipants={},d._network={threshold:"good",quality:100,networkState:"unknown",stats:{}},d._activeSpeaker={},d._localAudioLevel=0,d._isLocalAudioLevelObserverRunning=!1,d._remoteParticipantsAudioLevel={},d._isRemoteParticipantsAudioLevelObserverRunning=!1,d._maxAppMessageSize=rn,d._messageChannel=J()?new sp:new ap,d._iframe&&(d._iframe.requestFullscreen?d._iframe.addEventListener("fullscreenchange",(function(){document.fullscreenElement===d._iframe?(d.emitDailyJSEvent({action:dr}),d.sendMessageToCallMachine({action:dr})):(d.emitDailyJSEvent({action:hr}),d.sendMessageToCallMachine({action:hr}))})):d._iframe.webkitRequestFullscreen&&d._iframe.addEventListener("webkitfullscreenchange",(function(){document.webkitFullscreenElement===d._iframe?(d.emitDailyJSEvent({action:dr}),d.sendMessageToCallMachine({action:dr})):(d.emitDailyJSEvent({action:hr}),d.sendMessageToCallMachine({action:hr}))}))),J()){var I=d.nativeUtils();I.addAudioFocusChangeListener&&I.removeAudioFocusChangeListener&&I.addAppStateChangeListener&&I.removeAppStateChangeListener&&I.addSystemScreenCaptureStopListener&&I.removeSystemScreenCaptureStopListener||console.warn("expected (add|remove)(AudioFocusChange|AppActiveStateChange|SystemScreenCaptureStop)Listener to be available in React Native"),d._hasNativeAudioFocus=!0,I.addAudioFocusChangeListener(d.handleNativeAudioFocusChange),I.addAppStateChangeListener(d.handleNativeAppStateChange),I.addSystemScreenCaptureStopListener(d.handleNativeSystemScreenCaptureStop)}return d._callObjectMode&&d.startListeningForDeviceChanges(),d._messageChannel.addListenerForMessagesFromCallMachine(d.handleMessageFromCallMachine,d.callClientId,d),d}return jr(r,nr),fe(r,[{key:"destroy",value:(er=D((function*(){var o;try{yield this.leave()}catch{}var h=this._iframe;if(h){var d=h.parentElement;d&&d.removeChild(h)}if(this._messageChannel.removeListener(this.handleMessageFromCallMachine),J()){var p=this.nativeUtils();p.removeAudioFocusChangeListener(this.handleNativeAudioFocusChange),p.removeAppStateChangeListener(this.handleNativeAppStateChange),p.removeSystemScreenCaptureStopListener(this.handleNativeSystemScreenCaptureStop)}this._callObjectMode&&this.stopListeningForDeviceChanges(),this.resetMeetingDependentVars(),this._destroyed=!0,this.emitDailyJSEvent({action:"call-instance-destroyed"}),delete et[this.callClientId],!((o=window)===null||o===void 0||(o=o._daily)===null||o===void 0)&&o.instances&&delete window._daily.instances[this.callClientId],this.strictMode&&(this.callClientId=void 0)})),function(){return er.apply(this,arguments)})},{key:"isDestroyed",value:function(){return!!this._destroyed}},{key:"loadCss",value:function(o){var h=o.bodyClass,d=o.cssFile,p=o.cssText;return B(),this.sendMessageToCallMachine({action:"load-css",cssFile:this.absoluteUrl(d),bodyClass:h,cssText:p}),this}},{key:"iframe",value:function(){return B(),this._iframe}},{key:"meetingState",value:function(){return this._callState}},{key:"accessState",value:function(){return we(this._callObjectMode,"accessState()"),this._accessState}},{key:"participants",value:function(){return this._participants}},{key:"participantCounts",value:function(){return this._participantCounts}},{key:"waitingParticipants",value:function(){return we(this._callObjectMode,"waitingParticipants()"),this._waitingParticipants}},{key:"validateParticipantProperties",value:function(o,h){for(var d in h){if(!vr[d])throw new Error("unrecognized updateParticipant property ".concat(d));if(vr[d].validate&&!vr[d].validate(h[d],this,this._participants[o]))throw new Error(vr[d].help)}}},{key:"updateParticipant",value:function(o,h){return this._participants.local&&this._participants.local.session_id===o&&(o="local"),o&&h&&(this.validateParticipantProperties(o,h),this.sendMessageToCallMachine({action:"update-participant",id:o,properties:h})),this}},{key:"updateParticipants",value:function(o){var h=this._participants.local&&this._participants.local.session_id;for(var d in o)d===h&&(d="local"),d&&o[d]&&this.validateParticipantProperties(d,o[d]);return this.sendMessageToCallMachine({action:"update-participants",participants:o}),this}},{key:"updateWaitingParticipant",value:(Zt=D((function*(){var o=this,h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(we(this._callObjectMode,"updateWaitingParticipant()"),H(this._callState,"updateWaitingParticipant()"),typeof h!="string"||z(d)!=="object")throw new Error("updateWaitingParticipant() must take an id string and a updates object");return new Promise((function(p,g){o.sendMessageToCallMachine({action:"daily-method-update-waiting-participant",id:h,updates:d},(function(w){w.error&&g(w.error),w.id||g(new Error("unknown error in updateWaitingParticipant()")),p({id:w.id})}))}))})),function(){return Zt.apply(this,arguments)})},{key:"updateWaitingParticipants",value:(Xt=D((function*(){var o=this,h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(we(this._callObjectMode,"updateWaitingParticipants()"),H(this._callState,"updateWaitingParticipants()"),z(h)!=="object")throw new Error("updateWaitingParticipants() must take a mapping between ids and update objects");return new Promise((function(d,p){o.sendMessageToCallMachine({action:"daily-method-update-waiting-participants",updatesById:h},(function(g){g.error&&p(g.error),g.ids||p(new Error("unknown error in updateWaitingParticipants()")),d({ids:g.ids})}))}))})),function(){return Xt.apply(this,arguments)})},{key:"requestAccess",value:(Yt=D((function*(){var o=this,h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},d=h.access,p=d===void 0?{level:Zh}:d,g=h.name,w=g===void 0?"":g;return we(this._callObjectMode,"requestAccess()"),H(this._callState,"requestAccess()"),new Promise((function(T,E){o.sendMessageToCallMachine({action:"daily-method-request-access",access:p,name:w},(function(I){I.error&&E(I.error),I.access||E(new Error("unknown error in requestAccess()")),T({access:I.access,granted:I.granted})}))}))})),function(){return Yt.apply(this,arguments)})},{key:"localAudio",value:function(){return this._participants.local?!["blocked","off"].includes(this._participants.local.tracks.audio.state):null}},{key:"localVideo",value:function(){return this._participants.local?!["blocked","off"].includes(this._participants.local.tracks.video.state):null}},{key:"setLocalAudio",value:function(o){var h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return"forceDiscardTrack"in h&&(J()?(console.warn("forceDiscardTrack option not supported in React Native; ignoring"),h={}):o&&(console.warn("forceDiscardTrack option only supported when calling setLocalAudio(false); ignoring"),h={})),this.sendMessageToCallMachine({action:"local-audio",state:o,options:h}),this}},{key:"localScreenAudio",value:function(){return this._participants.local?!["blocked","off"].includes(this._participants.local.tracks.screenAudio.state):null}},{key:"localScreenVideo",value:function(){return this._participants.local?!["blocked","off"].includes(this._participants.local.tracks.screenVideo.state):null}},{key:"updateScreenShare",value:function(o){if(this._isScreenSharing)return this.sendMessageToCallMachine({action:"local-screen-update",options:o}),this;console.warn("There is no screen share in progress. Try calling startScreenShare first.")}},{key:"setLocalVideo",value:function(o){return this.sendMessageToCallMachine({action:"local-video",state:o}),this}},{key:"_setAllowLocalAudio",value:function(o){if(this._preloadCache.allowLocalAudio=o,this._callMachineInitialized)return this.sendMessageToCallMachine({action:"set-allow-local-audio",state:o}),this}},{key:"_setAllowLocalVideo",value:function(o){if(this._preloadCache.allowLocalVideo=o,this._callMachineInitialized)return this.sendMessageToCallMachine({action:"set-allow-local-video",state:o}),this}},{key:"getReceiveSettings",value:(It=D((function*(o){var h=this,d=(arguments.length>1&&arguments[1]!==void 0?arguments[1]:{}).showInheritedValues,p=d!==void 0&&d;if(we(this._callObjectMode,"getReceiveSettings()"),!this._callMachineInitialized)return this._receiveSettings;switch(z(o)){case"string":return new Promise((function(g){h.sendMessageToCallMachine({action:"get-single-participant-receive-settings",id:o,showInheritedValues:p},(function(w){g(w.receiveSettings)}))}));case"undefined":return this._receiveSettings;default:throw new Error('first argument to getReceiveSettings() must be a participant id (or "base"), or there should be no arguments')}})),function(o){return It.apply(this,arguments)})},{key:"updateReceiveSettings",value:(Qt=D((function*(o){var h=this;if(we(this._callObjectMode,"updateReceiveSettings()"),!Kl(o,{allowAllParticipantsKey:!0}))throw new Error(Xl({allowAllParticipantsKey:!0}));return H(this._callState,"updateReceiveSettings()","To specify receive settings earlier, use the receiveSettings config property."),new Promise((function(d){h.sendMessageToCallMachine({action:"update-receive-settings",receiveSettings:o},(function(p){d({receiveSettings:p.receiveSettings})}))}))})),function(o){return Qt.apply(this,arguments)})},{key:"_prepInputSettingsForSharing",value:function(o,h){if(o){var d={};if(o.audio){var p,g,w;o.audio.settings&&(!Object.keys(o.audio.settings).length&&h||(d.audio={settings:j({},o.audio.settings)})),h&&(p=d.audio)!==null&&p!==void 0&&(p=p.settings)!==null&&p!==void 0&&p.customTrack&&(d.audio.settings={customTrack:this._sharedTracks.audioTrack});var T=((g=o.audio.processor)===null||g===void 0?void 0:g.type)==="none"&&((w=o.audio.processor)===null||w===void 0?void 0:w._isDefaultWhenNone);if(o.audio.processor&&!T){var E=j({},o.audio.processor);delete E._isDefaultWhenNone,d.audio=j(j({},d.audio),{},{processor:E})}}if(o.video){var I,q,$;o.video.settings&&(!Object.keys(o.video.settings).length&&h||(d.video={settings:j({},o.video.settings)})),h&&(I=d.video)!==null&&I!==void 0&&(I=I.settings)!==null&&I!==void 0&&I.customTrack&&(d.video.settings={customTrack:this._sharedTracks.videoTrack});var ve=((q=o.video.processor)===null||q===void 0?void 0:q.type)==="none"&&(($=o.video.processor)===null||$===void 0?void 0:$._isDefaultWhenNone);if(o.video.processor&&!ve){var V=j({},o.video.processor);delete V._isDefaultWhenNone,d.video=j(j({},d.video),{},{processor:V})}}return d}}},{key:"getInputSettings",value:function(){var o=this;return B(),new Promise((function(h){h(o._getInputSettings())}))}},{key:"_getInputSettings",value:function(){var o,h,d,p,g,w,T={processor:{type:"none",_isDefaultWhenNone:!0}};this._inputSettings?(o=((d=this._inputSettings)===null||d===void 0?void 0:d.video)||T,h=((p=this._inputSettings)===null||p===void 0?void 0:p.audio)||T):(o=((g=this._preloadCache)===null||g===void 0||(g=g.inputSettings)===null||g===void 0?void 0:g.video)||T,h=((w=this._preloadCache)===null||w===void 0||(w=w.inputSettings)===null||w===void 0?void 0:w.audio)||T);var E={audio:h,video:o};return this._prepInputSettingsForSharing(E,!0)}},{key:"_updatePreloadCacheInputSettings",value:function(o,h){var d=this._inputSettings||{},p={};if(o.video){var g,w,T;p.video={},o.video.settings?(p.video.settings={},h||o.video.settings.customTrack||(T=d.video)===null||T===void 0||!T.settings?p.video.settings=o.video.settings:p.video.settings=j(j({},d.video.settings),o.video.settings),Object.keys(p.video.settings).length||delete p.video.settings):(g=d.video)!==null&&g!==void 0&&g.settings&&(p.video.settings=d.video.settings),o.video.processor?p.video.processor=o.video.processor:(w=d.video)!==null&&w!==void 0&&w.processor&&(p.video.processor=d.video.processor)}else d.video&&(p.video=d.video);if(o.audio){var E,I,q;p.audio={},o.audio.settings?(p.audio.settings={},h||o.audio.settings.customTrack||(q=d.audio)===null||q===void 0||!q.settings?p.audio.settings=o.audio.settings:p.audio.settings=j(j({},d.audio.settings),o.audio.settings),Object.keys(p.audio.settings).length||delete p.audio.settings):(E=d.audio)!==null&&E!==void 0&&E.settings&&(p.audio.settings=d.audio.settings),o.audio.processor?p.audio.processor=o.audio.processor:(I=d.audio)!==null&&I!==void 0&&I.processor&&(p.audio.processor=d.audio.processor)}else d.audio&&(p.audio=d.audio);this._maybeUpdateInputSettings(p)}},{key:"_devicesFromInputSettings",value:function(o){var h,d,p=(o==null||(h=o.video)===null||h===void 0||(h=h.settings)===null||h===void 0?void 0:h.deviceId)||null,g=(o==null||(d=o.audio)===null||d===void 0||(d=d.settings)===null||d===void 0?void 0:d.deviceId)||null,w=this._preloadCache.outputDeviceId||null;return{camera:p?{deviceId:p}:{},mic:g?{deviceId:g}:{},speaker:w?{deviceId:w}:{}}}},{key:"updateInputSettings",value:(Kt=D((function*(o){var h=this;return B(),Ql(o)?o.video||o.audio?(Yl(o,this.properties.dailyConfig,this._sharedTracks),this._callObjectMode&&!this._callMachineInitialized?(this._updatePreloadCacheInputSettings(o,!0),this._getInputSettings()):new Promise((function(d,p){h.sendMessageToCallMachine({action:"update-input-settings",inputSettings:o},(function(g){if(g.error)p(g.error);else{if(g.returnPreloadCache)return h._updatePreloadCacheInputSettings(o,!0),void d(h._getInputSettings());h._maybeUpdateInputSettings(g.inputSettings),d(h._prepInputSettingsForSharing(g.inputSettings,!0))}}))}))):this._getInputSettings():(console.error(La()),Promise.reject(La()))})),function(o){return Kt.apply(this,arguments)})},{key:"setBandwidth",value:function(o){var h=o.kbs,d=o.trackConstraints;if(B(),this._callMachineInitialized)return this.sendMessageToCallMachine({action:"set-bandwidth",kbs:h,trackConstraints:d}),this}},{key:"getDailyLang",value:function(){var o=this;if(B(),this._callMachineInitialized)return new Promise((function(h){o.sendMessageToCallMachine({action:"get-daily-lang"},(function(d){delete d.action,delete d.callbackStamp,h(d)}))}))}},{key:"setDailyLang",value:function(o){return B(),this.sendMessageToCallMachine({action:"set-daily-lang",lang:o}),this}},{key:"setProxyUrl",value:function(o){return this.sendMessageToCallMachine({action:"set-proxy-url",proxyUrl:o}),this}},{key:"setIceConfig",value:function(o){return this.sendMessageToCallMachine({action:"set-ice-config",iceConfig:o}),this}},{key:"meetingSessionSummary",value:function(){return[Ze,Be].includes(this._callState)?this._finalSummaryOfPrevSession:this._meetingSessionSummary}},{key:"getMeetingSession",value:(Ht=D((function*(){var o=this;return console.warn("getMeetingSession() is deprecated: use meetingSessionSummary(), which will return immediately"),H(this._callState,"getMeetingSession()"),new Promise((function(h){o.sendMessageToCallMachine({action:"get-meeting-session"},(function(d){delete d.action,delete d.callbackStamp,h(d)}))}))})),function(){return Ht.apply(this,arguments)})},{key:"meetingSessionState",value:function(){return H(this._callState,"meetingSessionState"),this._meetingSessionState}},{key:"setMeetingSessionData",value:function(o){var h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"replace";we(this._callObjectMode,"setMeetingSessionData()"),H(this._callState,"setMeetingSessionData");try{(function(d,p){new op({data:d,mergeStrategy:p})})(o,h)}catch(d){throw console.error(d),d}try{this.sendMessageToCallMachine({action:"set-session-data",data:o,mergeStrategy:h})}catch(d){throw new Error("Error setting meeting session data: ".concat(d))}}},{key:"setUserName",value:function(o,h){var d=this;return this.properties.userName=o,new Promise((function(p){d.sendMessageToCallMachine({action:"set-user-name",name:o??"",thisMeetingOnly:J()||!!h&&!!h.thisMeetingOnly},(function(g){delete g.action,delete g.callbackStamp,p(g)}))}))}},{key:"setUserData",value:(Pt=D((function*(o){var h=this;try{Hl(o)}catch(d){throw console.error(d),d}if(this.properties.userData=o,this._callMachineInitialized)return new Promise((function(d){try{h.sendMessageToCallMachine({action:"set-user-data",userData:o},(function(p){delete p.action,delete p.callbackStamp,d(p)}))}catch(p){throw new Error("Error setting user data: ".concat(p))}}))})),function(o){return Pt.apply(this,arguments)})},{key:"validateAudioLevelInterval",value:function(o){if(o&&(o<100||typeof o!="number"))throw new Error("The interval must be a number greater than or equal to 100 milliseconds.")}},{key:"startLocalAudioLevelObserver",value:function(o){var h=this;if(typeof AudioWorkletNode>"u"&&!J())throw new Error("startLocalAudioLevelObserver() is not supported on this browser");if(this.validateAudioLevelInterval(o),this._callMachineInitialized)return this._isLocalAudioLevelObserverRunning=!0,new Promise((function(d,p){h.sendMessageToCallMachine({action:"start-local-audio-level-observer",interval:o},(function(g){h._isLocalAudioLevelObserverRunning=!g.error,g.error?p({error:g.error}):d()}))}));this._preloadCache.localAudioLevelObserver={enabled:!0,interval:o}}},{key:"isLocalAudioLevelObserverRunning",value:function(){return this._isLocalAudioLevelObserverRunning}},{key:"stopLocalAudioLevelObserver",value:function(){this._preloadCache.localAudioLevelObserver=null,this._localAudioLevel=0,this._isLocalAudioLevelObserverRunning=!1,this.sendMessageToCallMachine({action:"stop-local-audio-level-observer"})}},{key:"startRemoteParticipantsAudioLevelObserver",value:function(o){var h=this;if(this.validateAudioLevelInterval(o),this._callMachineInitialized)return this._isRemoteParticipantsAudioLevelObserverRunning=!0,new Promise((function(d,p){h.sendMessageToCallMachine({action:"start-remote-participants-audio-level-observer",interval:o},(function(g){h._isRemoteParticipantsAudioLevelObserverRunning=!g.error,g.error?p({error:g.error}):d()}))}));this._preloadCache.remoteParticipantsAudioLevelObserver={enabled:!0,interval:o}}},{key:"isRemoteParticipantsAudioLevelObserverRunning",value:function(){return this._isRemoteParticipantsAudioLevelObserverRunning}},{key:"stopRemoteParticipantsAudioLevelObserver",value:function(){this._preloadCache.remoteParticipantsAudioLevelObserver=null,this._remoteParticipantsAudioLevel={},this._isRemoteParticipantsAudioLevelObserverRunning=!1,this.sendMessageToCallMachine({action:"stop-remote-participants-audio-level-observer"})}},{key:"startCamera",value:(Fe=D((function*(){var o=this,h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(we(this._callObjectMode,"startCamera()"),un(this._callState,this._isPreparingToJoin,"startCamera()","Did you mean to use setLocalAudio() and/or setLocalVideo() instead?"),this.needsLoad())try{yield this.load(h)}catch(d){return Promise.reject(d)}else{if(this._didPreAuth){if(h.url&&h.url!==this.properties.url)return console.error("url in startCamera() is different than the one used in preAuth()"),Promise.reject();if(h.token&&h.token!==this.properties.token)return console.error("token in startCamera() is different than the one used in preAuth()"),Promise.reject()}this.validateProperties(h),this.properties=j(j({},this.properties),h)}return new Promise((function(d){o._preloadCache.inputSettings=o._prepInputSettingsForSharing(o._inputSettings,!1),o.sendMessageToCallMachine({action:"start-camera",properties:yt(o.properties,o.callClientId),preloadCache:yt(o._preloadCache,o.callClientId)},(function(p){d({camera:p.camera,mic:p.mic,speaker:p.speaker})}))}))})),function(){return Fe.apply(this,arguments)})},{key:"validateCustomTrack",value:function(o,h,d){if(d&&d.length>50)throw new Error("Custom track `trackName` must not be more than 50 characters");if(h&&h!=="music"&&h!=="speech"&&!(h instanceof Object))throw new Error("Custom track `mode` must be either `music` | `speech` | `DailyMicAudioModeSettings` or `undefined`");if(d&&["cam-audio","cam-video","screen-video","screen-audio","rmpAudio","rmpVideo","customVideoDefaults"].includes(d))throw new Error("Custom track `trackName` must not match a track name already used by daily: cam-audio, cam-video, customVideoDefaults, screen-video, screen-audio, rmpAudio, rmpVideo");if(!(o instanceof MediaStreamTrack))throw new Error("Custom tracks provided must be instances of MediaStreamTrack")}},{key:"startCustomTrack",value:function(){var o=this,h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{track,mode,trackName,ignoreAudioLevel};return B(),H(this._callState,"startCustomTrack()"),this.validateCustomTrack(h.track,h.mode,h.trackName),new Promise((function(d,p){o._sharedTracks.customTrack=h.track,h.track=Ne,o.sendMessageToCallMachine({action:"start-custom-track",properties:h},(function(g){g.error?p({error:g.error}):d(g.mediaTag)}))}))}},{key:"stopCustomTrack",value:function(o){var h=this;return B(),H(this._callState,"stopCustomTrack()"),new Promise((function(d){h.sendMessageToCallMachine({action:"stop-custom-track",mediaTag:o},(function(p){d(p.mediaTag)}))}))}},{key:"setCamera",value:function(o){var h=this;return Rt(),gr(this._callMachineInitialized,"setCamera()"),new Promise((function(d){h.sendMessageToCallMachine({action:"set-camera",cameraDeviceId:o},(function(p){d({device:p.device})}))}))}},{key:"setAudioDevice",value:(_e=D((function*(o){return Rt(),this.nativeUtils().setAudioDevice(o),{deviceId:yield this.nativeUtils().getAudioDevice()}})),function(o){return _e.apply(this,arguments)})},{key:"cycleCamera",value:function(){var o=this,h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return new Promise((function(d){o.sendMessageToCallMachine({action:"cycle-camera",properties:h},(function(p){d({device:p.device})}))}))}},{key:"cycleMic",value:function(){var o=this;return B(),new Promise((function(h){o.sendMessageToCallMachine({action:"cycle-mic"},(function(d){h({device:d.device})}))}))}},{key:"getCameraFacingMode",value:function(){var o=this;return Rt(),new Promise((function(h){o.sendMessageToCallMachine({action:"get-camera-facing-mode"},(function(d){h(d.facingMode)}))}))}},{key:"setInputDevicesAsync",value:(F=D((function*(o){var h=this,d=o.audioDeviceId,p=o.videoDeviceId,g=o.audioSource,w=o.videoSource;if(B(),g!==void 0&&(d=g),w!==void 0&&(p=w),typeof d=="boolean"&&(this._setAllowLocalAudio(d),d=void 0),typeof p=="boolean"&&(this._setAllowLocalVideo(p),p=void 0),!d&&!p)return yield this.getInputDevices();var T={};return d&&(d instanceof MediaStreamTrack?(this._sharedTracks.audioTrack=d,d=Ne,T.audio={settings:{customTrack:d}}):(delete this._sharedTracks.audioTrack,T.audio={settings:{deviceId:d}})),p&&(p instanceof MediaStreamTrack?(this._sharedTracks.videoTrack=p,p=Ne,T.video={settings:{customTrack:p}}):(delete this._sharedTracks.videoTrack,T.video={settings:{deviceId:p}})),this._callObjectMode&&this.needsLoad()?(this._updatePreloadCacheInputSettings(T,!1),this._devicesFromInputSettings(this._inputSettings)):new Promise((function(E){h.sendMessageToCallMachine({action:"set-input-devices",audioDeviceId:d,videoDeviceId:p},(function(I){if(delete I.action,delete I.callbackStamp,I.returnPreloadCache)return h._updatePreloadCacheInputSettings(T,!1),void E(h._devicesFromInputSettings(h._inputSettings));E(I)}))}))})),function(o){return F.apply(this,arguments)})},{key:"setOutputDeviceAsync",value:(pe=D((function*(o){var h=this,d=o.outputDeviceId;if(B(),!d||typeof d!="string")throw new Error("outputDeviceId must be provided and must be a valid device id");return this._preloadCache.outputDeviceId=d,this._callObjectMode&&this.needsLoad()?this._devicesFromInputSettings(this._inputSettings):new Promise((function(p,g){h.sendMessageToCallMachine({action:"set-output-device",outputDeviceId:d},(function(w){if(delete w.action,delete w.callbackStamp,w.error){var T=new Error(w.error.message);return T.type=w.error.type,void g(T)}w.returnPreloadCache?p(h._devicesFromInputSettings(h._inputSettings)):p(w)}))}))})),function(o){return pe.apply(this,arguments)})},{key:"getInputDevices",value:(Q=D((function*(){var o=this;return this._callObjectMode&&this.needsLoad()?this._devicesFromInputSettings(this._inputSettings):new Promise((function(h){o.sendMessageToCallMachine({action:"get-input-devices"},(function(d){d.returnPreloadCache?h(o._devicesFromInputSettings(o._inputSettings)):h({camera:d.camera,mic:d.mic,speaker:d.speaker})}))}))})),function(){return Q.apply(this,arguments)})},{key:"nativeInCallAudioMode",value:function(){return Rt(),this._nativeInCallAudioMode}},{key:"setNativeInCallAudioMode",value:function(o){if(Rt(),[ec,Ep].includes(o)){if(o!==this._nativeInCallAudioMode)return this._nativeInCallAudioMode=o,!this.disableReactNativeAutoDeviceManagement("audio")&&_r(this._callState,this._isPreparingToJoin)&&this.nativeUtils().setAudioMode(this._nativeInCallAudioMode),this}else console.error("invalid in-call audio mode specified: ",o)}},{key:"preAuth",value:(Y=D((function*(){var o=this,h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(we(this._callObjectMode,"preAuth()"),un(this._callState,this._isPreparingToJoin,"preAuth()"),this.needsLoad()&&(yield this.load(h)),!h.url)throw new Error("preAuth() requires at least a url to be provided");return this.validateProperties(h),this.properties=j(j({},this.properties),h),new Promise((function(d,p){o._preloadCache.inputSettings=o._prepInputSettingsForSharing(o._inputSettings,!1),o.sendMessageToCallMachine({action:"daily-method-preauth",properties:yt(o.properties,o.callClientId),preloadCache:yt(o._preloadCache,o.callClientId)},(function(g){return g.error?p(g.error):g.access?(o._didPreAuth=!0,void d({access:g.access})):p(new Error("unknown error in preAuth()"))}))}))})),function(){return Y.apply(this,arguments)})},{key:"load",value:(U=D((function*(o){var h=this;if(this.needsLoad()){if(this._destroyed&&(this._logUseAfterDestroy(),this.strictMode))throw new Error("Use after destroy");if(o&&(this.validateProperties(o),this.properties=j(j({},this.properties),o)),!this._callObjectMode&&!this.properties.url)throw new Error("can't load iframe meeting because url property isn't set");return this._updateCallState(wo),this.emitDailyJSEvent({action:of}),this._callObjectMode?new Promise((function(d,p){h._callObjectLoader.cancel();var g=Date.now();h._callObjectLoader.load(h.properties.dailyConfig,(function(w){h._bundleLoadTime=w?"no-op":Date.now()-g,h._updateCallState(So),w&&h.emitDailyJSEvent({action:Co}),d()}),(function(w,T){if(h.emitDailyJSEvent({action:cf}),!T){h._updateCallState(Be),h.resetMeetingDependentVars();var E={action:Oo,errorMsg:w.msg,error:{type:"connection-error",msg:"Failed to load call object bundle.",details:{on:"load",sourceError:w,bundleUrl:wr(h.properties.dailyConfig)}}};h._maybeSendToSentry(E),h.emitDailyJSEvent(E),p(w.msg)}}))})):(this._iframe.src=gl(this.assembleMeetingUrl(),this.properties.dailyConfig),new Promise((function(d,p){h._loadedCallback=function(g){h._callState!==Be?(h._updateCallState(So),(h.properties.cssFile||h.properties.cssText)&&h.loadCss(h.properties),d()):p(g)}})))}})),function(o){return U.apply(this,arguments)})},{key:"join",value:(x=D((function*(){var o=this,h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._testCallInProgress&&this.stopTestCallQuality();var d=!1;if(this.needsLoad()){this.updateIsPreparingToJoin(!0);try{yield this.load(h)}catch(p){return this.updateIsPreparingToJoin(!1),Promise.reject(p)}}else{if(d=!(!this.properties.cssFile&&!this.properties.cssText),this._didPreAuth){if(h.url&&h.url!==this.properties.url)return console.error("url in join() is different than the one used in preAuth()"),this.updateIsPreparingToJoin(!1),Promise.reject();if(h.token&&h.token!==this.properties.token)return console.error("token in join() is different than the one used in preAuth()"),this.updateIsPreparingToJoin(!1),Promise.reject()}if(h.url&&!this._callObjectMode&&h.url&&h.url!==this.properties.url)return console.error("url in join() is different than the one used in load() (".concat(this.properties.url," -> ").concat(h.url,")")),this.updateIsPreparingToJoin(!1),Promise.reject();this.validateProperties(h),this.properties=j(j({},this.properties),h)}return h.showLocalVideo!==void 0&&(this._callObjectMode?console.error("showLocalVideo is not available in callObject mode"):this._showLocalVideo=!!h.showLocalVideo),h.showParticipantsBar!==void 0&&(this._callObjectMode?console.error("showParticipantsBar is not available in callObject mode"):this._showParticipantsBar=!!h.showParticipantsBar),this._callState===it||this._callState===Aa?(console.warn("already joined meeting, call leave() before joining again"),void this.updateIsPreparingToJoin(!1)):(this._updateCallState(Aa,!1),this.emitDailyJSEvent({action:df}),this._preloadCache.inputSettings=this._prepInputSettingsForSharing(this._inputSettings||{},!1),this.sendMessageToCallMachine({action:"join-meeting",properties:yt(this.properties,this.callClientId),preloadCache:yt(this._preloadCache,this.callClientId)}),new Promise((function(p,g){o._joinedCallback=function(w,T){if(o._callState!==Be){if(o._updateCallState(it),w)for(var E in w){if(o._callObjectMode){var I=o._callMachine().store;Uo(w[E],I),Vo(w[E],I),Jo(w[E],o._participants[E],I)}o._participants[E]=j({},w[E]),o.toggleParticipantAudioBasedOnNativeAudioFocus()}d&&o.loadCss(o.properties),p(w)}else g(T)}})))})),function(){return x.apply(this,arguments)})},{key:"leave",value:(P=D((function*(){var o=this;return this._testCallInProgress&&this.stopTestCallQuality(),new Promise((function(h){o._callState===Ze||o._callState===Be?h():o._callObjectLoader&&!o._callObjectLoader.loaded?(o._callObjectLoader.cancel(),o._updateCallState(Ze),o.resetMeetingDependentVars(),o.emitDailyJSEvent({action:Ze}),h()):(o._resolveLeave=h,o.sendMessageToCallMachine({action:"leave-meeting"}))}))})),function(){return P.apply(this,arguments)})},{key:"startScreenShare",value:(O=D((function*(){var o=this,h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(gr(this._callMachineInitialized,"startScreenShare()"),h.screenVideoSendSettings&&this._validateVideoSendSettings("screenVideo",h.screenVideoSendSettings),h.mediaStream&&(this._sharedTracks.screenMediaStream=h.mediaStream,h.mediaStream=Ne),typeof DailyNativeUtils<"u"&&DailyNativeUtils.isIOS!==void 0&&DailyNativeUtils.isIOS){var d=this.nativeUtils();if(yield d.isScreenBeingCaptured())return void this.emitDailyJSEvent({action:Ao,type:"screen-share-error",errorMsg:"Could not start the screen sharing. The screen is already been captured!"});d.setSystemScreenCaptureStartCallback((function(){d.setSystemScreenCaptureStartCallback(null),o.sendMessageToCallMachine({action:Io,captureOptions:h})})),d.presentSystemScreenCapturePrompt()}else this.sendMessageToCallMachine({action:Io,captureOptions:h})})),function(){return O.apply(this,arguments)})},{key:"stopScreenShare",value:function(){gr(this._callMachineInitialized,"stopScreenShare()"),this.sendMessageToCallMachine({action:"local-screen-stop"})}},{key:"startRecording",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},h=o.type;if(h&&h!=="cloud"&&h!=="raw-tracks"&&h!=="local")throw new Error("invalid type: ".concat(h,", allowed values 'cloud', 'raw-tracks', or 'local'"));this.sendMessageToCallMachine(j({action:"local-recording-start"},o))}},{key:"updateRecording",value:function(o){var h=o.layout,d=h===void 0?{preset:"default"}:h,p=o.instanceId;this.sendMessageToCallMachine({action:"daily-method-update-recording",layout:d,instanceId:p})}},{key:"stopRecording",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.sendMessageToCallMachine(j({action:"local-recording-stop"},o))}},{key:"startLiveStreaming",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.sendMessageToCallMachine(j({action:"daily-method-start-live-streaming"},o))}},{key:"updateLiveStreaming",value:function(o){var h=o.layout,d=h===void 0?{preset:"default"}:h,p=o.instanceId;this.sendMessageToCallMachine({action:"daily-method-update-live-streaming",layout:d,instanceId:p})}},{key:"addLiveStreamingEndpoints",value:function(o){var h=o.endpoints,d=o.instanceId;this.sendMessageToCallMachine({action:jo,endpointsOp:Zf,endpoints:h,instanceId:d})}},{key:"removeLiveStreamingEndpoints",value:function(o){var h=o.endpoints,d=o.instanceId;this.sendMessageToCallMachine({action:jo,endpointsOp:ep,endpoints:h,instanceId:d})}},{key:"stopLiveStreaming",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.sendMessageToCallMachine(j({action:"daily-method-stop-live-streaming"},o))}},{key:"validateDailyConfig",value:function(o){o.camSimulcastEncodings&&(console.warn("camSimulcastEncodings is deprecated. Use sendSettings, found in DailyCallOptions, to provide camera simulcast settings."),this.validateSimulcastEncodings(o.camSimulcastEncodings)),o.screenSimulcastEncodings&&console.warn("screenSimulcastEncodings is deprecated. Use sendSettings, found in DailyCallOptions, to provide screen simulcast settings."),Dl()&&o.noAutoDefaultDeviceChange&&console.warn("noAutoDefaultDeviceChange is not supported on Android, and will be ignored.")}},{key:"validateSimulcastEncodings",value:function(o){var h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,d=arguments.length>2&&arguments[2]!==void 0&&arguments[2];if(o){if(!(o instanceof Array||Array.isArray(o)))throw new Error("encodings must be an Array");if(!uc(o.length,1,3))throw new Error("encodings must be an Array with between 1 to ".concat(3," layers"));for(var p=0;p<o.length;p++){var g=o[p];for(var w in this._validateEncodingLayerHasValidProperties(g),g)if(cn.includes(w)){if(typeof g[w]!="number")throw new Error("".concat(w," must be a number"));if(h){var T=h[w],E=T.min,I=T.max;if(!uc(g[w],E,I))throw new Error("".concat(w," value not in range. valid range: ").concat(E," to ").concat(I))}}else if(!["active","scalabilityMode"].includes(w))throw new Error("Invalid key ".concat(w,", valid keys are:")+Object.values(cn));if(d&&!g.hasOwnProperty("maxBitrate"))throw new Error("maxBitrate is not specified")}}}},{key:"startRemoteMediaPlayer",value:(A=D((function*(o){var h=this,d=o.url,p=o.settings,g=p===void 0?{state:Oa.PLAY}:p;try{(function(w){if(typeof w!="string")throw new Error('url parameter must be "string" type')})(d),cc(g),(function(w){for(var T in w)if(!nc.includes(T))throw new Error("Invalid key ".concat(T,", valid keys are: ").concat(nc));w.simulcastEncodings&&this.validateSimulcastEncodings(w.simulcastEncodings,Gl,!0)})(g)}catch(w){throw console.error("invalid argument Error: ".concat(w)),console.error(`startRemoteMediaPlayer arguments must be of the form:
  { url: "playback url",
  settings?:
  {state: "play"|"pause", simulcastEncodings?: [{}] } }`),w}return new Promise((function(w,T){h.sendMessageToCallMachine({action:"daily-method-start-remote-media-player",url:d,settings:g},(function(E){E.error?T({error:E.error,errorMsg:E.errorMsg}):w({session_id:E.session_id,remoteMediaPlayerState:{state:E.state,settings:E.settings}})}))}))})),function(o){return A.apply(this,arguments)})},{key:"stopRemoteMediaPlayer",value:(C=D((function*(o){var h=this;if(typeof o!="string")throw new Error(" remotePlayerID must be of type string");return new Promise((function(d,p){h.sendMessageToCallMachine({action:"daily-method-stop-remote-media-player",session_id:o},(function(g){g.error?p({error:g.error,errorMsg:g.errorMsg}):d()}))}))})),function(o){return C.apply(this,arguments)})},{key:"updateRemoteMediaPlayer",value:(S=D((function*(o){var h=this,d=o.session_id,p=o.settings;try{cc(p)}catch(g){throw console.error("invalid argument Error: ".concat(g)),console.error(`updateRemoteMediaPlayer arguments must be of the form:
  session_id: "participant session",
  { settings?: {state: "play"|"pause"} }`),g}return new Promise((function(g,w){h.sendMessageToCallMachine({action:"daily-method-update-remote-media-player",session_id:d,settings:p},(function(T){T.error?w({error:T.error,errorMsg:T.errorMsg}):g({session_id:T.session_id,remoteMediaPlayerState:{state:T.state,settings:T.settings}})}))}))})),function(o){return S.apply(this,arguments)})},{key:"startTranscription",value:function(o){H(this._callState,"startTranscription()"),this.sendMessageToCallMachine(j({action:"daily-method-start-transcription"},o))}},{key:"updateTranscription",value:function(o){if(H(this._callState,"updateTranscription()"),!o)throw new Error("updateTranscription Error: options is mandatory");if(z(o)!=="object")throw new Error("updateTranscription Error: options must be object type");if(o.participants&&!Array.isArray(o.participants))throw new Error("updateTranscription Error: participants must be an array");this.sendMessageToCallMachine(j({action:"daily-method-update-transcription"},o))}},{key:"stopTranscription",value:function(o){if(H(this._callState,"stopTranscription()"),o&&z(o)!=="object")throw new Error("stopTranscription Error: options must be object type");if(o&&!o.instanceId)throw new Error('"instanceId" not provided');this.sendMessageToCallMachine(j({action:"daily-method-stop-transcription"},o))}},{key:"startDialOut",value:(_=D((function*(o){var h=this;H(this._callState,"startDialOut()");var d=function(T){if(T){if(!Array.isArray(T))throw new Error("Error starting dial out: audio codec must be an array");if(T.length<=0)throw new Error("Error starting dial out: audio codec array specified but empty");T.forEach((function(E){if(typeof E!="string")throw new Error("Error starting dial out: audio codec must be a string");if(E!=="OPUS"&&E!=="PCMU"&&E!=="PCMA"&&E!=="G722")throw new Error("Error starting dial out: audio codec must be one of OPUS, PCMU, PCMA, G722")}))}};if(!o.sipUri&&!o.phoneNumber)throw new Error("Error starting dial out: either a sip uri or phone number must be provided");if(o.sipUri&&o.phoneNumber)throw new Error("Error starting dial out: only one of sip uri or phone number must be provided");if(o.sipUri){if(typeof o.sipUri!="string")throw new Error("Error starting dial out: sipUri must be a string");if(!o.sipUri.startsWith("sip:"))throw new Error("Error starting dial out: Invalid SIP URI, must start with 'sip:'");if(o.video&&typeof o.video!="boolean")throw new Error("Error starting dial out: video must be a boolean value");(function(T){if(T&&(d(T.audio),T.video)){if(!Array.isArray(T.video))throw new Error("Error starting dial out: video codec must be an array");if(T.video.length<=0)throw new Error("Error starting dial out: video codec array specified but empty");T.video.forEach((function(E){if(typeof E!="string")throw new Error("Error starting dial out: video codec must be a string");if(E!=="H264"&&E!=="VP8")throw new Error("Error starting dial out: video codec must be H264 or VP8")}))}})(o.codecs)}if(o.phoneNumber){if(typeof o.phoneNumber!="string")throw new Error("Error starting dial out: phoneNumber must be a string");if(!/^\+\d{1,}$/.test(o.phoneNumber))throw new Error("Error starting dial out: Invalid phone number, must be valid phone number as per E.164");o.codecs&&d(o.codecs.audio)}if(o.callerId){if(typeof o.callerId!="string")throw new Error("Error starting dial out: callerId must be a string");if(o.sipUri)throw new Error("Error starting dial out: callerId not allowed with sipUri")}if(o.displayName){if(typeof o.displayName!="string")throw new Error("Error starting dial out: displayName must be a string");if(o.displayName.length>=200)throw new Error("Error starting dial out: displayName length must be less than 200")}if(o.userId){if(typeof o.userId!="string")throw new Error("Error starting dial out: userId must be a string");if(o.userId.length>36)throw new Error("Error starting dial out: userId length must be less than or equal to 36")}if(o.permissions&&o.permissions.canReceive){var p=ie(zl.validateJSONObject(o.permissions.canReceive),2),g=p[0],w=p[1];if(!g)throw new Error(w)}return new Promise((function(T,E){h.sendMessageToCallMachine(j({action:"dialout-start"},o),(function(I){I.error?E(I.error):T(I)}))}))})),function(o){return _.apply(this,arguments)})},{key:"stopDialOut",value:function(o){var h=this;return H(this._callState,"stopDialOut()"),new Promise((function(d,p){h.sendMessageToCallMachine(j({action:"dialout-stop"},o),(function(g){g.error?p(g.error):d(g)}))}))}},{key:"sipCallTransfer",value:(m=D((function*(o){var h=this;if(H(this._callState,"sipCallTransfer()"),!o)throw new Error("sipCallTransfer() requires a sessionId and toEndPoint");return o.useSipRefer=!1,oc(o,"sipCallTransfer"),new Promise((function(d,p){h.sendMessageToCallMachine(j({action:Ro},o),(function(g){g.error?p(g.error):d(g)}))}))})),function(o){return m.apply(this,arguments)})},{key:"sipRefer",value:(y=D((function*(o){var h=this;if(H(this._callState,"sipRefer()"),!o)throw new Error("sessionId and toEndPoint are mandatory parameter");return o.useSipRefer=!0,oc(o,"sipRefer"),new Promise((function(d,p){h.sendMessageToCallMachine(j({action:Ro},o),(function(g){g.error?p(g.error):d(g)}))}))})),function(o){return y.apply(this,arguments)})},{key:"sendDTMF",value:(k=D((function*(o){var h=this;return H(this._callState,"sendDTMF()"),(function(d){var p=d.sessionId,g=d.tones;if(!p||!g)throw new Error("sessionId and tones are mandatory parameter");if(typeof p!="string"||typeof g!="string")throw new Error("sessionId and tones should be of string type");if(g.length>20)throw new Error("tones string must be upto 20 characters");var w=/[^0-9A-D*#]/g,T=g.match(w);if(T&&T[0])throw new Error("".concat(T[0]," is not valid DTMF tone"))})(o),new Promise((function(d,p){h.sendMessageToCallMachine(j({action:"send-dtmf"},o),(function(g){g.error?p(g.error):d(g)}))}))})),function(o){return k.apply(this,arguments)})},{key:"getNetworkStats",value:function(){var o=this;return this._callState!==it?Promise.resolve(j({stats:{latest:{}}},this._network)):new Promise((function(h){o.sendMessageToCallMachine({action:"get-calc-stats"},(function(d){h(j(j({},o._network),{},{stats:d.stats}))}))}))}},{key:"testWebsocketConnectivity",value:(b=D((function*(){var o=this;if(ln(this._testCallInProgress,"testWebsocketConnectivity()"),this.needsLoad())try{yield this.load()}catch(h){return Promise.reject(h)}return new Promise((function(h,d){o.sendMessageToCallMachine({action:"test-websocket-connectivity"},(function(p){p.error?d(p.error):h(p.results)}))}))})),function(){return b.apply(this,arguments)})},{key:"abortTestWebsocketConnectivity",value:function(){this.sendMessageToCallMachine({action:"abort-test-websocket-connectivity"})}},{key:"_validateVideoTrackForNetworkTests",value:function(o){return o?o instanceof MediaStreamTrack?!!Sp(o)||(console.error("Video track is not playable. This test needs a live video track."),!1):(console.error("Video track needs to be of type `MediaStreamTrack`."),!1):(console.error("Missing video track. You must provide a video track in order to run this test."),!1)}},{key:"testCallQuality",value:(v=D((function*(){var o=this;B(),we(this._callObjectMode,"testCallQuality()"),gr(this._callMachineInitialized,"testCallQuality()",null,!0),un(this._callState,this._isPreparingToJoin,"testCallQuality()");var h=this._testCallAlreadyInProgress,d=function(g){h||(o._testCallInProgress=g)};if(d(!0),this.needsLoad())try{var p=this._callState;yield this.load(),this._callState=p}catch(g){return d(!1),Promise.reject(g)}return new Promise((function(g){o.sendMessageToCallMachine({action:"test-call-quality",dailyJsVersion:o.properties.dailyJsVersion},(function(w){var T=w.results,E=T.result,I=ps(T,Mp);if(E==="failed"){var q,$=j({},I);(q=I.error)!==null&&q!==void 0&&q.details?(I.error.details=JSON.parse(I.error.details),$.error=j(j({},$.error),{},{details:j({},$.error.details)}),$.error.details.duringTest="testCallQuality"):($.error=$.error?j({},$.error):{},$.error.details={duringTest:"testCallQuality"}),o._maybeSendToSentry($)}d(!1),g(j({result:E},I))}))}))})),function(){return v.apply(this,arguments)})},{key:"stopTestCallQuality",value:function(){this.sendMessageToCallMachine({action:"stop-test-call-quality"})}},{key:"testConnectionQuality",value:(f=D((function*(o){var h;J()?(console.warn("testConnectionQuality() is deprecated: use testPeerToPeerCallQuality() instead"),h=yield this.testPeerToPeerCallQuality(o)):(console.warn("testConnectionQuality() is deprecated: use testCallQuality() instead"),h=yield this.testCallQuality());var d={result:h.result,secondsElapsed:h.secondsElapsed};return h.data&&(d.data={maxRTT:h.data.maxRoundTripTime,packetLoss:h.data.avgRecvPacketLoss}),d})),function(o){return f.apply(this,arguments)})},{key:"testPeerToPeerCallQuality",value:(l=D((function*(o){var h=this;if(ln(this._testCallInProgress,"testPeerToPeerCallQuality()"),this.needsLoad())try{yield this.load()}catch(g){return Promise.reject(g)}var d=o.videoTrack,p=o.duration;if(!this._validateVideoTrackForNetworkTests(d))throw new Error("Video track error");return this._sharedTracks.videoTrackForConnectionQualityTest=d,new Promise((function(g,w){h.sendMessageToCallMachine({action:"test-p2p-call-quality",duration:p},(function(T){T.error?w(T.error):g(T.results)}))}))})),function(o){return l.apply(this,arguments)})},{key:"stopTestConnectionQuality",value:function(){J()?(console.warn("stopTestConnectionQuality() is deprecated: use testPeerToPeerCallQuality() and stopTestPeerToPeerCallQuality() instead"),this.stopTestPeerToPeerCallQuality()):(console.warn("stopTestConnectionQuality() is deprecated: use testCallQuality() and stopTestCallQuality() instead"),this.stopTestCallQuality())}},{key:"stopTestPeerToPeerCallQuality",value:function(){this.sendMessageToCallMachine({action:"stop-test-p2p-call-quality"})}},{key:"testNetworkConnectivity",value:(u=D((function*(o){var h=this;if(ln(this._testCallInProgress,"testNetworkConnectivity()"),this.needsLoad())try{yield this.load()}catch(d){return Promise.reject(d)}if(!this._validateVideoTrackForNetworkTests(o))throw new Error("Video track error");return this._sharedTracks.videoTrackForNetworkConnectivityTest=o,new Promise((function(d,p){h.sendMessageToCallMachine({action:"test-network-connectivity"},(function(g){g.error?p(g.error):d(g.results)}))}))})),function(o){return u.apply(this,arguments)})},{key:"abortTestNetworkConnectivity",value:function(){this.sendMessageToCallMachine({action:"abort-test-network-connectivity"})}},{key:"getCpuLoadStats",value:function(){var o=this;return new Promise((function(h){o._callState===it?o.sendMessageToCallMachine({action:"get-cpu-load-stats"},(function(d){h(d.cpuStats)})):h({cpuLoadState:void 0,cpuLoadStateReason:void 0,stats:{}})}))}},{key:"_validateEncodingLayerHasValidProperties",value:function(o){var h;if(!(((h=Object.keys(o))===null||h===void 0?void 0:h.length)>0))throw new Error("Empty encoding is not allowed. At least one of these valid keys should be specified:"+Object.values(cn))}},{key:"_validateVideoSendSettings",value:function(o,h){var d=o==="screenVideo"?["default-screen-video","detail-optimized","motion-optimized","motion-and-detail-balanced"]:["default-video","bandwidth-optimized","bandwidth-and-quality-balanced","quality-optimized","adaptive-2-layers","adaptive-3-layers"],p="Video send settings should be either an object or one of the supported presets: ".concat(d.join());if(typeof h=="string"){if(!d.includes(h))throw new Error(p)}else{if(z(h)!=="object")throw new Error(p);if(!h.maxQuality&&!h.encodings&&h.allowAdaptiveLayers===void 0)throw new Error("Video send settings must contain at least maxQuality, allowAdaptiveLayers or encodings attribute");if(h.maxQuality&&["low","medium","high"].indexOf(h.maxQuality)===-1)throw new Error("maxQuality must be either low, medium or high");if(h.encodings){var g=!1;switch(Object.keys(h.encodings).length){case 1:g=!h.encodings.low;break;case 2:g=!h.encodings.low||!h.encodings.medium;break;case 3:g=!h.encodings.low||!h.encodings.medium||!h.encodings.high;break;default:g=!0}if(g)throw new Error("Encodings must be defined as: low, low and medium, or low, medium and high.");h.encodings.low&&this._validateEncodingLayerHasValidProperties(h.encodings.low),h.encodings.medium&&this._validateEncodingLayerHasValidProperties(h.encodings.medium),h.encodings.high&&this._validateEncodingLayerHasValidProperties(h.encodings.high)}}}},{key:"validateUpdateSendSettings",value:function(o){var h=this;if(!o||Object.keys(o).length===0)throw new Error("Send settings must contain at least information for one track!");Object.entries(o).forEach((function(d){var p=ie(d,2),g=p[0],w=p[1];h._validateVideoSendSettings(g,w)}))}},{key:"updateSendSettings",value:function(o){var h=this;return this.validateUpdateSendSettings(o),this.needsLoad()?(this._preloadCache.sendSettings=o,{sendSettings:this._preloadCache.sendSettings}):new Promise((function(d,p){h.sendMessageToCallMachine({action:"update-send-settings",sendSettings:o},(function(g){g.error?p(g.error):d(g.sendSettings)}))}))}},{key:"getSendSettings",value:function(){return this._sendSettings||this._preloadCache.sendSettings}},{key:"getLocalAudioLevel",value:function(){return this._localAudioLevel}},{key:"getRemoteParticipantsAudioLevel",value:function(){return this._remoteParticipantsAudioLevel}},{key:"getActiveSpeaker",value:function(){return B(),this._activeSpeaker}},{key:"setActiveSpeakerMode",value:function(o){return B(),this.sendMessageToCallMachine({action:"set-active-speaker-mode",enabled:o}),this}},{key:"activeSpeakerMode",value:function(){return B(),this._activeSpeakerMode}},{key:"subscribeToTracksAutomatically",value:function(){return this._preloadCache.subscribeToTracksAutomatically}},{key:"setSubscribeToTracksAutomatically",value:function(o){return H(this._callState,"setSubscribeToTracksAutomatically()","Use the subscribeToTracksAutomatically configuration property."),this._preloadCache.subscribeToTracksAutomatically=o,this.sendMessageToCallMachine({action:"daily-method-subscribe-to-tracks-automatically",enabled:o}),this}},{key:"enumerateDevices",value:(c=D((function*(){var o=this;if(this._callObjectMode){var h=yield navigator.mediaDevices.enumerateDevices();return ht()==="Firefox"&&Er().major>115&&Er().major<123&&(h=h.filter((function(d){return d.kind!=="audiooutput"}))),{devices:h.map((function(d){var p=JSON.parse(JSON.stringify(d));if(!J()&&d.kind==="videoinput"&&d.getCapabilities){var g,w=d.getCapabilities();p.facing=(w==null||(g=w.facingMode)===null||g===void 0?void 0:g.length)>=1?w.facingMode[0]:void 0}return p}))}}return new Promise((function(d){o.sendMessageToCallMachine({action:"enumerate-devices"},(function(p){d({devices:p.devices})}))}))})),function(){return c.apply(this,arguments)})},{key:"sendAppMessage",value:function(o){var h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"*";if(H(this._callState,"sendAppMessage()"),JSON.stringify(o).length>this._maxAppMessageSize)throw new Error("Message data too large. Max size is "+this._maxAppMessageSize);return this.sendMessageToCallMachine({action:"app-msg",data:o,to:h}),this}},{key:"addFakeParticipant",value:function(o){return B(),H(this._callState,"addFakeParticipant()"),this.sendMessageToCallMachine(j({action:"add-fake-participant"},o)),this}},{key:"setShowNamesMode",value:function(o){return le(this._callObjectMode,"setShowNamesMode()"),B(),o&&o!=="always"&&o!=="never"?(console.error('setShowNamesMode argument should be "always", "never", or false'),this):(this.sendMessageToCallMachine({action:"set-show-names",mode:o}),this)}},{key:"setShowLocalVideo",value:function(){var o=!(arguments.length>0&&arguments[0]!==void 0)||arguments[0];return le(this._callObjectMode,"setShowLocalVideo()"),B(),H(this._callState,"setShowLocalVideo()"),typeof o!="boolean"?(console.error("setShowLocalVideo only accepts a boolean value"),this):(this.sendMessageToCallMachine({action:"set-show-local-video",show:o}),this._showLocalVideo=o,this)}},{key:"showLocalVideo",value:function(){return le(this._callObjectMode,"showLocalVideo()"),B(),this._showLocalVideo}},{key:"setShowParticipantsBar",value:function(){var o=!(arguments.length>0&&arguments[0]!==void 0)||arguments[0];return le(this._callObjectMode,"setShowParticipantsBar()"),B(),H(this._callState,"setShowParticipantsBar()"),typeof o!="boolean"?(console.error("setShowParticipantsBar only accepts a boolean value"),this):(this.sendMessageToCallMachine({action:"set-show-participants-bar",show:o}),this._showParticipantsBar=o,this)}},{key:"showParticipantsBar",value:function(){return le(this._callObjectMode,"showParticipantsBar()"),B(),this._showParticipantsBar}},{key:"customIntegrations",value:function(){return B(),le(this._callObjectMode,"customIntegrations()"),this._customIntegrations}},{key:"setCustomIntegrations",value:function(o){return B(),le(this._callObjectMode,"setCustomIntegrations()"),H(this._callState,"setCustomIntegrations()"),td(o)?(this.sendMessageToCallMachine({action:"set-custom-integrations",integrations:o}),this._customIntegrations=o,this):this}},{key:"startCustomIntegrations",value:function(o){var h=this;if(B(),le(this._callObjectMode,"startCustomIntegrations()"),H(this._callState,"startCustomIntegrations()"),Array.isArray(o)&&o.some((function(g){return typeof g!="string"}))||!Array.isArray(o)&&typeof o!="string")return console.error("startCustomIntegrations() only accepts string | string[]"),this;var d=typeof o=="string"?[o]:o,p=d.filter((function(g){return!(g in h._customIntegrations)}));return p.length?(console.error(`Can't find custom integration(s): "`.concat(p.join(", "),'"')),this):(this.sendMessageToCallMachine({action:"start-custom-integrations",ids:d}),this)}},{key:"stopCustomIntegrations",value:function(o){var h=this;if(B(),le(this._callObjectMode,"stopCustomIntegrations()"),H(this._callState,"stopCustomIntegrations()"),Array.isArray(o)&&o.some((function(g){return typeof g!="string"}))||!Array.isArray(o)&&typeof o!="string")return console.error("stopCustomIntegrations() only accepts string | string[]"),this;var d=typeof o=="string"?[o]:o,p=d.filter((function(g){return!(g in h._customIntegrations)}));return p.length?(console.error(`Can't find custom integration(s): "`.concat(p.join(", "),'"')),this):(this.sendMessageToCallMachine({action:"stop-custom-integrations",ids:d}),this)}},{key:"customTrayButtons",value:function(){return le(this._callObjectMode,"customTrayButtons()"),B(),this._customTrayButtons}},{key:"updateCustomTrayButtons",value:function(o){return le(this._callObjectMode,"updateCustomTrayButtons()"),B(),H(this._callState,"updateCustomTrayButtons()"),ed(o)?(this.sendMessageToCallMachine({action:"update-custom-tray-buttons",btns:o}),this._customTrayButtons=o,this):(console.error("updateCustomTrayButtons only accepts a dictionary of the type ".concat(JSON.stringify(Or))),this)}},{key:"theme",value:function(){return le(this._callObjectMode,"theme()"),this.properties.theme}},{key:"setTheme",value:function(o){var h=this;return le(this._callObjectMode,"setTheme()"),new Promise((function(d,p){try{h.validateProperties({theme:o}),h.properties.theme=j({},o),h.sendMessageToCallMachine({action:"set-theme",theme:h.properties.theme});try{h.emitDailyJSEvent({action:sf,theme:h.properties.theme})}catch(g){console.log("could not emit 'theme-updated'",g)}d(h.properties.theme)}catch(g){p(g)}}))}},{key:"requestFullscreen",value:(s=D((function*(){if(B(),this._iframe&&!document.fullscreenElement&&xo())try{(yield this._iframe.requestFullscreen)?this._iframe.requestFullscreen():this._iframe.webkitRequestFullscreen()}catch(o){console.log("could not make video call fullscreen",o)}})),function(){return s.apply(this,arguments)})},{key:"exitFullscreen",value:function(){B(),document.fullscreenElement?document.exitFullscreen():document.webkitFullscreenElement&&document.webkitExitFullscreen()}},{key:"getSidebarView",value:(a=D((function*(){var o=this;return this._callObjectMode?(console.error("getSidebarView is not available in callObject mode"),Promise.resolve(null)):new Promise((function(h){o.sendMessageToCallMachine({action:"get-sidebar-view"},(function(d){h(d.view)}))}))})),function(){return a.apply(this,arguments)})},{key:"setSidebarView",value:function(o){return this._callObjectMode?(console.error("setSidebarView is not available in callObject mode"),this):(this.sendMessageToCallMachine({action:"set-sidebar-view",view:o}),this)}},{key:"room",value:(i=D((function*(){var o=this,h=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:{}).includeRoomConfigDefaults,d=h===void 0||h;return this._accessState.access===tn||this.needsLoad()?this.properties.url?{roomUrlPendingJoin:this.properties.url}:null:new Promise((function(p){o.sendMessageToCallMachine({action:"lib-room-info",includeRoomConfigDefaults:d},(function(g){delete g.action,delete g.callbackStamp,p(g)}))}))})),function(){return i.apply(this,arguments)})},{key:"geo",value:(n=D((function*(){try{var o=yield fetch("https://gs.daily.co/_ks_/x-swsl/:");return{current:(yield o.json()).geo}}catch(h){return console.error("geo lookup failed",h),{current:""}}})),function(){return n.apply(this,arguments)})},{key:"setNetworkTopology",value:(t=D((function*(o){var h=this;return B(),H(this._callState,"setNetworkTopology()"),new Promise((function(d,p){h.sendMessageToCallMachine({action:"set-network-topology",opts:o},(function(g){g.error?p({error:g.error}):d({workerId:g.workerId})}))}))})),function(o){return t.apply(this,arguments)})},{key:"getNetworkTopology",value:(e=D((function*(){var o=this;return new Promise((function(h,d){o.needsLoad()&&h({topology:"none"}),o.sendMessageToCallMachine({action:"get-network-topology"},(function(p){p.error?d({error:p.error}):h({topology:p.topology})}))}))})),function(){return e.apply(this,arguments)})},{key:"setPlayNewParticipantSound",value:function(o){if(B(),typeof o!="number"&&o!==!0&&o!==!1)throw new Error("argument to setShouldPlayNewParticipantSound should be true, false, or a number, but is ".concat(o));this.sendMessageToCallMachine({action:"daily-method-set-play-ding",arg:o})}},{key:"on",value:function(o,h){return nr.prototype.on.call(this,o,h)}},{key:"once",value:function(o,h){return nr.prototype.once.call(this,o,h)}},{key:"off",value:function(o,h){return nr.prototype.off.call(this,o,h)}},{key:"validateProperties",value:function(o){var h,d;if(o!=null&&(h=o.dailyConfig)!==null&&h!==void 0&&h.userMediaAudioConstraints){var p,g;J()||console.warn("userMediaAudioConstraints is deprecated. You can override constraints with inputSettings.audio.settings, found in DailyCallOptions.");var w=o.inputSettings||{};w.audio=((p=o.inputSettings)===null||p===void 0?void 0:p.audio)||{},w.audio.settings=((g=o.inputSettings)===null||g===void 0||(g=g.audio)===null||g===void 0?void 0:g.settings)||{},w.audio.settings=j(j({},w.audio.settings),o.dailyConfig.userMediaAudioConstraints),o.inputSettings=w,delete o.dailyConfig.userMediaAudioConstraints}if(o!=null&&(d=o.dailyConfig)!==null&&d!==void 0&&d.userMediaVideoConstraints){var T,E;J()||console.warn("userMediaVideoConstraints is deprecated. You can override constraints with inputSettings.video.settings, found in DailyCallOptions.");var I=o.inputSettings||{};I.video=((T=o.inputSettings)===null||T===void 0?void 0:T.video)||{},I.video.settings=((E=o.inputSettings)===null||E===void 0||(E=E.video)===null||E===void 0?void 0:E.settings)||{},I.video.settings=j(j({},I.video.settings),o.dailyConfig.userMediaVideoConstraints),o.inputSettings=I,delete o.dailyConfig.userMediaVideoConstraints}for(var q in o){if(!tt[q])throw new Error("unrecognized property '".concat(q,"'"));if(tt[q].validate&&!tt[q].validate(o[q],this))throw new Error("property '".concat(q,"': ").concat(tt[q].help))}}},{key:"assembleMeetingUrl",value:function(){var o,h,d=j(j({},this.properties),{},{emb:this.callClientId,embHref:encodeURIComponent(window.location.href),proxy:(o=this.properties.dailyConfig)!==null&&o!==void 0&&o.proxyUrl?encodeURIComponent((h=this.properties.dailyConfig)===null||h===void 0?void 0:h.proxyUrl):void 0}),p=d.url.match(/\?/)?"&":"?";return d.url+p+Object.keys(tt).filter((function(g){return tt[g].queryString&&d[g]!==void 0})).map((function(g){return"".concat(tt[g].queryString,"=").concat(d[g])})).join("&")}},{key:"needsLoad",value:function(){return[_o,wo,Ze,Be].includes(this._callState)}},{key:"sendMessageToCallMachine",value:function(o,h){if(this._destroyed&&(this._logUseAfterDestroy(),this.strictMode))throw new Error("Use after destroy");this._messageChannel.sendMessageToCallMachine(o,h,this.callClientId,this._iframe)}},{key:"forwardPackagedMessageToCallMachine",value:function(o){this._messageChannel.forwardPackagedMessageToCallMachine(o,this._iframe,this.callClientId)}},{key:"addListenerForPackagedMessagesFromCallMachine",value:function(o){return this._messageChannel.addListenerForPackagedMessagesFromCallMachine(o,this.callClientId)}},{key:"removeListenerForPackagedMessagesFromCallMachine",value:function(o){this._messageChannel.removeListenerForPackagedMessagesFromCallMachine(o)}},{key:"handleMessageFromCallMachine",value:function(o){switch(o.action){case nf:this.sendMessageToCallMachine(j({action:af},this.properties));break;case"call-machine-initialized":this._callMachineInitialized=!0;var h={action:fr,level:"log",code:1011,stats:{event:"bundle load",time:this._bundleLoadTime==="no-op"?0:this._bundleLoadTime,preLoaded:this._bundleLoadTime==="no-op",url:wr(this.properties.dailyConfig)}};this.sendMessageToCallMachine(h),this._delayDuplicateInstanceLog&&this._logDuplicateInstanceAttempt();break;case Co:this._loadedCallback&&(this._loadedCallback(),this._loadedCallback=null),this.emitDailyJSEvent(o);break;case hf:var d,p=j({},o);delete p.internal,this._maxAppMessageSize=((d=o.internal)===null||d===void 0?void 0:d._maxAppMessageSize)||rn,this._joinedCallback&&(this._joinedCallback(o.participants),this._joinedCallback=null),this.emitDailyJSEvent(p);break;case pf:case vf:if(this._callState===Ze)return;if(o.participant&&o.participant.session_id){var g=o.participant.local?"local":o.participant.session_id;if(this._callObjectMode){var w=this._callMachine().store;Uo(o.participant,w),Vo(o.participant,w),Jo(o.participant,this._participants[g],w)}try{this.maybeParticipantTracksStopped(this._participants[g],o.participant),this.maybeParticipantTracksStarted(this._participants[g],o.participant),this.maybeEventRecordingStopped(this._participants[g],o.participant),this.maybeEventRecordingStarted(this._participants[g],o.participant)}catch(zr){console.error("track events error",zr)}this.compareEqualForParticipantUpdateEvent(o.participant,this._participants[g])||(this._participants[g]=j({},o.participant),this.toggleParticipantAudioBasedOnNativeAudioFocus(),this.emitDailyJSEvent(o))}break;case gf:if(o.participant&&o.participant.session_id){var T=this._participants[o.participant.session_id];T&&this.maybeParticipantTracksStopped(T,null),delete this._participants[o.participant.session_id],this.emitDailyJSEvent(o)}break;case mf:se(this._participantCounts,o.participantCounts)||(this._participantCounts=o.participantCounts,this.emitDailyJSEvent(o));break;case yf:var E={access:o.access};o.awaitingAccess&&(E.awaitingAccess=o.awaitingAccess),se(this._accessState,E)||(this._accessState=E,this.emitDailyJSEvent(o));break;case bf:if(o.meetingSession){this._meetingSessionSummary=o.meetingSession,this.emitDailyJSEvent(o);var I=j(j({},o),{},{action:"meeting-session-updated"});this.emitDailyJSEvent(I)}break;case Oo:var q;this._iframe&&!o.preserveIframe&&(this._iframe.src=""),this._updateCallState(Be),this.resetMeetingDependentVars(),this._loadedCallback&&(this._loadedCallback(o.errorMsg),this._loadedCallback=null),o.preserveIframe;var $=ps(o,Tp);$!=null&&(q=$.error)!==null&&q!==void 0&&q.details&&($.error.details=JSON.parse($.error.details)),this._maybeSendToSentry(o),this._joinedCallback&&(this._joinedCallback(null,$),this._joinedCallback=null),this.emitDailyJSEvent($);break;case ff:this._callState!==Be&&this._updateCallState(Ze),this.resetMeetingDependentVars(),this._resolveLeave&&(this._resolveLeave(),this._resolveLeave=null),this.emitDailyJSEvent(o);break;case"selected-devices-updated":o.devices&&this.emitDailyJSEvent(o);break;case Vf:var ve=o.state,V=o.threshold,Ae=o.quality,L=ve.state,ee=ve.reasons;L===this._network.networkState&&se(ee,this._network.networkStateReasons)&&V===this._network.threshold&&Ae===this._network.quality||(this._network.networkState=L,this._network.networkStateReasons=ee,this._network.quality=Ae,this._network.threshold=V,o.networkState=L,ee.length&&(o.networkStateReasons=ee),delete o.state,this.emitDailyJSEvent(o));break;case zf:o&&o.cpuLoadState&&this.emitDailyJSEvent(o);break;case Wf:o&&o.faceCounts!==void 0&&this.emitDailyJSEvent(o);break;case Bf:var ce=o.activeSpeaker;this._activeSpeaker.peerId!==ce.peerId&&(this._activeSpeaker.peerId=ce.peerId,this.emitDailyJSEvent({action:o.action,activeSpeaker:this._activeSpeaker}));break;case"show-local-video-changed":if(this._callObjectMode)return;var Ke=o.show;this._showLocalVideo=Ke,this.emitDailyJSEvent({action:o.action,show:Ke});break;case Uf:var Re=o.enabled;this._activeSpeakerMode!==Re&&(this._activeSpeakerMode=Re,this.emitDailyJSEvent({action:o.action,enabled:this._activeSpeakerMode}));break;case wf:case Sf:case kf:this._waitingParticipants=o.allWaitingParticipants,this.emitDailyJSEvent({action:o.action,participant:o.participant});break;case Xf:se(this._receiveSettings,o.receiveSettings)||(this._receiveSettings=o.receiveSettings,this.emitDailyJSEvent({action:o.action,receiveSettings:o.receiveSettings}));break;case Eo:this._maybeUpdateInputSettings(o.inputSettings);break;case"send-settings-updated":se(this._sendSettings,o.sendSettings)||(this._sendSettings=o.sendSettings,this._preloadCache.sendSettings=null,this.emitDailyJSEvent({action:o.action,sendSettings:o.sendSettings}));break;case"local-audio-level":this._localAudioLevel=o.audioLevel,this._preloadCache.localAudioLevelObserver=null,this.emitDailyJSEvent(o);break;case"remote-participants-audio-level":this._remoteParticipantsAudioLevel=o.participantsAudioLevel,this._preloadCache.remoteParticipantsAudioLevelObserver=null,this.emitDailyJSEvent(o);break;case Lf:var ue=o.session_id;this._rmpPlayerState[ue]=o.playerState,this.emitDailyJSEvent(o);break;case Nf:delete this._rmpPlayerState[o.session_id],this.emitDailyJSEvent(o);break;case Df:var Z=o.session_id,Qe=this._rmpPlayerState[Z];Qe&&this.compareEqualForRMPUpdateEvent(Qe,o.remoteMediaPlayerState)||(this._rmpPlayerState[Z]=o.remoteMediaPlayerState,this.emitDailyJSEvent(o));break;case"custom-button-click":case"sidebar-view-changed":this.emitDailyJSEvent(o);break;case _f:var gt=this._meetingSessionState.topology!==(o.meetingSessionState&&o.meetingSessionState.topology);this._meetingSessionState=dn(o.meetingSessionState,this._callObjectMode),(this._callObjectMode||gt)&&this.emitDailyJSEvent(o);break;case qf:this._isScreenSharing=!0,this.emitDailyJSEvent(o);break;case Ff:case $f:this._isScreenSharing=!1,this.emitDailyJSEvent(o);break;case Mo:case To:case Of:case Pf:case If:case Tf:case Ef:case Af:case uf:case lf:case Rf:case xf:case"test-completed":case Jf:case jf:case Gf:case Hf:case Kf:case Qf:case Ao:case Yf:case"dialin-ready":case"dialin-connected":case"dialin-error":case"dialin-stopped":case"dialin-warning":case"dialout-connected":case"dialout-answered":case"dialout-error":case"dialout-stopped":case"dialout-warning":this.emitDailyJSEvent(o);break;case"request-fullscreen":this.requestFullscreen();break;case"request-exit-fullscreen":this.exitFullscreen()}}},{key:"maybeEventRecordingStopped",value:function(o,h){var d="record";o&&(h.local||h[d]!==!1||o[d]===h[d]||this.emitDailyJSEvent({action:To}))}},{key:"maybeEventRecordingStarted",value:function(o,h){var d="record";o&&(h.local||h[d]!==!0||o[d]===h[d]||this.emitDailyJSEvent({action:Mo}))}},{key:"_trackStatePlayable",value:function(o){return!(!o||o.state!==Xh)}},{key:"_trackChanged",value:function(o,h){return o?.id!==h?.id}},{key:"maybeEventTrackStopped",value:function(o,h,d){var p,g,w=(p=h?.tracks[o])!==null&&p!==void 0?p:null,T=(g=d?.tracks[o])!==null&&g!==void 0?g:null,E=w?.track;if(E){var I=this._trackStatePlayable(w),q=this._trackStatePlayable(T),$=this._trackChanged(E,T?.track);I&&(q&&!$||this.emitDailyJSEvent({action:Mf,track:E,participant:d??h,type:o}))}}},{key:"maybeEventTrackStarted",value:function(o,h,d){var p,g,w=(p=h?.tracks[o])!==null&&p!==void 0?p:null,T=(g=d?.tracks[o])!==null&&g!==void 0?g:null,E=T?.track;if(E){var I=this._trackStatePlayable(w),q=this._trackStatePlayable(T),$=this._trackChanged(w?.track,E);q&&(I&&!$||this.emitDailyJSEvent({action:Cf,track:E,participant:d,type:o}))}}},{key:"maybeParticipantTracksStopped",value:function(o,h){if(o)for(var d in o.tracks)this.maybeEventTrackStopped(d,o,h)}},{key:"maybeParticipantTracksStarted",value:function(o,h){if(h)for(var d in h.tracks)this.maybeEventTrackStarted(d,o,h)}},{key:"compareEqualForRMPUpdateEvent",value:function(o,h){var d,p;return o.state===h.state&&((d=o.settings)===null||d===void 0?void 0:d.volume)===((p=h.settings)===null||p===void 0?void 0:p.volume)}},{key:"emitDailyJSEvent",value:function(o){try{o.callClientId=this.callClientId,this.emit(o.action,o)}catch(h){console.log("could not emit",o,h)}}},{key:"compareEqualForParticipantUpdateEvent",value:function(o,h){return!!se(o,h)&&(!o.videoTrack||!h.videoTrack||o.videoTrack.id===h.videoTrack.id&&o.videoTrack.muted===h.videoTrack.muted&&o.videoTrack.enabled===h.videoTrack.enabled)&&(!o.audioTrack||!h.audioTrack||o.audioTrack.id===h.audioTrack.id&&o.audioTrack.muted===h.audioTrack.muted&&o.audioTrack.enabled===h.audioTrack.enabled)}},{key:"nativeUtils",value:function(){return J()?typeof DailyNativeUtils>"u"?(console.warn("in React Native, DailyNativeUtils is expected to be available"),null):DailyNativeUtils:null}},{key:"updateIsPreparingToJoin",value:function(o){this._updateCallState(this._callState,o)}},{key:"_updateCallState",value:function(o){var h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this._isPreparingToJoin;if(o!==this._callState||h!==this._isPreparingToJoin){var d=this._callState,p=this._isPreparingToJoin;this._callState=o,this._isPreparingToJoin=h;var g=this._callState===it;this.updateShowAndroidOngoingMeetingNotification(g);var w=_r(d,p),T=_r(this._callState,this._isPreparingToJoin);w!==T&&(this.updateKeepDeviceAwake(T),this.updateDeviceAudioMode(T),this.updateNoOpRecordingEnsuringBackgroundContinuity(T))}}},{key:"resetMeetingDependentVars",value:function(){this._participants={},this._participantCounts=rc,this._waitingParticipants={},this._activeSpeaker={},this._activeSpeakerMode=!1,this._didPreAuth=!1,this._accessState={access:tn},this._finalSummaryOfPrevSession=this._meetingSessionSummary,this._meetingSessionSummary={},this._meetingSessionState=dn(tc,this._callObjectMode),this._isScreenSharing=!1,this._receiveSettings={},this._inputSettings=void 0,this._sendSettings={},this._localAudioLevel=0,this._isLocalAudioLevelObserverRunning=!1,this._remoteParticipantsAudioLevel={},this._isRemoteParticipantsAudioLevelObserverRunning=!1,this._maxAppMessageSize=rn,this._callMachineInitialized=!1,this._bundleLoadTime=void 0,this._preloadCache}},{key:"updateKeepDeviceAwake",value:function(o){J()&&this.nativeUtils().setKeepDeviceAwake(o,this.callClientId)}},{key:"updateDeviceAudioMode",value:function(o){if(J()&&!this.disableReactNativeAutoDeviceManagement("audio")){var h=o?this._nativeInCallAudioMode:"idle";this.nativeUtils().setAudioMode(h)}}},{key:"updateShowAndroidOngoingMeetingNotification",value:function(o){if(J()&&this.nativeUtils().setShowOngoingMeetingNotification){var h,d,p,g;if(this.properties.reactNativeConfig&&this.properties.reactNativeConfig.androidInCallNotification){var w=this.properties.reactNativeConfig.androidInCallNotification;h=w.title,d=w.subtitle,p=w.iconName,g=w.disableForCustomOverride}g&&(o=!1),this.nativeUtils().setShowOngoingMeetingNotification(o,h,d,p,this.callClientId)}}},{key:"updateNoOpRecordingEnsuringBackgroundContinuity",value:function(o){J()&&this.nativeUtils().enableNoOpRecordingEnsuringBackgroundContinuity&&this.nativeUtils().enableNoOpRecordingEnsuringBackgroundContinuity(o)}},{key:"toggleParticipantAudioBasedOnNativeAudioFocus",value:function(){var o;if(J()){var h=(o=this._callMachine())===null||o===void 0||(o=o.store)===null||o===void 0?void 0:o.getState();for(var d in h?.streams){var p=h.streams[d];p&&p.pendingTrack&&p.pendingTrack.kind==="audio"&&(p.pendingTrack.enabled=this._hasNativeAudioFocus)}}}},{key:"disableReactNativeAutoDeviceManagement",value:function(o){return this.properties.reactNativeConfig&&this.properties.reactNativeConfig.disableAutoDeviceManagement&&this.properties.reactNativeConfig.disableAutoDeviceManagement[o]}},{key:"absoluteUrl",value:function(o){if(o!==void 0){var h=document.createElement("a");return h.href=o,h.href}}},{key:"sayHello",value:function(){var o="hello, world.";return console.log(o),o}},{key:"_logUseAfterDestroy",value:function(){var o=Object.values(et)[0];if(this.needsLoad())if(o&&!o.needsLoad()){var h={action:fr,level:"error",code:this.strictMode?9995:9997};o.sendMessageToCallMachine(h)}else this.strictMode||console.error("You are are attempting to use a call instance that was previously destroyed, which is unsupported. Please remove `strictMode: false` from your constructor properties to enable strict mode to track down and fix this unsupported usage.");else{var d={action:fr,level:"error",code:this.strictMode?9995:9997};this._messageChannel.sendMessageToCallMachine(d,null,this.callClientId,this._iframe)}}},{key:"_logDuplicateInstanceAttempt",value:function(){for(var o=0,h=Object.values(et);o<h.length;o++){var d=h[o];d._callMachineInitialized?(d.sendMessageToCallMachine({action:fr,level:"warn",code:this.allowMultipleCallInstances?9993:9992}),d._delayDuplicateInstanceLog=!1):d._delayDuplicateInstanceLog=!0}}},{key:"_maybeSendToSentry",value:function(o){var h,d,p,g;if(!((h=o.error)!==null&&h!==void 0&&h.type&&(![rf,tf,ko].includes(o.error.type)||o.error.type===ko&&o.error.msg.includes("deleted")))){var w=(d=this.properties)!==null&&d!==void 0&&d.url?new URL(this.properties.url):void 0,T="production";w&&w.host.includes(".staging.daily")&&(T="staging");var E,I,q,$,ve,V=(function(ue){const Z=[yh(),gh(),Jh(),Uh(),Kh(),Yh(),Sh(),Qh()];return ue.autoSessionTracking!==!1&&Z.push(Hh()),Z})({}).filter((function(ue){return!["BrowserApiErrors","Breadcrumbs","GlobalHandlers"].includes(ue.name)})),Ae=new Ph({dsn:"https://f10f1c81e5d44a4098416c0867a8b740@o77906.ingest.sentry.io/168844",transport:Lh,stackParser:Bh,integrations:V,environment:T}),L=new He;if(L.setClient(Ae),Ae.init(),this.session_id&&L.setExtra("sessionId",this.session_id),this.properties){var ee=j({},this.properties);ee.userName=ee.userName?"[Filtered]":void 0,ee.userData=ee.userData?"[Filtered]":void 0,ee.token=ee.token?"[Filtered]":void 0,L.setExtra("properties",ee)}if(w){var ce=w.searchParams.get("domain");if(!ce){var Ke=w.host.match(/(.*?)\./);ce=Ke&&Ke[1]||""}ce&&L.setTag("domain",ce)}o.error&&(L.setTag("fatalErrorType",o.error.type),L.setExtra("errorDetails",o.error.details),!((E=o.error.details)===null||E===void 0)&&E.uri&&L.setTag("serverAddress",o.error.details.uri),!((I=o.error.details)===null||I===void 0)&&I.workerGroup&&L.setTag("workerGroup",o.error.details.workerGroup),!((q=o.error.details)===null||q===void 0)&&q.geoGroup&&L.setTag("geoGroup",o.error.details.geoGroup),!(($=o.error.details)===null||$===void 0)&&$.on&&L.setTag("connectionAttempt",o.error.details.on),(ve=o.error.details)!==null&&ve!==void 0&&ve.bundleUrl&&(L.setTag("bundleUrl",o.error.details.bundleUrl),L.setTag("bundleError",o.error.details.sourceError.type))),L.setTags({callMode:this._callObjectMode?J()?"reactNative":(p=this.properties)!==null&&p!==void 0&&(p=p.dailyConfig)!==null&&p!==void 0&&(p=p.callMode)!==null&&p!==void 0&&p.includes("prebuilt")?this.properties.dailyConfig.callMode:"custom":"prebuilt-frame",version:r.version()});var Re=((g=o.error)===null||g===void 0?void 0:g.msg)||o.errorMsg;L.captureException(new Error(Re))}}},{key:"_callMachine",value:function(){var o;return(o=window._daily)===null||o===void 0||(o=o.instances)===null||o===void 0||(o=o[this.callClientId])===null||o===void 0?void 0:o.callMachine}},{key:"_maybeUpdateInputSettings",value:function(o){if(!se(this._inputSettings,o)){var h=this._getInputSettings();this._inputSettings=o;var d=this._getInputSettings();se(h,d)||this.emitDailyJSEvent({action:Eo,inputSettings:d})}}}],[{key:"supportedBrowser",value:function(){if(J())return{supported:!0,mobile:!0,name:"React Native",version:null,supportsScreenShare:!0,supportsSfu:!0,supportsVideoProcessing:!1,supportsAudioProcessing:!1};var o=qd.getParser(be());return{supported:!!Lo(),mobile:o.getPlatformType()==="mobile",name:o.getBrowserName(),version:o.getBrowserVersion(),supportsFullscreen:!!xo(),supportsScreenShare:!!tp(),supportsSfu:!!Lo(),supportsVideoProcessing:xl(),supportsAudioProcessing:Ll()}}},{key:"version",value:function(){return"0.83.1"}},{key:"createCallObject",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return o.layout="none",new r(null,o)}},{key:"wrap",value:function(o){var h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(B(),!o||!o.contentWindow||typeof o.src!="string")throw new Error("DailyIframe::Wrap needs an iframe-like first argument");return h.layout||(h.customLayout?h.layout="custom-v1":h.layout="browser"),new r(o,h)}},{key:"createFrame",value:function(o,h){var d,p;B(),o&&h?(d=o,p=h):o&&o.append?(d=o,p={}):(d=document.body,p=o||{});var g=p.iframeStyle;g||(g=d===document.body?{position:"fixed",border:"1px solid black",backgroundColor:"white",width:"375px",height:"450px",right:"1em",bottom:"1em"}:{border:0,width:"100%",height:"100%"});var w=document.createElement("iframe");window.navigator&&window.navigator.userAgent.match(/Chrome\/61\./)?w.allow="microphone, camera":w.allow="microphone; camera; autoplay; display-capture; screen-wake-lock",w.style.visibility="hidden",d.appendChild(w),w.style.visibility=null,Object.keys(g).forEach((function(T){return w.style[T]=g[T]})),p.layout||(p.customLayout?p.layout="custom-v1":p.layout="browser");try{return new r(w,p)}catch(T){throw d.removeChild(w),T}}},{key:"createTransparentFrame",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};B();var h=document.createElement("iframe");return h.allow="microphone; camera; autoplay",h.style.cssText=`
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      border: 0;
      pointer-events: none;
    `,document.body.appendChild(h),o.layout||(o.layout="custom-v1"),r.wrap(h,o)}},{key:"getCallInstance",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:void 0;return o?et[o]:Object.values(et)[0]}}]);var e,t,n,i,a,s,c,u,l,f,v,b,k,y,m,_,S,C,A,O,P,x,U,Y,Q,pe,F,_e,Fe,Pt,Ht,Kt,Qt,It,Yt,Xt,Zt,er})();function yt(r,e){var t={};for(var n in r)if(r[n]instanceof MediaStreamTrack)console.warn("MediaStreamTrack found in props or cache.",n),t[n]=Ne;else if(n==="dailyConfig"){if(r[n].modifyLocalSdpHook){var i=window._daily.instances[e].customCallbacks||{};i.modifyLocalSdpHook=r[n].modifyLocalSdpHook,window._daily.instances[e].customCallbacks=i,delete r[n].modifyLocalSdpHook}if(r[n].modifyRemoteSdpHook){var a=window._daily.instances[e].customCallbacks||{};a.modifyRemoteSdpHook=r[n].modifyRemoteSdpHook,window._daily.instances[e].customCallbacks=a,delete r[n].modifyRemoteSdpHook}t[n]=r[n]}else t[n]=r[n];return t}function H(r){var e=arguments.length>2?arguments[2]:void 0;if(r!==it){var t="".concat(arguments.length>1&&arguments[1]!==void 0?arguments[1]:"This daily-js method"," only supported after join.");throw e&&(t+=" ".concat(e)),console.error(t),new Error(t)}}function _r(r,e){return[Aa,it].includes(r)||e}function un(r,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"This daily-js method",n=arguments.length>3?arguments[3]:void 0;if(_r(r,e)){var i="".concat(t," not supported after joining a meeting.");throw n&&(i+=" ".concat(n)),console.error(i),new Error(i)}}function gr(r){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"This daily-js method",t=arguments.length>2?arguments[2]:void 0;if(!r){var n="".concat(e,arguments.length>3&&arguments[3]!==void 0&&arguments[3]?" requires preAuth() or startCamera() to initialize call state.":" requires preAuth(), startCamera(), or join() to initialize call state.");throw t&&(n+=" ".concat(t)),console.error(n),new Error(n)}}function ln(r){if(r){var e="A pre-call quality test is in progress. Please try ".concat(arguments.length>1&&arguments[1]!==void 0?arguments[1]:"This daily-js method"," again once testing has completed. Use stopTestCallQuality() to end it early.");throw console.error(e),new Error(e)}}function we(r){if(!r){var e="".concat(arguments.length>1&&arguments[1]!==void 0?arguments[1]:"This daily-js method"," is only supported on custom callObject instances");throw console.error(e),new Error(e)}}function le(r){if(r){var e="".concat(arguments.length>1&&arguments[1]!==void 0?arguments[1]:"This daily-js method"," is only supported as part of Daily's Prebuilt");throw console.error(e),new Error(e)}}function B(){if(J())throw new Error("This daily-js method is not currently supported in React Native")}function Rt(){if(!J())throw new Error("This daily-js method is only supported in React Native")}function Hl(r){if(r===void 0)return!0;var e;if(typeof r=="string")e=r;else try{e=JSON.stringify(r),se(JSON.parse(e),r)||console.warn("The userData provided will be modified when serialized.")}catch(t){throw Error("userData must be serializable to JSON: ".concat(t))}if(e.length>4096)throw Error("userData is too large (".concat(e.length," characters). Maximum size suppported is ").concat(4096,"."));return!0}function Kl(r,e){for(var t=e.allowAllParticipantsKey,n=function(v){var b=["local"];return t||b.push("*"),v&&!b.includes(v)},i=function(v){return!!(v.layer===void 0||Number.isInteger(v.layer)&&v.layer>=0||v.layer==="inherit")},a=function(v){return!!v&&!(v.video&&!i(v.video))&&!(v.screenVideo&&!i(v.screenVideo))},s=0,c=Object.entries(r);s<c.length;s++){var u=ie(c[s],2),l=u[0],f=u[1];if(!n(l)||!a(f))return!1}return!0}function Ql(r){if(z(r)!=="object")return!1;for(var e=0,t=Object.entries(r);e<t.length;e++){var n=ie(t[e],2),i=n[0],a=n[1];switch(i){case"video":if(z(a)!=="object")return!1;for(var s=0,c=Object.entries(a);s<c.length;s++){var u=ie(c[s],2),l=u[0],f=u[1];switch(l){case"processor":if(!Op(f))return!1;break;case"settings":if(!sc(f))return!1;break;default:return!1}}break;case"audio":if(z(a)!=="object")return!1;for(var v=0,b=Object.entries(a);v<b.length;v++){var k=ie(b[v],2),y=k[0],m=k[1];switch(y){case"processor":if(!Ap(m))return!1;break;case"settings":if(!sc(m))return!1;break;default:return!1}}break;default:return!1}}return!0}function Yl(r,e,t){var n,i=[];r.video&&r.video.processor&&(xl((n=e?.useLegacyVideoProcessor)!==null&&n!==void 0&&n)||(r.video.settings?delete r.video.processor:delete r.video,i.push("video"))),r.audio&&r.audio.processor&&(Ll()||(r.audio.settings?delete r.audio.processor:delete r.audio,i.push("audio"))),i.length>0&&console.error("Ignoring settings for browser- or platform-unsupported input processor(s): ".concat(i.join(", "))),r.audio&&r.audio.settings&&(r.audio.settings.customTrack?(t.audioTrack=r.audio.settings.customTrack,r.audio.settings={customTrack:Ne}):delete t.audioTrack),r.video&&r.video.settings&&(r.video.settings.customTrack?(t.videoTrack=r.video.settings.customTrack,r.video.settings={customTrack:Ne}):delete t.videoTrack)}function Ap(r){if(J())return console.warn("Video processing is not yet supported in React Native"),!1;var e=["type"];return!!r&&z(r)==="object"&&(Object.keys(r).filter((function(t){return!e.includes(t)})).forEach((function(t){console.warn("invalid key inputSettings -> audio -> processor : ".concat(t)),delete r[t]})),!!(function(t){return typeof t!="string"?!1:Object.values(jl).includes(t)?!0:(console.error("inputSettings audio processor type invalid"),!1)})(r.type))}function Op(r){if(J())return console.warn("Video processing is not yet supported in React Native"),!1;var e=["type","config"];return!r||z(r)!=="object"||!(function(t){return typeof t!="string"?!1:Object.values(br).includes(t)?!0:(console.error("inputSettings video processor type invalid"),!1)})(r.type)||r.config&&(z(r.config)!=="object"||!(function(t,n){var i=Object.keys(n);if(i.length===0)return!0;var a="invalid object in inputSettings -> video -> processor -> config";switch(t){case br.BGBLUR:return i.length>1||i[0]!=="strength"?(console.error(a),!1):!(typeof n.strength!="number"||n.strength<=0||n.strength>1||isNaN(n.strength))||(console.error("".concat(a,"; expected: {0 < strength <= 1}, got: ").concat(n.strength)),!1);case br.BGIMAGE:return!(n.source!==void 0&&!(function(s){if(s.source==="default")return s.type="default",!0;if(s.source instanceof ArrayBuffer)return!0;if(Sr(s.source))return s.type="url",!!(function(l){var f=new URL(l),v=f.pathname;if(f.protocol==="data:")try{var b=v.substring(v.indexOf(":")+1,v.indexOf(";")).split("/")[1];return an.includes(b)}catch(y){return console.error("failed to deduce blob content type",y),!1}var k=v.split(".").at(-1).toLowerCase().trim();return an.includes(k)})(s.source)||(console.error("invalid image type; supported types: [".concat(an.join(", "),"]")),!1);return c=s.source,u=Number(c),isNaN(u)||!Number.isInteger(u)||u<=0||u>10?(console.error("invalid image selection; must be an int, > 0, <= ".concat(10)),!1):(s.type="daily-preselect",!0);var c,u})(n));default:return!0}})(r.type,r.config))?!1:(Object.keys(r).filter((function(t){return!e.includes(t)})).forEach((function(t){console.warn("invalid key inputSettings -> video -> processor : ".concat(t)),delete r[t]})),!0)}function sc(r){return z(r)==="object"&&(!r.customTrack||r.customTrack instanceof MediaStreamTrack)}function La(){var r=Object.values(br).join(" | "),e=Object.values(jl).join(" | ");return"inputSettings must be of the form: { video?: { processor?: { type: [ ".concat(r," ], config?: {} } }, audio?: { processor: {type: [ ").concat(e," ] } } }")}function Xl(r){var e=r.allowAllParticipantsKey;return"receiveSettings must be of the form { [<remote participant id> | ".concat(ef).concat(e?' | "'.concat("*",'"'):"","]: ")+'{ [video: [{ layer: [<non-negative integer> | "inherit"] } | "inherit"]], [screenVideo: [{ layer: [<non-negative integer> | "inherit"] } | "inherit"]] }}}'}function Zl(){return"customIntegrations should be an object of type ".concat(JSON.stringify(xa),".")}function ed(r){if(r&&z(r)!=="object"||Array.isArray(r))return console.error("customTrayButtons should be an Object of the type ".concat(JSON.stringify(Or),".")),!1;if(r)for(var e=0,t=Object.entries(r);e<t.length;e++)for(var n=ie(t[e],1)[0],i=0,a=Object.entries(r[n]);i<a.length;i++){var s=ie(a[i],2),c=s[0],u=s[1],l=Or.id[c];if(!l)return console.error("customTrayButton does not support key ".concat(c)),!1;switch(c){case"iconPath":case"iconPathDarkMode":if(!Sr(u))return console.error("customTrayButton ".concat(c," should be a url.")),!1;break;case"visualState":if(!["default","sidebar-open","active"].includes(u))return console.error("customTrayButton ".concat(c," should be ").concat(l,". Got: ").concat(u)),!1;break;default:if(z(u)!==l)return console.error("customTrayButton ".concat(c," should be a ").concat(l,".")),!1}}return!0}function td(r){if(!r||r&&z(r)!=="object"||Array.isArray(r))return console.error(Zl()),!1;for(var e=function(v){return"".concat(v," should be ").concat(xa.id[v])},t=function(v,b){return console.error("customIntegration ".concat(v,": ").concat(b))},n=0,i=Object.entries(r);n<i.length;n++){var a=ie(i[n],1)[0];if(!("label"in r[a]))return t(a,"label is required"),!1;if(!("location"in r[a]))return t(a,"location is required"),!1;if(!("src"in r[a])&&!("srcdoc"in r[a]))return t(a,"src or srcdoc is required"),!1;for(var s=0,c=Object.entries(r[a]);s<c.length;s++){var u=ie(c[s],2),l=u[0],f=u[1];switch(l){case"allow":case"csp":case"name":case"referrerPolicy":case"sandbox":if(typeof f!="string")return t(a,e(l)),!1;break;case"iconURL":if(!Sr(f))return t(a,"".concat(l," should be a url")),!1;break;case"src":if("srcdoc"in r[a])return t(a,"cannot have both src and srcdoc"),!1;if(!Sr(f))return t(a,'src "'.concat(f,'" is not a valid URL')),!1;break;case"srcdoc":if("src"in r[a])return t(a,"cannot have both src and srcdoc"),!1;if(typeof f!="string")return t(a,e(l)),!1;break;case"location":if(!["main","sidebar"].includes(f))return t(a,e(l)),!1;break;case"controlledBy":if(f!=="*"&&f!=="owners"&&(!Array.isArray(f)||f.some((function(v){return typeof v!="string"}))))return t(a,e(l)),!1;break;case"shared":if((!Array.isArray(f)||f.some((function(v){return typeof v!="string"})))&&f!=="owners"&&typeof f!="boolean")return t(a,e(l)),!1;break;default:if(!xa.id[l])return console.error("customIntegration does not support key ".concat(l)),!1}}}return!0}function rd(r,e){if(e===void 0)return!1;switch(z(e)){case"string":return z(r)===e;case"object":if(z(r)!=="object")return!1;for(var t in r)if(!rd(r[t],e[t]))return!1;return!0;default:return!1}}function oc(r,e){var t=r.sessionId,n=r.toEndPoint,i=r.callerId,a=r.useSipRefer;if(!t||!n)throw new Error("".concat(e,"() requires a sessionId and toEndPoint"));if(typeof t!="string"||typeof n!="string")throw new Error("Invalid paramater: sessionId and toEndPoint must be of type string");if(a&&!n.startsWith("sip:"))throw new Error('"toEndPoint" must be a "sip" address');if(!n.startsWith("sip:")&&!n.startsWith("+"))throw new Error("toEndPoint: ".concat(n,' must starts with either "sip:" or "+"'));if(i&&typeof i!="string")throw new Error("callerId must be of type string");if(i&&!n.startsWith("+"))throw new Error("callerId is only valid when transferring to a PSTN number")}function cc(r){if(z(r)!=="object")throw new Error('RemoteMediaPlayerSettings: must be "object" type');if(r.state&&!Object.values(Oa).includes(r.state))throw new Error("Invalid value for RemoteMediaPlayerSettings.state, valid values are: "+JSON.stringify(Oa));if(r.volume){if(typeof r.volume!="number")throw new Error('RemoteMediaPlayerSettings.volume: must be "number" type');if(r.volume<0||r.volume>2)throw new Error("RemoteMediaPlayerSettings.volume: must be between 0.0 - 2.0")}}function uc(r,e,t){return!(typeof r!="number"||r<e||r>t)}function dn(r,e){return r&&!e&&delete r.data,r}var hn,lc;function Pp(){if(lc)return hn;lc=1;function r(){this.__data__=[],this.size=0}return hn=r,hn}var fn,dc;function nd(){if(dc)return fn;dc=1;function r(e,t){return e===t||e!==e&&t!==t}return fn=r,fn}var pn,hc;function Fr(){if(hc)return pn;hc=1;var r=nd();function e(t,n){for(var i=t.length;i--;)if(r(t[i][0],n))return i;return-1}return pn=e,pn}var vn,fc;function Ip(){if(fc)return vn;fc=1;var r=Fr(),e=Array.prototype,t=e.splice;function n(i){var a=this.__data__,s=r(a,i);if(s<0)return!1;var c=a.length-1;return s==c?a.pop():t.call(a,s,1),--this.size,!0}return vn=n,vn}var gn,pc;function jp(){if(pc)return gn;pc=1;var r=Fr();function e(t){var n=this.__data__,i=r(n,t);return i<0?void 0:n[i][1]}return gn=e,gn}var mn,vc;function Rp(){if(vc)return mn;vc=1;var r=Fr();function e(t){return r(this.__data__,t)>-1}return mn=e,mn}var yn,gc;function xp(){if(gc)return yn;gc=1;var r=Fr();function e(t,n){var i=this.__data__,a=r(i,t);return a<0?(++this.size,i.push([t,n])):i[a][1]=n,this}return yn=e,yn}var bn,mc;function $r(){if(mc)return bn;mc=1;var r=Pp(),e=Ip(),t=jp(),n=Rp(),i=xp();function a(s){var c=-1,u=s==null?0:s.length;for(this.clear();++c<u;){var l=s[c];this.set(l[0],l[1])}}return a.prototype.clear=r,a.prototype.delete=e,a.prototype.get=t,a.prototype.has=n,a.prototype.set=i,bn=a,bn}var _n,yc;function Lp(){if(yc)return _n;yc=1;var r=$r();function e(){this.__data__=new r,this.size=0}return _n=e,_n}var wn,bc;function Dp(){if(bc)return wn;bc=1;function r(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n}return wn=r,wn}var Sn,_c;function Np(){if(_c)return Sn;_c=1;function r(e){return this.__data__.get(e)}return Sn=r,Sn}var kn,wc;function qp(){if(wc)return kn;wc=1;function r(e){return this.__data__.has(e)}return kn=r,kn}var Cn,Sc;function id(){if(Sc)return Cn;Sc=1;var r=typeof tr=="object"&&tr&&tr.Object===Object&&tr;return Cn=r,Cn}var Mn,kc;function je(){if(kc)return Mn;kc=1;var r=id(),e=typeof self=="object"&&self&&self.Object===Object&&self,t=r||e||Function("return this")();return Mn=t,Mn}var Tn,Cc;function Qa(){if(Cc)return Tn;Cc=1;var r=je(),e=r.Symbol;return Tn=e,Tn}var En,Mc;function Fp(){if(Mc)return En;Mc=1;var r=Qa(),e=Object.prototype,t=e.hasOwnProperty,n=e.toString,i=r?r.toStringTag:void 0;function a(s){var c=t.call(s,i),u=s[i];try{s[i]=void 0;var l=!0}catch{}var f=n.call(s);return l&&(c?s[i]=u:delete s[i]),f}return En=a,En}var An,Tc;function $p(){if(Tc)return An;Tc=1;var r=Object.prototype,e=r.toString;function t(n){return e.call(n)}return An=t,An}var On,Ec;function Br(){if(Ec)return On;Ec=1;var r=Qa(),e=Fp(),t=$p(),n="[object Null]",i="[object Undefined]",a=r?r.toStringTag:void 0;function s(c){return c==null?c===void 0?i:n:a&&a in Object(c)?e(c):t(c)}return On=s,On}var Pn,Ac;function Wt(){if(Ac)return Pn;Ac=1;function r(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}return Pn=r,Pn}var In,Oc;function ad(){if(Oc)return In;Oc=1;var r=Br(),e=Wt(),t="[object AsyncFunction]",n="[object Function]",i="[object GeneratorFunction]",a="[object Proxy]";function s(c){if(!e(c))return!1;var u=r(c);return u==n||u==i||u==t||u==a}return In=s,In}var jn,Pc;function Bp(){if(Pc)return jn;Pc=1;var r=je(),e=r["__core-js_shared__"];return jn=e,jn}var Rn,Ic;function Up(){if(Ic)return Rn;Ic=1;var r=Bp(),e=(function(){var n=/[^.]+$/.exec(r&&r.keys&&r.keys.IE_PROTO||"");return n?"Symbol(src)_1."+n:""})();function t(n){return!!e&&e in n}return Rn=t,Rn}var xn,jc;function sd(){if(jc)return xn;jc=1;var r=Function.prototype,e=r.toString;function t(n){if(n!=null){try{return e.call(n)}catch{}try{return n+""}catch{}}return""}return xn=t,xn}var Ln,Rc;function Vp(){if(Rc)return Ln;Rc=1;var r=ad(),e=Up(),t=Wt(),n=sd(),i=/[\\^$.*+?()[\]{}|]/g,a=/^\[object .+?Constructor\]$/,s=Function.prototype,c=Object.prototype,u=s.toString,l=c.hasOwnProperty,f=RegExp("^"+u.call(l).replace(i,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function v(b){if(!t(b)||e(b))return!1;var k=r(b)?f:a;return k.test(n(b))}return Ln=v,Ln}var Dn,xc;function Jp(){if(xc)return Dn;xc=1;function r(e,t){return e?.[t]}return Dn=r,Dn}var Nn,Lc;function vt(){if(Lc)return Nn;Lc=1;var r=Vp(),e=Jp();function t(n,i){var a=e(n,i);return r(a)?a:void 0}return Nn=t,Nn}var qn,Dc;function Ya(){if(Dc)return qn;Dc=1;var r=vt(),e=je(),t=r(e,"Map");return qn=t,qn}var Fn,Nc;function Ur(){if(Nc)return Fn;Nc=1;var r=vt(),e=r(Object,"create");return Fn=e,Fn}var $n,qc;function zp(){if(qc)return $n;qc=1;var r=Ur();function e(){this.__data__=r?r(null):{},this.size=0}return $n=e,$n}var Bn,Fc;function Wp(){if(Fc)return Bn;Fc=1;function r(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}return Bn=r,Bn}var Un,$c;function Gp(){if($c)return Un;$c=1;var r=Ur(),e="__lodash_hash_undefined__",t=Object.prototype,n=t.hasOwnProperty;function i(a){var s=this.__data__;if(r){var c=s[a];return c===e?void 0:c}return n.call(s,a)?s[a]:void 0}return Un=i,Un}var Vn,Bc;function Hp(){if(Bc)return Vn;Bc=1;var r=Ur(),e=Object.prototype,t=e.hasOwnProperty;function n(i){var a=this.__data__;return r?a[i]!==void 0:t.call(a,i)}return Vn=n,Vn}var Jn,Uc;function Kp(){if(Uc)return Jn;Uc=1;var r=Ur(),e="__lodash_hash_undefined__";function t(n,i){var a=this.__data__;return this.size+=this.has(n)?0:1,a[n]=r&&i===void 0?e:i,this}return Jn=t,Jn}var zn,Vc;function Qp(){if(Vc)return zn;Vc=1;var r=zp(),e=Wp(),t=Gp(),n=Hp(),i=Kp();function a(s){var c=-1,u=s==null?0:s.length;for(this.clear();++c<u;){var l=s[c];this.set(l[0],l[1])}}return a.prototype.clear=r,a.prototype.delete=e,a.prototype.get=t,a.prototype.has=n,a.prototype.set=i,zn=a,zn}var Wn,Jc;function Yp(){if(Jc)return Wn;Jc=1;var r=Qp(),e=$r(),t=Ya();function n(){this.size=0,this.__data__={hash:new r,map:new(t||e),string:new r}}return Wn=n,Wn}var Gn,zc;function Xp(){if(zc)return Gn;zc=1;function r(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}return Gn=r,Gn}var Hn,Wc;function Vr(){if(Wc)return Hn;Wc=1;var r=Xp();function e(t,n){var i=t.__data__;return r(n)?i[typeof n=="string"?"string":"hash"]:i.map}return Hn=e,Hn}var Kn,Gc;function Zp(){if(Gc)return Kn;Gc=1;var r=Vr();function e(t){var n=r(this,t).delete(t);return this.size-=n?1:0,n}return Kn=e,Kn}var Qn,Hc;function ev(){if(Hc)return Qn;Hc=1;var r=Vr();function e(t){return r(this,t).get(t)}return Qn=e,Qn}var Yn,Kc;function tv(){if(Kc)return Yn;Kc=1;var r=Vr();function e(t){return r(this,t).has(t)}return Yn=e,Yn}var Xn,Qc;function rv(){if(Qc)return Xn;Qc=1;var r=Vr();function e(t,n){var i=r(this,t),a=i.size;return i.set(t,n),this.size+=i.size==a?0:1,this}return Xn=e,Xn}var Zn,Yc;function nv(){if(Yc)return Zn;Yc=1;var r=Yp(),e=Zp(),t=ev(),n=tv(),i=rv();function a(s){var c=-1,u=s==null?0:s.length;for(this.clear();++c<u;){var l=s[c];this.set(l[0],l[1])}}return a.prototype.clear=r,a.prototype.delete=e,a.prototype.get=t,a.prototype.has=n,a.prototype.set=i,Zn=a,Zn}var ei,Xc;function iv(){if(Xc)return ei;Xc=1;var r=$r(),e=Ya(),t=nv(),n=200;function i(a,s){var c=this.__data__;if(c instanceof r){var u=c.__data__;if(!e||u.length<n-1)return u.push([a,s]),this.size=++c.size,this;c=this.__data__=new t(u)}return c.set(a,s),this.size=c.size,this}return ei=i,ei}var ti,Zc;function av(){if(Zc)return ti;Zc=1;var r=$r(),e=Lp(),t=Dp(),n=Np(),i=qp(),a=iv();function s(c){var u=this.__data__=new r(c);this.size=u.size}return s.prototype.clear=e,s.prototype.delete=t,s.prototype.get=n,s.prototype.has=i,s.prototype.set=a,ti=s,ti}var ri,eu;function sv(){if(eu)return ri;eu=1;function r(e,t){for(var n=-1,i=e==null?0:e.length;++n<i&&t(e[n],n,e)!==!1;);return e}return ri=r,ri}var ni,tu;function ov(){if(tu)return ni;tu=1;var r=vt(),e=(function(){try{var t=r(Object,"defineProperty");return t({},"",{}),t}catch{}})();return ni=e,ni}var ii,ru;function od(){if(ru)return ii;ru=1;var r=ov();function e(t,n,i){n=="__proto__"&&r?r(t,n,{configurable:!0,enumerable:!0,value:i,writable:!0}):t[n]=i}return ii=e,ii}var ai,nu;function cd(){if(nu)return ai;nu=1;var r=od(),e=nd(),t=Object.prototype,n=t.hasOwnProperty;function i(a,s,c){var u=a[s];(!(n.call(a,s)&&e(u,c))||c===void 0&&!(s in a))&&r(a,s,c)}return ai=i,ai}var si,iu;function Jr(){if(iu)return si;iu=1;var r=cd(),e=od();function t(n,i,a,s){var c=!a;a||(a={});for(var u=-1,l=i.length;++u<l;){var f=i[u],v=s?s(a[f],n[f],f,a,n):void 0;v===void 0&&(v=n[f]),c?e(a,f,v):r(a,f,v)}return a}return si=t,si}var oi,au;function cv(){if(au)return oi;au=1;function r(e,t){for(var n=-1,i=Array(e);++n<e;)i[n]=t(n);return i}return oi=r,oi}var ci,su;function Gt(){if(su)return ci;su=1;function r(e){return e!=null&&typeof e=="object"}return ci=r,ci}var ui,ou;function uv(){if(ou)return ui;ou=1;var r=Br(),e=Gt(),t="[object Arguments]";function n(i){return e(i)&&r(i)==t}return ui=n,ui}var li,cu;function lv(){if(cu)return li;cu=1;var r=uv(),e=Gt(),t=Object.prototype,n=t.hasOwnProperty,i=t.propertyIsEnumerable,a=r((function(){return arguments})())?r:function(s){return e(s)&&n.call(s,"callee")&&!i.call(s,"callee")};return li=a,li}var di,uu;function Xa(){if(uu)return di;uu=1;var r=Array.isArray;return di=r,di}var Dt={exports:{}},hi,lu;function dv(){if(lu)return hi;lu=1;function r(){return!1}return hi=r,hi}Dt.exports;var du;function ud(){return du||(du=1,(function(r,e){var t=je(),n=dv(),i=e&&!e.nodeType&&e,a=i&&!0&&r&&!r.nodeType&&r,s=a&&a.exports===i,c=s?t.Buffer:void 0,u=c?c.isBuffer:void 0,l=u||n;r.exports=l})(Dt,Dt.exports)),Dt.exports}var fi,hu;function hv(){if(hu)return fi;hu=1;var r=9007199254740991,e=/^(?:0|[1-9]\d*)$/;function t(n,i){var a=typeof n;return i=i??r,!!i&&(a=="number"||a!="symbol"&&e.test(n))&&n>-1&&n%1==0&&n<i}return fi=t,fi}var pi,fu;function ld(){if(fu)return pi;fu=1;var r=9007199254740991;function e(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=r}return pi=e,pi}var vi,pu;function fv(){if(pu)return vi;pu=1;var r=Br(),e=ld(),t=Gt(),n="[object Arguments]",i="[object Array]",a="[object Boolean]",s="[object Date]",c="[object Error]",u="[object Function]",l="[object Map]",f="[object Number]",v="[object Object]",b="[object RegExp]",k="[object Set]",y="[object String]",m="[object WeakMap]",_="[object ArrayBuffer]",S="[object DataView]",C="[object Float32Array]",A="[object Float64Array]",O="[object Int8Array]",P="[object Int16Array]",x="[object Int32Array]",U="[object Uint8Array]",Y="[object Uint8ClampedArray]",Q="[object Uint16Array]",pe="[object Uint32Array]",F={};F[C]=F[A]=F[O]=F[P]=F[x]=F[U]=F[Y]=F[Q]=F[pe]=!0,F[n]=F[i]=F[_]=F[a]=F[S]=F[s]=F[c]=F[u]=F[l]=F[f]=F[v]=F[b]=F[k]=F[y]=F[m]=!1;function _e(Fe){return t(Fe)&&e(Fe.length)&&!!F[r(Fe)]}return vi=_e,vi}var gi,vu;function Za(){if(vu)return gi;vu=1;function r(e){return function(t){return e(t)}}return gi=r,gi}var Nt={exports:{}};Nt.exports;var gu;function es(){return gu||(gu=1,(function(r,e){var t=id(),n=e&&!e.nodeType&&e,i=n&&!0&&r&&!r.nodeType&&r,a=i&&i.exports===n,s=a&&t.process,c=(function(){try{var u=i&&i.require&&i.require("util").types;return u||s&&s.binding&&s.binding("util")}catch{}})();r.exports=c})(Nt,Nt.exports)),Nt.exports}var mi,mu;function pv(){if(mu)return mi;mu=1;var r=fv(),e=Za(),t=es(),n=t&&t.isTypedArray,i=n?e(n):r;return mi=i,mi}var yi,yu;function dd(){if(yu)return yi;yu=1;var r=cv(),e=lv(),t=Xa(),n=ud(),i=hv(),a=pv(),s=Object.prototype,c=s.hasOwnProperty;function u(l,f){var v=t(l),b=!v&&e(l),k=!v&&!b&&n(l),y=!v&&!b&&!k&&a(l),m=v||b||k||y,_=m?r(l.length,String):[],S=_.length;for(var C in l)(f||c.call(l,C))&&!(m&&(C=="length"||k&&(C=="offset"||C=="parent")||y&&(C=="buffer"||C=="byteLength"||C=="byteOffset")||i(C,S)))&&_.push(C);return _}return yi=u,yi}var bi,bu;function ts(){if(bu)return bi;bu=1;var r=Object.prototype;function e(t){var n=t&&t.constructor,i=typeof n=="function"&&n.prototype||r;return t===i}return bi=e,bi}var _i,_u;function hd(){if(_u)return _i;_u=1;function r(e,t){return function(n){return e(t(n))}}return _i=r,_i}var wi,wu;function vv(){if(wu)return wi;wu=1;var r=hd(),e=r(Object.keys,Object);return wi=e,wi}var Si,Su;function gv(){if(Su)return Si;Su=1;var r=ts(),e=vv(),t=Object.prototype,n=t.hasOwnProperty;function i(a){if(!r(a))return e(a);var s=[];for(var c in Object(a))n.call(a,c)&&c!="constructor"&&s.push(c);return s}return Si=i,Si}var ki,ku;function fd(){if(ku)return ki;ku=1;var r=ad(),e=ld();function t(n){return n!=null&&e(n.length)&&!r(n)}return ki=t,ki}var Ci,Cu;function rs(){if(Cu)return Ci;Cu=1;var r=dd(),e=gv(),t=fd();function n(i){return t(i)?r(i):e(i)}return Ci=n,Ci}var Mi,Mu;function mv(){if(Mu)return Mi;Mu=1;var r=Jr(),e=rs();function t(n,i){return n&&r(i,e(i),n)}return Mi=t,Mi}var Ti,Tu;function yv(){if(Tu)return Ti;Tu=1;function r(e){var t=[];if(e!=null)for(var n in Object(e))t.push(n);return t}return Ti=r,Ti}var Ei,Eu;function bv(){if(Eu)return Ei;Eu=1;var r=Wt(),e=ts(),t=yv(),n=Object.prototype,i=n.hasOwnProperty;function a(s){if(!r(s))return t(s);var c=e(s),u=[];for(var l in s)l=="constructor"&&(c||!i.call(s,l))||u.push(l);return u}return Ei=a,Ei}var Ai,Au;function ns(){if(Au)return Ai;Au=1;var r=dd(),e=bv(),t=fd();function n(i){return t(i)?r(i,!0):e(i)}return Ai=n,Ai}var Oi,Ou;function _v(){if(Ou)return Oi;Ou=1;var r=Jr(),e=ns();function t(n,i){return n&&r(i,e(i),n)}return Oi=t,Oi}var qt={exports:{}};qt.exports;var Pu;function wv(){return Pu||(Pu=1,(function(r,e){var t=je(),n=e&&!e.nodeType&&e,i=n&&!0&&r&&!r.nodeType&&r,a=i&&i.exports===n,s=a?t.Buffer:void 0,c=s?s.allocUnsafe:void 0;function u(l,f){if(f)return l.slice();var v=l.length,b=c?c(v):new l.constructor(v);return l.copy(b),b}r.exports=u})(qt,qt.exports)),qt.exports}var Pi,Iu;function Sv(){if(Iu)return Pi;Iu=1;function r(e,t){var n=-1,i=e.length;for(t||(t=Array(i));++n<i;)t[n]=e[n];return t}return Pi=r,Pi}var Ii,ju;function kv(){if(ju)return Ii;ju=1;function r(e,t){for(var n=-1,i=e==null?0:e.length,a=0,s=[];++n<i;){var c=e[n];t(c,n,e)&&(s[a++]=c)}return s}return Ii=r,Ii}var ji,Ru;function pd(){if(Ru)return ji;Ru=1;function r(){return[]}return ji=r,ji}var Ri,xu;function is(){if(xu)return Ri;xu=1;var r=kv(),e=pd(),t=Object.prototype,n=t.propertyIsEnumerable,i=Object.getOwnPropertySymbols,a=i?function(s){return s==null?[]:(s=Object(s),r(i(s),function(c){return n.call(s,c)}))}:e;return Ri=a,Ri}var xi,Lu;function Cv(){if(Lu)return xi;Lu=1;var r=Jr(),e=is();function t(n,i){return r(n,e(n),i)}return xi=t,xi}var Li,Du;function vd(){if(Du)return Li;Du=1;function r(e,t){for(var n=-1,i=t.length,a=e.length;++n<i;)e[a+n]=t[n];return e}return Li=r,Li}var Di,Nu;function gd(){if(Nu)return Di;Nu=1;var r=hd(),e=r(Object.getPrototypeOf,Object);return Di=e,Di}var Ni,qu;function md(){if(qu)return Ni;qu=1;var r=vd(),e=gd(),t=is(),n=pd(),i=Object.getOwnPropertySymbols,a=i?function(s){for(var c=[];s;)r(c,t(s)),s=e(s);return c}:n;return Ni=a,Ni}var qi,Fu;function Mv(){if(Fu)return qi;Fu=1;var r=Jr(),e=md();function t(n,i){return r(n,e(n),i)}return qi=t,qi}var Fi,$u;function yd(){if($u)return Fi;$u=1;var r=vd(),e=Xa();function t(n,i,a){var s=i(n);return e(n)?s:r(s,a(n))}return Fi=t,Fi}var $i,Bu;function Tv(){if(Bu)return $i;Bu=1;var r=yd(),e=is(),t=rs();function n(i){return r(i,t,e)}return $i=n,$i}var Bi,Uu;function Ev(){if(Uu)return Bi;Uu=1;var r=yd(),e=md(),t=ns();function n(i){return r(i,t,e)}return Bi=n,Bi}var Ui,Vu;function Av(){if(Vu)return Ui;Vu=1;var r=vt(),e=je(),t=r(e,"DataView");return Ui=t,Ui}var Vi,Ju;function Ov(){if(Ju)return Vi;Ju=1;var r=vt(),e=je(),t=r(e,"Promise");return Vi=t,Vi}var Ji,zu;function Pv(){if(zu)return Ji;zu=1;var r=vt(),e=je(),t=r(e,"Set");return Ji=t,Ji}var zi,Wu;function Iv(){if(Wu)return zi;Wu=1;var r=vt(),e=je(),t=r(e,"WeakMap");return zi=t,zi}var Wi,Gu;function as(){if(Gu)return Wi;Gu=1;var r=Av(),e=Ya(),t=Ov(),n=Pv(),i=Iv(),a=Br(),s=sd(),c="[object Map]",u="[object Object]",l="[object Promise]",f="[object Set]",v="[object WeakMap]",b="[object DataView]",k=s(r),y=s(e),m=s(t),_=s(n),S=s(i),C=a;return(r&&C(new r(new ArrayBuffer(1)))!=b||e&&C(new e)!=c||t&&C(t.resolve())!=l||n&&C(new n)!=f||i&&C(new i)!=v)&&(C=function(A){var O=a(A),P=O==u?A.constructor:void 0,x=P?s(P):"";if(x)switch(x){case k:return b;case y:return c;case m:return l;case _:return f;case S:return v}return O}),Wi=C,Wi}var Gi,Hu;function jv(){if(Hu)return Gi;Hu=1;var r=Object.prototype,e=r.hasOwnProperty;function t(n){var i=n.length,a=new n.constructor(i);return i&&typeof n[0]=="string"&&e.call(n,"index")&&(a.index=n.index,a.input=n.input),a}return Gi=t,Gi}var Hi,Ku;function Rv(){if(Ku)return Hi;Ku=1;var r=je(),e=r.Uint8Array;return Hi=e,Hi}var Ki,Qu;function ss(){if(Qu)return Ki;Qu=1;var r=Rv();function e(t){var n=new t.constructor(t.byteLength);return new r(n).set(new r(t)),n}return Ki=e,Ki}var Qi,Yu;function xv(){if(Yu)return Qi;Yu=1;var r=ss();function e(t,n){var i=n?r(t.buffer):t.buffer;return new t.constructor(i,t.byteOffset,t.byteLength)}return Qi=e,Qi}var Yi,Xu;function Lv(){if(Xu)return Yi;Xu=1;var r=/\w*$/;function e(t){var n=new t.constructor(t.source,r.exec(t));return n.lastIndex=t.lastIndex,n}return Yi=e,Yi}var Xi,Zu;function Dv(){if(Zu)return Xi;Zu=1;var r=Qa(),e=r?r.prototype:void 0,t=e?e.valueOf:void 0;function n(i){return t?Object(t.call(i)):{}}return Xi=n,Xi}var Zi,el;function Nv(){if(el)return Zi;el=1;var r=ss();function e(t,n){var i=n?r(t.buffer):t.buffer;return new t.constructor(i,t.byteOffset,t.length)}return Zi=e,Zi}var ea,tl;function qv(){if(tl)return ea;tl=1;var r=ss(),e=xv(),t=Lv(),n=Dv(),i=Nv(),a="[object Boolean]",s="[object Date]",c="[object Map]",u="[object Number]",l="[object RegExp]",f="[object Set]",v="[object String]",b="[object Symbol]",k="[object ArrayBuffer]",y="[object DataView]",m="[object Float32Array]",_="[object Float64Array]",S="[object Int8Array]",C="[object Int16Array]",A="[object Int32Array]",O="[object Uint8Array]",P="[object Uint8ClampedArray]",x="[object Uint16Array]",U="[object Uint32Array]";function Y(Q,pe,F){var _e=Q.constructor;switch(pe){case k:return r(Q);case a:case s:return new _e(+Q);case y:return e(Q,F);case m:case _:case S:case C:case A:case O:case P:case x:case U:return i(Q,F);case c:return new _e;case u:case v:return new _e(Q);case l:return t(Q);case f:return new _e;case b:return n(Q)}}return ea=Y,ea}var ta,rl;function Fv(){if(rl)return ta;rl=1;var r=Wt(),e=Object.create,t=(function(){function n(){}return function(i){if(!r(i))return{};if(e)return e(i);n.prototype=i;var a=new n;return n.prototype=void 0,a}})();return ta=t,ta}var ra,nl;function $v(){if(nl)return ra;nl=1;var r=Fv(),e=gd(),t=ts();function n(i){return typeof i.constructor=="function"&&!t(i)?r(e(i)):{}}return ra=n,ra}var na,il;function Bv(){if(il)return na;il=1;var r=as(),e=Gt(),t="[object Map]";function n(i){return e(i)&&r(i)==t}return na=n,na}var ia,al;function Uv(){if(al)return ia;al=1;var r=Bv(),e=Za(),t=es(),n=t&&t.isMap,i=n?e(n):r;return ia=i,ia}var aa,sl;function Vv(){if(sl)return aa;sl=1;var r=as(),e=Gt(),t="[object Set]";function n(i){return e(i)&&r(i)==t}return aa=n,aa}var sa,ol;function Jv(){if(ol)return sa;ol=1;var r=Vv(),e=Za(),t=es(),n=t&&t.isSet,i=n?e(n):r;return sa=i,sa}var oa,cl;function zv(){if(cl)return oa;cl=1;var r=av(),e=sv(),t=cd(),n=mv(),i=_v(),a=wv(),s=Sv(),c=Cv(),u=Mv(),l=Tv(),f=Ev(),v=as(),b=jv(),k=qv(),y=$v(),m=Xa(),_=ud(),S=Uv(),C=Wt(),A=Jv(),O=rs(),P=ns(),x=1,U=2,Y=4,Q="[object Arguments]",pe="[object Array]",F="[object Boolean]",_e="[object Date]",Fe="[object Error]",Pt="[object Function]",Ht="[object GeneratorFunction]",Kt="[object Map]",Qt="[object Number]",It="[object Object]",Yt="[object RegExp]",Xt="[object Set]",Zt="[object String]",er="[object Symbol]",o="[object WeakMap]",h="[object ArrayBuffer]",d="[object DataView]",p="[object Float32Array]",g="[object Float64Array]",w="[object Int8Array]",T="[object Int16Array]",E="[object Int32Array]",I="[object Uint8Array]",q="[object Uint8ClampedArray]",$="[object Uint16Array]",ve="[object Uint32Array]",V={};V[Q]=V[pe]=V[h]=V[d]=V[F]=V[_e]=V[p]=V[g]=V[w]=V[T]=V[E]=V[Kt]=V[Qt]=V[It]=V[Yt]=V[Xt]=V[Zt]=V[er]=V[I]=V[q]=V[$]=V[ve]=!0,V[Fe]=V[Pt]=V[o]=!1;function Ae(L,ee,ce,Ke,Re,ue){var Z,Qe=ee&x,gt=ee&U,zr=ee&Y;if(ce&&(Z=Re?ce(L,Ke,Re,ue):ce(L)),Z!==void 0)return Z;if(!C(L))return L;var us=m(L);if(us){if(Z=b(L),!Qe)return s(L,Z)}else{var mt=v(L),ls=mt==Pt||mt==Ht;if(_(L))return a(L,Qe);if(mt==It||mt==Q||ls&&!Re){if(Z=gt||ls?{}:y(L),!Qe)return gt?u(L,i(Z,L)):c(L,n(Z,L))}else{if(!V[mt])return Re?L:{};Z=k(L,mt,Qe)}}ue||(ue=new r);var ds=ue.get(L);if(ds)return ds;ue.set(L,Z),A(L)?L.forEach(function($e){Z.add(Ae($e,ee,ce,$e,L,ue))}):S(L)&&L.forEach(function($e,Ye){Z.set(Ye,Ae($e,ee,ce,Ye,L,ue))});var Cd=zr?gt?f:l:gt?P:O,hs=us?void 0:Cd(L);return e(hs||L,function($e,Ye){hs&&(Ye=$e,$e=L[Ye]),t(Z,Ye,Ae($e,ee,ce,Ye,L,ue))}),Z}return oa=Ae,oa}var ca,ul;function Wv(){if(ul)return ca;ul=1;var r=zv(),e=1,t=4;function n(i){return r(i,e|t)}return ca=n,ca}var Gv=Wv();const Hv=Md(Gv);function Kv(r,e,t,n){Object.defineProperty(r,e,{get:t,set:n,enumerable:!0,configurable:!0})}class Me{static floatTo16BitPCM(e){const t=new ArrayBuffer(e.length*2),n=new DataView(t);let i=0;for(let a=0;a<e.length;a++,i+=2){let s=Math.max(-1,Math.min(1,e[a]));n.setInt16(i,s<0?s*32768:s*32767,!0)}return t}static mergeBuffers(e,t){const n=new Uint8Array(e.byteLength+t.byteLength);return n.set(new Uint8Array(e),0),n.set(new Uint8Array(t),e.byteLength),n.buffer}_packData(e,t){return[new Uint8Array([t,t>>8]),new Uint8Array([t,t>>8,t>>16,t>>24])][e]}pack(e,t){if(t?.bitsPerSample)if(t?.channels){if(!t?.data)throw new Error('Missing "data"')}else throw new Error('Missing "channels"');else throw new Error('Missing "bitsPerSample"');const{bitsPerSample:n,channels:i,data:a}=t,s=["RIFF",this._packData(1,52),"WAVE","fmt ",this._packData(1,16),this._packData(0,1),this._packData(0,i.length),this._packData(1,e),this._packData(1,e*i.length*n/8),this._packData(0,i.length*n/8),this._packData(0,n),"data",this._packData(1,i[0].length*i.length*n/8),a],c=new Blob(s,{type:"audio/mpeg"}),u=URL.createObjectURL(c);return{blob:c,url:u,channelCount:i.length,sampleRate:e,duration:a.byteLength/(i.length*e*2)}}}globalThis.WavPacker=Me;const ll=[4186.01,4434.92,4698.63,4978.03,5274.04,5587.65,5919.91,6271.93,6644.88,7040,7458.62,7902.13],Qv=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"],We=[],os=[];for(let r=1;r<=8;r++)for(let e=0;e<ll.length;e++){const t=ll[e];We.push(t/Math.pow(2,8-r)),os.push(Qv[e]+r)}const Pr=[32,2e3],dl=We.filter((r,e)=>We[e]>Pr[0]&&We[e]<Pr[1]),Yv=os.filter((r,e)=>We[e]>Pr[0]&&We[e]<Pr[1]);class Ot{static getFrequencies(e,t,n,i="frequency",a=-100,s=-30){n||(n=new Float32Array(e.frequencyBinCount),e.getFloatFrequencyData(n));const c=t/2,u=1/n.length*c;let l,f,v;if(i==="music"||i==="voice"){const y=i==="voice"?dl:We,m=Array(y.length).fill(a);for(let _=0;_<n.length;_++){const S=_*u,C=n[_];for(let A=y.length-1;A>=0;A--)if(S>y[A]){m[A]=Math.max(m[A],C);break}}l=m,f=i==="voice"?dl:We,v=i==="voice"?Yv:os}else l=Array.from(n),f=l.map((y,m)=>u*m),v=f.map(y=>`${y.toFixed(2)} Hz`);const b=l.map(y=>Math.max(0,Math.min((y-a)/(s-a),1)));return{values:new Float32Array(b),frequencies:f,labels:v}}constructor(e,t=null){if(this.fftResults=[],t){const{length:n,sampleRate:i}=t,a=new OfflineAudioContext({length:n,sampleRate:i}),s=a.createBufferSource();s.buffer=t;const c=a.createAnalyser();c.fftSize=8192,c.smoothingTimeConstant=.1,s.connect(c);const u=1/60,l=n/i,f=v=>{const b=u*v;b<l&&a.suspend(b).then(()=>{const k=new Float32Array(c.frequencyBinCount);c.getFloatFrequencyData(k),this.fftResults.push(k),f(v+1)}),v===1?a.startRendering():a.resume()};s.start(0),f(1),this.audio=e,this.context=a,this.analyser=c,this.sampleRate=i,this.audioBuffer=t}else{const n=new AudioContext,i=n.createMediaElementSource(e),a=n.createAnalyser();a.fftSize=8192,a.smoothingTimeConstant=.1,i.connect(a),a.connect(n.destination),this.audio=e,this.context=n,this.analyser=a,this.sampleRate=this.context.sampleRate,this.audioBuffer=null}}getFrequencies(e="frequency",t=-100,n=-30){let i=null;if(this.audioBuffer&&this.fftResults.length){const a=this.audio.currentTime/this.audio.duration,s=Math.min(a*this.fftResults.length|0,this.fftResults.length-1);i=this.fftResults[s]}return Ot.getFrequencies(this.analyser,this.sampleRate,i,e,t,n)}async resumeIfSuspended(){return this.context.state==="suspended"&&await this.context.resume(),!0}}globalThis.AudioAnalysis=Ot;const Xv=`
class StreamProcessor extends AudioWorkletProcessor {
  constructor() {
    super();
    this.hasStarted = false;
    this.hasInterrupted = false;
    this.outputBuffers = [];
    this.bufferLength = 128;
    this.write = { buffer: new Float32Array(this.bufferLength), trackId: null };
    this.writeOffset = 0;
    this.trackSampleOffsets = {};
    this.port.onmessage = (event) => {
      if (event.data) {
        const payload = event.data;
        if (payload.event === 'write') {
          const int16Array = payload.buffer;
          const float32Array = new Float32Array(int16Array.length);
          for (let i = 0; i < int16Array.length; i++) {
            float32Array[i] = int16Array[i] / 0x8000; // Convert Int16 to Float32
          }
          this.writeData(float32Array, payload.trackId);
        } else if (
          payload.event === 'offset' ||
          payload.event === 'interrupt'
        ) {
          const requestId = payload.requestId;
          const trackId = this.write.trackId;
          const offset = this.trackSampleOffsets[trackId] || 0;
          this.port.postMessage({
            event: 'offset',
            requestId,
            trackId,
            offset,
          });
          if (payload.event === 'interrupt') {
            this.hasInterrupted = true;
          }
        } else {
          throw new Error(\`Unhandled event "\${payload.event}"\`);
        }
      }
    };
  }

  writeData(float32Array, trackId = null) {
    let { buffer } = this.write;
    let offset = this.writeOffset;
    for (let i = 0; i < float32Array.length; i++) {
      buffer[offset++] = float32Array[i];
      if (offset >= buffer.length) {
        this.outputBuffers.push(this.write);
        this.write = { buffer: new Float32Array(this.bufferLength), trackId };
        buffer = this.write.buffer;
        offset = 0;
      }
    }
    this.writeOffset = offset;
    return true;
  }

  process(inputs, outputs, parameters) {
    const output = outputs[0];
    const outputChannelData = output[0];
    const outputBuffers = this.outputBuffers;
    if (this.hasInterrupted) {
      this.port.postMessage({ event: 'stop' });
      return false;
    } else if (outputBuffers.length) {
      this.hasStarted = true;
      const { buffer, trackId } = outputBuffers.shift();
      for (let i = 0; i < outputChannelData.length; i++) {
        outputChannelData[i] = buffer[i] || 0;
      }
      if (trackId) {
        this.trackSampleOffsets[trackId] =
          this.trackSampleOffsets[trackId] || 0;
        this.trackSampleOffsets[trackId] += buffer.length;
      }
      return true;
    } else if (this.hasStarted) {
      this.port.postMessage({ event: 'stop' });
      return false;
    } else {
      return true;
    }
  }
}

registerProcessor('stream_processor', StreamProcessor);
`,Zv=new Blob([Xv],{type:"application/javascript"}),eg=URL.createObjectURL(Zv),tg=eg;class cs{constructor({sampleRate:e=44100}={}){this.scriptSrc=tg,this.sampleRate=e,this.context=null,this.stream=null,this.analyser=null,this.trackSampleOffsets={},this.interruptedTrackIds={}}async connect(){this.context=new AudioContext({sampleRate:this.sampleRate}),this._speakerID&&this.context.setSinkId(this._speakerID),this.context.state==="suspended"&&await this.context.resume();try{await this.context.audioWorklet.addModule(this.scriptSrc)}catch(t){throw console.error(t),new Error(`Could not add audioWorklet module: ${this.scriptSrc}`)}const e=this.context.createAnalyser();return e.fftSize=8192,e.smoothingTimeConstant=.1,this.analyser=e,!0}getFrequencies(e="frequency",t=-100,n=-30){if(!this.analyser)throw new Error("Not connected, please call .connect() first");return Ot.getFrequencies(this.analyser,this.sampleRate,null,e,t,n)}async updateSpeaker(e){const t=this._speakerID;if(this._speakerID=e,this.context)try{e==="default"?await this.context.setSinkId():await this.context.setSinkId(e)}catch(n){console.error(`Could not set sinkId to ${e}: ${n}`),this._speakerID=t}}_start(){const e=new AudioWorkletNode(this.context,"stream_processor");return e.connect(this.context.destination),e.port.onmessage=t=>{const{event:n}=t.data;if(n==="stop")e.disconnect(),this.stream=null;else if(n==="offset"){const{requestId:i,trackId:a,offset:s}=t.data,c=s/this.sampleRate;this.trackSampleOffsets[i]={trackId:a,offset:s,currentTime:c}}},this.analyser.disconnect(),e.connect(this.analyser),this.stream=e,!0}add16BitPCM(e,t="default"){if(typeof t!="string")throw new Error("trackId must be a string");if(this.interruptedTrackIds[t])return;this.stream||this._start();let n;if(e instanceof Int16Array)n=e;else if(e instanceof ArrayBuffer)n=new Int16Array(e);else throw new Error("argument must be Int16Array or ArrayBuffer");return this.stream.port.postMessage({event:"write",buffer:n,trackId:t}),n}async getTrackSampleOffset(e=!1){if(!this.stream)return null;const t=crypto.randomUUID();this.stream.port.postMessage({event:e?"interrupt":"offset",requestId:t});let n;for(;!n;)n=this.trackSampleOffsets[t],await new Promise(a=>setTimeout(()=>a(),1));const{trackId:i}=n;return e&&i&&(this.interruptedTrackIds[i]=!0),n}async interrupt(){return this.getTrackSampleOffset(!0)}}globalThis.WavStreamPlayer=cs;const rg=`
class AudioProcessor extends AudioWorkletProcessor {

  constructor() {
    super();
    this.port.onmessage = this.receive.bind(this);
    this.initialize();
  }

  initialize() {
    this.foundAudio = false;
    this.recording = false;
    this.chunks = [];
  }

  /**
   * Concatenates sampled chunks into channels
   * Format is chunk[Left[], Right[]]
   */
  readChannelData(chunks, channel = -1, maxChannels = 9) {
    let channelLimit;
    if (channel !== -1) {
      if (chunks[0] && chunks[0].length - 1 < channel) {
        throw new Error(
          \`Channel \${channel} out of range: max \${chunks[0].length}\`
        );
      }
      channelLimit = channel + 1;
    } else {
      channel = 0;
      channelLimit = Math.min(chunks[0] ? chunks[0].length : 1, maxChannels);
    }
    const channels = [];
    for (let n = channel; n < channelLimit; n++) {
      const length = chunks.reduce((sum, chunk) => {
        return sum + chunk[n].length;
      }, 0);
      const buffers = chunks.map((chunk) => chunk[n]);
      const result = new Float32Array(length);
      let offset = 0;
      for (let i = 0; i < buffers.length; i++) {
        result.set(buffers[i], offset);
        offset += buffers[i].length;
      }
      channels[n] = result;
    }
    return channels;
  }

  /**
   * Combines parallel audio data into correct format,
   * channels[Left[], Right[]] to float32Array[LRLRLRLR...]
   */
  formatAudioData(channels) {
    if (channels.length === 1) {
      // Simple case is only one channel
      const float32Array = channels[0].slice();
      const meanValues = channels[0].slice();
      return { float32Array, meanValues };
    } else {
      const float32Array = new Float32Array(
        channels[0].length * channels.length
      );
      const meanValues = new Float32Array(channels[0].length);
      for (let i = 0; i < channels[0].length; i++) {
        const offset = i * channels.length;
        let meanValue = 0;
        for (let n = 0; n < channels.length; n++) {
          float32Array[offset + n] = channels[n][i];
          meanValue += channels[n][i];
        }
        meanValues[i] = meanValue / channels.length;
      }
      return { float32Array, meanValues };
    }
  }

  /**
   * Converts 32-bit float data to 16-bit integers
   */
  floatTo16BitPCM(float32Array) {
    const buffer = new ArrayBuffer(float32Array.length * 2);
    const view = new DataView(buffer);
    let offset = 0;
    for (let i = 0; i < float32Array.length; i++, offset += 2) {
      let s = Math.max(-1, Math.min(1, float32Array[i]));
      view.setInt16(offset, s < 0 ? s * 0x8000 : s * 0x7fff, true);
    }
    return buffer;
  }

  /**
   * Retrieves the most recent amplitude values from the audio stream
   * @param {number} channel
   */
  getValues(channel = -1) {
    const channels = this.readChannelData(this.chunks, channel);
    const { meanValues } = this.formatAudioData(channels);
    return { meanValues, channels };
  }

  /**
   * Exports chunks as an audio/wav file
   */
  export() {
    const channels = this.readChannelData(this.chunks);
    const { float32Array, meanValues } = this.formatAudioData(channels);
    const audioData = this.floatTo16BitPCM(float32Array);
    return {
      meanValues: meanValues,
      audio: {
        bitsPerSample: 16,
        channels: channels,
        data: audioData,
      },
    };
  }

  receive(e) {
    const { event, id } = e.data;
    let receiptData = {};
    switch (event) {
      case 'start':
        this.recording = true;
        break;
      case 'stop':
        this.recording = false;
        break;
      case 'clear':
        this.initialize();
        break;
      case 'export':
        receiptData = this.export();
        break;
      case 'read':
        receiptData = this.getValues();
        break;
      default:
        break;
    }
    // Always send back receipt
    this.port.postMessage({ event: 'receipt', id, data: receiptData });
  }

  sendChunk(chunk) {
    const channels = this.readChannelData([chunk]);
    const { float32Array, meanValues } = this.formatAudioData(channels);
    const rawAudioData = this.floatTo16BitPCM(float32Array);
    const monoAudioData = this.floatTo16BitPCM(meanValues);
    this.port.postMessage({
      event: 'chunk',
      data: {
        mono: monoAudioData,
        raw: rawAudioData,
      },
    });
  }

  process(inputList, outputList, parameters) {
    // Copy input to output (e.g. speakers)
    // Note that this creates choppy sounds with Mac products
    const sourceLimit = Math.min(inputList.length, outputList.length);
    for (let inputNum = 0; inputNum < sourceLimit; inputNum++) {
      const input = inputList[inputNum];
      const output = outputList[inputNum];
      const channelCount = Math.min(input.length, output.length);
      for (let channelNum = 0; channelNum < channelCount; channelNum++) {
        input[channelNum].forEach((sample, i) => {
          output[channelNum][i] = sample;
        });
      }
    }
    const inputs = inputList[0];
    // There's latency at the beginning of a stream before recording starts
    // Make sure we actually receive audio data before we start storing chunks
    let sliceIndex = 0;
    if (!this.foundAudio) {
      for (const channel of inputs) {
        sliceIndex = 0; // reset for each channel
        if (this.foundAudio) {
          break;
        }
        if (channel) {
          for (const value of channel) {
            if (value !== 0) {
              // find only one non-zero entry in any channel
              this.foundAudio = true;
              break;
            } else {
              sliceIndex++;
            }
          }
        }
      }
    }
    if (inputs && inputs[0] && this.foundAudio && this.recording) {
      // We need to copy the TypedArray, because the \`process\`
      // internals will reuse the same buffer to hold each input
      const chunk = inputs.map((input) => input.slice(sliceIndex));
      this.chunks.push(chunk);
      this.sendChunk(chunk);
    }
    return true;
  }
}

registerProcessor('audio_processor', AudioProcessor);
`,ng=new Blob([rg],{type:"application/javascript"}),ig=URL.createObjectURL(ng),bd=ig;class _d{constructor({sampleRate:e=44100,outputToSpeakers:t=!1,debug:n=!1}={}){this.scriptSrc=bd,this.sampleRate=e,this.outputToSpeakers=t,this.debug=!!n,this._deviceChangeCallback=null,this._deviceErrorCallback=null,this._devices=[],this.deviceSelection=null,this.stream=null,this.processor=null,this.source=null,this.node=null,this.recording=!1,this._lastEventId=0,this.eventReceipts={},this.eventTimeout=5e3,this._chunkProcessor=()=>{},this._chunkProcessorSize=void 0,this._chunkProcessorBuffer={raw:new ArrayBuffer(0),mono:new ArrayBuffer(0)}}static async decode(e,t=44100,n=-1){const i=new AudioContext({sampleRate:t});let a,s;if(e instanceof Blob){if(n!==-1)throw new Error('Can not specify "fromSampleRate" when reading from Blob');s=e,a=await s.arrayBuffer()}else if(e instanceof ArrayBuffer){if(n!==-1)throw new Error('Can not specify "fromSampleRate" when reading from ArrayBuffer');a=e,s=new Blob([a],{type:"audio/wav"})}else{let f,v;if(e instanceof Int16Array){v=e,f=new Float32Array(e.length);for(let m=0;m<e.length;m++)f[m]=e[m]/32768}else if(e instanceof Float32Array)f=e;else if(e instanceof Array)f=new Float32Array(e);else throw new Error('"audioData" must be one of: Blob, Float32Arrray, Int16Array, ArrayBuffer, Array<number>');if(n===-1)throw new Error('Must specify "fromSampleRate" when reading from Float32Array, In16Array or Array');if(n<3e3)throw new Error('Minimum "fromSampleRate" is 3000 (3kHz)');v||(v=Me.floatTo16BitPCM(f));const b={bitsPerSample:16,channels:[f],data:v};s=new Me().pack(n,b).blob,a=await s.arrayBuffer()}const c=await i.decodeAudioData(a),u=c.getChannelData(0),l=URL.createObjectURL(s);return{blob:s,url:l,values:u,audioBuffer:c}}log(){return this.debug&&this.log(...arguments),!0}getSampleRate(){return this.sampleRate}getStatus(){return this.processor?this.recording?"recording":"paused":"ended"}async _event(e,t={},n=null){if(n=n||this.processor,!n)throw new Error("Can not send events without recording first");const i={event:e,id:this._lastEventId++,data:t};n.port.postMessage(i);const a=new Date().valueOf();for(;!this.eventReceipts[i.id];){if(new Date().valueOf()-a>this.eventTimeout)throw new Error(`Timeout waiting for "${e}" event`);await new Promise(c=>setTimeout(()=>c(!0),1))}const s=this.eventReceipts[i.id];return delete this.eventReceipts[i.id],s}listenForDeviceChange(e){if(e===null&&this._deviceChangeCallback)navigator.mediaDevices.removeEventListener("devicechange",this._deviceChangeCallback),this._deviceChangeCallback=null;else if(e!==null){let t=0,n=[];const i=s=>s.map(c=>c.deviceId).sort().join(","),a=async()=>{let s=++t;const c=await this.listDevices();s===t&&i(n)!==i(c)&&(n=c,e(c.slice()))};navigator.mediaDevices.addEventListener("devicechange",a),a(),this._deviceChangeCallback=a}return!0}listenForDeviceErrors(e){this._deviceErrorCallback=e}async requestPermission(){const e=await navigator.permissions.query({name:"microphone"});if(e.state==="denied")this._deviceErrorCallback&&this._deviceErrorCallback({devices:["mic"],type:"unknown",error:new Error("Microphone access denied")});else if(e.state==="prompt")try{(await navigator.mediaDevices.getUserMedia({audio:!0})).getTracks().forEach(i=>i.stop())}catch(t){console.error("Error accessing microphone."),this._deviceErrorCallback&&this._deviceErrorCallback({devices:["mic"],type:"unknown",error:t})}return!0}async listDevices(){if(!navigator.mediaDevices||!("enumerateDevices"in navigator.mediaDevices))throw new Error("Could not request user devices");return await this.requestPermission(),(await navigator.mediaDevices.enumerateDevices()).filter(n=>n.kind==="audioinput")}async begin(e){if(this.processor)throw new Error("Already connected: please call .end() to start a new session");if(!navigator.mediaDevices||!("getUserMedia"in navigator.mediaDevices))throw this._deviceErrorCallback&&this._deviceErrorCallback({devices:["mic","cam"],type:"undefined-mediadevices"}),new Error("Could not request user media");e=e??this.deviceSelection?.deviceId;try{const c={audio:!0};e&&(c.audio={deviceId:{exact:e}}),this.stream=await navigator.mediaDevices.getUserMedia(c)}catch(c){throw this._deviceErrorCallback&&this._deviceErrorCallback({devices:["mic"],type:"unknown",error:c}),new Error("Could not start media stream")}this.listDevices().then(c=>{e=this.stream.getAudioTracks()[0].getSettings().deviceId,console.log("find current device",c,e,this.stream.getAudioTracks()[0].getSettings()),this.deviceSelection=c.find(u=>u.deviceId===e),console.log("current device",this.deviceSelection)});const t=new AudioContext({sampleRate:this.sampleRate}),n=t.createMediaStreamSource(this.stream);try{await t.audioWorklet.addModule(this.scriptSrc)}catch(c){throw console.error(c),new Error(`Could not add audioWorklet module: ${this.scriptSrc}`)}const i=new AudioWorkletNode(t,"audio_processor");i.port.onmessage=c=>{const{event:u,id:l,data:f}=c.data;if(u==="receipt")this.eventReceipts[l]=f;else if(u==="chunk")if(this._chunkProcessorSize){const v=this._chunkProcessorBuffer;this._chunkProcessorBuffer={raw:Me.mergeBuffers(v.raw,f.raw),mono:Me.mergeBuffers(v.mono,f.mono)},this._chunkProcessorBuffer.mono.byteLength>=this._chunkProcessorSize&&(this._chunkProcessor(this._chunkProcessorBuffer),this._chunkProcessorBuffer={raw:new ArrayBuffer(0),mono:new ArrayBuffer(0)})}else this._chunkProcessor(f)};const a=n.connect(i),s=t.createAnalyser();return s.fftSize=8192,s.smoothingTimeConstant=.1,a.connect(s),this.outputToSpeakers&&(console.warn(`Warning: Output to speakers may affect sound quality,
especially due to system audio feedback preventative measures.
use only for debugging`),s.connect(t.destination)),this.source=n,this.node=a,this.analyser=s,this.processor=i,console.log("begin completed"),!0}getFrequencies(e="frequency",t=-100,n=-30){if(!this.processor)throw new Error("Session ended: please call .begin() first");return Ot.getFrequencies(this.analyser,this.sampleRate,null,e,t,n)}async pause(){if(this.processor){if(!this.recording)throw new Error("Already paused: please call .record() first")}else throw new Error("Session ended: please call .begin() first");return this._chunkProcessorBuffer.raw.byteLength&&this._chunkProcessor(this._chunkProcessorBuffer),this.log("Pausing ..."),await this._event("stop"),this.recording=!1,!0}async record(e=()=>{},t=8192){if(this.processor){if(this.recording)throw new Error("Already recording: please call .pause() first");if(typeof e!="function")throw new Error("chunkProcessor must be a function")}else throw new Error("Session ended: please call .begin() first");return this._chunkProcessor=e,this._chunkProcessorSize=t,this._chunkProcessorBuffer={raw:new ArrayBuffer(0),mono:new ArrayBuffer(0)},this.log("Recording ..."),await this._event("start"),this.recording=!0,!0}async clear(){if(!this.processor)throw new Error("Session ended: please call .begin() first");return await this._event("clear"),!0}async read(){if(!this.processor)throw new Error("Session ended: please call .begin() first");return this.log("Reading ..."),await this._event("read")}async save(e=!1){if(!this.processor)throw new Error("Session ended: please call .begin() first");if(!e&&this.recording)throw new Error("Currently recording: please call .pause() first, or call .save(true) to force");this.log("Exporting ...");const t=await this._event("export");return new Me().pack(this.sampleRate,t.audio)}async end(){if(!this.processor)throw new Error("Session ended: please call .begin() first");const e=this.processor;this.log("Stopping ..."),await this._event("stop"),this.recording=!1,this.stream.getTracks().forEach(s=>s.stop()),this.log("Exporting ...");const n=await this._event("export",{},e);return this.processor.disconnect(),this.source.disconnect(),this.node.disconnect(),this.analyser.disconnect(),this.stream=null,this.processor=null,this.source=null,this.node=null,new Me().pack(this.sampleRate,n.audio)}async quit(){return this.listenForDeviceChange(null),this.deviceSelection=null,this.processor&&await this.end(),!0}}globalThis.WavRecorder=_d;class ag{constructor({sampleRate:e=44100,outputToSpeakers:t=!1,debug:n=!1}={}){this.scriptSrc=bd,this.sampleRate=e,this.outputToSpeakers=t,this.debug=!!n,this.stream=null,this.processor=null,this.source=null,this.node=null,this.recording=!1,this._lastEventId=0,this.eventReceipts={},this.eventTimeout=5e3,this._chunkProcessor=()=>{},this._chunkProcessorSize=void 0,this._chunkProcessorBuffer={raw:new ArrayBuffer(0),mono:new ArrayBuffer(0)}}log(){return this.debug&&this.log(...arguments),!0}getSampleRate(){return this.sampleRate}getStatus(){return this.processor?this.recording?"recording":"paused":"ended"}async _event(e,t={},n=null){if(n=n||this.processor,!n)throw new Error("Can not send events without recording first");const i={event:e,id:this._lastEventId++,data:t};n.port.postMessage(i);const a=new Date().valueOf();for(;!this.eventReceipts[i.id];){if(new Date().valueOf()-a>this.eventTimeout)throw new Error(`Timeout waiting for "${e}" event`);await new Promise(c=>setTimeout(()=>c(!0),1))}const s=this.eventReceipts[i.id];return delete this.eventReceipts[i.id],s}async begin(e){if(this.processor)throw new Error("Already connected: please call .end() to start a new session");if(!e||e.kind!=="audio")throw new Error("No audio track provided");this.stream=new MediaStream([e]);const t=new AudioContext({sampleRate:this.sampleRate}),n=t.createMediaStreamSource(this.stream);try{await t.audioWorklet.addModule(this.scriptSrc)}catch(c){throw console.error(c),new Error(`Could not add audioWorklet module: ${this.scriptSrc}`)}const i=new AudioWorkletNode(t,"audio_processor");i.port.onmessage=c=>{const{event:u,id:l,data:f}=c.data;if(u==="receipt")this.eventReceipts[l]=f;else if(u==="chunk")if(this._chunkProcessorSize){const v=this._chunkProcessorBuffer;this._chunkProcessorBuffer={raw:Me.mergeBuffers(v.raw,f.raw),mono:Me.mergeBuffers(v.mono,f.mono)},this._chunkProcessorBuffer.mono.byteLength>=this._chunkProcessorSize&&(this._chunkProcessor(this._chunkProcessorBuffer),this._chunkProcessorBuffer={raw:new ArrayBuffer(0),mono:new ArrayBuffer(0)})}else this._chunkProcessor(f)};const a=n.connect(i),s=t.createAnalyser();return s.fftSize=8192,s.smoothingTimeConstant=.1,a.connect(s),this.outputToSpeakers&&(console.warn(`Warning: Output to speakers may affect sound quality,
especially due to system audio feedback preventative measures.
use only for debugging`),s.connect(t.destination)),this.source=n,this.node=a,this.analyser=s,this.processor=i,!0}getFrequencies(e="frequency",t=-100,n=-30){if(!this.processor)throw new Error("Session ended: please call .begin() first");return Ot.getFrequencies(this.analyser,this.sampleRate,null,e,t,n)}async pause(){if(this.processor){if(!this.recording)throw new Error("Already paused: please call .record() first")}else throw new Error("Session ended: please call .begin() first");return this._chunkProcessorBuffer.raw.byteLength&&this._chunkProcessor(this._chunkProcessorBuffer),this.log("Pausing ..."),await this._event("stop"),this.recording=!1,!0}async record(e=()=>{},t=8192){if(this.processor){if(this.recording)throw new Error("Already recording: HELLO please call .pause() first");if(typeof e!="function")throw new Error("chunkProcessor must be a function")}else throw new Error("Session ended: please call .begin() first");return this._chunkProcessor=e,this._chunkProcessorSize=t,this._chunkProcessorBuffer={raw:new ArrayBuffer(0),mono:new ArrayBuffer(0)},this.log("Recording ..."),await this._event("start"),this.recording=!0,!0}async clear(){if(!this.processor)throw new Error("Session ended: please call .begin() first");return await this._event("clear"),!0}async read(){if(!this.processor)throw new Error("Session ended: please call .begin() first");return this.log("Reading ..."),await this._event("read")}async save(e=!1){if(!this.processor)throw new Error("Session ended: please call .begin() first");if(!e&&this.recording)throw new Error("Currently recording: please call .pause() first, or call .save(true) to force");this.log("Exporting ...");const t=await this._event("export");return new Me().pack(this.sampleRate,t.audio)}async end(){if(!this.processor)throw new Error("Session ended: please call .begin() first");const e=this.processor;this.log("Stopping ..."),await this._event("stop"),this.recording=!1,this.log("Exporting ...");const t=await this._event("export",{},e);return this.processor.disconnect(),this.source.disconnect(),this.node.disconnect(),this.analyser.disconnect(),this.stream=null,this.processor=null,this.source=null,this.node=null,new Me().pack(this.sampleRate,t.audio)}async quit(){return this.listenForDeviceChange(null),this.processor&&await this.end(),!0}}globalThis.WavRecorder=WavRecorder;var sg=(function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}})(),rt=function(r,e,t,n){function i(a){return a instanceof t?a:new t(function(s){s(a)})}return new(t||(t=Promise))(function(a,s){function c(f){try{l(n.next(f))}catch(v){s(v)}}function u(f){try{l(n.throw(f))}catch(v){s(v)}}function l(f){f.done?a(f.value):i(f.value).then(c,u)}l((n=n.apply(r,e||[])).next())})},nt=function(r,e){var t={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},n,i,a,s=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return s.next=c(0),s.throw=c(1),s.return=c(2),typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function c(l){return function(f){return u([l,f])}}function u(l){if(n)throw new TypeError("Generator is already executing.");for(;s&&(s=0,l[0]&&(t=0)),t;)try{if(n=1,i&&(a=l[0]&2?i.return:l[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,l[1])).done)return a;switch(i=0,a&&(l=[l[0]&2,a.value]),l[0]){case 0:case 1:a=l;break;case 4:return t.label++,{value:l[1],done:!1};case 5:t.label++,i=l[1],l=[0];continue;case 7:l=t.ops.pop(),t.trys.pop();continue;default:if(a=t.trys,!(a=a.length>0&&a[a.length-1])&&(l[0]===6||l[0]===2)){t=0;continue}if(l[0]===3&&(!a||l[1]>a[0]&&l[1]<a[3])){t.label=l[1];break}if(l[0]===6&&t.label<a[1]){t.label=a[1],a=l;break}if(a&&t.label<a[2]){t.label=a[2],t.ops.push(l);break}a[2]&&t.ops.pop(),t.trys.pop();continue}l=e.call(r,t)}catch(f){l=[6,f],i=0}finally{n=a=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}},wd=(function(){function r(){this._callbacks={},this._micEnabled=!0,this._camEnabled=!1,this._supportsScreenShare=!1}return r.prototype.setUserAudioCallback=function(e){this._userAudioCallback=e},r.prototype.setClientOptions=function(e,t){var n,i,a;t===void 0&&(t=!1),!(this._options&&!t)&&(this._options=e,this._callbacks=(n=e.callbacks)!==null&&n!==void 0?n:{},this._micEnabled=(i=e.enableMic)!==null&&i!==void 0?i:!0,this._camEnabled=(a=e.enableCam)!==null&&a!==void 0?a:!1)},Object.defineProperty(r.prototype,"supportsScreenShare",{get:function(){return this._supportsScreenShare},enumerable:!1,configurable:!0}),r})();(function(r){sg(e,r);function e(t,n){t===void 0&&(t=void 0),n===void 0&&(n=24e3);var i=r.call(this)||this;return i._initialized=!1,i._recorderChunkSize=void 0,i._recorderChunkSize=t,i._wavRecorder=new _d({sampleRate:n}),i._wavStreamPlayer=new cs({sampleRate:24e3}),i}return e.prototype.initialize=function(){return rt(this,void 0,Promise,function(){return nt(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this._wavRecorder.begin()];case 1:return t.sent(),[3,3];case 2:return t.sent(),[3,3];case 3:return this._wavRecorder.listenForDeviceChange(null),this._wavRecorder.listenForDeviceChange(this._handleAvailableDevicesUpdated.bind(this)),this._wavRecorder.listenForDeviceErrors(null),this._wavRecorder.listenForDeviceErrors(this._handleDeviceError.bind(this)),[4,this._wavStreamPlayer.connect()];case 4:return t.sent(),this._initialized=!0,[2]}})})},e.prototype.connect=function(){return rt(this,void 0,Promise,function(){var t;return nt(this,function(n){switch(n.label){case 0:return this._initialized?[3,2]:[4,this.initialize()];case 1:n.sent(),n.label=2;case 2:return t=this._wavRecorder.getStatus()=="recording",this._micEnabled&&!t?[4,this._startRecording()]:[3,4];case 3:n.sent(),n.label=4;case 4:return this._camEnabled&&console.warn("WavMediaManager does not support video input."),[2]}})})},e.prototype.disconnect=function(){return rt(this,void 0,Promise,function(){return nt(this,function(t){switch(t.label){case 0:return this._initialized?[4,this._wavRecorder.end()]:[2];case 1:return t.sent(),[4,this._wavStreamPlayer.interrupt()];case 2:return t.sent(),this._initialized=!1,[2]}})})},e.prototype.userStartedSpeaking=function(){return rt(this,void 0,Promise,function(){return nt(this,function(t){return[2,this._wavStreamPlayer.interrupt()]})})},e.prototype.bufferBotAudio=function(t,n){return this._wavStreamPlayer.add16BitPCM(t,n)},e.prototype.getAllMics=function(){return this._wavRecorder.listDevices()},e.prototype.getAllCams=function(){return Promise.resolve([])},e.prototype.getAllSpeakers=function(){return Promise.resolve([])},e.prototype.updateMic=function(t){return rt(this,void 0,Promise,function(){var n,i,a,s;return nt(this,function(c){switch(c.label){case 0:return n=this._wavRecorder.deviceSelection,this._wavRecorder.getStatus()==="ended"?[3,2]:[4,this._wavRecorder.end()];case 1:c.sent(),c.label=2;case 2:return c.trys.push([2,6,,7]),[4,this._wavRecorder.begin(t)];case 3:return c.sent(),this._micEnabled?[4,this._startRecording()]:[3,5];case 4:c.sent(),c.label=5;case 5:return i=this._wavRecorder.deviceSelection,i&&n&&n.label!==i.label&&((s=(a=this._callbacks).onMicUpdated)===null||s===void 0||s.call(a,i)),[3,7];case 6:return c.sent(),[3,7];case 7:return[2]}})})},e.prototype.updateCam=function(t){},e.prototype.updateSpeaker=function(t){},Object.defineProperty(e.prototype,"selectedMic",{get:function(){var t;return(t=this._wavRecorder.deviceSelection)!==null&&t!==void 0?t:{}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"selectedCam",{get:function(){return{}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"selectedSpeaker",{get:function(){return{}},enumerable:!1,configurable:!0}),e.prototype.enableMic=function(t){return rt(this,void 0,Promise,function(){var n=this;return nt(this,function(i){switch(i.label){case 0:return this._micEnabled=t,this._wavRecorder.stream?(this._wavRecorder.stream.getAudioTracks().forEach(function(a){var s,c;a.enabled=t,t||(c=(s=n._callbacks).onTrackStopped)===null||c===void 0||c.call(s,a,hl())}),t?[4,this._startRecording()]:[3,2]):[2];case 1:return i.sent(),[3,4];case 2:return[4,this._wavRecorder.pause()];case 3:i.sent(),i.label=4;case 4:return[2]}})})},e.prototype.enableCam=function(t){console.warn("WavMediaManager does not support video input.")},e.prototype.enableScreenShare=function(t){console.warn("WavMediaManager does not support screen sharing.")},Object.defineProperty(e.prototype,"isCamEnabled",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isMicEnabled",{get:function(){return this._micEnabled},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isSharingScreen",{get:function(){return!1},enumerable:!1,configurable:!0}),e.prototype.tracks=function(){var t,n=(t=this._wavRecorder.stream)===null||t===void 0?void 0:t.getTracks()[0];return{local:n?{audio:n}:{}}},e.prototype._startRecording=function(){return rt(this,void 0,void 0,function(){var t,n=this,i,a,s;return nt(this,function(c){switch(c.label){case 0:return[4,this._wavRecorder.record(function(u){var l;(l=n._userAudioCallback)===null||l===void 0||l.call(n,u.mono)},this._recorderChunkSize)];case 1:return c.sent(),t=(i=this._wavRecorder.stream)===null||i===void 0?void 0:i.getAudioTracks()[0],t&&((s=(a=this._callbacks).onTrackStarted)===null||s===void 0||s.call(a,t,hl())),[2]}})})},e.prototype._handleAvailableDevicesUpdated=function(t){var n,i,a,s;(i=(n=this._callbacks).onAvailableCamsUpdated)===null||i===void 0||i.call(n,t.filter(function(l){return l.kind==="videoinput"})),(s=(a=this._callbacks).onAvailableMicsUpdated)===null||s===void 0||s.call(a,t.filter(function(l){return l.kind==="audioinput"}));var c=t.find(function(l){return l.deviceId==="default"}),u=this._wavRecorder.deviceSelection;u&&(!t.some(function(l){return l.deviceId===u.deviceId})||u.deviceId==="default"&&u.label!==c?.label)&&this.updateMic("")},e.prototype._handleDeviceError=function(t){var n,i,a=t.devices,s=t.type,c=t.error,u=new Ve(a,s,c?.message,c?{sourceError:c}:void 0);(i=(n=this._callbacks).onDeviceError)===null||i===void 0||i.call(n,u)},e})(wd);var hl=function(){return{id:"local",name:"",local:!0}},og=(function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}})(),Se=function(r,e,t,n){function i(a){return a instanceof t?a:new t(function(s){s(a)})}return new(t||(t=Promise))(function(a,s){function c(f){try{l(n.next(f))}catch(v){s(v)}}function u(f){try{l(n.throw(f))}catch(v){s(v)}}function l(f){f.done?a(f.value):i(f.value).then(c,u)}l((n=n.apply(r,e||[])).next())})},ke=function(r,e){var t={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},n,i,a,s=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return s.next=c(0),s.throw=c(1),s.return=c(2),typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function c(l){return function(f){return u([l,f])}}function u(l){if(n)throw new TypeError("Generator is already executing.");for(;s&&(s=0,l[0]&&(t=0)),t;)try{if(n=1,i&&(a=l[0]&2?i.return:l[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,l[1])).done)return a;switch(i=0,a&&(l=[l[0]&2,a.value]),l[0]){case 0:case 1:a=l;break;case 4:return t.label++,{value:l[1],done:!1};case 5:t.label++,i=l[1],l=[0];continue;case 7:l=t.ops.pop(),t.trys.pop();continue;default:if(a=t.trys,!(a=a.length>0&&a[a.length-1])&&(l[0]===6||l[0]===2)){t=0;continue}if(l[0]===3&&(!a||l[1]>a[0]&&l[1]<a[3])){t.label=l[1];break}if(l[0]===6&&t.label<a[1]){t.label=a[1],a=l;break}if(a&&t.label<a[2]){t.label=a[2],t.ops.push(l);break}a[2]&&t.ops.pop(),t.trys.pop();continue}l=e.call(r,t)}catch(f){l=[6,f],i=0}finally{n=a=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}},cg=(function(r){og(e,r);function e(t,n,i,a,s,c,u){t===void 0&&(t=!0),n===void 0&&(n=!0),s===void 0&&(s=void 0),c===void 0&&(c=24e3),u===void 0&&(u=24e3);var l,f=r.call(this)||this;return f._selectedCam={},f._selectedMic={},f._selectedSpeaker={},f._remoteAudioLevelInterval=null,f._recorderChunkSize=void 0,f._initialized=!1,f._connected=!1,f._currentAudioTrack=null,f._connectResolve=null,f.onTrackStartedCallback=i,f.onTrackStoppedCallback=a,f._recorderChunkSize=s,f._supportsScreenShare=!0,f._daily=(l=ac.getCallInstance())!==null&&l!==void 0?l:ac.createCallObject(),n&&(f._mediaStreamRecorder=new ag({sampleRate:c})),t&&(f._wavStreamPlayer=new cs({sampleRate:u})),f._daily.on("track-started",f.handleTrackStarted.bind(f)),f._daily.on("track-stopped",f.handleTrackStopped.bind(f)),f._daily.on("available-devices-updated",f._handleAvailableDevicesUpdated.bind(f)),f._daily.on("selected-devices-updated",f._handleSelectedDevicesUpdated.bind(f)),f._daily.on("camera-error",f.handleDeviceError.bind(f)),f._daily.on("local-audio-level",f._handleLocalAudioLevel.bind(f)),f}return e.prototype.initialize=function(){return Se(this,void 0,Promise,function(){var t,n,i,a,s,c=this,u,l,f,v,b,k,y,m,_,S,C,A;return ke(this,function(O){switch(O.label){case 0:return this._initialized?(console.warn("DailyMediaManager already initialized"),[2]):[4,this._daily.startCamera({startVideoOff:!this._camEnabled,startAudioOff:!this._micEnabled,dailyConfig:{useDevicePreferenceCookies:!0}})];case 1:return t=O.sent(),[4,this._daily.enumerateDevices()];case 2:return n=O.sent().devices,i=n.filter(function(P){return P.kind==="videoinput"}),a=n.filter(function(P){return P.kind==="audioinput"}),s=n.filter(function(P){return P.kind==="audiooutput"}),(l=(u=this._callbacks).onAvailableCamsUpdated)===null||l===void 0||l.call(u,i),(v=(f=this._callbacks).onAvailableMicsUpdated)===null||v===void 0||v.call(f,a),(k=(b=this._callbacks).onAvailableSpeakersUpdated)===null||k===void 0||k.call(b,s),this._selectedCam=t.camera,(m=(y=this._callbacks).onCamUpdated)===null||m===void 0||m.call(y,t.camera),this._selectedMic=t.mic,(S=(_=this._callbacks).onMicUpdated)===null||S===void 0||S.call(_,t.mic),this._selectedSpeaker=t.speaker,(A=(C=this._callbacks).onSpeakerUpdated)===null||A===void 0||A.call(C,t.speaker),this._daily.isLocalAudioLevelObserverRunning()?[3,4]:[4,this._daily.startLocalAudioLevelObserver(100)];case 3:O.sent(),O.label=4;case 4:return this._wavStreamPlayer?[4,this._wavStreamPlayer.connect()]:[3,6];case 5:O.sent(),this._remoteAudioLevelInterval||(this._remoteAudioLevelInterval=setInterval(function(){var P,x=c._wavStreamPlayer.getFrequencies(),U=0;!((P=x.values)===null||P===void 0)&&P.length&&(U=x.values.reduce(function(Y,Q){return Y+Q},0)/x.values.length),c._handleRemoteAudioLevel(U)},100)),O.label=6;case 6:return this._initialized=!0,[2]}})})},e.prototype.connect=function(){return Se(this,void 0,Promise,function(){var t=this;return ke(this,function(n){return this._connected?(console.warn("DailyMediaManager already connected"),[2]):(this._connected=!0,this._initialized?(this._micEnabled&&this._startRecording(),[2]):[2,new Promise(function(i){(function(){return Se(t,void 0,void 0,function(){return ke(this,function(a){switch(a.label){case 0:return this._connectResolve=i,[4,this.initialize()];case 1:return a.sent(),[2]}})})})()})])})})},e.prototype.disconnect=function(){return Se(this,void 0,Promise,function(){var t,n;return ke(this,function(i){switch(i.label){case 0:return this._remoteAudioLevelInterval&&clearInterval(this._remoteAudioLevelInterval),this._remoteAudioLevelInterval=null,this._daily.leave(),this._currentAudioTrack=null,[4,(t=this._mediaStreamRecorder)===null||t===void 0?void 0:t.end()];case 1:return i.sent(),(n=this._wavStreamPlayer)===null||n===void 0||n.interrupt(),this._initialized=!1,this._connected=!1,[2]}})})},e.prototype.userStartedSpeaking=function(){return Se(this,void 0,Promise,function(){var t;return ke(this,function(n){return[2,(t=this._wavStreamPlayer)===null||t===void 0?void 0:t.interrupt()]})})},e.prototype.bufferBotAudio=function(t,n){var i;return(i=this._wavStreamPlayer)===null||i===void 0?void 0:i.add16BitPCM(t,n)},e.prototype.getAllMics=function(){return Se(this,void 0,Promise,function(){var t;return ke(this,function(n){switch(n.label){case 0:return[4,this._daily.enumerateDevices()];case 1:return t=n.sent().devices,[2,t.filter(function(i){return i.kind==="audioinput"})]}})})},e.prototype.getAllCams=function(){return Se(this,void 0,Promise,function(){var t;return ke(this,function(n){switch(n.label){case 0:return[4,this._daily.enumerateDevices()];case 1:return t=n.sent().devices,[2,t.filter(function(i){return i.kind==="videoinput"})]}})})},e.prototype.getAllSpeakers=function(){return Se(this,void 0,Promise,function(){var t;return ke(this,function(n){switch(n.label){case 0:return[4,this._daily.enumerateDevices()];case 1:return t=n.sent().devices,[2,t.filter(function(i){return i.kind==="audiooutput"})]}})})},e.prototype.updateMic=function(t){var n=this;this._daily.setInputDevicesAsync({audioDeviceId:t}).then(function(i){n._selectedMic=i.mic})},e.prototype.updateCam=function(t){var n=this;this._daily.setInputDevicesAsync({videoDeviceId:t}).then(function(i){n._selectedCam=i.camera})},e.prototype.updateSpeaker=function(t){return Se(this,void 0,Promise,function(){var n,i,a,s,c=this,u,l;return ke(this,function(f){switch(f.label){case 0:return t!=="default"&&this._selectedSpeaker.deviceId===t?[2]:(n=t,n!=="default"?[3,2]:[4,this.getAllSpeakers()]);case 1:if(i=f.sent(),a=i.find(function(v){return v.deviceId==="default"}),!a)return console.warn("No default speaker found"),[2];i.splice(i.indexOf(a),1),s=i.find(function(v){return a.label.includes(v.label)}),n=(u=s?.deviceId)!==null&&u!==void 0?u:t,f.label=2;case 2:return(l=this._wavStreamPlayer)===null||l===void 0||l.updateSpeaker(n).then(function(){var v,b;c._selectedSpeaker={deviceId:t},(b=(v=c._callbacks).onSpeakerUpdated)===null||b===void 0||b.call(v,c._selectedSpeaker)}),[2]}})})},Object.defineProperty(e.prototype,"selectedMic",{get:function(){return this._selectedMic},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"selectedCam",{get:function(){return this._selectedCam},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"selectedSpeaker",{get:function(){return this._selectedSpeaker},enumerable:!1,configurable:!0}),e.prototype.enableMic=function(t){return Se(this,void 0,Promise,function(){var n;return ke(this,function(i){return this._micEnabled=t,!((n=this._daily.participants())===null||n===void 0)&&n.local?(this._daily.setLocalAudio(t),this._mediaStreamRecorder&&(t?this._mediaStreamRecorder.getStatus()==="paused"&&this._startRecording():this._mediaStreamRecorder.getStatus()==="recording"&&this._mediaStreamRecorder.pause()),[2]):[2]})})},e.prototype.enableCam=function(t){this._camEnabled=t,this._daily.setLocalVideo(t)},e.prototype.enableScreenShare=function(t){t?this._daily.startScreenShare():this._daily.stopScreenShare()},Object.defineProperty(e.prototype,"isCamEnabled",{get:function(){return this._daily.localVideo()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isMicEnabled",{get:function(){return this._daily.localAudio()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isSharingScreen",{get:function(){return this._daily.localScreenAudio()||this._daily.localScreenVideo()},enumerable:!1,configurable:!0}),e.prototype.tracks=function(){var t,n,i,a,s,c,u,l,f,v,b,k,y=this._daily.participants();return{local:{audio:(i=(n=(t=y?.local)===null||t===void 0?void 0:t.tracks)===null||n===void 0?void 0:n.audio)===null||i===void 0?void 0:i.persistentTrack,screenAudio:(c=(s=(a=y?.local)===null||a===void 0?void 0:a.tracks)===null||s===void 0?void 0:s.screenAudio)===null||c===void 0?void 0:c.persistentTrack,screenVideo:(f=(l=(u=y?.local)===null||u===void 0?void 0:u.tracks)===null||l===void 0?void 0:l.screenVideo)===null||f===void 0?void 0:f.persistentTrack,video:(k=(b=(v=y?.local)===null||v===void 0?void 0:v.tracks)===null||b===void 0?void 0:b.video)===null||k===void 0?void 0:k.persistentTrack}}},e.prototype._startRecording=function(){var t=this;if(!(!this._connected||!this._mediaStreamRecorder))try{this._mediaStreamRecorder.record(function(i){t._userAudioCallback(i.mono)},this._recorderChunkSize)}catch(i){var n=i;n.message.includes("Already recording")||console.error("Error starting recording",i)}},e.prototype._handleAvailableDevicesUpdated=function(t){var n,i,a,s,c,u;(i=(n=this._callbacks).onAvailableCamsUpdated)===null||i===void 0||i.call(n,t.availableDevices.filter(function(l){return l.kind==="videoinput"})),(s=(a=this._callbacks).onAvailableMicsUpdated)===null||s===void 0||s.call(a,t.availableDevices.filter(function(l){return l.kind==="audioinput"})),(u=(c=this._callbacks).onAvailableSpeakersUpdated)===null||u===void 0||u.call(c,t.availableDevices.filter(function(l){return l.kind==="audiooutput"})),this._selectedSpeaker.deviceId==="default"&&this.updateSpeaker("default")},e.prototype._handleSelectedDevicesUpdated=function(t){var n,i,a,s,c,u;((n=this._selectedCam)===null||n===void 0?void 0:n.deviceId)!==t.devices.camera&&(this._selectedCam=t.devices.camera,(a=(i=this._callbacks).onCamUpdated)===null||a===void 0||a.call(i,t.devices.camera)),((s=this._selectedMic)===null||s===void 0?void 0:s.deviceId)!==t.devices.mic&&(this._selectedMic=t.devices.mic,(u=(c=this._callbacks).onMicUpdated)===null||u===void 0||u.call(c,t.devices.mic))},e.prototype.handleDeviceError=function(t){var n,i,a=function(s){var c=[];switch(s.type){case"permissions":return s.blockedMedia.forEach(function(u){c.push(u==="video"?"cam":"mic")}),new Ve(c,s.type,s.msg,{blockedBy:s.blockedBy});case"not-found":return s.missingMedia.forEach(function(u){c.push(u==="video"?"cam":"mic")}),new Ve(c,s.type,s.msg);case"constraints":return s.failedMedia.forEach(function(u){c.push(u==="video"?"cam":"mic")}),new Ve(c,s.type,s.msg,{reason:s.reason});case"cam-in-use":return c.push("cam"),new Ve(c,"in-use",s.msg);case"mic-in-use":return c.push("mic"),new Ve(c,"in-use",s.msg);case"cam-mic-in-use":return c.push("cam"),c.push("mic"),new Ve(c,"in-use",s.msg);case"undefined-mediadevices":case"unknown":default:return c.push("cam"),c.push("mic"),new Ve(c,s.type,s.msg)}};(i=(n=this._callbacks).onDeviceError)===null||i===void 0||i.call(n,a(t.error))},e.prototype._handleLocalAudioLevel=function(t){var n,i;(i=(n=this._callbacks).onLocalAudioLevel)===null||i===void 0||i.call(n,t.audioLevel)},e.prototype._handleRemoteAudioLevel=function(t){var n,i;(i=(n=this._callbacks).onRemoteAudioLevel)===null||i===void 0||i.call(n,t,ug())},e.prototype.handleTrackStarted=function(t){return Se(this,void 0,void 0,function(){var n,i,a,s,c,u;return ke(this,function(l){switch(l.label){case 0:if(!(!((a=t.participant)===null||a===void 0)&&a.local))return[2];if(t.track.kind!=="audio")return[3,15];if(!this._mediaStreamRecorder)return[3,14];switch(n=this._mediaStreamRecorder.getStatus(),i=n,i){case"ended":return[3,1];case"paused":return[3,5];case"recording":return[3,6]}return[3,6];case 1:return l.trys.push([1,3,,4]),[4,this._mediaStreamRecorder.begin(t.track)];case 2:return l.sent(),this._connected&&(this._startRecording(),this._connectResolve&&(this._connectResolve(),this._connectResolve=null)),[3,4];case 3:return l.sent(),[3,4];case 4:return[3,14];case 5:return this._startRecording(),[3,14];case 6:return this._currentAudioTrack===t.track?[3,12]:[4,this._mediaStreamRecorder.end()];case 7:l.sent(),l.label=8;case 8:return l.trys.push([8,10,,11]),[4,this._mediaStreamRecorder.begin(t.track)];case 9:return l.sent(),this._startRecording(),[3,11];case 10:return l.sent(),[3,11];case 11:return[3,13];case 12:console.warn("track-started event received for current track and already recording"),l.label=13;case 13:return[3,14];case 14:this._currentAudioTrack=t.track,l.label=15;case 15:return(c=(s=this._callbacks).onTrackStarted)===null||c===void 0||c.call(s,t.track,t.participant?fl(t.participant):void 0),(u=this.onTrackStartedCallback)===null||u===void 0||u.call(this,t),[2]}})})},e.prototype.handleTrackStopped=function(t){var n,i,a,s;!((n=t.participant)===null||n===void 0)&&n.local&&(t.track.kind==="audio"&&this._mediaStreamRecorder&&this._mediaStreamRecorder.getStatus()==="recording"&&this._mediaStreamRecorder.pause(),(a=(i=this._callbacks).onTrackStopped)===null||a===void 0||a.call(i,t.track,t.participant?fl(t.participant):void 0),(s=this.onTrackStoppedCallback)===null||s===void 0||s.call(this,t))},e})(wd),fl=function(r){return{id:r.user_id,local:r.local,name:r.user_name}},ug=function(){return{id:"bot",local:!1,name:"Bot"}},lg={};Kv(lg,"SmallWebRTCTransport",()=>kd);class bt{constructor(e,t){this.type="trackStatus",this.receiver_index=e,this.enabled=t}}class dg{constructor(e){this.track=e,this.status="new"}}const hg="peerLeft",Sd="signalling";class fg{constructor(e){this.type=Sd,this.message=e}}const ua=0,la=1,da=2;class kd extends Td{constructor(e={}){super(),this._webrtcRequest=null,this._connectResolved=null,this._connectFailed=null,this.pc=null,this.dc=null,this.audioCodec=null,this.videoCodec=null,this.pc_id=null,this.reconnectionAttempts=0,this.maxReconnectionAttempts=3,this.isReconnecting=!1,this.keepAliveInterval=null,this._iceServers=[],this._incomingTracks=new Map,this._canSendIceCandidates=!1,this._candidateQueue=[],this.__flushTimeout=null,this._flushDelay=200,this._iceServers=e.iceServers??[],this._waitForICEGathering=e.waitForICEGathering??!1,this.audioCodec=e.audioCodec??null,this.videoCodec=e.videoCodec??null,this._webrtcRequest=this._resolveRequestInfo(e),this.mediaManager=e.mediaManager||new cg(!1,!1,async t=>{this.pc&&(t.type=="audio"?(R.info("SmallWebRTCMediaManager replacing audio track"),await this.getAudioTransceiver().sender.replaceTrack(t.track)):t.type=="video"?(R.info("SmallWebRTCMediaManager replacing video track"),await this.getVideoTransceiver().sender.replaceTrack(t.track)):t.type=="screenVideo"?(R.info("SmallWebRTCMediaManager replacing screen video track"),await this.getScreenVideoTransceiver().sender.replaceTrack(t.track)):t.type=="screenAudio"&&R.info("SmallWebRTCMediaManager does not yet support screen audio. Track is ignored."))},t=>R.debug("SmallWebRTCMediaManager Track stopped:",t))}initialize(e,t){this._options=e,this._callbacks=e.callbacks??{},this._onMessage=t,this.mediaManager.setClientOptions(e),this.state="disconnected",R.debug("[RTVI Transport] Initialized")}async initDevices(){this.state="initializing",await this.mediaManager.initialize(),this.state="initialized"}setAudioCodec(e){this.audioCodec=e}setVideoCodec(e){this.videoCodec=e}_resolveRequestInfo(e){let t=null;const n=e.webrtcUrl??e.connectionUrl??null;if(n){const i=e.webrtcUrl?"webrtcUrl":"connectionUrl";R.warn(`${i} is deprecated. Use webrtcRequestParams instead.`),e.webrtcRequestParams?R.warn(`Both ${i} and webrtcRequestParams provided. Using webrtcRequestParams.`):typeof n=="string"?t={endpoint:n}:R.error(`Invalid ${i} provided in params. Ignoring.`)}return e.webrtcRequestParams&&(Ed(e.webrtcRequestParams)?t=e.webrtcRequestParams:R.error("Invalid webrtcRequestParams provided in params. Ignoring.")),t??this._webrtcRequest}_getStartEndpointAsString(){const e=this.startBotParams?.endpoint;switch(typeof e){case"string":return e;case"object":if(e instanceof URL)return e.toString();if(e instanceof Request)return e.url}}_isValidObject(e){if(e==null)return!1;if(typeof e!="object")throw new Ad("Invalid connection parameters");return!0}_fixConnectionOptionsParams(e,t){const n=s=>s.replace(/_([a-z,A-Z])/g,(c,u)=>u.toUpperCase());let i={},a;for(const[s,c]of Object.entries(e)){const u=n(s);if(u==="sessionId"){a=c;continue}if(!t.includes(u)){R.warn(`Unrecognized connection parameter: ${s}. Ignored.`);continue}i[u]=c}return a&&this._shouldUseStartBotFallback(i)&&(i.webrtcRequestParams=this._buildRequestParamsBasedOnStartBotParams(a)),i}_shouldUseStartBotFallback(e){const t=!!this._getStartEndpointAsString(),n=!e.webrtcUrl&&!e.connectionUrl&&!e.webrtcRequestParams;return t&&n}_buildRequestParamsBasedOnStartBotParams(e){return{endpoint:this._getStartEndpointAsString().replace("/start",`/sessions/${e}/api/offer`),headers:this.startBotParams.headers}}_validateConnectionParams(e){if(!this._isValidObject(e))return;const t=e,n=["webrtcUrl","connectionUrl","webrtcRequestParams","iceConfig"],i=this._fixConnectionOptionsParams(t,n),a=this._resolveRequestInfo(i);if(a&&(i.webrtcRequestParams=a),delete i.connectionUrl,delete i.webrtcUrl,Object.keys(i).length!==0)return i}async _connect(e){if(!this._abortController?.signal.aborted){if(this.state="connecting",e?.iceConfig?.iceServers&&(this._iceServers=e?.iceConfig?.iceServers),this._webrtcRequest=e?.webrtcRequestParams??this._webrtcRequest,!this._webrtcRequest)throw R.error("No request details provided for WebRTC connection"),this.state="error",new fs;await this.mediaManager.connect(),await this.startNewPeerConnection(),!this._abortController?.signal.aborted&&(this.dc?.readyState!=="open"&&await new Promise((t,n)=>{this._connectResolved=t,this._connectFailed=n}),this.state="connected",this._callbacks.onConnected?.())}}syncTrackStatus(){this.sendSignallingMessage(new bt(ua,this.mediaManager.isMicEnabled)),this.sendSignallingMessage(new bt(la,this.mediaManager.isCamEnabled)),this.mediaManager.supportsScreenShare&&this.sendSignallingMessage(new bt(da,this.mediaManager.isSharingScreen&&!!this.mediaManager.tracks().local.screenVideo))}sendReadyMessage(){this.state="ready",this.sendMessage(Od.clientReady())}sendMessage(e){if(!this.dc||this.dc.readyState!=="open"){R.warn(`Datachannel is not ready. Message not sent: ${e}`);return}this.dc?.send(JSON.stringify(e))}sendSignallingMessage(e){if(!this.dc||this.dc.readyState!=="open"){R.warn(`Datachannel is not ready. Message not sent: ${e}`);return}const t=new fg(e);this.dc?.send(JSON.stringify(t))}async _disconnect(){this.state="disconnecting",await this.stop(),this.state="disconnected"}createPeerConnection(){const e={iceServers:this._iceServers};let t=new RTCPeerConnection(e);return t.onicecandidate=async n=>{n.candidate?(R.debug("New ICE candidate:",n.candidate),await this.sendIceCandidate(n.candidate)):R.info("All ICE candidates have been sent.")},t.addEventListener("icegatheringstatechange",()=>{t.iceGatheringState==="complete"&&t.iceConnectionState==="checking"&&this._waitForICEGathering&&R.info("Ice gathering state changed:",t.iceGatheringState)}),t.addEventListener("iceconnectionstatechange",()=>this.handleICEConnectionStateChange()),R.debug(`iceConnectionState: ${t.iceConnectionState}`),t.addEventListener("signalingstatechange",()=>{R.debug(`signalingState: ${this.pc.signalingState}`),this.pc.signalingState=="stable"&&this.handleReconnectionCompleted()}),R.debug(`signalingState: ${t.signalingState}`),t.addEventListener("track",n=>{const i=n.transceiver?n.transceiver.mid==="0"?"microphone":n.transceiver.mid==="1"?"camera":"screenVideo":null;if(!i){R.warn("Received track without transceiver mid",n);return}R.debug(`Received new remote track for ${i}`),this._incomingTracks.set(i,new dg(n.track)),n.track.addEventListener("unmute",()=>{const a=this._incomingTracks.get(i);a&&(R.debug(`Remote track unmuted: ${i}`),a.status="unmuted",this._callbacks.onTrackStarted?.(n.track))}),n.track.addEventListener("mute",()=>{const a=this._incomingTracks.get(i);!a||a.status!=="unmuted"||(R.debug(`Remote track muted: ${i}`),a.status="muted",this._callbacks.onTrackStopped?.(n.track))}),n.track.addEventListener("ended",()=>{R.debug(`Remote track ended: ${i}`),this._callbacks.onTrackStopped?.(n.track),this._incomingTracks.delete(i)})}),t}handleICEConnectionStateChange(){this.pc&&(R.debug(`ICE Connection State: ${this.pc.iceConnectionState}`),this.pc.iceConnectionState==="failed"?(R.debug("ICE connection failed, attempting restart."),this.attemptReconnection(!0)):this.pc.iceConnectionState==="disconnected"&&setTimeout(()=>{this.pc?.iceConnectionState==="disconnected"&&(R.debug("Still disconnected, attempting reconnection."),this.attemptReconnection(!0))},3e5))}handleReconnectionCompleted(){this.reconnectionAttempts=0,this.isReconnecting=!1}async attemptReconnection(e=!1){if(this.isReconnecting){R.debug("Reconnection already in progress, skipping.");return}if(this.reconnectionAttempts>=this.maxReconnectionAttempts){R.debug("Max reconnection attempts reached. Stopping transport."),await this.stop();return}if(this.isReconnecting=!0,this.reconnectionAttempts++,R.debug(`Reconnection attempt ${this.reconnectionAttempts}...`),e){const t=this.pc;await this.startNewPeerConnection(e),t&&(R.debug("closing old peer connection"),this.closePeerConnection(t))}else await this.negotiate()}async waitForIceGatheringComplete(e=2e3){const t=this.pc;if(t.iceGatheringState!=="complete")return R.info("Waiting for ICE gathering to complete. Current state:",t.iceGatheringState),new Promise(n=>{let i;const a=()=>{t.removeEventListener("icegatheringstatechange",s),clearTimeout(i)},s=()=>{R.debug("icegatheringstatechange:",t.iceGatheringState),t.iceGatheringState==="complete"&&(a(),n())},c=()=>{R.debug(`ICE gathering timed out after ${e} ms.`),a(),n()};t.addEventListener("icegatheringstatechange",s),i=setTimeout(c,e),s()})}async sendIceCandidate(e){if(!this._webrtcRequest){R.error("No request details provided for WebRTC connection");return}this._candidateQueue.push(e),this.__flushTimeout||(this.__flushTimeout=setTimeout(()=>this.flushIceCandidates(),this._flushDelay))}async flushIceCandidates(){if(this.__flushTimeout=null,!this._webrtcRequest||this._candidateQueue.length===0||!this._canSendIceCandidates)return;const e=this._candidateQueue.splice(0,this._candidateQueue.length);try{const t=new Headers({"Content-Type":"application/json",...Object.fromEntries((this._webrtcRequest.headers??new Headers).entries())}),n={pc_id:this.pc_id,candidates:e.map(i=>({candidate:i.candidate,sdp_mid:i.sdpMid,sdp_mline_index:i.sdpMLineIndex}))};await fetch(this._webrtcRequest.endpoint,{method:"PATCH",headers:t,body:JSON.stringify(n)})}catch(t){R.error(`Failed to send ICE candidate: ${t}`)}}async negotiate(e=!1){if(!this.pc)return Promise.reject("Peer connection is not initialized");if(!this._webrtcRequest)throw R.error("No request details provided for WebRTC connection"),this.state="error",new fs;try{const t=await this.pc.createOffer();await this.pc.setLocalDescription(t),this._waitForICEGathering&&await this.waitForIceGatheringComplete();let n=this.pc.localDescription;this.audioCodec&&this.audioCodec!=="default"&&(n.sdp=this.sdpFilterCodec("audio",this.audioCodec,n.sdp)),this.videoCodec&&this.videoCodec!=="default"&&(n.sdp=this.sdpFilterCodec("video",this.videoCodec,n.sdp)),R.debug(`Will create offer for peerId: ${this.pc_id}`);const i=Hv(this._webrtcRequest),a={sdp:n.sdp,type:n.type,pc_id:this.pc_id,restart_pc:e};this._webrtcRequest.requestData&&(a.requestData=this._webrtcRequest.requestData),i.requestData=a;const s=await Pd(i);this.pc_id=s.pc_id,R.debug(`Received answer for peer connection id ${s.pc_id}`),await this.pc.setRemoteDescription(s)}catch(t){R.debug(`Reconnection attempt ${this.reconnectionAttempts} failed: ${t}`),this.isReconnecting=!1,setTimeout(()=>this.attemptReconnection(!0),3e5)}}addInitialTransceivers(){this.pc.addTransceiver("audio",{direction:"sendrecv"}),this.pc.addTransceiver("video",{direction:"sendrecv"}),this.mediaManager.supportsScreenShare&&this.pc.addTransceiver("video",{direction:"sendonly"})}getAudioTransceiver(){return this.pc.getTransceivers()[ua]}getVideoTransceiver(){return this.pc.getTransceivers()[la]}getScreenVideoTransceiver(){return this.pc.getTransceivers()[da]}async startNewPeerConnection(e=!1){this.pc=this.createPeerConnection(),this.addInitialTransceivers(),this.dc=this.createDataChannel("chat",{ordered:!0}),await this.addUserMedia(),await this.negotiate(e),this._canSendIceCandidates=!0,await this.flushIceCandidates()}async addUserMedia(){R.debug(`addUserMedia this.tracks(): ${this.tracks()}`);let e=this.tracks().local.audio;R.debug(`addUserMedia audioTrack: ${e}`),e&&await this.getAudioTransceiver().sender.replaceTrack(e);let t=this.tracks().local.video;R.debug(`addUserMedia videoTrack: ${t}`),t&&await this.getVideoTransceiver().sender.replaceTrack(t),this.mediaManager.supportsScreenShare&&(t=this.tracks().local.screenVideo,R.debug(`addUserMedia screenVideoTrack: ${t}`),t&&await this.getScreenVideoTransceiver().sender.replaceTrack(t))}handleMessage(e){try{const t=JSON.parse(e);R.debug("received message:",t),t.type===Sd?this.handleSignallingMessage(t):t.label==="rtvi-ai"&&this._onMessage({id:t.id,type:t.type,data:t.data})}catch(t){R.error("Failed to parse JSON message:",t)}}async handleSignallingMessage(e){const t=e;switch(t.message.type){case hg:this.disconnect();break;default:R.warn("Unknown signalling message:",t.message)}}createDataChannel(e,t){const n=this.pc.createDataChannel(e,t);return n.addEventListener("close",()=>{R.debug("datachannel closed"),this.keepAliveInterval&&(clearInterval(this.keepAliveInterval),this.keepAliveInterval=null)}),n.addEventListener("open",()=>{R.debug("datachannel opened"),this._connectResolved&&(this.syncTrackStatus(),this._connectResolved(),this._connectResolved=null,this._connectFailed=null),this.keepAliveInterval=setInterval(()=>{const i="ping: "+new Date().getTime();n.send(i)},1e3)}),n.addEventListener("message",i=>{let a=i.data;this.handleMessage(a)}),n}closePeerConnection(e){e.getTransceivers().forEach(t=>{t.stop&&t.stop()}),e.getSenders().forEach(t=>{t.track?.stop()}),e.close()}async stop(){if(!this.pc){R.debug("Peer connection is already closed or null.");return}this.dc&&this.dc.close(),this.closePeerConnection(this.pc),this.pc=null,await this.mediaManager.disconnect(),this.pc_id=null,this.reconnectionAttempts=0,this.isReconnecting=!1,this._callbacks.onDisconnected?.(),this._candidateQueue=[],this._canSendIceCandidates=!1,this._connectFailed&&this._connectFailed(),this._connectFailed=null,this._connectResolved=null}getAllMics(){return this.mediaManager.getAllMics()}getAllCams(){return this.mediaManager.getAllCams()}getAllSpeakers(){return this.mediaManager.getAllSpeakers()}async updateMic(e){return this.mediaManager.updateMic(e)}updateCam(e){return this.mediaManager.updateCam(e)}updateSpeaker(e){return this.mediaManager.updateSpeaker(e)}get selectedMic(){return this.mediaManager.selectedMic}get selectedCam(){return this.mediaManager.selectedCam}get selectedSpeaker(){return this.mediaManager.selectedSpeaker}set iceServers(e){this._iceServers=e}get iceServers(){return this._iceServers}enableMic(e){this.mediaManager.enableMic(e),this.sendSignallingMessage(new bt(ua,e))}enableCam(e){this.mediaManager.enableCam(e),this.sendSignallingMessage(new bt(la,e))}async enableScreenShare(e){if(!this.mediaManager.supportsScreenShare)throw new Id("enableScreenShare","mediaManager","Screen sharing is not supported by the current media manager");this.mediaManager.enableScreenShare(e),this.sendSignallingMessage(new bt(da,e))}get isCamEnabled(){return this.mediaManager.isCamEnabled}get isMicEnabled(){return this.mediaManager.isMicEnabled}get isSharingScreen(){return this.mediaManager.isSharingScreen}get state(){return this._state}set state(e){this._state!==e&&(this._state=e,this._callbacks.onTransportStateChanged?.(e))}tracks(){return this.mediaManager.tracks()}sdpFilterCodec(e,t,n){const i=[],a=new RegExp("a=fmtp:(\\d+) apt=(\\d+)\\r$"),s=new RegExp("a=rtpmap:([0-9]+) "+this.escapeRegExp(t)),c=new RegExp("(m="+e+" .*?)( ([0-9]+))*\\s*$"),u=n.split(`
`);let l=!1;for(let b=0;b<u.length;b++)if(u[b].startsWith("m="+e+" ")?l=!0:u[b].startsWith("m=")&&(l=!1),l){const k=u[b].match(s);k&&i.push(parseInt(k[1]));const y=u[b].match(a);y&&i.includes(parseInt(y[2]))&&i.push(parseInt(y[1]))}const f="a=(fmtp|rtcp-fb|rtpmap):([0-9]+)";let v="";l=!1;for(let b=0;b<u.length;b++)if(u[b].startsWith("m="+e+" ")?l=!0:u[b].startsWith("m=")&&(l=!1),l){const k=u[b].match(f);if(k&&!i.includes(parseInt(k[2])))continue;u[b].match(c)?v+=u[b].replace(c,"$1 "+i.join(" "))+`
`:v+=u[b]+`
`}else v+=u[b]+`
`;return v}escapeRegExp(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}}kd.SERVICE_NAME="small-webrtc-transport";export{cg as DailyMediaManager,kd as SmallWebRTCTransport};
